(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{6397:function(e,t,n){"use strict";n.d(t,{R_:function(){return h},ez:function(){return d}});var r=n(6500),i=n(1350),s=[{index:7,opacity:.15},{index:6,opacity:.25},{index:5,opacity:.3},{index:5,opacity:.45},{index:5,opacity:.65},{index:5,opacity:.85},{index:4,opacity:.9},{index:3,opacity:.95},{index:2,opacity:.97},{index:1,opacity:.98}];function o(e){var t=e.r,n=e.g,i=e.b,s=(0,r.py)(t,n,i);return{h:360*s.h,s:s.s,v:s.v}}function a(e){var t=e.r,n=e.g,i=e.b;return"#".concat((0,r.vq)(t,n,i,!1))}function l(e,t,n){var r;return(r=Math.round(e.h)>=60&&240>=Math.round(e.h)?n?Math.round(e.h)-2*t:Math.round(e.h)+2*t:n?Math.round(e.h)+2*t:Math.round(e.h)-2*t)<0?r+=360:r>=360&&(r-=360),r}function u(e,t,n){var r;return 0===e.h&&0===e.s?e.s:((r=n?e.s-.16*t:4===t?e.s+.16:e.s+.05*t)>1&&(r=1),n&&5===t&&r>.1&&(r=.1),r<.06&&(r=.06),Number(r.toFixed(2)))}function c(e,t,n){var r;return(r=n?e.v+.05*t:e.v-.15*t)>1&&(r=1),Number(r.toFixed(2))}function h(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=[],r=(0,i.uA)(e),h=5;h>0;h-=1){var d=o(r),f=a((0,i.uA)({h:l(d,h,!0),s:u(d,h,!0),v:c(d,h,!0)}));n.push(f)}n.push(a(r));for(var p=1;p<=4;p+=1){var g=o(r),m=a((0,i.uA)({h:l(g,p),s:u(g,p),v:c(g,p)}));n.push(m)}return"dark"===t.theme?s.map(function(e){var r,s,o,l=e.index,u=e.opacity;return a((r=(0,i.uA)(t.backgroundColor||"#141414"),s=(0,i.uA)(n[l]),o=100*u/100,{r:(s.r-r.r)*o+r.r,g:(s.g-r.g)*o+r.g,b:(s.b-r.b)*o+r.b}))}):n}var d={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},f={},p={};Object.keys(d).forEach(function(e){f[e]=h(d[e]),f[e].primary=f[e][5],p[e]=h(d[e],{theme:"dark",backgroundColor:"#141414"}),p[e].primary=p[e][5]}),f.red,f.volcano,f.gold,f.orange,f.yellow,f.lime,f.green,f.cyan,f.blue,f.geekblue,f.purple,f.magenta,f.grey,f.grey},7431:function(e,t,n){"use strict";n.d(t,{E4:function(){return ea},jG:function(){return ed},fp:function(){return S},xy:function(){return eo}});var r=n(1413),i=n(4902),s=function(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))*1540483477+((t>>>16)*59797<<16),t^=t>>>24,n=(65535&t)*1540483477+((t>>>16)*59797<<16)^(65535&n)*1540483477+((n>>>16)*59797<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n^=255&e.charCodeAt(r),n=(65535&n)*1540483477+((n>>>16)*59797<<16)}return n^=n>>>13,(((n=(65535&n)*1540483477+((n>>>16)*59797<<16))^n>>>15)>>>0).toString(36)},o=n(7294);n(6982),n(1881);var a=n(5671),l=n(3144),u=n(4942),c=function(){function e(t){(0,a.Z)(this,e),(0,u.Z)(this,"instanceId",void 0),(0,u.Z)(this,"cache",new Map),this.instanceId=t}return(0,l.Z)(e,[{key:"get",value:function(e){return this.cache.get(e.join("%"))||null}},{key:"update",value:function(e,t){var n=e.join("%"),r=t(this.cache.get(n));null===r?this.cache.delete(n):this.cache.set(n,r)}}]),e}(),h="data-token-hash",d="data-css-hash",f="__cssinjs_instance__",p=o.createContext({hashPriority:"low",cache:function(){var e=Math.random().toString(12).slice(2);if("undefined"!=typeof document&&document.head&&document.body){var t=document.body.querySelectorAll("style[".concat(d,"]"))||[],n=document.head.firstChild;Array.from(t).forEach(function(t){t[f]=t[f]||e,t[f]===e&&document.head.insertBefore(t,n)});var r={};Array.from(document.querySelectorAll("style[".concat(d,"]"))).forEach(function(t){var n,i=t.getAttribute(d);r[i]?t[f]===e&&(null===(n=t.parentNode)||void 0===n||n.removeChild(t)):r[i]=!0})}return new c(e)}(),defaultCache:!0}),g=n(1002),m=n(8924),y=n(4958);function v(e){var t="";return Object.keys(e).forEach(function(n){var r=e[n];t+=n,r&&"object"===(0,g.Z)(r)?t+=v(r):t+=r}),t}var _="layer-".concat(Date.now(),"-").concat(Math.random()).replace(/\./g,""),w="903px",b=void 0,I=n(7685);function T(e,t,n,r){var s=o.useContext(p).cache,a=[e].concat((0,i.Z)(t));return o.useMemo(function(){s.update(a,function(e){var t=(0,I.Z)(e||[],2),r=t[0];return[(void 0===r?0:r)+1,t[1]||n()]})},[a.join("_")]),o.useEffect(function(){return function(){s.update(a,function(e){var t=(0,I.Z)(e||[],2),n=t[0],i=void 0===n?0:n,s=t[1];return 0==i-1?(null==r||r(s,!1),null):[i-1,s]})}},a),s.get(a)[1]}var E={},C=new Map;function S(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=(0,o.useContext)(p).cache.instanceId,l=n.salt,u=void 0===l?"":l,c=n.override,d=void 0===c?E:c,g=n.formatToken,m=o.useMemo(function(){return Object.assign.apply(Object,[{}].concat((0,i.Z)(t)))},[t]),y=o.useMemo(function(){return v(m)},[m]),_=o.useMemo(function(){return v(d)},[d]);return T("token",[u,e.id,y,_],function(){var t,n=e.getDerivativeToken(m),i=(0,r.Z)((0,r.Z)({},n),d);g&&(i=g(i));var o=(t=i,s("".concat(u,"_").concat(v(t))));i._tokenKey=o,C.set(o,(C.get(o)||0)+1);var a="".concat("css","-").concat(s(o));return i._hashId=a,[i,a]},function(e){var t,n,r;t=e[0]._tokenKey,C.set(t,(C.get(t)||0)-1),(r=(n=Array.from(C.keys())).filter(function(e){return 0>=(C.get(e)||0)})).length<n.length&&r.forEach(function(e){"undefined"!=typeof document&&document.querySelectorAll("style[".concat(h,'="').concat(e,'"]')).forEach(function(e){if(e[f]===a){var t;null===(t=e.parentNode)||void 0===t||t.removeChild(e)}}),C.delete(e)})})}var k=n(7462),x={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},A="comm",R="rule",N="decl",P=Math.abs,D=String.fromCharCode;function O(e,t,n){return e.replace(t,n)}function F(e,t){return 0|e.charCodeAt(t)}function L(e,t,n){return e.slice(t,n)}function M(e){return e.length}function U(e,t){return t.push(e),e}function V(e,t){for(var n="",r=e.length,i=0;i<r;i++)n+=t(e[i],i,e,t)||"";return n}function q(e,t,n,r){switch(e.type){case"@import":case N:return e.return=e.return||e.value;case A:return"";case"@keyframes":return e.return=e.value+"{"+V(e.children,r)+"}";case R:e.value=e.props.join(",")}return M(n=V(e.children,r))?e.return=e.value+"{"+n+"}":""}var j=1,B=1,z=0,$=0,H=0,W="";function G(e,t,n,r,i,s,o){return{value:e,root:t,parent:n,type:r,props:i,children:s,line:j,column:B,length:o,return:""}}function K(){return H=$<z?F(W,$++):0,B++,10===H&&(B=1,j++),H}function Z(){return F(W,$)}function Q(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function Y(e){var t,n;return(t=$-1,n=function e(t){for(;K();)switch(H){case t:return $;case 34:case 39:34!==t&&39!==t&&e(H);break;case 40:41===t&&e(t);break;case 92:K()}return $}(91===e?e+2:40===e?e+1:e),L(W,t,n)).trim()}function X(e,t,n,r,i,s,o,a,l,u,c){for(var h=i-1,d=0===i?s:[""],f=d.length,p=0,g=0,m=0;p<r;++p)for(var y=0,v=L(e,h+1,h=P(g=o[p])),_=e;y<f;++y)(_=(g>0?d[y]+" "+v:O(v,/&\f/g,d[y])).trim())&&(l[m++]=_);return G(e,t,n,0===i?R:a,l,u,c)}function J(e,t,n,r){return G(e,t,n,N,L(e,0,r),L(e,r+1,-1),r)}var ee=n(334),et=(0,m.Z)(),en="_multi_value_";function er(e){var t,n,r;return V((r=function e(t,n,r,i,s,o,a,l,u){for(var c,h=0,d=0,f=a,p=0,g=0,m=0,y=1,v=1,_=1,w=0,b="",I=s,T=o,E=i,C=b;v;)switch(m=w,w=K()){case 40:if(108!=m&&58==F(C,f-1)){-1!=(C+=O(Y(w),"&","&\f")).indexOf("&\f")&&(_=-1);break}case 34:case 39:case 91:C+=Y(w);break;case 9:case 10:case 13:case 32:C+=function(e){for(;H=Z();)if(H<33)K();else break;return Q(e)>2||Q(H)>3?"":" "}(m);break;case 92:C+=function(e,t){for(var n;--t&&K()&&!(H<48)&&!(H>102)&&(!(H>57)||!(H<65))&&(!(H>70)||!(H<97)););return n=$+(t<6&&32==Z()&&32==K()),L(W,e,n)}($-1,7);continue;case 47:switch(Z()){case 42:case 47:U(G(c=function(e,t){for(;K();)if(e+H===57)break;else if(e+H===84&&47===Z())break;return"/*"+L(W,t,$-1)+"*"+D(47===e?e:K())}(K(),$),n,r,A,D(H),L(c,2,-2),0),u);break;default:C+="/"}break;case 123*y:l[h++]=M(C)*_;case 125*y:case 59:case 0:switch(w){case 0:case 125:v=0;case 59+d:-1==_&&(C=O(C,/\f/g,"")),g>0&&M(C)-f&&U(g>32?J(C+";",i,r,f-1):J(O(C," ","")+";",i,r,f-2),u);break;case 59:C+=";";default:if(U(E=X(C,n,r,h,d,s,l,b,I=[],T=[],f),o),123===w){if(0===d)e(C,n,E,E,I,o,f,l,T);else switch(99===p&&110===F(C,3)?100:p){case 100:case 109:case 115:e(t,E,E,i&&U(X(t,E,E,0,0,s,l,b,s,I=[],f),T),s,T,f,l,i?I:T);break;default:e(C,E,E,E,[""],T,0,l,T)}}}h=d=g=0,y=_=1,b=C="",f=a;break;case 58:f=1+M(C),g=m;default:if(y<1){if(123==w)--y;else if(125==w&&0==y++&&125==(H=$>0?F(W,--$):0,B--,10===H&&(B=1,j--),H))continue}switch(C+=D(w),w*y){case 38:_=d>0?1:(C+="\f",-1);break;case 44:l[h++]=(M(C)-1)*_,_=1;break;case 64:45===Z()&&(C+=Y(K())),p=Z(),d=f=M(b=C+=function(e){for(;!Q(Z());)K();return L(W,e,$)}($)),w++;break;case 45:45===m&&2==M(C)&&(y=0)}}return o}("",null,null,null,[""],(n=t=e,j=B=1,z=M(W=n),$=0,t=[]),0,[0],t),W="",r),q).replace(/\{%%%\:[^;];}/g,";")}var ei=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{root:!0,parentSelectors:[]},o=s.root,a=s.injectHash,l=s.parentSelectors,u=n.hashId,c=n.layer,h=(n.path,n.hashPriority),d=n.transformers,f=void 0===d?[]:d;n.linters;var p="",v={};function T(t){var r=t.getName(u);if(!v[r]){var i=e(t.style,n,{root:!1,parentSelectors:l}),s=(0,I.Z)(i,1)[0];v[r]="@keyframes ".concat(t.getName(u)).concat(s)}}if((function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t.forEach(function(t){Array.isArray(t)?e(t,n):t&&n.push(t)}),n})(Array.isArray(t)?t:[t]).forEach(function(t){var s="string"!=typeof t||o?t:{};if("string"==typeof s)p+="".concat(s,"\n");else if(s._keyframe)T(s);else{var c=f.reduce(function(e,t){var n;return(null==t?void 0:null===(n=t.visit)||void 0===n?void 0:n.call(t,e))||e},s);Object.keys(c).forEach(function(t){var s=c[t];if("object"!==(0,g.Z)(s)||!s||"animationName"===t&&s._keyframe||"object"===(0,g.Z)(s)&&s&&("_skip_check_"in s||en in s)){function d(e,t){var n=e.replace(/[A-Z]/g,function(e){return"-".concat(e.toLowerCase())}),r=t;x[e]||"number"!=typeof r||0===r||(r="".concat(r,"px")),"animationName"===e&&null!=t&&t._keyframe&&(T(t),r=t.getName(u)),p+="".concat(n,":").concat(r,";")}var f,m=null!==(f=null==s?void 0:s.value)&&void 0!==f?f:s;"object"===(0,g.Z)(s)&&null!=s&&s[en]&&Array.isArray(m)?m.forEach(function(e){d(t,e)}):d(t,m)}else{var y=!1,_=t.trim(),w=!1;(o||a)&&u?_.startsWith("@")?y=!0:_=function(e,t,n){if(!t)return e;var r=".".concat(t),s="low"===n?":where(".concat(r,")"):r;return e.split(",").map(function(e){var t,n=e.trim().split(/\s+/),r=n[0]||"",o=(null===(t=r.match(/^\w+/))||void 0===t?void 0:t[0])||"";return[r="".concat(o).concat(s).concat(r.slice(o.length))].concat((0,i.Z)(n.slice(1))).join(" ")}).join(",")}(t,u,h):o&&!u&&("&"===_||""===_)&&(_="",w=!0);var b=e(s,n,{root:w,injectHash:y,parentSelectors:[].concat((0,i.Z)(l),[_])}),E=(0,I.Z)(b,2),C=E[0],S=E[1];v=(0,r.Z)((0,r.Z)({},v),S),p+="".concat(_).concat(C)}})}}),o){if(c&&(void 0===b&&(b=function(e,t){if((0,m.Z)()){(0,y.hq)(e,_);var n,r=document.createElement("div");r.style.position="fixed",r.style.left="0",r.style.top="0",null==t||t(r),document.body.appendChild(r);var i=getComputedStyle(r).width===w;return null===(n=r.parentNode)||void 0===n||n.removeChild(r),(0,y.jL)(_),i}return!1}("@layer ".concat(_," { .").concat(_," { width: ").concat(w,"!important; } }"),function(e){e.className=_})),b)){var E=c.split(","),C=E[E.length-1].trim();p="@layer ".concat(C," {").concat(p,"}"),E.length>1&&(p="@layer ".concat(c,"{%%%:%}").concat(p))}}else p="{".concat(p,"}");return[p,v]};function es(){return null}function eo(e,t){var n=e.token,r=e.path,a=e.hashId,l=e.layer,c=e.nonce,g=o.useContext(p),m=g.autoClear,v=(g.mock,g.defaultCache),_=g.hashPriority,w=g.container,b=g.ssrInline,E=g.transformers,C=g.linters,S=g.cache,x=n._tokenKey,A=[x].concat((0,i.Z)(r)),R=T("style",A,function(){var e=ei(t(),{hashId:a,hashPriority:_,layer:l,path:r.join("-"),transformers:E,linters:C}),n=(0,I.Z)(e,2),i=n[0],o=n[1],u=er(i),p=s("".concat(A.join("%")).concat(u));if(et){var g={mark:d,prepend:"queue",attachTo:w},m="function"==typeof c?c():c;m&&(g.csp={nonce:m});var v=(0,y.hq)(u,p,g);v[f]=S.instanceId,v.setAttribute(h,x),Object.keys(o).forEach(function(e){(0,y.hq)(er(o[e]),"_effect-".concat(e),g)})}return[u,x,p]},function(e,t){var n=(0,I.Z)(e,3)[2];(t||m)&&et&&(0,y.jL)(n,{mark:d})}),N=(0,I.Z)(R,3),P=N[0],D=N[1],O=N[2];return function(e){var t,n;return t=b&&!et&&v?o.createElement("style",(0,k.Z)({},(n={},(0,u.Z)(n,h,D),(0,u.Z)(n,d,O),n),{dangerouslySetInnerHTML:{__html:P}})):o.createElement(es,null),o.createElement(o.Fragment,null,t,e)}}var ea=function(){function e(t,n){(0,a.Z)(this,e),(0,u.Z)(this,"name",void 0),(0,u.Z)(this,"style",void 0),(0,u.Z)(this,"_keyframe",!0),this.name=t,this.style=n}return(0,l.Z)(e,[{key:"getName",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?"".concat(e,"-").concat(this.name):this.name}}]),e}(),el=function(){function e(){(0,a.Z)(this,e),(0,u.Z)(this,"cache",void 0),(0,u.Z)(this,"keys",void 0),(0,u.Z)(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return(0,l.Z)(e,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i={map:this.cache};return e.forEach(function(e){if(i){var t,n;i=null===(t=i)||void 0===t?void 0:null===(n=t.map)||void 0===n?void 0:n.get(e)}else i=void 0}),null!==(t=i)&&void 0!==t&&t.value&&r&&(i.value[1]=this.cacheCallTimes++),null===(n=i)||void 0===n?void 0:n.value}},{key:"get",value:function(e){var t;return null===(t=this.internalGet(e,!0))||void 0===t?void 0:t[0]}},{key:"has",value:function(e){return!!this.internalGet(e)}},{key:"set",value:function(t,n){var r=this;if(!this.has(t)){if(this.size()+1>e.MAX_CACHE_SIZE+e.MAX_CACHE_OFFSET){var i=this.keys.reduce(function(e,t){var n=(0,I.Z)(e,2)[1];return r.internalGet(t)[1]<n?[t,r.internalGet(t)[1]]:e},[this.keys[0],this.cacheCallTimes]),s=(0,I.Z)(i,1)[0];this.delete(s)}this.keys.push(t)}var o=this.cache;t.forEach(function(e,i){if(i===t.length-1)o.set(e,{value:[n,r.cacheCallTimes++]});else{var s=o.get(e);s?s.map||(s.map=new Map):o.set(e,{map:new Map}),o=o.get(e).map}})}},{key:"deleteByPath",value:function(e,t){var n,r=e.get(t[0]);if(1===t.length)return r.map?e.set(t[0],{map:r.map}):e.delete(t[0]),null===(n=r.value)||void 0===n?void 0:n[0];var i=this.deleteByPath(r.map,t.slice(1));return r.map&&0!==r.map.size||r.value||e.delete(t[0]),i}},{key:"delete",value:function(e){if(this.has(e))return this.keys=this.keys.filter(function(t){return!function(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}(t,e)}),this.deleteByPath(this.cache,e)}}]),e}();(0,u.Z)(el,"MAX_CACHE_SIZE",20),(0,u.Z)(el,"MAX_CACHE_OFFSET",5);var eu=0,ec=function(){function e(t){(0,a.Z)(this,e),(0,u.Z)(this,"derivatives",void 0),(0,u.Z)(this,"id",void 0),this.derivatives=Array.isArray(t)?t:[t],this.id=eu,0===t.length&&(0,ee.Kp)(t.length>0,"[Ant Design CSS-in-JS] Theme should have at least one derivative function."),eu+=1}return(0,l.Z)(e,[{key:"getDerivativeToken",value:function(e){return this.derivatives.reduce(function(t,n){return n(e,t)},void 0)}}]),e}(),eh=new el;function ed(e){var t=Array.isArray(e)?e:[e];return eh.has(t)||eh.set(t,new ec(t)),eh.get(t)}function ef(e){return e.notSplit=!0,e}ef(["borderTop","borderBottom"]),ef(["borderTop"]),ef(["borderBottom"]),ef(["borderLeft","borderRight"]),ef(["borderLeft"]),ef(["borderRight"])},3017:function(e,t,n){"use strict";var r=(0,n(7294).createContext)({});t.Z=r},6500:function(e,t,n){"use strict";n.d(t,{T6:function(){return d},VD:function(){return f},WE:function(){return u},Yt:function(){return p},lC:function(){return s},py:function(){return l},rW:function(){return i},s:function(){return h},ve:function(){return a},vq:function(){return c}});var r=n(279);function i(e,t,n){return{r:255*(0,r.sh)(e,255),g:255*(0,r.sh)(t,255),b:255*(0,r.sh)(n,255)}}function s(e,t,n){var i=Math.max(e=(0,r.sh)(e,255),t=(0,r.sh)(t,255),n=(0,r.sh)(n,255)),s=Math.min(e,t,n),o=0,a=0,l=(i+s)/2;if(i===s)a=0,o=0;else{var u=i-s;switch(a=l>.5?u/(2-i-s):u/(i+s),i){case e:o=(t-n)/u+(t<n?6:0);break;case t:o=(n-e)/u+2;break;case n:o=(e-t)/u+4}o/=6}return{h:o,s:a,l:l}}function o(e,t,n){return(n<0&&(n+=1),n>1&&(n-=1),n<1/6)?e+(t-e)*(6*n):n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function a(e,t,n){if(e=(0,r.sh)(e,360),t=(0,r.sh)(t,100),n=(0,r.sh)(n,100),0===t)s=n,a=n,i=n;else{var i,s,a,l=n<.5?n*(1+t):n+t-n*t,u=2*n-l;i=o(u,l,e+1/3),s=o(u,l,e),a=o(u,l,e-1/3)}return{r:255*i,g:255*s,b:255*a}}function l(e,t,n){var i=Math.max(e=(0,r.sh)(e,255),t=(0,r.sh)(t,255),n=(0,r.sh)(n,255)),s=Math.min(e,t,n),o=0,a=i-s;if(i===s)o=0;else{switch(i){case e:o=(t-n)/a+(t<n?6:0);break;case t:o=(n-e)/a+2;break;case n:o=(e-t)/a+4}o/=6}return{h:o,s:0===i?0:a/i,v:i}}function u(e,t,n){e=6*(0,r.sh)(e,360),t=(0,r.sh)(t,100),n=(0,r.sh)(n,100);var i=Math.floor(e),s=e-i,o=n*(1-t),a=n*(1-s*t),l=n*(1-(1-s)*t),u=i%6;return{r:255*[n,a,o,o,l,n][u],g:255*[l,n,n,a,o,o][u],b:255*[o,o,l,n,n,a][u]}}function c(e,t,n,i){var s=[(0,r.FZ)(Math.round(e).toString(16)),(0,r.FZ)(Math.round(t).toString(16)),(0,r.FZ)(Math.round(n).toString(16))];return i&&s[0].startsWith(s[0].charAt(1))&&s[1].startsWith(s[1].charAt(1))&&s[2].startsWith(s[2].charAt(1))?s[0].charAt(0)+s[1].charAt(0)+s[2].charAt(0):s.join("")}function h(e,t,n,i,s){var o=[(0,r.FZ)(Math.round(e).toString(16)),(0,r.FZ)(Math.round(t).toString(16)),(0,r.FZ)(Math.round(n).toString(16)),(0,r.FZ)(Math.round(255*parseFloat(i)).toString(16))];return s&&o[0].startsWith(o[0].charAt(1))&&o[1].startsWith(o[1].charAt(1))&&o[2].startsWith(o[2].charAt(1))&&o[3].startsWith(o[3].charAt(1))?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0)+o[3].charAt(0):o.join("")}function d(e){return f(e)/255}function f(e){return parseInt(e,16)}function p(e){return{r:e>>16,g:(65280&e)>>8,b:255&e}}},8701:function(e,t,n){"use strict";n.d(t,{R:function(){return r}});var r={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",goldenrod:"#daa520",gold:"#ffd700",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavenderblush:"#fff0f5",lavender:"#e6e6fa",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"}},1350:function(e,t,n){"use strict";n.d(t,{uA:function(){return o}});var r=n(6500),i=n(8701),s=n(279);function o(e){var t={r:0,g:0,b:0},n=1,o=null,a=null,l=null,u=!1,d=!1;return"string"==typeof e&&(e=function(e){if(0===(e=e.trim().toLowerCase()).length)return!1;var t=!1;if(i.R[e])e=i.R[e],t=!0;else if("transparent"===e)return{r:0,g:0,b:0,a:0,format:"name"};var n=c.rgb.exec(e);return n?{r:n[1],g:n[2],b:n[3]}:(n=c.rgba.exec(e))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=c.hsl.exec(e))?{h:n[1],s:n[2],l:n[3]}:(n=c.hsla.exec(e))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=c.hsv.exec(e))?{h:n[1],s:n[2],v:n[3]}:(n=c.hsva.exec(e))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=c.hex8.exec(e))?{r:(0,r.VD)(n[1]),g:(0,r.VD)(n[2]),b:(0,r.VD)(n[3]),a:(0,r.T6)(n[4]),format:t?"name":"hex8"}:(n=c.hex6.exec(e))?{r:(0,r.VD)(n[1]),g:(0,r.VD)(n[2]),b:(0,r.VD)(n[3]),format:t?"name":"hex"}:(n=c.hex4.exec(e))?{r:(0,r.VD)(n[1]+n[1]),g:(0,r.VD)(n[2]+n[2]),b:(0,r.VD)(n[3]+n[3]),a:(0,r.T6)(n[4]+n[4]),format:t?"name":"hex8"}:!!(n=c.hex3.exec(e))&&{r:(0,r.VD)(n[1]+n[1]),g:(0,r.VD)(n[2]+n[2]),b:(0,r.VD)(n[3]+n[3]),format:t?"name":"hex"}}(e)),"object"==typeof e&&(h(e.r)&&h(e.g)&&h(e.b)?(t=(0,r.rW)(e.r,e.g,e.b),u=!0,d="%"===String(e.r).substr(-1)?"prgb":"rgb"):h(e.h)&&h(e.s)&&h(e.v)?(o=(0,s.JX)(e.s),a=(0,s.JX)(e.v),t=(0,r.WE)(e.h,o,a),u=!0,d="hsv"):h(e.h)&&h(e.s)&&h(e.l)&&(o=(0,s.JX)(e.s),l=(0,s.JX)(e.l),t=(0,r.ve)(e.h,o,l),u=!0,d="hsl"),Object.prototype.hasOwnProperty.call(e,"a")&&(n=e.a)),n=(0,s.Yq)(n),{ok:u,format:e.format||d,r:Math.min(255,Math.max(t.r,0)),g:Math.min(255,Math.max(t.g,0)),b:Math.min(255,Math.max(t.b,0)),a:n}}var a="(?:".concat("[-\\+]?\\d*\\.\\d+%?",")|(?:").concat("[-\\+]?\\d+%?",")"),l="[\\s|\\(]+(".concat(a,")[,|\\s]+(").concat(a,")[,|\\s]+(").concat(a,")\\s*\\)?"),u="[\\s|\\(]+(".concat(a,")[,|\\s]+(").concat(a,")[,|\\s]+(").concat(a,")[,|\\s]+(").concat(a,")\\s*\\)?"),c={CSS_UNIT:new RegExp(a),rgb:RegExp("rgb"+l),rgba:RegExp("rgba"+u),hsl:RegExp("hsl"+l),hsla:RegExp("hsla"+u),hsv:RegExp("hsv"+l),hsva:RegExp("hsva"+u),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex4:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/};function h(e){return!!c.CSS_UNIT.exec(String(e))}},274:function(e,t,n){"use strict";n.d(t,{C:function(){return a}});var r=n(6500),i=n(8701),s=n(1350),o=n(279),a=function(){function e(t,n){if(void 0===t&&(t=""),void 0===n&&(n={}),t instanceof e)return t;"number"==typeof t&&(t=(0,r.Yt)(t)),this.originalInput=t;var i,o=(0,s.uA)(t);this.originalInput=t,this.r=o.r,this.g=o.g,this.b=o.b,this.a=o.a,this.roundA=Math.round(100*this.a)/100,this.format=null!==(i=n.format)&&void 0!==i?i:o.format,this.gradientType=n.gradientType,this.r<1&&(this.r=Math.round(this.r)),this.g<1&&(this.g=Math.round(this.g)),this.b<1&&(this.b=Math.round(this.b)),this.isValid=o.ok}return e.prototype.isDark=function(){return 128>this.getBrightness()},e.prototype.isLight=function(){return!this.isDark()},e.prototype.getBrightness=function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},e.prototype.getLuminance=function(){var e=this.toRgb(),t=e.r/255,n=e.g/255,r=e.b/255;return .2126*(t<=.03928?t/12.92:Math.pow((t+.055)/1.055,2.4))+.7152*(n<=.03928?n/12.92:Math.pow((n+.055)/1.055,2.4))+.0722*(r<=.03928?r/12.92:Math.pow((r+.055)/1.055,2.4))},e.prototype.getAlpha=function(){return this.a},e.prototype.setAlpha=function(e){return this.a=(0,o.Yq)(e),this.roundA=Math.round(100*this.a)/100,this},e.prototype.isMonochrome=function(){return 0===this.toHsl().s},e.prototype.toHsv=function(){var e=(0,r.py)(this.r,this.g,this.b);return{h:360*e.h,s:e.s,v:e.v,a:this.a}},e.prototype.toHsvString=function(){var e=(0,r.py)(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.v);return 1===this.a?"hsv(".concat(t,", ").concat(n,"%, ").concat(i,"%)"):"hsva(".concat(t,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")},e.prototype.toHsl=function(){var e=(0,r.lC)(this.r,this.g,this.b);return{h:360*e.h,s:e.s,l:e.l,a:this.a}},e.prototype.toHslString=function(){var e=(0,r.lC)(this.r,this.g,this.b),t=Math.round(360*e.h),n=Math.round(100*e.s),i=Math.round(100*e.l);return 1===this.a?"hsl(".concat(t,", ").concat(n,"%, ").concat(i,"%)"):"hsla(".concat(t,", ").concat(n,"%, ").concat(i,"%, ").concat(this.roundA,")")},e.prototype.toHex=function(e){return void 0===e&&(e=!1),(0,r.vq)(this.r,this.g,this.b,e)},e.prototype.toHexString=function(e){return void 0===e&&(e=!1),"#"+this.toHex(e)},e.prototype.toHex8=function(e){return void 0===e&&(e=!1),(0,r.s)(this.r,this.g,this.b,this.a,e)},e.prototype.toHex8String=function(e){return void 0===e&&(e=!1),"#"+this.toHex8(e)},e.prototype.toHexShortString=function(e){return void 0===e&&(e=!1),1===this.a?this.toHexString(e):this.toHex8String(e)},e.prototype.toRgb=function(){return{r:Math.round(this.r),g:Math.round(this.g),b:Math.round(this.b),a:this.a}},e.prototype.toRgbString=function(){var e=Math.round(this.r),t=Math.round(this.g),n=Math.round(this.b);return 1===this.a?"rgb(".concat(e,", ").concat(t,", ").concat(n,")"):"rgba(".concat(e,", ").concat(t,", ").concat(n,", ").concat(this.roundA,")")},e.prototype.toPercentageRgb=function(){var e=function(e){return"".concat(Math.round(100*(0,o.sh)(e,255)),"%")};return{r:e(this.r),g:e(this.g),b:e(this.b),a:this.a}},e.prototype.toPercentageRgbString=function(){var e=function(e){return Math.round(100*(0,o.sh)(e,255))};return 1===this.a?"rgb(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%)"):"rgba(".concat(e(this.r),"%, ").concat(e(this.g),"%, ").concat(e(this.b),"%, ").concat(this.roundA,")")},e.prototype.toName=function(){if(0===this.a)return"transparent";if(this.a<1)return!1;for(var e="#"+(0,r.vq)(this.r,this.g,this.b,!1),t=0,n=Object.entries(i.R);t<n.length;t++){var s=n[t],o=s[0];if(e===s[1])return o}return!1},e.prototype.toString=function(e){var t=!!e;e=null!=e?e:this.format;var n=!1,r=this.a<1&&this.a>=0;return!t&&r&&(e.startsWith("hex")||"name"===e)?"name"===e&&0===this.a?this.toName():this.toRgbString():("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex4"===e&&(n=this.toHex8String(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString())},e.prototype.toNumber=function(){return(Math.round(this.r)<<16)+(Math.round(this.g)<<8)+Math.round(this.b)},e.prototype.clone=function(){return new e(this.toString())},e.prototype.lighten=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l+=t/100,n.l=(0,o.V2)(n.l),new e(n)},e.prototype.brighten=function(t){void 0===t&&(t=10);var n=this.toRgb();return n.r=Math.max(0,Math.min(255,n.r-Math.round(-(255*(t/100))))),n.g=Math.max(0,Math.min(255,n.g-Math.round(-(255*(t/100))))),n.b=Math.max(0,Math.min(255,n.b-Math.round(-(255*(t/100))))),new e(n)},e.prototype.darken=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.l-=t/100,n.l=(0,o.V2)(n.l),new e(n)},e.prototype.tint=function(e){return void 0===e&&(e=10),this.mix("white",e)},e.prototype.shade=function(e){return void 0===e&&(e=10),this.mix("black",e)},e.prototype.desaturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s-=t/100,n.s=(0,o.V2)(n.s),new e(n)},e.prototype.saturate=function(t){void 0===t&&(t=10);var n=this.toHsl();return n.s+=t/100,n.s=(0,o.V2)(n.s),new e(n)},e.prototype.greyscale=function(){return this.desaturate(100)},e.prototype.spin=function(t){var n=this.toHsl(),r=(n.h+t)%360;return n.h=r<0?360+r:r,new e(n)},e.prototype.mix=function(t,n){void 0===n&&(n=50);var r=this.toRgb(),i=new e(t).toRgb(),s=n/100,o={r:(i.r-r.r)*s+r.r,g:(i.g-r.g)*s+r.g,b:(i.b-r.b)*s+r.b,a:(i.a-r.a)*s+r.a};return new e(o)},e.prototype.analogous=function(t,n){void 0===t&&(t=6),void 0===n&&(n=30);var r=this.toHsl(),i=360/n,s=[this];for(r.h=(r.h-(i*t>>1)+720)%360;--t;)r.h=(r.h+i)%360,s.push(new e(r));return s},e.prototype.complement=function(){var t=this.toHsl();return t.h=(t.h+180)%360,new e(t)},e.prototype.monochromatic=function(t){void 0===t&&(t=6);for(var n=this.toHsv(),r=n.h,i=n.s,s=n.v,o=[],a=1/t;t--;)o.push(new e({h:r,s:i,v:s})),s=(s+a)%1;return o},e.prototype.splitcomplement=function(){var t=this.toHsl(),n=t.h;return[this,new e({h:(n+72)%360,s:t.s,l:t.l}),new e({h:(n+216)%360,s:t.s,l:t.l})]},e.prototype.onBackground=function(t){var n=this.toRgb(),r=new e(t).toRgb(),i=n.a+r.a*(1-n.a);return new e({r:(n.r*n.a+r.r*r.a*(1-n.a))/i,g:(n.g*n.a+r.g*r.a*(1-n.a))/i,b:(n.b*n.a+r.b*r.a*(1-n.a))/i,a:i})},e.prototype.triad=function(){return this.polyad(3)},e.prototype.tetrad=function(){return this.polyad(4)},e.prototype.polyad=function(t){for(var n=this.toHsl(),r=n.h,i=[this],s=360/t,o=1;o<t;o++)i.push(new e({h:(r+o*s)%360,s:n.s,l:n.l}));return i},e.prototype.equals=function(t){return this.toRgbString()===new e(t).toRgbString()},e}()},279:function(e,t,n){"use strict";function r(e,t){"string"==typeof(n=e)&&-1!==n.indexOf(".")&&1===parseFloat(n)&&(e="100%");var n,r,i="string"==typeof(r=e)&&-1!==r.indexOf("%");return(e=360===t?e:Math.min(t,Math.max(0,parseFloat(e))),i&&(e=parseInt(String(e*t),10)/100),1e-6>Math.abs(e-t))?1:e=360===t?(e<0?e%t+t:e%t)/parseFloat(String(t)):e%t/parseFloat(String(t))}function i(e){return Math.min(1,Math.max(0,e))}function s(e){return(isNaN(e=parseFloat(e))||e<0||e>1)&&(e=1),e}function o(e){return e<=1?"".concat(100*Number(e),"%"):e}function a(e){return 1===e.length?"0"+e:String(e)}n.d(t,{FZ:function(){return a},JX:function(){return o},V2:function(){return i},Yq:function(){return s},sh:function(){return r}})},1720:function(e,t,n){"use strict";n.d(t,{$:function(){return tg},A:function(){return c},B:function(){return tY},D:function(){return d},I:function(){return eP},J:function(){return eF},L:function(){return eZ},N:function(){return ei},P:function(){return nP},Q:function(){return e4},R:function(){return nC},U:function(){return e3},V:function(){return e8},W:function(){return e7},X:function(){return e6},Y:function(){return tt},Z:function(){return tn},_:function(){return to},a:function(){return t7},a0:function(){return tm},a1:function(){return ty},a2:function(){return t_},a3:function(){return tE},a4:function(){return tC},a5:function(){return tS},a6:function(){return tk},a7:function(){return tx},a8:function(){return tA},a9:function(){return tR},aA:function(){return b},aB:function(){return n3},aC:function(){return en},aD:function(){return es},aE:function(){return n5},aF:function(){return nZ},aG:function(){return nK},aH:function(){return eR},aL:function(){return nt},aO:function(){return te},aa:function(){return tN},ab:function(){return tP},ac:function(){return tD},ad:function(){return tF},ae:function(){return tL},af:function(){return tM},ai:function(){return tV},aj:function(){return tq},ak:function(){return tj},an:function(){return tc},ao:function(){return tZ},aq:function(){return t0},ar:function(){return t4},as:function(){return T},at:function(){return eg},au:function(){return ed},av:function(){return m},aw:function(){return rp},ax:function(){return re},ay:function(){return em},az:function(){return y},b:function(){return t3},c:function(){return nq},d:function(){return nB},e:function(){return nj},f:function(){return nX},g:function(){return n2},h:function(){return n0},i:function(){return nm},j:function(){return n9},k:function(){return rm},l:function(){return nx},m:function(){return r_},o:function(){return rA},p:function(){return u},r:function(){return nA},s:function(){return nk},u:function(){return nN},x:function(){return tQ}});var r,i=n(4444),s=n(5816);function o(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n}var a=n(3333),l=n(740);let u={FACEBOOK:"facebook.com",GITHUB:"github.com",GOOGLE:"google.com",PASSWORD:"password",PHONE:"phone",TWITTER:"twitter.com"},c={EMAIL_SIGNIN:"EMAIL_SIGNIN",PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:"REVERT_SECOND_FACTOR_ADDITION",VERIFY_AND_CHANGE_EMAIL:"VERIFY_AND_CHANGE_EMAIL",VERIFY_EMAIL:"VERIFY_EMAIL"};function h(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}let d=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend."}},f=new i.LL("auth","Firebase",h()),p=new a.Yd("@firebase/auth");function g(e,...t){p.logLevel<=a.in.ERROR&&p.error(`Auth (${s.SDK_VERSION}): ${e}`,...t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m(e,...t){throw w(e,...t)}function y(e,...t){return w(e,...t)}function v(e,t,n){let r=Object.assign(Object.assign({},h()),{[t]:n}),s=new i.LL("auth","Firebase",r);return s.create(t,{appName:e.name})}function _(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&m(e,"argument-error"),v(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function w(e,...t){if("string"!=typeof e){let n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return f.create(e,...t)}function b(e,t,...n){if(!e)throw w(t,...n)}function I(e){let t="INTERNAL ASSERTION FAILED: "+e;throw g(t),Error(t)}function T(e,t){e||I(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function E(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function C(){return"http:"===S()||"https:"===S()}function S(){var e;return"undefined"!=typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k{constructor(e,t){this.shortDelay=e,this.longDelay=t,T(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,i.uI)()||(0,i.b$)()}get(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&(C()||(0,i.ru)()||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x(e,t){T(e.emulator,"Emulator should always be set here");let{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void I("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void I("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void I("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let R={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},N=new k(3e4,6e4);function P(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function D(e,t,n,r,s={}){return O(e,s,async()=>{let s={},o={};r&&("GET"===t?o=r:s={body:JSON.stringify(r)});let a=(0,i.xO)(Object.assign({key:e.config.apiKey},o)).slice(1),l=await e._getAdditionalHeaders();return l["Content-Type"]="application/json",e.languageCode&&(l["X-Firebase-Locale"]=e.languageCode),A.fetch()(L(e,e.config.apiHost,n,a),Object.assign({method:t,headers:l,referrerPolicy:"no-referrer"},s))})}async function O(e,t,n){e._canInitEmulator=!1;let r=Object.assign(Object.assign({},R),t);try{let t=new M(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();let s=await i.json();if("needConfirmation"in s)throw U(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{let t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw U(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw U(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw U(e,"user-disabled",s);let a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw v(e,a,o);m(e,a)}}catch(t){if(t instanceof i.ZR)throw t;m(e,"network-request-failed",{message:String(t)})}}async function F(e,t,n,r,i={}){let s=await D(e,t,n,r,i);return"mfaPendingCredential"in s&&m(e,"multi-factor-auth-required",{_serverResponse:s}),s}function L(e,t,n,r){let i=`${t}${n}?${r}`;return e.config.emulator?x(e.config,i):`${e.config.apiScheme}://${i}`}class M{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((e,t)=>{this.timer=setTimeout(()=>t(y(this.auth,"network-request-failed")),N.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function U(e,t,n){let r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);let i=y(e,t,r);return i.customData._tokenResponse=n,i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function V(e,t){return D(e,"POST","/v1/accounts:delete",t)}async function q(e,t){return D(e,"POST","/v1/accounts:update",t)}async function j(e,t){return D(e,"POST","/v1/accounts:lookup",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B(e){if(e)try{let t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(e){}}async function z(e,t=!1){let n=(0,i.m9)(e),r=await n.getIdToken(t),s=H(r);b(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");let o="object"==typeof s.firebase?s.firebase:void 0,a=null==o?void 0:o.sign_in_provider;return{claims:s,token:r,authTime:B($(s.auth_time)),issuedAtTime:B($(s.iat)),expirationTime:B($(s.exp)),signInProvider:a||null,signInSecondFactor:(null==o?void 0:o.sign_in_second_factor)||null}}function $(e){return 1e3*Number(e)}function H(e){let[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return g("JWT malformed, contained fewer than 3 sections"),null;try{let e=(0,i.tV)(n);if(!e)return g("Failed to decode base64 JWT payload"),null;return JSON.parse(e)}catch(e){return g("Caught error parsing JWT payload as JSON",null==e?void 0:e.toString()),null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function W(e,t,n=!1){if(n)return t;try{return await t}catch(t){throw t instanceof i.ZR&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(t)&&e.auth.currentUser===e&&await e.auth.signOut(),t}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){let e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;let e=null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0,n=e-Date.now()-3e5;return Math.max(0,n)}}schedule(e=!1){if(!this.isRunning)return;let t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(null==e?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=B(this.lastLoginAt),this.creationTime=B(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z(e){var t;let n=e.auth,r=await e.getIdToken(),i=await W(e,j(n,{idToken:r}));b(null==i?void 0:i.users.length,n,"internal-error");let s=i.users[0];e._notifyReloadListener(s);let a=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?s.providerUserInfo.map(e=>{var{providerId:t}=e,n=o(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}):[],l=function(e,t){let n=e.filter(e=>!t.some(t=>t.providerId===e.providerId));return[...n,...t]}(e.providerData,a),u=e.isAnonymous,c=!(e.email&&s.passwordHash)&&!(null==l?void 0:l.length),h={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new K(s.createdAt,s.lastLoginAt),isAnonymous:!!u&&c};Object.assign(e,h)}async function Q(e){let t=(0,i.m9)(e);await Z(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y(e,t){let n=await O(e,{},async()=>{let n=(0,i.xO)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,o=L(e,r,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();return a["Content-Type"]="application/x-www-form-urlencoded",A.fetch()(o,{method:"POST",headers:a,body:n})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){b(e.idToken,"internal-error"),b(void 0!==e.idToken,"internal-error"),b(void 0!==e.refreshToken,"internal-error");let t="expiresIn"in e&&void 0!==e.expiresIn?Number(e.expiresIn):function(e){let t=H(e);return b(t,"internal-error"),b(void 0!==t.exp,"internal-error"),b(void 0!==t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}async getToken(e,t=!1){return(b(!this.accessToken||this.refreshToken,e,"user-token-expired"),t||!this.accessToken||this.isExpired)?this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){let{accessToken:n,refreshToken:r,expiresIn:i}=await Y(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){let{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new X;return n&&(b("string"==typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(b("string"==typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(b("number"==typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new X,this.toJSON())}_performRefresh(){return I("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(e,t){b("string"==typeof e||void 0===e,"internal-error",{appName:t})}class ee{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=o(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new G(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new K(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){let t=await W(this,this.stsTokenManager.getToken(this.auth,e));return b(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return z(this,e)}reload(){return Q(this)}_assign(e){this!==e&&(b(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(e=>Object.assign({},e)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){let t=new ee(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){b(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Z(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){let e=await this.getIdToken();return await W(this,V(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,u;let c=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,g=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,m=null!==(l=t.createdAt)&&void 0!==l?l:void 0,y=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:v,emailVerified:_,isAnonymous:w,providerData:I,stsTokenManager:T}=t;b(v&&T,e,"internal-error");let E=X.fromJSON(this.name,T);b("string"==typeof v,e,"internal-error"),J(c,e.name),J(h,e.name),b("boolean"==typeof _,e,"internal-error"),b("boolean"==typeof w,e,"internal-error"),J(d,e.name),J(f,e.name),J(p,e.name),J(g,e.name),J(m,e.name),J(y,e.name);let C=new ee({uid:v,auth:e,email:h,emailVerified:_,displayName:c,isAnonymous:w,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:E,createdAt:m,lastLoginAt:y});return I&&Array.isArray(I)&&(C.providerData=I.map(e=>Object.assign({},e))),g&&(C._redirectEventId=g),C}static async _fromIdTokenResponse(e,t,n=!1){let r=new X;r.updateFromServerResponse(t);let i=new ee({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await Z(i),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let et=new Map;function en(e){T(e instanceof Function,"Expected a class definition");let t=et.get(e);return t?(T(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,et.set(e,t),t)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){let t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}er.type="NONE";let ei=er;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(e,t,n){return`firebase:${e}:${t}:${n}`}class eo{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;let{config:r,name:i}=this.auth;this.fullUserKey=es(this.userKey,r.apiKey,i),this.fullPersistenceKey=es("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){let e=await this.persistence._get(this.fullUserKey);return e?ee._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;let t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new eo(en(ei),e,n);let r=(await Promise.all(t.map(async e=>{if(await e._isAvailable())return e}))).filter(e=>e),i=r[0]||en(ei),s=es(n,e.config.apiKey,e.name),o=null;for(let n of t)try{let t=await n._get(s);if(t){let r=ee._fromJSON(e,t);n!==i&&(o=r),i=n;break}}catch(e){}let a=r.filter(e=>e._shouldAllowMigration);return i._shouldAllowMigration&&a.length&&(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map(async e=>{if(e!==i)try{await e._remove(s)}catch(e){}}))),new eo(i,e,n)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ea(e){let t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(eh(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";{if(t.includes("edge/"))return"Edge";if(el(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(ef(t))return"Blackberry";if(ep(t))return"Webos";if(eu(t))return"Safari";if((t.includes("chrome/")||ec(t))&&!t.includes("edge/"))return"Chrome";if(ed(t))return"Android";let n=e.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/);if((null==n?void 0:n.length)===2)return n[1]}return"Other"}function el(e=(0,i.z$)()){return/firefox\//i.test(e)}function eu(e=(0,i.z$)()){let t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ec(e=(0,i.z$)()){return/crios\//i.test(e)}function eh(e=(0,i.z$)()){return/iemobile/i.test(e)}function ed(e=(0,i.z$)()){return/android/i.test(e)}function ef(e=(0,i.z$)()){return/blackberry/i.test(e)}function ep(e=(0,i.z$)()){return/webos/i.test(e)}function eg(e=(0,i.z$)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function em(e=(0,i.z$)()){return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}function ey(e=(0,i.z$)()){return eg(e)||ed(e)||ep(e)||ef(e)||/windows phone/i.test(e)||eh(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ev(e,t=[]){let n;switch(e){case"Browser":n=ea((0,i.z$)());break;case"Worker":n=`${ea((0,i.z$)())}-${e}`;break;default:n=e}let r=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${s.SDK_VERSION}/${r}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e_(e){return(await D(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}async function ew(e,t){return D(e,"GET","/v2/recaptchaConfig",P(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eb(e){return void 0!==e&&void 0!==e.getResponse}function eI(e){return void 0!==e&&void 0!==e.enterprise}class eT{constructor(e){if(this.siteKey="",this.emailPasswordEnabled=!1,void 0===e.recaptchaKey)throw Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.emailPasswordEnabled=e.recaptchaEnforcementState.some(e=>"EMAIL_PASSWORD_PROVIDER"===e.provider&&"OFF"!==e.enforcementState)}}function eE(e){return new Promise((t,n)=>{var r,i;let s=document.createElement("script");s.setAttribute("src",e),s.onload=t,s.onerror=e=>{let t=y("internal-error");t.customData=e,n(t)},s.type="text/javascript",s.charset="UTF-8",(null!==(i=null===(r=document.getElementsByTagName("head"))||void 0===r?void 0:r[0])&&void 0!==i?i:document).appendChild(s)})}function eC(e){return`__${e}${Math.floor(1e6*Math.random())}`}class eS{constructor(e){this.type="recaptcha-enterprise",this.auth=eR(e)}async verify(e="verify",t=!1){async function n(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise(async(t,n)=>{ew(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(r=>{if(void 0===r.recaptchaKey)n(Error("recaptcha Enterprise site key undefined"));else{let n=new eT(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}}).catch(e=>{n(e)})})}function r(t,n,r){let i=window.grecaptcha;eI(i)?i.enterprise.ready(()=>{i.enterprise.execute(t,{action:e}).then(e=>{n(e)}).catch(()=>{n("NO_RECAPTCHA")})}):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((e,i)=>{n(this.auth).then(n=>{if(!t&&eI(window.grecaptcha))r(n,e,i);else{if("undefined"==typeof window){i(Error("RecaptchaVerifier is only supported in browser"));return}eE("https://www.google.com/recaptcha/enterprise.js?render="+n).then(()=>{r(n,e,i)}).catch(e=>{i(e)})}}).catch(e=>{i(e)})})}}async function ek(e,t,n,r=!1){let i;let s=new eS(e);try{i=await s.verify(n)}catch(e){i=await s.verify(n,!0)}let o=Object.assign({},t);return r?Object.assign(o,{captchaResp:i}):Object.assign(o,{captchaResponse:i}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ex{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){let n=t=>new Promise((n,r)=>{try{let r=e(t);n(r)}catch(e){r(e)}});n.onAbort=t,this.queue.push(n);let r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;let t=[];try{for(let n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(e){for(let e of(t.reverse(),t))try{e()}catch(e){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null==e?void 0:e.message})}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eA{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new eN(this),this.idTokenSubscription=new eN(this),this.beforeStateQueue=new ex(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=f,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=en(t)),this._initializationPromise=this.queue(async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await eo.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(e){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;let e=await this.assertedPersistence.getCurrentUser();if(this.currentUser||e){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUser(e){var t;let n=await this.assertedPersistence.getCurrentUser(),r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();let n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null==r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);(!n||n===s)&&(null==o?void 0:o.user)&&(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(e){r=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(e))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return(b(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId)?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(e){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Z(e)}catch(e){if((null==e?void 0:e.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"==typeof navigator)return null;let e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){let t=e?(0,i.m9)(e):null;return t&&b(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&b(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0)}setPersistence(e){return this.queue(async()=>{await this.assertedPersistence.setPersistence(en(e))})}async initializeRecaptchaConfig(){let e=await ew(this,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),t=new eT(e);if(null==this.tenantId?this._agentRecaptchaConfig=t:this._tenantRecaptchaConfigs[this.tenantId]=t,t.emailPasswordEnabled){let e=new eS(this);e.verify()}}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new i.LL("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){let n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){let t=e&&en(e)||this._popupRedirectResolver;b(t,this,"argument-error"),this.redirectPersistenceManager=await eo.create(this,[en(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return(this._isInitialized&&await this.queue(async()=>{}),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e)?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);let n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};let i="function"==typeof t?t:t.next.bind(t),s=this._isInitialized?Promise.resolve():this._initializationPromise;return(b(s,this,"internal-error"),s.then(()=>i(this.currentUser)),"function"==typeof t)?e.addObserver(t,n,r):e.addObserver(t)}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return b(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ev(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;let t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);let n=await (null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);let r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;let t=await (null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null==t?void 0:t.error)&&function(e,...t){p.logLevel<=a.in.WARN&&p.warn(`Auth (${s.SDK_VERSION}): ${e}`,...t)}(`Error while retrieving App Check token: ${t.error}`),null==t?void 0:t.token}}function eR(e){return(0,i.m9)(e)}class eN{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,i.ne)(e=>this.observer=e)}get next(){return b(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}function eP(e,t,n){let r=eR(e);b(r._canInitEmulator,r,"emulator-config-failed"),b(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");let i=!!(null==n?void 0:n.disableWarnings),s=eD(t),{host:o,port:a}=function(e){let t=eD(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};let r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){let e=i[1];return{host:e,port:eO(r.substr(e.length+1))}}{let[e,t]=r.split(":");return{host:e,port:eO(t)}}}(t),l=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){let e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!=typeof console&&"function"==typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),"undefined"!=typeof window&&"undefined"!=typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function eD(e){let t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function eO(e){if(!e)return null;let t=Number(e);return isNaN(t)?null:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eF{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return I("not implemented")}_getIdTokenResponse(e){return I("not implemented")}_linkToIdToken(e,t){return I("not implemented")}_getReauthenticationResolver(e){return I("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eL(e,t){return D(e,"POST","/v1/accounts:resetPassword",P(e,t))}async function eM(e,t){return D(e,"POST","/v1/accounts:update",t)}async function eU(e,t){return D(e,"POST","/v1/accounts:update",P(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eV(e,t){return F(e,"POST","/v1/accounts:signInWithPassword",P(e,t))}async function eq(e,t){return D(e,"POST","/v1/accounts:sendOobCode",P(e,t))}async function ej(e,t){return eq(e,t)}async function eB(e,t){return eq(e,t)}async function ez(e,t){return eq(e,t)}async function e$(e,t){return eq(e,t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eH(e,t){return F(e,"POST","/v1/accounts:signInWithEmailLink",P(e,t))}async function eW(e,t){return F(e,"POST","/v1/accounts:signInWithEmailLink",P(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eG extends eF{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new eG(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new eG(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e;if((null==t?void 0:t.email)&&(null==t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){var t;switch(this.signInMethod){case"password":let n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};if(null===(t=e._getRecaptchaConfig())||void 0===t||!t.emailPasswordEnabled)return eV(e,n).catch(async t=>{if("auth/missing-recaptcha-token"!==t.code)return Promise.reject(t);{console.log("Sign-in with email address and password is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");let t=await ek(e,n,"signInWithPassword");return eV(e,t)}});{let t=await ek(e,n,"signInWithPassword");return eV(e,t)}case"emailLink":return eH(e,{email:this._email,oobCode:this._password});default:m(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return eM(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return eW(e,{idToken:t,email:this._email,oobCode:this._password});default:m(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eK(e,t){return F(e,"POST","/v1/accounts:signInWithIdp",P(e,t))}class eZ extends eF{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){let t=new eZ(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):m("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=o(t,["providerId","signInMethod"]);if(!n||!r)return null;let s=new eZ(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){let t=this.buildRequest();return eK(e,t)}_linkToIdToken(e,t){let n=this.buildRequest();return n.idToken=t,eK(e,n)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,eK(e,t)}buildRequest(){let e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{let t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,i.xO)(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eQ(e,t){return D(e,"POST","/v1/accounts:sendVerificationCode",P(e,t))}async function eY(e,t){return F(e,"POST","/v1/accounts:signInWithPhoneNumber",P(e,t))}async function eX(e,t){let n=await F(e,"POST","/v1/accounts:signInWithPhoneNumber",P(e,t));if(n.temporaryProof)throw U(e,"account-exists-with-different-credential",n);return n}let eJ={USER_NOT_FOUND:"user-not-found"};async function e0(e,t){let n=Object.assign(Object.assign({},t),{operation:"REAUTH"});return F(e,"POST","/v1/accounts:signInWithPhoneNumber",P(e,n),eJ)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e1 extends eF{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new e1({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new e1({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return eY(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return eX(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return e0(e,this._makeVerificationRequest())}_makeVerificationRequest(){let{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){let e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"==typeof e&&(e=JSON.parse(e));let{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new e1({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class e2{constructor(e){var t,n,r,s,o,a;let l=(0,i.zd)((0,i.pd)(e)),u=null!==(t=l.apiKey)&&void 0!==t?t:null,c=null!==(n=l.oobCode)&&void 0!==n?n:null,h=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=l.mode)&&void 0!==r?r:null);b(u&&c&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=c,this.continueUrl=null!==(s=l.continueUrl)&&void 0!==s?s:null,this.languageCode=null!==(o=l.languageCode)&&void 0!==o?o:null,this.tenantId=null!==(a=l.tenantId)&&void 0!==a?a:null}static parseLink(e){let t=function(e){let t=(0,i.zd)((0,i.pd)(e)).link,n=t?(0,i.zd)((0,i.pd)(t)).deep_link_id:null,r=(0,i.zd)((0,i.pd)(e)).deep_link_id,s=r?(0,i.zd)((0,i.pd)(r)).link:null;return s||r||n||t||e}(e);try{return new e2(t)}catch(e){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e4{constructor(){this.providerId=e4.PROVIDER_ID}static credential(e,t){return eG._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){let n=e2.parseLink(t);return b(n,"argument-error"),eG._fromEmailAndCode(e,n.code,n.tenantId)}}e4.PROVIDER_ID="password",e4.EMAIL_PASSWORD_SIGN_IN_METHOD="password",e4.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e9{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e5 extends e9{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class e6 extends e5{static credentialFromJSON(e){let t="string"==typeof e?JSON.parse(e):e;return b("providerId"in t&&"signInMethod"in t,"argument-error"),eZ._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return b(e.idToken||e.accessToken,"argument-error"),eZ._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return e6.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return e6.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:n,oauthTokenSecret:r,pendingToken:i,nonce:s,providerId:o}=e;if(!n&&!r&&!t&&!i||!o)return null;try{return new e6(o)._credential({idToken:t,accessToken:n,nonce:s,pendingToken:i})}catch(e){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e3 extends e5{constructor(){super("facebook.com")}static credential(e){return eZ._fromParams({providerId:e3.PROVIDER_ID,signInMethod:e3.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return e3.credentialFromTaggedObject(e)}static credentialFromError(e){return e3.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return e3.credential(e.oauthAccessToken)}catch(e){return null}}}e3.FACEBOOK_SIGN_IN_METHOD="facebook.com",e3.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8 extends e5{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return eZ._fromParams({providerId:e8.PROVIDER_ID,signInMethod:e8.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return e8.credentialFromTaggedObject(e)}static credentialFromError(e){return e8.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return e8.credential(t,n)}catch(e){return null}}}e8.GOOGLE_SIGN_IN_METHOD="google.com",e8.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e7 extends e5{constructor(){super("github.com")}static credential(e){return eZ._fromParams({providerId:e7.PROVIDER_ID,signInMethod:e7.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return e7.credentialFromTaggedObject(e)}static credentialFromError(e){return e7.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return e7.credential(e.oauthAccessToken)}catch(e){return null}}}e7.GITHUB_SIGN_IN_METHOD="github.com",e7.PROVIDER_ID="github.com";class te extends eF{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){let t=this.buildRequest();return eK(e,t)}_linkToIdToken(e,t){let n=this.buildRequest();return n.idToken=t,eK(e,n)}_getReauthenticationResolver(e){let t=this.buildRequest();return t.autoCreate=!1,eK(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){let t="string"==typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new te(n,i):null}static _create(e,t){return new te(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class tt extends e9{constructor(e){b(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return tt.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return tt.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){let t=te.fromJSON(e);return b(t,"argument-error"),t}static samlCredentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{pendingToken:t,providerId:n}=e;if(!t||!n)return null;try{return te._create(n,t)}catch(e){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tn extends e5{constructor(){super("twitter.com")}static credential(e,t){return eZ._fromParams({providerId:tn.PROVIDER_ID,signInMethod:tn.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return tn.credentialFromTaggedObject(e)}static credentialFromError(e){return tn.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return tn.credential(t,n)}catch(e){return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tr(e,t){return F(e,"POST","/v1/accounts:signUp",P(e,t))}tn.TWITTER_SIGN_IN_METHOD="twitter.com",tn.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){let i=await ee._fromIdTokenResponse(e,n,r),s=ts(n),o=new ti({user:i,providerId:s,_tokenResponse:n,operationType:t});return o}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);let r=ts(n);return new ti({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function ts(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function to(e){var t;let n=eR(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new ti({user:n.currentUser,providerId:null,operationType:"signIn"});let r=await tr(n,{returnSecureToken:!0}),i=await ti._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta extends i.ZR{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,ta.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new ta(e,t,n,r)}}function tl(e,t,n,r){let i="reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e);return i.catch(n=>{if("auth/multi-factor-auth-required"===n.code)throw ta._fromErrorAndOperation(e,n,t,r);throw n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tu(e){return new Set(e.map(({providerId:e})=>e).filter(e=>!!e))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tc(e,t){let n=(0,i.m9)(e);await td(!0,n,t);let{providerUserInfo:r}=await q(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),s=tu(r||[]);return n.providerData=n.providerData.filter(e=>s.has(e.providerId)),s.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function th(e,t,n=!1){let r=await W(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return ti._forOperation(e,"link",r)}async function td(e,t,n){await Z(t);let r=tu(t.providerData);b(r.has(n)===e,t.auth,!1===e?"provider-already-linked":"no-such-provider")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tf(e,t,n=!1){let{auth:r}=e,i="reauthenticate";try{let s=await W(e,tl(r,i,t,e),n);b(s.idToken,r,"internal-error");let o=H(s.idToken);b(o,r,"internal-error");let{sub:a}=o;return b(e.uid===a,r,"user-mismatch"),ti._forOperation(e,i,s)}catch(e){throw(null==e?void 0:e.code)==="auth/user-not-found"&&m(r,"user-mismatch"),e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tp(e,t,n=!1){let r="signIn",i=await tl(e,r,t),s=await ti._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function tg(e,t){return tp(eR(e),t)}async function tm(e,t){let n=(0,i.m9)(e);return await td(!1,n,t.providerId),th(n,t)}async function ty(e,t){return tf((0,i.m9)(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tv(e,t){return F(e,"POST","/v1/accounts:signInWithCustomToken",P(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t_(e,t){let n=eR(e),r=await tv(n,{token:t,returnSecureToken:!0}),i=await ti._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tw{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?tb._fromServerResponse(e,t):"totpInfo"in t?tI._fromServerResponse(e,t):m(e,"internal-error")}}class tb extends tw{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new tb(t)}}class tI extends tw{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new tI(t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tT(e,t,n){var r;b((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),b(void 0===n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(b(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(b(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tE(e,t,n){var r;let i=eR(e),s={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};if(null===(r=i._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){let e=await ek(i,s,"getOobCode",!0);n&&tT(i,e,n),await eB(i,e)}else n&&tT(i,s,n),await eB(i,s).catch(async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log("Password resets are protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the password reset flow.");let e=await ek(i,s,"getOobCode",!0);n&&tT(i,e,n),await eB(i,e)}})}async function tC(e,t,n){await eL((0,i.m9)(e),{oobCode:t,newPassword:n})}async function tS(e,t){await eU((0,i.m9)(e),{oobCode:t})}async function tk(e,t){let n=(0,i.m9)(e),r=await eL(n,{oobCode:t}),s=r.requestType;switch(b(s,n,"internal-error"),s){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":b(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":b(r.mfaInfo,n,"internal-error");default:b(r.email,n,"internal-error")}let o=null;return r.mfaInfo&&(o=tw._fromServerResponse(eR(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:o},operation:s}}async function tx(e,t){let{data:n}=await tk((0,i.m9)(e),t);return n.email}async function tA(e,t,n){var r;let i;let s=eR(e),o={returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"};if(null===(r=s._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){let e=await ek(s,o,"signUpPassword");i=tr(s,e)}else i=tr(s,o).catch(async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log("Sign-up is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-up flow.");let e=await ek(s,o,"signUpPassword");return tr(s,e)}});let a=await i.catch(e=>Promise.reject(e)),l=await ti._fromIdTokenResponse(s,"signIn",a);return await s._updateCurrentUser(l.user),l}function tR(e,t,n){return tg((0,i.m9)(e),e4.credential(t,n))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tN(e,t,n){var r;let i=eR(e),s={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};function o(e,t){b(t.handleCodeInApp,i,"argument-error"),t&&tT(i,e,t)}if(null===(r=i._getRecaptchaConfig())||void 0===r?void 0:r.emailPasswordEnabled){let e=await ek(i,s,"getOobCode",!0);o(e,n),await ez(i,e)}else o(s,n),await ez(i,s).catch(async e=>{if("auth/missing-recaptcha-token"!==e.code)return Promise.reject(e);{console.log("Email link sign-in is protected by reCAPTCHA for this project. Automatically triggering the reCAPTCHA flow and restarting the sign-in flow.");let e=await ek(i,s,"getOobCode",!0);o(e,n),await ez(i,e)}})}function tP(e,t){let n=e2.parseLink(t);return(null==n?void 0:n.operation)==="EMAIL_SIGNIN"}async function tD(e,t,n){let r=(0,i.m9)(e),s=e4.credentialWithLink(t,n||E());return b(s._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),tg(r,s)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tO(e,t){return D(e,"POST","/v1/accounts:createAuthUri",P(e,t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tF(e,t){let n=C()?E():"http://localhost",{signinMethods:r}=await tO((0,i.m9)(e),{identifier:t,continueUri:n});return r||[]}async function tL(e,t){let n=(0,i.m9)(e),r=await e.getIdToken(),s={requestType:"VERIFY_EMAIL",idToken:r};t&&tT(n.auth,s,t);let{email:o}=await ej(n.auth,s);o!==e.email&&await e.reload()}async function tM(e,t,n){let r=(0,i.m9)(e),s=await e.getIdToken(),o={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:s,newEmail:t};n&&tT(r.auth,o,n);let{email:a}=await e$(r.auth,o);a!==e.email&&await e.reload()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tU(e,t){return D(e,"POST","/v1/accounts:update",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tV(e,{displayName:t,photoURL:n}){if(void 0===t&&void 0===n)return;let r=(0,i.m9)(e),s=await r.getIdToken(),o=await W(r,tU(r.auth,{idToken:s,displayName:t,photoUrl:n,returnSecureToken:!0}));r.displayName=o.displayName||null,r.photoURL=o.photoUrl||null;let a=r.providerData.find(({providerId:e})=>"password"===e);a&&(a.displayName=r.displayName,a.photoURL=r.photoURL),await r._updateTokensIfNecessary(o)}function tq(e,t){return tB((0,i.m9)(e),t,null)}function tj(e,t){return tB((0,i.m9)(e),null,t)}async function tB(e,t,n){let{auth:r}=e,i=await e.getIdToken(),s={idToken:i,returnSecureToken:!0};t&&(s.email=t),n&&(s.password=n);let o=await W(e,eM(r,s));await e._updateTokensIfNecessary(o,!0)}class tz{constructor(e,t,n={}){this.isNewUser=e,this.providerId=t,this.profile=n}}class t$ extends tz{constructor(e,t,n,r){super(e,t,n),this.username=r}}class tH extends tz{constructor(e,t){super(e,"facebook.com",t)}}class tW extends t${constructor(e,t){super(e,"github.com",t,"string"==typeof(null==t?void 0:t.login)?null==t?void 0:t.login:null)}}class tG extends tz{constructor(e,t){super(e,"google.com",t)}}class tK extends t${constructor(e,t,n){super(e,"twitter.com",t,n)}}function tZ(e){let{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){var t,n;if(!e)return null;let{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null==e?void 0:e.idToken)){let r=null===(n=null===(t=H(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new tz(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new tH(s,i);case"github.com":return new tW(s,i);case"google.com":return new tG(s,i);case"twitter.com":return new tK(s,i,e.screenName||null);case"custom":case"anonymous":return new tz(s,null);default:return new tz(s,r,i)}}(n)}function tQ(e,t,n,r){return(0,i.m9)(e).onAuthStateChanged(t,n,r)}function tY(e){return(0,i.m9)(e).signOut()}class tX{constructor(e,t,n){this.type=e,this.credential=t,this.auth=n}static _fromIdtoken(e,t){return new tX("enroll",e,t)}static _fromMfaPendingCredential(e){return new tX("signin",e)}toJSON(){let e="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[e]:this.credential}}}static fromJSON(e){var t,n;if(null==e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return tX._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return tX._fromIdtoken(e.multiFactorSession.idToken)}return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tJ{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){let n=eR(e),r=t.customData._serverResponse,i=(r.mfaInfo||[]).map(e=>tw._fromServerResponse(n,e));b(r.mfaPendingCredential,n,"internal-error");let s=tX._fromMfaPendingCredential(r.mfaPendingCredential);return new tJ(s,i,async e=>{let i=await e._process(n,s);delete r.mfaInfo,delete r.mfaPendingCredential;let o=Object.assign(Object.assign({},r),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":let a=await ti._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(a.user),a;case"reauthenticate":return b(t.user,n,"internal-error"),ti._forOperation(t.user,t.operationType,o);default:m(n,"internal-error")}})}async resolveSignIn(e){return this.signInResolver(e)}}function t0(e,t){var n;let r=(0,i.m9)(e);return b(t.customData.operationType,r,"argument-error"),b(null===(n=t.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),tJ._fromError(r,t)}class t1{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload(t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map(t=>tw._fromServerResponse(e.auth,t)))})}static _fromUser(e){return new t1(e)}async getSession(){return tX._fromIdtoken(await this.user.getIdToken(),this.user.auth)}async enroll(e,t){let n=await this.getSession(),r=await W(this.user,e._process(this.user.auth,n,t));return await this.user._updateTokensIfNecessary(r),this.user.reload()}async unenroll(e){let t="string"==typeof e?e:e.uid,n=await this.user.getIdToken();try{var r;let e=await W(this.user,(r=this.user.auth,D(r,"POST","/v2/accounts/mfaEnrollment:withdraw",P(r,{idToken:n,mfaEnrollmentId:t}))));this.enrolledFactors=this.enrolledFactors.filter(({uid:e})=>e!==t),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(e){throw e}}}let t2=new WeakMap;function t4(e){let t=(0,i.m9)(e);return t2.has(t)||t2.set(t,t1._fromUser(t)),t2.get(t)}let t9="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t5{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(t9,"1"),this.storage.removeItem(t9),Promise.resolve(!0)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){let t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class t6 extends t5{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(){let e=(0,i.z$)();return eu(e)||eg(e)}()&&function(){try{return!!(window&&window!==window.top)}catch(e){return!1}}(),this.fallbackToPolling=ey(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(let t of Object.keys(this.listeners)){let n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((e,t,n)=>{this.notifyListeners(e,n)});return}let n=e.key;if(t?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){let r=this.storage.getItem(n);if(e.newValue!==r)null!==e.newValue?this.storage.setItem(n,e.newValue):this.storage.removeItem(n);else if(this.localCache[n]===e.newValue&&!t)return}let r=()=>{let e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);(0,i.w1)()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;let n=this.listeners[e];if(n)for(let e of Array.from(n))e(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){let t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}t6.type="LOCAL";let t3=t6;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t8 extends t5{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}t8.type="SESSION";let t7=t8;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){let t=this.receivers.find(t=>t.isListeningto(e));if(t)return t;let n=new ne(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){let{eventId:t,eventType:n,data:r}=e.data,i=this.handlersMap[n];if(!(null==i?void 0:i.size))return;e.ports[0].postMessage({status:"ack",eventId:t,eventType:n});let s=Array.from(i).map(async t=>t(e.origin,r)),o=await Promise.all(s.map(async e=>{try{let t=await e;return{fulfilled:!0,value:t}}catch(e){return{fulfilled:!1,reason:e}}}));e.ports[0].postMessage({status:"done",eventId:t,eventType:n,response:o})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nt(e="",t=10){let n="";for(let e=0;e<t;e++)n+=Math.floor(10*Math.random());return e+n}ne.receivers=[];/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nn{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){let r,i;let s="undefined"!=typeof MessageChannel?new MessageChannel:null;if(!s)throw Error("connection_unavailable");return new Promise((o,a)=>{let l=nt("",20);s.port1.start();let u=setTimeout(()=>{a(Error("unsupported_event"))},n);i={messageChannel:s,onMessage(e){if(e.data.eventId===l)switch(e.data.status){case"ack":clearTimeout(u),r=setTimeout(()=>{a(Error("timeout"))},3e3);break;case"done":clearTimeout(r),o(e.data.response);break;default:clearTimeout(u),clearTimeout(r),a(Error("invalid_response"))}}},this.handlers.add(i),s.port1.addEventListener("message",i.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[s.port2])}).finally(()=>{i&&this.removeMessageHandler(i)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nr(){return window}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ni(){return void 0!==nr().WorkerGlobalScope&&"function"==typeof nr().importScripts}async function ns(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{let e=await navigator.serviceWorker.ready;return e.active}catch(e){return null}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let no="firebaseLocalStorageDb",na="firebaseLocalStorage",nl="fbase_key";class nu{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function nc(e,t){return e.transaction([na],t?"readwrite":"readonly").objectStore(na)}function nh(){let e=indexedDB.open(no,1);return new Promise((t,n)=>{e.addEventListener("error",()=>{n(e.error)}),e.addEventListener("upgradeneeded",()=>{let t=e.result;try{t.createObjectStore(na,{keyPath:nl})}catch(e){n(e)}}),e.addEventListener("success",async()=>{let n=e.result;n.objectStoreNames.contains(na)?t(n):(n.close(),await function(){let e=indexedDB.deleteDatabase(no);return new nu(e).toPromise()}(),t(await nh()))})})}async function nd(e,t,n){let r=nc(e,!0).put({[nl]:t,value:n});return new nu(r).toPromise()}async function nf(e,t){let n=nc(e,!1).get(t),r=await new nu(n).toPromise();return void 0===r?null:r.value}function np(e,t){let n=nc(e,!0).delete(t);return new nu(n).toPromise()}class ng{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await nh()),this.db}async _withRetries(e){let t=0;for(;;)try{let t=await this._openDb();return await e(t)}catch(e){if(t++>3)throw e;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ni()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=ne._getInstance(ni()?self:null),this.receiver._subscribe("keyChanged",async(e,t)=>{let n=await this._poll();return{keyProcessed:n.includes(t.key)}}),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await ns(),!this.activeServiceWorker)return;this.sender=new nn(this.activeServiceWorker);let n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){var t;if(this.sender&&this.activeServiceWorker&&((null===(t=null==navigator?void 0:navigator.serviceWorker)||void 0===t?void 0:t.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(e){}}async _isAvailable(){try{if(!indexedDB)return!1;let e=await nh();return await nd(e,t9,"1"),await np(e,t9),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>nd(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){let t=await this._withRetries(t=>nf(t,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>np(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){let e=await this._withRetries(e=>{let t=nc(e,!1).getAll();return new nu(t).toPromise()});if(!e||0!==this.pendingWrites)return[];let t=[],n=new Set;for(let{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(let e of Object.keys(this.localCache))this.localCache[e]&&!n.has(e)&&(this.notifyListeners(e,null),t.push(e));return t}notifyListeners(e,t){this.localCache[e]=t;let n=this.listeners[e];if(n)for(let e of Array.from(n))e(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}ng.type="LOCAL";let nm=ng;class ny{constructor(e){this.auth=e,this.counter=1e12,this._widgets=new Map}render(e,t){let n=this.counter;return this._widgets.set(n,new nv(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;let n=e||1e12;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;return(null===(t=this._widgets.get(e||1e12))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;return null===(t=this._widgets.get(e||1e12))||void 0===t||t.execute(),""}}class nv{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};let r="string"==typeof e?document.getElementById(e):e;b(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout(()=>{this.responseToken=function(e){let t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let e=0;e<50;e++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(0);let{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(e){}this.timerId=window.setTimeout(()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(e){}this.isVisible&&this.execute()},6e4)},500))}checkIfDeleted(){if(this.deleted)throw Error("reCAPTCHA mock was already deleted!")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let n_=eC("rcb"),nw=new k(3e4,6e4);class nb{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=nr().grecaptcha)||void 0===e?void 0:e.render)}load(e,t=""){return(b(t.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(t),e,"argument-error"),this.shouldResolveImmediately(t)&&eb(nr().grecaptcha))?Promise.resolve(nr().grecaptcha):new Promise((n,r)=>{let s=nr().setTimeout(()=>{r(y(e,"network-request-failed"))},nw.get());nr()[n_]=()=>{nr().clearTimeout(s),delete nr()[n_];let i=nr().grecaptcha;if(!i||!eb(i)){r(y(e,"internal-error"));return}let o=i.render;i.render=(e,t)=>{let n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(i)};let o=`https://www.google.com/recaptcha/api.js??${(0,i.xO)({onload:n_,render:"explicit",hl:t})}`;eE(o).catch(()=>{clearTimeout(s),r(y(e,"internal-error"))})})}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=nr().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class nI{async load(e){return new ny(e)}clearedOneInstance(){}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nT="recaptcha",nE={theme:"light",type:"image"};class nC{constructor(e,t=Object.assign({},nE),n){this.parameters=t,this.type=nT,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=eR(n),this.isInvisible="invisible"===this.parameters.size,b("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment");let r="string"==typeof e?document.getElementById(e):e;b(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new nI:new nb,this.validateStartingState()}async verify(){this.assertNotDestroyed();let e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise(n=>{let r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)})}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch(e=>{throw this.renderPromise=null,e})),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach(e=>{this.container.removeChild(e)})}validateStartingState(){b(!this.parameters.sitekey,this.auth,"argument-error"),b(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),b("undefined"!=typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach(e=>e(t)),"function"==typeof e)e(t);else if("string"==typeof e){let n=nr()[e];"function"==typeof n&&n(t)}}}assertNotDestroyed(){b(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){let t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){let e;b(C()&&!ni(),this.auth,"internal-error"),await (e=null,new Promise(t=>{if("complete"===document.readyState){t();return}e=()=>t(),window.addEventListener("load",e)}).catch(t=>{throw e&&window.removeEventListener("load",e),t})),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);let t=await e_(this.auth);b(t,this.auth,"internal-error"),this.parameters.sitekey=t}getAssertedRecaptcha(){return b(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nS{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){let t=e1._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function nk(e,t,n){let r=eR(e),s=await nR(r,t,(0,i.m9)(n));return new nS(s,e=>tg(r,e))}async function nx(e,t,n){let r=(0,i.m9)(e);await td(!1,r,"phone");let s=await nR(r.auth,t,(0,i.m9)(n));return new nS(s,e=>tm(r,e))}async function nA(e,t,n){let r=(0,i.m9)(e),s=await nR(r.auth,t,(0,i.m9)(n));return new nS(s,e=>ty(r,e))}async function nR(e,t,n){var r,i,s;let o=await n.verify();try{let a;if(b("string"==typeof o,e,"argument-error"),b(n.type===nT,e,"argument-error"),a="string"==typeof t?{phoneNumber:t}:t,"session"in a){let t=a.session;if("phoneNumber"in a){b("enroll"===t.type,e,"internal-error");let n=await (i={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:a.phoneNumber,recaptchaToken:o}},D(e,"POST","/v2/accounts/mfaEnrollment:start",P(e,i)));return n.phoneSessionInfo.sessionInfo}{b("signin"===t.type,e,"internal-error");let n=(null===(r=a.multiFactorHint)||void 0===r?void 0:r.uid)||a.multiFactorUid;b(n,e,"missing-multi-factor-info");let i=await (s={mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:o}},D(e,"POST","/v2/accounts/mfaSignIn:start",P(e,s)));return i.phoneResponseInfo.sessionInfo}}{let{sessionInfo:t}=await eQ(e,{phoneNumber:a.phoneNumber,recaptchaToken:o});return t}}finally{n._reset()}}async function nN(e,t){await th((0,i.m9)(e),t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nP{constructor(e){this.providerId=nP.PROVIDER_ID,this.auth=eR(e)}verifyPhoneNumber(e,t){return nR(this.auth,e,(0,i.m9)(t))}static credential(e,t){return e1._fromVerification(e,t)}static credentialFromResult(e){return nP.credentialFromTaggedObject(e)}static credentialFromError(e){return nP.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;let{phoneNumber:t,temporaryProof:n}=e;return t&&n?e1._fromTokenResponse(t,n):null}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nD(e,t){return t?en(t):(b(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}nP.PROVIDER_ID="phone",nP.PHONE_SIGN_IN_METHOD="phone";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nO extends eF{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return eK(e,this._buildIdpRequest())}_linkToIdToken(e,t){return eK(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return eK(e,this._buildIdpRequest())}_buildIdpRequest(e){let t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function nF(e){return tp(e.auth,new nO(e),e.bypassAuthState)}function nL(e){let{auth:t,user:n}=e;return b(n,t,"internal-error"),tf(n,new nO(e),e.bypassAuthState)}async function nM(e){let{auth:t,user:n}=e;return b(n,t,"internal-error"),th(n,new nO(e),e.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nU{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(e){this.reject(e)}})}async onAuthEvent(e){let{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s){this.reject(s);return}let a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(e){this.reject(e)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return nF;case"linkViaPopup":case"linkViaRedirect":return nM;case"reauthViaPopup":case"reauthViaRedirect":return nL;default:m(this.auth,"internal-error")}}resolve(e){T(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){T(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nV=new k(2e3,1e4);async function nq(e,t,n){let r=eR(e);_(e,t,e9);let i=nD(r,n),s=new nz(r,"signInViaPopup",t,i);return s.executeNotNull()}async function nj(e,t,n){let r=(0,i.m9)(e);_(r.auth,t,e9);let s=nD(r.auth,n),o=new nz(r.auth,"reauthViaPopup",t,s,r);return o.executeNotNull()}async function nB(e,t,n){let r=(0,i.m9)(e);_(r.auth,t,e9);let s=nD(r.auth,n),o=new nz(r.auth,"linkViaPopup",t,s,r);return o.executeNotNull()}class nz extends nU{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,nz.currentPopupAction&&nz.currentPopupAction.cancel(),nz.currentPopupAction=this}async executeNotNull(){let e=await this.execute();return b(e,this.auth,"internal-error"),e}async onExecution(){T(1===this.filter.length,"Popup operations only handle one event");let e=nt();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(e=>{this.reject(e)}),this.resolver._isIframeWebStorageSupported(this.auth,e=>{e||this.reject(y(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(y(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,nz.currentPopupAction=null}pollUserCancellation(){let e=()=>{var t,n;if(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(y(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,nV.get())};e()}}nz.currentPopupAction=null;let n$=new Map;class nH extends nU{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=n$.get(this.auth._key());if(!e){try{let t=await nW(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}n$.set(this.auth._key(),e)}return this.bypassAuthState||n$.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"===e.type){this.resolve(null);return}if(e.eventId){let t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function nW(e,t){let n=nY(t),r=nQ(e);if(!await r._isAvailable())return!1;let i=await r._get(n)==="true";return await r._remove(n),i}async function nG(e,t){return nQ(e)._set(nY(t),"true")}function nK(){n$.clear()}function nZ(e,t){n$.set(e._key(),t)}function nQ(e){return en(e._redirectPersistence)}function nY(e){return es("pendingRedirect",e.config.apiKey,e.name)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nX(e,t,n){return nJ(e,t,n)}async function nJ(e,t,n){let r=eR(e);_(e,t,e9),await r._initializationPromise;let i=nD(r,n);return await nG(i,r),i._openRedirect(r,t,"signInViaRedirect")}function n0(e,t,n){return n1(e,t,n)}async function n1(e,t,n){let r=(0,i.m9)(e);_(r.auth,t,e9),await r.auth._initializationPromise;let s=nD(r.auth,n);await nG(s,r.auth);let o=await n6(r);return s._openRedirect(r.auth,t,"reauthViaRedirect",o)}function n2(e,t,n){return n4(e,t,n)}async function n4(e,t,n){let r=(0,i.m9)(e);_(r.auth,t,e9),await r.auth._initializationPromise;let s=nD(r.auth,n);await td(!1,r,t.providerId),await nG(s,r.auth);let o=await n6(r);return s._openRedirect(r.auth,t,"linkViaRedirect",o)}async function n9(e,t){return await eR(e)._initializationPromise,n5(e,t,!1)}async function n5(e,t,n=!1){let r=eR(e),i=nD(r,t),s=new nH(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function n6(e){let t=nt(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class n3{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return n7(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!n7(e)){let r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(y(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){let n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(n8(e))}saveEventToCache(e){this.cachedEventUids.add(n8(e)),this.lastProcessedEventTime=Date.now()}}function n8(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter(e=>e).join("-")}function n7({type:e,error:t}){return"unknown"===e&&(null==t?void 0:t.code)==="auth/no-auth-event"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function re(e,t={}){return D(e,"GET","/v1/projects",t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rt=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rn=/^https?/;async function rr(e){if(e.config.emulator)return;let{authorizedDomains:t}=await re(e);for(let e of t)try{if(function(e){let t=E(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){let i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!rn.test(n))return!1;if(rt.test(e))return r===e;let i=e.replace(/\./g,"\\."),s=RegExp("^(.+\\."+i+"|"+i+")$","i");return s.test(r)}(e))return}catch(e){}m(e,"unauthorized-domain")}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ri=new k(3e4,6e4);function rs(){let e=nr().___jsl;if(null==e?void 0:e.H){for(let t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let t=0;t<e.CP.length;t++)e.CP[t]=null}}let ro=null,ra=new k(5e3,15e3),rl={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},ru=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function rc(e){let t=await (ro=ro||new Promise((t,n)=>{var r,i,s;function o(){rs(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{rs(),n(y(e,"network-request-failed"))},timeout:ri.get()})}if(null===(i=null===(r=nr().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else if(null===(s=nr().gapi)||void 0===s?void 0:s.load)o();else{let t=eC("iframefcb");return nr()[t]=()=>{gapi.load?o():n(y(e,"network-request-failed"))},eE(`https://apis.google.com/js/api.js?onload=${t}`).catch(e=>n(e))}}).catch(e=>{throw ro=null,e})),n=nr().gapi;return b(n,e,"internal-error"),t.open({where:document.body,url:function(e){let t=e.config;b(t.authDomain,e,"auth-domain-config-required");let n=t.emulator?x(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:s.SDK_VERSION},o=ru.get(e.config.apiHost);o&&(r.eid=o);let a=e._getFrameworks();return a.length&&(r.fw=a.join(",")),`${n}?${(0,i.xO)(r).slice(1)}`}(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:rl,dontclear:!0},t=>new Promise(async(n,r)=>{await t.restyle({setHideOnLeave:!1});let i=y(e,"network-request-failed"),s=nr().setTimeout(()=>{r(i)},ra.get());function o(){nr().clearTimeout(s),n(t)}t.ping(o).then(o,()=>{r(i)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rh={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class rd{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}let rf=encodeURIComponent("fac");async function rp(e,t,n,r,o,a){b(e.config.authDomain,e,"auth-domain-config-required"),b(e.config.apiKey,e,"invalid-api-key");let l={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:s.SDK_VERSION,eventId:o};if(t instanceof e9)for(let[n,r]of(t.setDefaultLanguage(e.languageCode),l.providerId=t.providerId||"",(0,i.xb)(t.getCustomParameters())||(l.customParameters=JSON.stringify(t.getCustomParameters())),Object.entries(a||{})))l[n]=r;if(t instanceof e5){let e=t.getScopes().filter(e=>""!==e);e.length>0&&(l.scopes=e.join(","))}e.tenantId&&(l.tid=e.tenantId);let u=l;for(let e of Object.keys(u))void 0===u[e]&&delete u[e];let c=await e._getAppCheckToken(),h=c?`#${rf}=${encodeURIComponent(c)}`:"";return`${function({config:e}){return e.emulator?x(e,"emulator/auth/handler"):`https://${e.authDomain}/__/auth/handler`}(e)}?${(0,i.xO)(u).slice(1)}${h}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rg="webStorageSupport",rm=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=t7,this._completeRedirectFn=n5,this._overrideRedirectResult=nZ}async _openPopup(e,t,n,r){var s;T(null===(s=this.eventManagers[e._key()])||void 0===s?void 0:s.manager,"_initialize() not called before _openPopup()");let o=await rp(e,t,n,E(),r);return function(e,t,n,r=500,s=600){let o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString(),l="",u=Object.assign(Object.assign({},rh),{width:r.toString(),height:s.toString(),top:o,left:a}),c=(0,i.z$)().toLowerCase();n&&(l=ec(c)?"_blank":n),el(c)&&(t=t||"http://localhost",u.scrollbars="yes");let h=Object.entries(u).reduce((e,[t,n])=>`${e}${t}=${n},`,"");if(function(e=(0,i.z$)()){var t;return eg(e)&&!!(null===(t=window.navigator)||void 0===t?void 0:t.standalone)}(c)&&"_self"!==l)return function(e,t){let n=document.createElement("a");n.href=e,n.target=t;let r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",l),new rd(null);let d=window.open(t||"",l,h);b(d,e,"popup-blocked");try{d.focus()}catch(e){}return new rd(d)}(e,o,nt())}async _openRedirect(e,t,n,r){await this._originValidation(e);let i=await rp(e,t,n,E(),r);return nr().location.href=i,new Promise(()=>{})}_initialize(e){let t=e._key();if(this.eventManagers[t]){let{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(T(n,"If manager is not set, promise should be"),n)}let n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){let t=await rc(e),n=new n3(e);return t.register("authEvent",t=>{b(null==t?void 0:t.authEvent,e,"invalid-auth-event");let r=n.onEvent(t.authEvent);return{status:r?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){let n=this.iframes[e._key()];n.send(rg,{type:rg},n=>{var r;let i=null===(r=null==n?void 0:n[0])||void 0===r?void 0:r[rg];void 0!==i&&t(!!i),m(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=rr(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return ey()||eu()||eg()}};class ry{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return I("unexpected MultiFactorSessionType")}}}class rv extends ry{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new rv(e)}_finalizeEnroll(e,t,n){return D(e,"POST","/v2/accounts/mfaEnrollment:finalize",P(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}_finalizeSignIn(e,t){return D(e,"POST","/v2/accounts/mfaSignIn:finalize",P(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}}class r_{constructor(){}static assertion(e){return rv._fromCredential(e)}}r_.FACTOR_ID="phone";class rw extends ry{constructor(e,t,n){super("totp"),this.otp=e,this.enrollmentId=t,this.secret=n}static _fromSecret(e,t){return new rw(t,void 0,e)}static _fromEnrollmentId(e,t){return new rw(t,e)}async _finalizeEnroll(e,t,n){return b(void 0!==this.secret,e,"argument-error"),D(e,"POST","/v2/accounts/mfaEnrollment:finalize",P(e,{idToken:t,displayName:n,totpVerificationInfo:this.secret._makeTotpVerificationInfo(this.otp)}))}async _finalizeSignIn(e,t){b(void 0!==this.enrollmentId&&void 0!==this.otp,e,"argument-error");let n={verificationCode:this.otp};return D(e,"POST","/v2/accounts/mfaSignIn:finalize",P(e,{mfaPendingCredential:t,mfaEnrollmentId:this.enrollmentId,totpVerificationInfo:n}))}}class rb{constructor(e,t,n,r,i,s,o){this.sessionInfo=s,this.auth=o,this.secretKey=e,this.hashingAlgorithm=t,this.codeLength=n,this.codeIntervalSeconds=r,this.enrollmentCompletionDeadline=i}static _fromStartTotpMfaEnrollmentResponse(e,t){return new rb(e.totpSessionInfo.sharedSecretKey,e.totpSessionInfo.hashingAlgorithm,e.totpSessionInfo.verificationCodeLength,e.totpSessionInfo.periodSec,new Date(e.totpSessionInfo.finalizeEnrollmentTime).toUTCString(),e.totpSessionInfo.sessionInfo,t)}_makeTotpVerificationInfo(e){return{sessionInfo:this.sessionInfo,verificationCode:e}}generateQrCodeUrl(e,t){var n;let r=!1;return(rI(e)||rI(t))&&(r=!0),r&&(rI(e)&&(e=(null===(n=this.auth.currentUser)||void 0===n?void 0:n.email)||"unknownuser"),rI(t)&&(t=this.auth.name)),`otpauth://totp/${t}:${e}?secret=${this.secretKey}&issuer=${t}&algorithm=${this.hashingAlgorithm}&digits=${this.codeLength}`}}function rI(e){return void 0===e||(null==e?void 0:e.length)===0}var rT="@firebase/auth",rE="0.23.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;let t=await this.auth.currentUser.getIdToken(e);return{accessToken:t}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;let t=this.auth.onIdTokenChanged(t=>{e((null==t?void 0:t.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();let t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){b(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}let rS=(0,i.Pz)("authIdTokenMaxAge")||300,rk=null,rx=e=>async t=>{let n=t&&await t.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>rS)return;let i=null==n?void 0:n.token;rk!==i&&(rk=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function rA(e=(0,s.getApp)()){let t=(0,s._getProvider)(e,"auth");if(t.isInitialized())return t.getImmediate();let n=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e,t){let n=(0,s._getProvider)(e,"auth");if(n.isInitialized()){let e=n.getImmediate(),r=n.getOptions();if((0,i.vZ)(r,null!=t?t:{}))return e;m(e,"already-initialized")}let r=n.initialize({options:t});return r}(e,{popupRedirectResolver:rm,persistence:[nm,t3,t7]}),r=(0,i.Pz)("authTokenSyncURL");if(r){var o,a;let e=rx(r);o=()=>e(n.currentUser),(0,i.m9)(n).beforeAuthStateChanged(e,o),a=t=>e(t),(0,i.m9)(n).onIdTokenChanged(a,void 0,void 0)}let l=(0,i.q4)("auth");return l&&eP(n,`http://${l}`),n}r="Browser",(0,s._registerComponent)(new l.wA("auth",(e,{options:t})=>{let n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=n.options;b(o&&!o.includes(":"),"invalid-api-key",{appName:n.name}),b(!(null==a?void 0:a.includes(":")),"argument-error",{appName:n.name});let l={apiKey:o,authDomain:a,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ev(r)},u=new eA(n,i,s,l);return function(e,t){let n=(null==t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(en);(null==t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null==t?void 0:t.popupRedirectResolver)}(u,t),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{let r=e.getProvider("auth-internal");r.initialize()})),(0,s._registerComponent)(new l.wA("auth-internal",e=>{let t=eR(e.getProvider("auth").getImmediate());return new rC(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,s.registerVersion)(rT,rE,/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(r)),(0,s.registerVersion)(rT,rE,"esm2017")},774:function(e,t,n){"use strict";n.d(t,{$Y:function(){return el},B0:function(){return eC},FN:function(){return ea},IX:function(){return eg},Jt:function(){return eR},UJ:function(){return j},Ym:function(){return ek},a1:function(){return eF},aF:function(){return eA},bm:function(){return F},cF:function(){return eO},g6:function(){return eD},gE:function(){return T},gH:function(){return v},iH:function(){return eP},oq:function(){return eN},pb:function(){return ex},qm:function(){return M},sd:function(){return eS},y4:function(){return w}});var r,i,s,o,a=n(5816),l=n(4444),u=n(740);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let c="firebasestorage.googleapis.com",h="storageBucket";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d extends l.ZR{constructor(e,t,n=0){super(f(e),`Firebase Storage: ${t} (${f(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,d.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return f(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}function f(e){return"storage/"+e}function p(){return new d(s.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function g(){return new d(s.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function m(){return new d(s.CANCELED,"User canceled the upload/download.")}function y(){return new d(s.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function v(e){return new d(s.INVALID_ARGUMENT,e)}function _(){return new d(s.APP_DELETED,"The Firebase app was deleted.")}function w(e){return new d(s.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function b(e,t){return new d(s.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function I(e){throw new d(s.INTERNAL_ERROR,"Internal error: "+e)}(r=s||(s={})).UNKNOWN="unknown",r.OBJECT_NOT_FOUND="object-not-found",r.BUCKET_NOT_FOUND="bucket-not-found",r.PROJECT_NOT_FOUND="project-not-found",r.QUOTA_EXCEEDED="quota-exceeded",r.UNAUTHENTICATED="unauthenticated",r.UNAUTHORIZED="unauthorized",r.UNAUTHORIZED_APP="unauthorized-app",r.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",r.INVALID_CHECKSUM="invalid-checksum",r.CANCELED="canceled",r.INVALID_EVENT_NAME="invalid-event-name",r.INVALID_URL="invalid-url",r.INVALID_DEFAULT_BUCKET="invalid-default-bucket",r.NO_DEFAULT_BUCKET="no-default-bucket",r.CANNOT_SLICE_BLOB="cannot-slice-blob",r.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",r.NO_DOWNLOAD_URL="no-download-url",r.INVALID_ARGUMENT="invalid-argument",r.INVALID_ARGUMENT_COUNT="invalid-argument-count",r.APP_DELETED="app-deleted",r.INVALID_ROOT_OPERATION="invalid-root-operation",r.INVALID_FORMAT="invalid-format",r.INTERNAL_ERROR="internal-error",r.UNSUPPORTED_ENVIRONMENT="unsupported-environment";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){let e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=T.makeFromUrl(e,t)}catch(t){return new T(e,"")}if(""===n.path)return n;throw new d(s.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+e+"'.")}static makeFromUrl(e,t){let n=null,r="([A-Za-z0-9.\\-_]+)",i=RegExp("^gs://"+r+"(/(.*))?$","i");function o(e){e.path_=decodeURIComponent(e.path)}let a=t.replace(/[.]/g,"\\."),l=RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),u=RegExp(`^https?://${t===c?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),h=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:l,indices:{bucket:1,path:3},postModify:o},{regex:u,indices:{bucket:1,path:2},postModify:o}];for(let t=0;t<h.length;t++){let r=h[t],i=r.regex.exec(e);if(i){let e=i[r.indices.bucket],t=i[r.indices.path];t||(t=""),n=new T(e,t),r.postModify(n);break}}if(null==n)throw new d(s.INVALID_URL,"Invalid URL '"+e+"'.");return n}}class E{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function C(e){return"string"==typeof e||e instanceof String}function S(e){return k()&&e instanceof Blob}function k(){return"undefined"!=typeof Blob&&!(0,l.UG)()}function x(e,t,n,r){if(r<t)throw v(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw v(`Invalid value for '${e}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function R(e){let t=encodeURIComponent,n="?";for(let r in e)if(e.hasOwnProperty(r)){let i=t(r)+"="+t(e[r]);n=n+i+"&"}return n.slice(0,-1)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N(e,t){let n=-1!==[408,429].indexOf(e),r=-1!==t.indexOf(e);return e>=500&&e<600||n||r}(i=o||(o={}))[i.NO_ERROR=0]="NO_ERROR",i[i.NETWORK_ERROR=1]="NETWORK_ERROR",i[i.ABORT=2]="ABORT";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P{constructor(e,t,n,r,i,s,o,a,l,u,c,h=!0){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=c,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()})}start_(){let e=(e,t)=>{if(t){e(!1,new D(!1,null,!0));return}let n=this.connectionFactory_();this.pendingConnection_=n;let r=e=>{let t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;let t=n.getErrorCode()===o.NO_ERROR,i=n.getStatus();if(!t||N(i,this.additionalRetryCodes_)&&this.retry){let t=n.getErrorCode()===o.ABORT;e(!1,new D(!1,null,t));return}let s=-1!==this.successCodes_.indexOf(i);e(!0,new D(s,n))})},t=(e,t)=>{let n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{let e=this.callback_(i,i.getResponse());void 0!==e?n(e):n()}catch(e){r(e)}else if(null!==i){let e=p();e.serverResponse=i.getErrorText(),r(this.errorCallback_?this.errorCallback_(i,e):e)}else if(t.canceled){let e=this.appDelete_?_():m();r(e)}else{let e=g();r(e)}};this.canceled_?t(!1,new D(!1,null,!0)):this.backoffId_=/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e,t,n){let r=1,i=null,s=null,o=!1,a=0,l=!1;function u(...e){l||(l=!0,t.apply(null,e))}function c(t){i=setTimeout(()=>{i=null,e(d,2===a)},t)}function h(){s&&clearTimeout(s)}function d(e,...t){let n;if(l){h();return}if(e){h(),u.call(null,e,...t);return}let i=2===a||o;if(i){h(),u.call(null,e,...t);return}r<64&&(r*=2),1===a?(a=2,n=0):n=(r+Math.random())*1e3,c(n)}let f=!1;function p(e){!f&&(f=!0,h(),!l&&(null!==i?(e||(a=2),clearTimeout(i),c(0)):e||(a=1)))}return c(0),s=setTimeout(()=>{o=!0,p(!0)},n),p}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class D{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function O(...e){let t="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==t){let n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(k())return new Blob(e);throw new d(s.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class L{constructor(e,t){this.data=e,this.contentType=t||null}}function M(e,t){switch(e){case F.RAW:return new L(U(t));case F.BASE64:case F.BASE64URL:return new L(V(e,t));case F.DATA_URL:return new L(function(e){let t=new q(e);return t.base64?V(F.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(e){throw b(F.DATA_URL,"Malformed data URL.")}return U(t)}(t.rest)}(t),function(e){let t=new q(e);return t.contentType}(t))}throw p()}function U(e){let t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if((64512&r)==55296){let i=n<e.length-1&&(64512&e.charCodeAt(n+1))==56320;if(i){let i=r,s=e.charCodeAt(++n);r=65536|(1023&i)<<10|1023&s,t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else(64512&r)==56320?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function V(e,t){let n;switch(e){case F.BASE64:{let n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r)throw b(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?");break}case F.BASE64URL:{let n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r)throw b(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?");t=t.replace(/-/g,"+").replace(/_/g,"/")}}try{n=/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){if("undefined"==typeof atob)throw new d(s.UNSUPPORTED_ENVIRONMENT,"base-64 is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.");return atob(e)}(t)}catch(t){if(t.message.includes("polyfill"))throw t;throw b(e,"Invalid character found")}let r=new Uint8Array(n.length);for(let e=0;e<n.length;e++)r[e]=n.charCodeAt(e);return r}class q{constructor(e){this.base64=!1,this.contentType=null;let t=e.match(/^data:([^,]+)?,/);if(null===t)throw b(F.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");let n=t[1]||null;null!=n&&(this.base64=function(e,t){let n=e.length>=t.length;return!!n&&e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j{constructor(e,t){let n=0,r="";S(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(S(this.data_)){let n=this.data_,r=n.webkitSlice?n.webkitSlice(e,t):n.mozSlice?n.mozSlice(e,t):n.slice?n.slice(e,t):null;return null===r?null:new j(r)}{let n=new Uint8Array(this.data_.buffer,e,t-e);return new j(n,!0)}}static getBlob(...e){if(k()){let t=e.map(e=>e instanceof j?e.data_:e);return new j(O.apply(null,t))}{let t=e.map(e=>C(e)?M(F.RAW,e).data:e.data_),n=0;t.forEach(e=>{n+=e.byteLength});let r=new Uint8Array(n),i=0;return t.forEach(e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]}),new j(r,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B(e){var t;let n;try{n=JSON.parse(e)}catch(e){return null}return"object"!=typeof(t=n)||Array.isArray(t)?null:n}function z(e){let t=e.lastIndexOf("/",e.length-2);return -1===t?e:e.slice(t+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $(e,t){return t}class H{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||$}}let W=null;function G(){if(W)return W;let e=[];e.push(new H("bucket")),e.push(new H("generation")),e.push(new H("metageneration")),e.push(new H("name","fullPath",!0));let t=new H("name");t.xform=function(e,t){return!C(t)||t.length<2?t:z(t)},e.push(t);let n=new H("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new H("timeCreated")),e.push(new H("updated")),e.push(new H("md5Hash",null,!0)),e.push(new H("cacheControl",null,!0)),e.push(new H("contentDisposition",null,!0)),e.push(new H("contentEncoding",null,!0)),e.push(new H("contentLanguage",null,!0)),e.push(new H("contentType",null,!0)),e.push(new H("metadata","customMetadata",!0)),W=e}function K(e,t,n){let r=B(t);return null===r?null:function(e,t,n){let r={};r.type="file";let i=n.length;for(let e=0;e<i;e++){let i=n[e];r[i.local]=i.xform(r,t[i.server])}return Object.defineProperty(r,"ref",{get:function(){let t=r.bucket,n=r.fullPath,i=new T(t,n);return e._makeStorageReference(i)}}),r}(e,r,n)}function Z(e,t){let n={},r=t.length;for(let i=0;i<r;i++){let r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Q="prefixes",Y="items";class X{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function J(e){if(!e)throw p()}function ee(e,t){return function(n,r){let i=K(e,r,t);return J(null!==i),i}}function et(e){return function(t,n){var r,i;let o;return 401===t.getStatus()?o=t.getErrorText().includes("Firebase App Check token is invalid")?new d(s.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new d(s.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(r=e.bucket,o=new d(s.QUOTA_EXCEEDED,"Quota for bucket '"+r+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,o=new d(s.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):o=n,o.status=t.getStatus(),o.serverResponse=n.serverResponse,o}}function en(e){let t=et(e);return function(n,r){let i=t(n,r);if(404===n.getStatus()){var o;o=e.path,i=new d(s.OBJECT_NOT_FOUND,"Object '"+o+"' does not exist.")}return i.serverResponse=r.serverResponse,i}}function er(e,t,n){let r=t.fullServerUrl(),i=A(r,e.host,e._protocol),s=e.maxOperationRetryTime,o=new X(i,"GET",ee(e,n),s);return o.errorHandler=en(t),o}function ei(e,t,n){let r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),!r.contentType&&(r.contentType=t&&t.type()||"application/octet-stream"),r}class es{constructor(e,t,n,r){this.current=e,this.total=t,this.finalized=!!n,this.metadata=r||null}}function eo(e,t){let n=null;try{n=e.getResponseHeader("X-Goog-Upload-Status")}catch(e){J(!1)}return J(!!n&&-1!==(t||["active"]).indexOf(n)),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ea={STATE_CHANGED:"state_changed"},el={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function eu(e){switch(e){case"running":case"pausing":case"canceling":return el.RUNNING;case"paused":return el.PAUSED;case"success":return el.SUCCESS;case"canceled":return el.CANCELED;default:return el.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(e,t,n){"function"==typeof e||null!=t||null!=n?(this.next=e,this.error=null!=t?t:void 0,this.complete=null!=n?n:void 0):(this.next=e.next,this.error=e.error,this.complete=e.complete)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eh(e){return(...t)=>{Promise.resolve().then(()=>e(...t))}}class ed{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=o.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=o.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=o.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,t,n,r){if(this.sent_)throw I("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(let e in r)r.hasOwnProperty(e)&&this.xhr_.setRequestHeader(e,r[e].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw I("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw I("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return -1}}getResponse(){if(!this.sent_)throw I("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw I("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class ef extends ed{initXhr(){this.xhr_.responseType="text"}}function ep(){return new ef}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eg{constructor(e,t,n=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=t,this._metadata=n,this._mappings=G(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=e=>{if(this._request=void 0,this._chunkMultiplier=1,e._codeEquals(s.CANCELED))this._needToFetchStatus=!0,this.completeTransitions_();else{let t=this.isExponentialBackoffExpired();if(N(e.status,[])){if(t)e=g();else{this.sleepTime=Math.max(2*this.sleepTime,1e3),this._needToFetchStatus=!0,this.completeTransitions_();return}}this._error=e,this._transition("error")}},this._metadataErrorHandler=e=>{this._request=void 0,e._codeEquals(s.CANCELED)?this.completeTransitions_():(this._error=e,this._transition("error"))},this.sleepTime=0,this.maxSleepTime=this._ref.storage.maxUploadRetryTime,this._promise=new Promise((e,t)=>{this._resolve=e,this._reject=t,this._start()}),this._promise.then(null,()=>{})}isExponentialBackoffExpired(){return this.sleepTime>this.maxSleepTime}_makeProgressCallback(){let e=this._transferred;return t=>this._updateProgress(e+t)}_shouldDoResumable(e){return e.size()>262144}_start(){"running"===this._state&&void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this.pendingTimeout=setTimeout(()=>{this.pendingTimeout=void 0,this._continueUpload()},this.sleepTime):this._oneShotUpload())}_resolveToken(e){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([t,n])=>{switch(this._state){case"running":e(t,n);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused")}})}_createResumable(){this._resolveToken((e,t)=>{let n=function(e,t,n,r,i){let s=t.bucketOnlyServerUrl(),o=ei(t,r,i),a={name:o.fullPath},l=A(s,e.host,e._protocol),u={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${r.size()}`,"X-Goog-Upload-Header-Content-Type":o.contentType,"Content-Type":"application/json; charset=utf-8"},c=Z(o,n),h=e.maxUploadRetryTime,d=new X(l,"POST",function(e){let t;eo(e);try{t=e.getResponseHeader("X-Goog-Upload-URL")}catch(e){J(!1)}return J(C(t)),t},h);return d.urlParams=a,d.headers=u,d.body=c,d.errorHandler=et(t),d}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,ep,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._uploadUrl=e,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){let e=this._uploadUrl;this._resolveToken((t,n)=>{let r=function(e,t,n,r){let i=e.maxUploadRetryTime,s=new X(n,"POST",function(e){let t=eo(e,["active","final"]),n=null;try{n=e.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){J(!1)}n||J(!1);let i=Number(n);return J(!isNaN(i)),new es(i,r.size(),"final"===t)},i);return s.headers={"X-Goog-Upload-Command":"query"},s.errorHandler=et(t),s}(this._ref.storage,this._ref._location,e,this._blob),i=this._ref.storage._makeRequest(r,ep,t,n);this._request=i,i.getPromise().then(e=>{this._request=void 0,this._updateProgress(e.current),this._needToFetchStatus=!1,e.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){let e=262144*this._chunkMultiplier,t=new es(this._transferred,this._blob.size()),n=this._uploadUrl;this._resolveToken((r,i)=>{let o;try{o=function(e,t,n,r,i,o,a,l){let u=new es(0,0);if(a?(u.current=a.current,u.total=a.total):(u.current=0,u.total=r.size()),r.size()!==u.total)throw new d(s.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.");let c=u.total-u.current,h=c;i>0&&(h=Math.min(h,i));let f=u.current,p=f+h,g="";g=0===h?"finalize":c===h?"upload, finalize":"upload";let m={"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":`${u.current}`},v=r.slice(f,p);if(null===v)throw y();let _=t.maxUploadRetryTime,w=new X(n,"POST",function(e,n){let i;let s=eo(e,["active","final"]),a=u.current+h,l=r.size();return i="final"===s?ee(t,o)(e,n):null,new es(a,l,"final"===s,i)},_);return w.headers=m,w.body=v.uploadData(),w.progressCallback=l||null,w.errorHandler=et(e),w}(this._ref._location,this._ref.storage,n,this._blob,e,this._mappings,t,this._makeProgressCallback())}catch(e){this._error=e,this._transition("error");return}let a=this._ref.storage._makeRequest(o,ep,r,i,!1);this._request=a,a.getPromise().then(e=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(e.current),e.finalized?(this._metadata=e.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){let e=262144*this._chunkMultiplier;2*e<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((e,t)=>{let n=er(this._ref.storage,this._ref._location,this._mappings),r=this._ref.storage._makeRequest(n,ep,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((e,t)=>{let n=function(e,t,n,r,i){let s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"},a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;let l=ei(t,r,i),u=Z(l,n),c="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+u+"\r\n--"+a+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",h=j.getBlob(c,r,"\r\n--"+a+"--");if(null===h)throw y();let d={name:l.fullPath},f=A(s,e.host,e._protocol),p=e.maxUploadRetryTime,g=new X(f,"POST",ee(e,n),p);return g.urlParams=d,g.headers=o,g.body=h.uploadData(),g.errorHandler=et(t),g}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),r=this._ref.storage._makeRequest(n,ep,e,t);this._request=r,r.getPromise().then(e=>{this._request=void 0,this._metadata=e,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(e){let t=this._transferred;this._transferred=e,this._transferred!==t&&this._notifyObservers()}_transition(e){if(this._state!==e)switch(e){case"canceling":case"pausing":this._state=e,void 0!==this._request?this._request.cancel():this.pendingTimeout&&(clearTimeout(this.pendingTimeout),this.pendingTimeout=void 0,this.completeTransitions_());break;case"running":let t="paused"===this._state;this._state=e,t&&(this._notifyObservers(),this._start());break;case"paused":case"error":case"success":this._state=e,this._notifyObservers();break;case"canceled":this._error=m(),this._state=e,this._notifyObservers()}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start()}}get snapshot(){let e=eu(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}}on(e,t,n,r){let i=new ec(t||void 0,n||void 0,r||void 0);return this._addObserver(i),()=>{this._removeObserver(i)}}then(e,t){return this._promise.then(e,t)}catch(e){return this.then(null,e)}_addObserver(e){this._observers.push(e),this._notifyObserver(e)}_removeObserver(e){let t=this._observers.indexOf(e);-1!==t&&this._observers.splice(t,1)}_notifyObservers(){this._finishPromise();let e=this._observers.slice();e.forEach(e=>{this._notifyObserver(e)})}_finishPromise(){if(void 0!==this._resolve){let e=!0;switch(eu(this._state)){case el.SUCCESS:eh(this._resolve.bind(null,this.snapshot))();break;case el.CANCELED:case el.ERROR:let t=this._reject;eh(t.bind(null,this._error))();break;default:e=!1}e&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(e){let t=eu(this._state);switch(t){case el.RUNNING:case el.PAUSED:e.next&&eh(e.next.bind(e,this.snapshot))();break;case el.SUCCESS:e.complete&&eh(e.complete.bind(e))();break;case el.CANCELED:case el.ERROR:default:e.error&&eh(e.error.bind(e,this._error))()}}resume(){let e="paused"===this._state||"pausing"===this._state;return e&&this._transition("running"),e}pause(){let e="running"===this._state;return e&&this._transition("pausing"),e}cancel(){let e="running"===this._state||"pausing"===this._state;return e&&this._transition("canceling"),e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e,t){this._service=e,t instanceof T?this._location=t:this._location=T.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new em(e,t)}get root(){let e=new T(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return z(this._location.path)}get storage(){return this._service}get parent(){let e=/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){if(0===e.length)return null;let t=e.lastIndexOf("/");if(-1===t)return"";let n=e.slice(0,t);return n}(this._location.path);if(null===e)return null;let t=new T(this._location.bucket,e);return new em(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw w(e)}}async function ey(e,t,n){let r=await ev(e,{pageToken:n});t.prefixes.push(...r.prefixes),t.items.push(...r.items),null!=r.nextPageToken&&await ey(e,t,r.nextPageToken)}function ev(e,t){null!=t&&"number"==typeof t.maxResults&&x("options.maxResults",1,1e3,t.maxResults);let n=t||{},r=function(e,t,n,r,i){var s;let o={};t.isRoot?o.prefix="":o.prefix=t.path+"/",n&&n.length>0&&(o.delimiter=n),r&&(o.pageToken=r),i&&(o.maxResults=i);let a=t.bucketOnlyServerUrl(),l=A(a,e.host,e._protocol),u=e.maxOperationRetryTime,c=new X(l,"GET",(s=t.bucket,function(t,n){let r=function(e,t,n){let r=B(n);return null===r?null:function(e,t,n){let r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[Q])for(let i of n[Q]){let n=i.replace(/\/$/,""),s=e._makeStorageReference(new T(t,n));r.prefixes.push(s)}if(n[Y])for(let i of n[Y]){let n=e._makeStorageReference(new T(t,i.name));r.items.push(n)}return r}(e,t,r)}(e,s,n);return J(null!==r),r}),u);return c.urlParams=o,c.errorHandler=et(t),c}(e.storage,e._location,"/",n.pageToken,n.maxResults);return e.storage.makeRequestWithTokens(r,ep)}function e_(e,t){let n=function(e,t){let n=t.split("/").filter(e=>e.length>0).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new T(e._location.bucket,n);return new em(e.storage,r)}function ew(e,t){let n=null==t?void 0:t[h];return null==n?null:T.makeFromBucketSpec(n,e)}class eb{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=c,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,null!=r?this._bucket=T.makeFromBucketSpec(r,this._host):this._bucket=ew(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=T.makeFromBucketSpec(this._url,e):this._bucket=ew(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){x("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){x("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;let e=this._authProvider.getImmediate({optional:!0});if(e){let t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){let e=this._appCheckProvider.getImmediate({optional:!0});if(e){let t=await e.getToken();return t.token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new em(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new E(_());{let s=function(e,t,n,r,i,s,o=!0){var a,l,u;let c=R(e.urlParams),h=e.url+c,d=Object.assign({},e.headers);return a=d,t&&(a["X-Firebase-GMPID"]=t),l=d,null!==n&&n.length>0&&(l.Authorization="Firebase "+n),d["X-Firebase-Storage-Version"]="webjs/"+(null!=s?s:"AppManager"),u=d,null!==r&&(u["X-Firebase-AppCheck"]=r),new P(h,e.method,d,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(s),s.getPromise().then(()=>this._requests.delete(s),()=>this._requests.delete(s)),s}}async makeRequestWithTokens(e,t){let[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}let eI="@firebase/storage",eT="0.11.2",eE="storage";function eC(e,t,n){var r;return(r=e=(0,l.m9)(e))._throwIfRoot("uploadBytesResumable"),new eg(r,new j(t),n)}function eS(e){return function(e){e._throwIfRoot("getMetadata");let t=er(e.storage,e._location,G());return e.storage.makeRequestWithTokens(t,ep)}(e=(0,l.m9)(e))}function ek(e,t){return function(e,t){e._throwIfRoot("updateMetadata");let n=function(e,t,n,r){let i=t.fullServerUrl(),s=A(i,e.host,e._protocol),o=Z(n,r),a=e.maxOperationRetryTime,l=new X(s,"PATCH",ee(e,r),a);return l.headers={"Content-Type":"application/json; charset=utf-8"},l.body=o,l.errorHandler=en(t),l}(e.storage,e._location,t,G());return e.storage.makeRequestWithTokens(n,ep)}(e=(0,l.m9)(e),t)}function ex(e,t){return ev(e=(0,l.m9)(e),t)}function eA(e){return function(e){let t={prefixes:[],items:[]};return ey(e,t).then(()=>t)}(e=(0,l.m9)(e))}function eR(e){return function(e){e._throwIfRoot("getDownloadURL");let t=function(e,t,n){let r=t.fullServerUrl(),i=A(r,e.host,e._protocol),s=e.maxOperationRetryTime,o=new X(i,"GET",function(t,r){let i=K(e,r,n);return J(null!==i),function(e,t,n,r){let i=B(t);if(null===i||!C(i.downloadTokens))return null;let s=i.downloadTokens;if(0===s.length)return null;let o=encodeURIComponent,a=s.split(","),l=a.map(t=>{let i=e.bucket,s=e.fullPath,a="/b/"+o(i)+"/o/"+o(s),l=A(a,n,r),u=R({alt:"media",token:t});return l+u});return l[0]}(i,r,e.host,e._protocol)},s);return o.errorHandler=en(t),o}(e.storage,e._location,G());return e.storage.makeRequestWithTokens(t,ep).then(e=>{if(null===e)throw new d(s.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e})}(e=(0,l.m9)(e))}function eN(e){return function(e){e._throwIfRoot("deleteObject");let t=function(e,t){let n=t.fullServerUrl(),r=A(n,e.host,e._protocol),i=e.maxOperationRetryTime,s=new X(r,"DELETE",function(e,t){},i);return s.successCodes=[200,204],s.errorHandler=en(t),s}(e.storage,e._location);return e.storage.makeRequestWithTokens(t,ep)}(e=(0,l.m9)(e))}function eP(e,t){return function(e,t){if(!(t&&/^[A-Za-z]+:\/\//.test(t)))return function e(t,n){if(t instanceof eb){if(null==t._bucket)throw new d(s.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+h+"' property when initializing the app?");let r=new em(t,t._bucket);return null!=n?e(r,n):r}return void 0!==n?e_(t,n):t}(e,t);if(e instanceof eb)return new em(e,t);throw v("To use ref(service, url), the first argument must be a Storage instance.")}(e=(0,l.m9)(e),t)}function eD(e,t){return e_(e,t)}function eO(e=(0,a.getApp)(),t){e=(0,l.m9)(e);let n=(0,a._getProvider)(e,eE),r=n.getImmediate({identifier:t}),i=(0,l.P0)("storage");return i&&eF(r,...i),r}function eF(e,t,n,r={}){!function(e,t,n,r={}){e.host=`${t}:${n}`,e._protocol="http";let{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"==typeof i?i:(0,l.Sg)(i,e.app.options.projectId))}(e,t,n,r)}(0,a._registerComponent)(new u.wA(eE,function(e,{instanceIdentifier:t}){let n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return new eb(n,r,i,t,a.SDK_VERSION)},"PUBLIC").setMultipleInstances(!0)),(0,a.registerVersion)(eI,eT,""),(0,a.registerVersion)(eI,eT,"esm2017")},4444:function(e,t,n){"use strict";n.d(t,{BH:function(){return E},DV:function(){return W},Dv:function(){return er},G6:function(){return O},GJ:function(){return $},L:function(){return d},LL:function(){return U},P0:function(){return b},Pz:function(){return T},Sg:function(){return C},UG:function(){return x},UI:function(){return K},US:function(){return u},Wj:function(){return es},Wl:function(){return j},Yr:function(){return D},ZB:function(){return g},ZR:function(){return M},aH:function(){return I},b$:function(){return N},cI:function(){return q},dS:function(){return ea},eu:function(){return L},g5:function(){return o},gK:function(){return ei},gQ:function(){return J},h$:function(){return h},hl:function(){return F},hu:function(){return s},jU:function(){return A},lb:function(){return eo},m9:function(){return eu},ne:function(){return ee},p$:function(){return p},pd:function(){return X},q4:function(){return w},r3:function(){return H},ru:function(){return R},tV:function(){return f},uI:function(){return k},ug:function(){return el},vZ:function(){return function e(t,n){if(t===n)return!0;let r=Object.keys(t),i=Object.keys(n);for(let s of r){if(!i.includes(s))return!1;let r=t[s],o=n[s];if(Z(r)&&Z(o)){if(!e(r,o))return!1}else if(r!==o)return!1}for(let e of i)if(!r.includes(e))return!1;return!0}},w1:function(){return P},w9:function(){return z},xO:function(){return Q},xb:function(){return G},z$:function(){return S},zd:function(){return Y}});var r=n(3454);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let i={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},s=function(e,t){if(!e)throw o(t)},o=function(e){return Error("Firebase Database ("+i.SDK_VERSION+") INTERNAL ASSERT FAILED: "+e)},a=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):(64512&i)==55296&&r+1<e.length&&(64512&e.charCodeAt(r+1))==56320?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},l=function(e){let t=[],n=0,r=0;for(;n<e.length;){let i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){let s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){let s=e[n++],o=e[n++],a=e[n++],l=((7&i)<<18|(63&s)<<12|(63&o)<<6|63&a)-65536;t[r++]=String.fromCharCode(55296+(l>>10)),t[r++]=String.fromCharCode(56320+(1023&l))}else{let s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")},u={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let t=0;t<e.length;t+=3){let i=e[t],s=t+1<e.length,o=s?e[t+1]:0,a=t+2<e.length,l=a?e[t+2]:0,u=i>>2,c=(3&i)<<4|o>>4,h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[u],n[c],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(a(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):l(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let t=0;t<e.length;){let i=n[e.charAt(t++)],s=t<e.length,o=s?n[e.charAt(t)]:0;++t;let a=t<e.length,l=a?n[e.charAt(t)]:64;++t;let u=t<e.length,h=u?n[e.charAt(t)]:64;if(++t,null==i||null==o||null==l||null==h)throw new c;let d=i<<2|o>>4;if(r.push(d),64!==l){let e=o<<4&240|l>>2;if(r.push(e),64!==h){let e=l<<6&192|h;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class c extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let h=function(e){let t=a(e);return u.encodeByteArray(t,!0)},d=function(e){return h(e).replace(/\./g,"")},f=function(e){try{return u.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p(e){return g(void 0,e)}function g(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(let n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=g(e[n],t[n]));return e}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let m=()=>/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */(function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw Error("Unable to locate global object.")})().__FIREBASE_DEFAULTS__,y=()=>{if(void 0===r||void 0===r.env)return;let e=r.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},v=()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&f(e[1]);return t&&JSON.parse(t)},_=()=>{try{return m()||y()||v()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},w=e=>{var t,n;return null===(n=null===(t=_())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]},b=e=>{let t=w(e);if(!t)return;let n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},I=()=>{var e;return null===(e=_())||void 0===e?void 0:e.config},T=e=>{var t;return null===(t=_())||void 0===t?void 0:t[`_${e}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function C(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[d(JSON.stringify({alg:"none",type:"JWT"})),d(JSON.stringify(s)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function S(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function k(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(S())}function x(){var e;let t=null===(e=_())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(e){return!1}}function A(){return"object"==typeof self&&self.self===self}function R(){let e="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof e&&void 0!==e.id}function N(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function P(){let e=S();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function D(){return!0===i.NODE_CLIENT||!0===i.NODE_ADMIN}function O(){return!x()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function F(){try{return"object"==typeof indexedDB}catch(e){return!1}}function L(){return new Promise((e,t)=>{try{let n=!0,r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(e){t(e)}})}class M extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,M.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,U.prototype.create)}}class U{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){let n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?i.replace(V,(e,t)=>{let r=n[t];return null!=r?String(r):`<${t}?>`}):"Error",o=`${this.serviceName}: ${s} (${r}).`,a=new M(r,o,n);return a}}let V=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q(e){return JSON.parse(e)}function j(e){return JSON.stringify(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let B=function(e){let t={},n={},r={},i="";try{let s=e.split(".");t=q(f(s[0])||""),n=q(f(s[1])||""),i=s[2],r=n.d||{},delete n.d}catch(e){}return{header:t,claims:n,data:r,signature:i}},z=function(e){let t=B(e),n=t.claims;return!!n&&"object"==typeof n&&n.hasOwnProperty("iat")},$=function(e){let t=B(e).claims;return"object"==typeof t&&!0===t.admin};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function W(e,t){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0}function G(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function K(e,t,n){let r={};for(let i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=t.call(n,e[i],i,e));return r}function Z(e){return null!==e&&"object"==typeof e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q(e){let t=[];for(let[n,r]of Object.entries(e))Array.isArray(r)?r.forEach(e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))}):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function Y(e){let t={},n=e.replace(/^\?/,"").split("&");return n.forEach(e=>{if(e){let[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}}),t}function X(e){let t=e.indexOf("?");if(!t)return"";let n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J{constructor(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=64,this.pad_[0]=128;for(let e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}reset(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0}compress_(e,t){let n,r;t||(t=0);let i=this.W_;if("string"==typeof e)for(let n=0;n<16;n++)i[n]=e.charCodeAt(t)<<24|e.charCodeAt(t+1)<<16|e.charCodeAt(t+2)<<8|e.charCodeAt(t+3),t+=4;else for(let n=0;n<16;n++)i[n]=e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3],t+=4;for(let e=16;e<80;e++){let t=i[e-3]^i[e-8]^i[e-14]^i[e-16];i[e]=(t<<1|t>>>31)&4294967295}let s=this.chain_[0],o=this.chain_[1],a=this.chain_[2],l=this.chain_[3],u=this.chain_[4];for(let e=0;e<80;e++){e<40?e<20?(n=l^o&(a^l),r=1518500249):(n=o^a^l,r=1859775393):e<60?(n=o&a|l&(o|a),r=2400959708):(n=o^a^l,r=3395469782);let t=(s<<5|s>>>27)+n+u+r+i[e]&4294967295;u=l,l=a,a=(o<<30|o>>>2)&4294967295,o=s,s=t}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+o&4294967295,this.chain_[2]=this.chain_[2]+a&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+u&4294967295}update(e,t){if(null==e)return;void 0===t&&(t=e.length);let n=t-this.blockSize,r=0,i=this.buf_,s=this.inbuf_;for(;r<t;){if(0===s)for(;r<=n;)this.compress_(e,r),r+=this.blockSize;if("string"==typeof e){for(;r<t;)if(i[s]=e.charCodeAt(r),++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}else for(;r<t;)if(i[s]=e[r],++s,++r,s===this.blockSize){this.compress_(i),s=0;break}}this.inbuf_=s,this.total_+=t}digest(){let e=[],t=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(let e=this.blockSize-1;e>=56;e--)this.buf_[e]=255&t,t/=256;this.compress_(this.buf_);let n=0;for(let t=0;t<5;t++)for(let r=24;r>=0;r-=8)e[n]=this.chain_[t]>>r&255,++n;return e}}function ee(e,t){let n=new et(e,t);return n.subscribe.bind(n)}class et{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(e=>{this.error(e)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw Error("Missing Observer.");void 0===(r=!function(e,t){if("object"!=typeof e||null===e)return!1;for(let n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])?{next:e,error:t,complete:n}:e).next&&(r.next=en),void 0===r.error&&(r.error=en),void 0===r.complete&&(r.complete=en);let i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}}),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(e){"undefined"!=typeof console&&console.error&&console.error(e)}})}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function en(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let er=function(e,t,n,r){let i;if(r<t?i="at least "+t:r>n&&(i=0===n?"none":"no more than "+n),i){let t=e+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw Error(t)}};function ei(e,t){return`${e} failed: ${t} argument `}function es(e,t,n,r){if((!r||n)&&"function"!=typeof n)throw Error(ei(e,t)+"must be a valid function.")}function eo(e,t,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw Error(ei(e,t)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ea=function(e){let t=[],n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);if(i>=55296&&i<=56319){let t=i-55296;s(++r<e.length,"Surrogate pair missing trail surrogate.");let n=e.charCodeAt(r)-56320;i=65536+(t<<10)+n}i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):i<65536?(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},el=function(e){let t=0;for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);r<128?t++:r<2048?t+=2:r>=55296&&r<=56319?(t+=4,n++):t+=3}return t};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eu(e){return e&&e._delegate?e._delegate:e}},8866:function(e,t,n){"use strict";n.d(t,{n:function(){return s}});var r=n(7294);let i=r.createContext(!1),s=e=>{let{children:t,disabled:n}=e,s=r.useContext(i);return r.createElement(i.Provider,{value:null!=n?n:s},t)};t.Z=i},7647:function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var r=n(7294);let i=r.createContext(void 0),s=e=>{let{children:t,size:n}=e,s=r.useContext(i);return r.createElement(i.Provider,{value:n||s},t)};t.Z=i},3124:function(e,t,n){"use strict";n.d(t,{E_:function(){return o},oR:function(){return i}});var r=n(7294);let i="anticon",s=(e,t)=>t||(e?`ant-${e}`:"ant"),o=r.createContext({getPrefixCls:s,iconPrefixCls:i}),{Consumer:a}=o},3830:function(e,t,n){"use strict";let r,i;n.d(t,{ZP:function(){return L},w6:function(){return D}});var s=n(7431),o=n(3017),a=n(8335),l=n(3236),u=n(6982),c=n(7294),h=n(3008),d=n(6745);let f=e=>{let{locale:t={},children:n,_ANT_MARK__:r}=e;c.useEffect(()=>((0,h.f)(t&&t.Modal),()=>{(0,h.f)()}),[t]);let i=c.useMemo(()=>Object.assign(Object.assign({},t),{exist:!0}),[t]);return c.createElement(d.Z.Provider,{value:i},n)};var p=n(8526),g=n(8012),m=n(2790),y=n(3124),v=n(6397),_=n(274),w=n(8924),b=n(4958);let I=`-ant-${Date.now()}-${Math.random()}`;var T=n(8866),E=n(7647),C=n(1881),S=n(4747);let k=(e,t)=>{let[n,r]=(0,g.dQ)();return(0,s.xy)({theme:n,token:r,hashId:"",path:["ant-design-icons",e],nonce:()=>null==t?void 0:t.nonce},()=>[{[`.${e}`]:Object.assign(Object.assign({},(0,S.Ro)()),{[`.${e} .${e}-icon`]:{display:"block"}})}])};var x=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};let A=["getTargetContainer","getPopupContainer","renderEmpty","pageHeader","input","pagination","form","select"];function R(){return r||"ant"}function N(){return i||y.oR}let P=e=>{let{prefixCls:t,iconPrefixCls:n,theme:s}=e;void 0!==t&&(r=t),void 0!==n&&(i=n),s&&function(e,t){let n=function(e,t){let n={},r=(e,t)=>{let n=e.clone();return(n=(null==t?void 0:t(n))||n).toRgbString()},i=(e,t)=>{let i=new _.C(e),s=(0,v.R_)(i.toRgbString());n[`${t}-color`]=r(i),n[`${t}-color-disabled`]=s[1],n[`${t}-color-hover`]=s[4],n[`${t}-color-active`]=s[6],n[`${t}-color-outline`]=i.clone().setAlpha(.2).toRgbString(),n[`${t}-color-deprecated-bg`]=s[0],n[`${t}-color-deprecated-border`]=s[2]};if(t.primaryColor){i(t.primaryColor,"primary");let e=new _.C(t.primaryColor),s=(0,v.R_)(e.toRgbString());s.forEach((e,t)=>{n[`primary-${t+1}`]=e}),n["primary-color-deprecated-l-35"]=r(e,e=>e.lighten(35)),n["primary-color-deprecated-l-20"]=r(e,e=>e.lighten(20)),n["primary-color-deprecated-t-20"]=r(e,e=>e.tint(20)),n["primary-color-deprecated-t-50"]=r(e,e=>e.tint(50)),n["primary-color-deprecated-f-12"]=r(e,e=>e.setAlpha(.12*e.getAlpha()));let o=new _.C(s[0]);n["primary-color-active-deprecated-f-30"]=r(o,e=>e.setAlpha(.3*e.getAlpha())),n["primary-color-active-deprecated-d-02"]=r(o,e=>e.darken(2))}t.successColor&&i(t.successColor,"success"),t.warningColor&&i(t.warningColor,"warning"),t.errorColor&&i(t.errorColor,"error"),t.infoColor&&i(t.infoColor,"info");let s=Object.keys(n).map(t=>`--${e}-${t}: ${n[t]};`);return`
  :root {
    ${s.join("\n")}
  }
  `.trim()}(e,t);(0,w.Z)()&&(0,b.hq)(n,`${I}-dynamic-theme`)}(R(),s)},D=()=>({getPrefixCls:(e,t)=>t||(e?`${R()}-${e}`:R()),getIconPrefixCls:N,getRootPrefixCls:()=>r||R()}),O=e=>{let{children:t,csp:n,autoInsertSpaceInButton:r,form:i,locale:h,componentSize:d,direction:v,space:_,virtual:w,dropdownMatchSelectWidth:b,legacyLocale:I,parentContext:S,iconPrefixCls:R,theme:N,componentDisabled:P}=e,D=c.useCallback((t,n)=>{let{prefixCls:r}=e;if(n)return n;let i=r||S.getPrefixCls("");return t?`${i}-${t}`:i},[S.getPrefixCls,e.prefixCls]),O=R||S.iconPrefixCls||y.oR,F=O!==S.iconPrefixCls,L=n||S.csp,M=k(O,L),U=function(e,t){let n=e||{},r=!1!==n.inherit&&t?t:g.u_,i=(0,u.Z)(()=>{if(!e)return t;let i=Object.assign({},r.components);return Object.keys(e.components||{}).forEach(t=>{i[t]=Object.assign(Object.assign({},i[t]),e.components[t])}),Object.assign(Object.assign(Object.assign({},r),n),{token:Object.assign(Object.assign({},r.token),n.token),components:i})},[n,r],(e,t)=>e.some((e,n)=>{let r=t[n];return!(0,C.Z)(e,r,!0)}));return i}(N,S.theme),V={csp:L,autoInsertSpaceInButton:r,locale:h||I,direction:v,space:_,virtual:w,dropdownMatchSelectWidth:b,getPrefixCls:D,iconPrefixCls:O,theme:U},q=Object.assign({},S);Object.keys(V).forEach(e=>{void 0!==V[e]&&(q[e]=V[e])}),A.forEach(t=>{let n=e[t];n&&(q[t]=n)});let j=(0,u.Z)(()=>q,q,(e,t)=>{let n=Object.keys(e),r=Object.keys(t);return n.length!==r.length||n.some(n=>e[n]!==t[n])}),B=c.useMemo(()=>({prefixCls:O,csp:L}),[O,L]),z=F?M(t):t,$=c.useMemo(()=>{var e,t,n;return(0,l.gg)({},(null===(e=p.Z.Form)||void 0===e?void 0:e.defaultValidateMessages)||{},(null===(n=null===(t=j.locale)||void 0===t?void 0:t.Form)||void 0===n?void 0:n.defaultValidateMessages)||{},(null==i?void 0:i.validateMessages)||{})},[j,null==i?void 0:i.validateMessages]);Object.keys($).length>0&&(z=c.createElement(a.RV,{validateMessages:$},t)),h&&(z=c.createElement(f,{locale:h,_ANT_MARK__:"internalMark"},z)),(O||L)&&(z=c.createElement(o.Z.Provider,{value:B},z)),d&&(z=c.createElement(E.q,{size:d},z));let H=c.useMemo(()=>{let e=U||{},{algorithm:t,token:n}=e,r=x(e,["algorithm","token"]),i=t&&(!Array.isArray(t)||t.length>0)?(0,s.jG)(t):void 0;return Object.assign(Object.assign({},r),{theme:i,token:Object.assign(Object.assign({},m.Z),n)})},[U]);return N&&(z=c.createElement(g.Mj.Provider,{value:H},z)),void 0!==P&&(z=c.createElement(T.n,{disabled:P},z)),c.createElement(y.E_.Provider,{value:j},z)},F=e=>{let t=c.useContext(y.E_),n=c.useContext(d.Z);return c.createElement(O,Object.assign({parentContext:t,legacyLocale:n},e))};F.ConfigContext=y.E_,F.SizeContext=E.Z,F.config=P,F.useConfig=function(){let e=(0,c.useContext)(T.Z),t=(0,c.useContext)(E.Z);return{componentDisabled:e,componentSize:t}},Object.defineProperty(F,"SizeContext",{get:()=>E.Z});var L=F},6745:function(e,t,n){"use strict";var r=n(7294);let i=(0,r.createContext)(void 0);t.Z=i},8526:function(e,t,n){"use strict";n.d(t,{Z:function(){return l}});var r=n(2906),i={placeholder:"Select time",rangePlaceholder:["Start time","End time"]};let s={lang:Object.assign({placeholder:"Select date",yearPlaceholder:"Select year",quarterPlaceholder:"Select quarter",monthPlaceholder:"Select month",weekPlaceholder:"Select week",rangePlaceholder:["Start date","End date"],rangeYearPlaceholder:["Start year","End year"],rangeQuarterPlaceholder:["Start quarter","End quarter"],rangeMonthPlaceholder:["Start month","End month"],rangeWeekPlaceholder:["Start week","End week"]},{locale:"en_US",today:"Today",now:"Now",backToToday:"Back to today",ok:"OK",clear:"Clear",month:"Month",year:"Year",timeSelect:"select time",dateSelect:"select date",weekSelect:"Choose a week",monthSelect:"Choose a month",yearSelect:"Choose a year",decadeSelect:"Choose a decade",yearFormat:"YYYY",dateFormat:"M/D/YYYY",dayFormat:"D",dateTimeFormat:"M/D/YYYY HH:mm:ss",monthBeforeYear:!0,previousMonth:"Previous month (PageUp)",nextMonth:"Next month (PageDown)",previousYear:"Last year (Control + left)",nextYear:"Next year (Control + right)",previousDecade:"Last decade",nextDecade:"Next decade",previousCentury:"Last century",nextCentury:"Next century"}),timePickerLocale:Object.assign({},i)},o="${label} is not a valid ${type}",a={locale:"en",Pagination:r.Z,DatePicker:s,TimePicker:i,Calendar:s,global:{placeholder:"Please select"},Table:{filterTitle:"Filter menu",filterConfirm:"OK",filterReset:"Reset",filterEmptyText:"No filters",filterCheckall:"Select all items",filterSearchPlaceholder:"Search in filters",emptyText:"No data",selectAll:"Select current page",selectInvert:"Invert current page",selectNone:"Clear all data",selectionAll:"Select all data",sortTitle:"Sort",expand:"Expand row",collapse:"Collapse row",triggerDesc:"Click to sort descending",triggerAsc:"Click to sort ascending",cancelSort:"Click to cancel sorting"},Tour:{Next:"Next",Previous:"Previous",Finish:"Finish"},Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Popconfirm:{okText:"OK",cancelText:"Cancel"},Transfer:{titles:["",""],searchPlaceholder:"Search here",itemUnit:"item",itemsUnit:"items",remove:"Remove",selectCurrent:"Select current page",removeCurrent:"Remove current page",selectAll:"Select all data",removeAll:"Remove all data",selectInvert:"Invert current page"},Upload:{uploading:"Uploading...",removeFile:"Remove file",uploadError:"Upload error",previewFile:"Preview file",downloadFile:"Download file"},Empty:{description:"No data"},Icon:{icon:"icon"},Text:{edit:"Edit",copy:"Copy",copied:"Copied",expand:"Expand"},PageHeader:{back:"Back"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:o,method:o,array:o,object:o,number:o,date:o,boolean:o,integer:o,float:o,regexp:o,email:o,url:o,hex:o},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}},Image:{preview:"Preview"},QRCode:{expired:"QR code expired",refresh:"Refresh"}};var l=a},3008:function(e,t,n){"use strict";n.d(t,{A:function(){return o},f:function(){return s}});var r=n(8526);let i=Object.assign({},r.Z.Modal);function s(e){i=e?Object.assign(Object.assign({},i),e):Object.assign({},r.Z.Modal)}function o(){return i}},4747:function(e,t,n){"use strict";n.d(t,{Lx:function(){return a},Qy:function(){return c},Ro:function(){return s},Wf:function(){return i},dF:function(){return o},du:function(){return l},oN:function(){return u},vS:function(){return r}});let r={overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"},i=e=>({boxSizing:"border-box",margin:0,padding:0,color:e.colorText,fontSize:e.fontSize,lineHeight:e.lineHeight,listStyle:"none",fontFamily:e.fontFamily}),s=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),o=()=>({"&::before":{display:"table",content:'""'},"&::after":{display:"table",clear:"both",content:'""'}}),a=e=>({a:{color:e.colorLink,textDecoration:e.linkDecoration,backgroundColor:"transparent",outline:"none",cursor:"pointer",transition:`color ${e.motionDurationSlow}`,"-webkit-text-decoration-skip":"objects","&:hover":{color:e.colorLinkHover},"&:active":{color:e.colorLinkActive},[`&:active,
  &:hover`]:{textDecoration:e.linkHoverDecoration,outline:0},"&:focus":{textDecoration:e.linkFocusDecoration,outline:0},"&[disabled]":{color:e.colorTextDisabled,cursor:"not-allowed"}}}),l=(e,t)=>{let{fontFamily:n,fontSize:r}=e,i=`[class^="${t}"], [class*=" ${t}"]`;return{[i]:{fontFamily:n,fontSize:r,boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"},[i]:{boxSizing:"border-box","&::before, &::after":{boxSizing:"border-box"}}}}},u=e=>({outline:`${e.lineWidthFocus}px solid ${e.colorPrimaryBorder}`,outlineOffset:1,transition:"outline-offset 0s, outline 0s"}),c=e=>({"&:focus-visible":Object.assign({},u(e))})},8012:function(e,t,n){"use strict";n.d(t,{Mj:function(){return p},u_:function(){return f},dQ:function(){return g}});var r=n(7431),i=n(7294),s=n(7164),o=n(2790),a=n(274);function l(e){return e>=0&&e<=255}var u=function(e,t){let{r:n,g:r,b:i,a:s}=new a.C(e).toRgb();if(s<1)return e;let{r:o,g:u,b:c}=new a.C(t).toRgb();for(let e=.01;e<=1;e+=.01){let t=Math.round((n-o*(1-e))/e),s=Math.round((r-u*(1-e))/e),h=Math.round((i-c*(1-e))/e);if(l(t)&&l(s)&&l(h))return new a.C({r:t,g:s,b:h,a:Math.round(100*e)/100}).toRgbString()}return new a.C({r:n,g:r,b:i,a:1}).toRgbString()},c=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&0>t.indexOf(r)&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(e);i<r.length;i++)0>t.indexOf(r[i])&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]]);return n};function h(e){let{override:t}=e,n=c(e,["override"]),r=Object.assign({},t);Object.keys(o.Z).forEach(e=>{delete r[e]});let i=Object.assign(Object.assign({},n),r),s=Object.assign(Object.assign(Object.assign({},i),{colorLink:i.colorInfoText,colorLinkHover:i.colorInfoHover,colorLinkActive:i.colorInfoActive,colorFillContent:i.colorFillSecondary,colorFillContentHover:i.colorFill,colorFillAlter:i.colorFillQuaternary,colorBgContainerDisabled:i.colorFillTertiary,colorBorderBg:i.colorBgContainer,colorSplit:u(i.colorBorderSecondary,i.colorBgContainer),colorTextPlaceholder:i.colorTextQuaternary,colorTextDisabled:i.colorTextQuaternary,colorTextHeading:i.colorText,colorTextLabel:i.colorTextSecondary,colorTextDescription:i.colorTextTertiary,colorTextLightSolid:i.colorWhite,colorHighlight:i.colorError,colorBgTextHover:i.colorFillSecondary,colorBgTextActive:i.colorFill,colorIcon:i.colorTextTertiary,colorIconHover:i.colorText,colorErrorOutline:u(i.colorErrorBg,i.colorBgContainer),colorWarningOutline:u(i.colorWarningBg,i.colorBgContainer),fontSizeIcon:i.fontSizeSM,lineWidthFocus:4*i.lineWidth,lineWidth:i.lineWidth,controlOutlineWidth:2*i.lineWidth,controlInteractiveSize:i.controlHeight/2,controlItemBgHover:i.colorFillTertiary,controlItemBgActive:i.colorPrimaryBg,controlItemBgActiveHover:i.colorPrimaryBgHover,controlItemBgActiveDisabled:i.colorFill,controlTmpOutline:i.colorFillQuaternary,controlOutline:u(i.colorPrimaryBg,i.colorBgContainer),lineType:i.lineType,borderRadius:i.borderRadius,borderRadiusXS:i.borderRadiusXS,borderRadiusSM:i.borderRadiusSM,borderRadiusLG:i.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:i.sizeXXS,paddingXS:i.sizeXS,paddingSM:i.sizeSM,padding:i.size,paddingMD:i.sizeMD,paddingLG:i.sizeLG,paddingXL:i.sizeXL,paddingContentHorizontalLG:i.sizeLG,paddingContentVerticalLG:i.sizeMS,paddingContentHorizontal:i.sizeMS,paddingContentVertical:i.sizeSM,paddingContentHorizontalSM:i.size,paddingContentVerticalSM:i.sizeXS,marginXXS:i.sizeXXS,marginXS:i.sizeXS,marginSM:i.sizeSM,margin:i.size,marginMD:i.sizeMD,marginLG:i.sizeLG,marginXL:i.sizeXL,marginXXL:i.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:480,screenXSMin:480,screenXSMax:575,screenSM:576,screenSMMin:576,screenSMMax:767,screenMD:768,screenMDMin:768,screenMDMax:991,screenLG:992,screenLGMin:992,screenLGMax:1199,screenXL:1200,screenXLMin:1200,screenXLMax:1599,screenXXL:1600,screenXXLMin:1600,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new a.C("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new a.C("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new a.C("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),r);return s}let d=(0,r.jG)(s.Z),f={token:o.Z,hashed:!0},p=i.createContext(f);function g(){let{token:e,hashed:t,theme:n,components:s}=i.useContext(p),a=`5.4.6-${t||""}`,l=n||d,[u,c]=(0,r.fp)(l,[o.Z,e],{salt:a,override:Object.assign({override:e},s),formatToken:h});return[l,u,t?c:""]}},7164:function(e,t,n){"use strict";n.d(t,{Z:function(){return p}});var r=n(6397),i=n(372),s=n(2790),o=n(57);let a=e=>{let t=e,n=e,r=e,i=e;return e<6&&e>=5?t=e+1:e<16&&e>=6?t=e+2:e>=16&&(t=16),e<7&&e>=5?n=4:e<8&&e>=7?n=5:e<14&&e>=8?n=6:e<16&&e>=14?n=7:e>=16&&(n=8),e<6&&e>=2?r=1:e>=6&&(r=2),e>4&&e<8?i=4:e>=8&&(i=6),{borderRadius:e>16?16:e,borderRadiusXS:r,borderRadiusSM:n,borderRadiusLG:t,borderRadiusOuter:i}};var l=n(274);let u=(e,t)=>new l.C(e).setAlpha(t).toRgbString(),c=(e,t)=>{let n=new l.C(e);return n.darken(t).toHexString()},h=e=>{let t=(0,r.R_)(e);return{1:t[0],2:t[1],3:t[2],4:t[3],5:t[4],6:t[5],7:t[6],8:t[4],9:t[5],10:t[6]}},d=(e,t)=>{let n=e||"#fff",r=t||"#000";return{colorBgBase:n,colorTextBase:r,colorText:u(r,.88),colorTextSecondary:u(r,.65),colorTextTertiary:u(r,.45),colorTextQuaternary:u(r,.25),colorFill:u(r,.15),colorFillSecondary:u(r,.06),colorFillTertiary:u(r,.04),colorFillQuaternary:u(r,.02),colorBgLayout:c(n,4),colorBgContainer:c(n,0),colorBgElevated:c(n,0),colorBgSpotlight:u(r,.85),colorBorder:c(n,15),colorBorderSecondary:c(n,6)}};var f=n(8378);function p(e){let t=Object.keys(s.M).map(t=>{let n=(0,r.R_)(e[t]);return Array(10).fill(1).reduce((e,r,i)=>(e[`${t}-${i+1}`]=n[i],e[`${t}${i+1}`]=n[i],e),{})}).reduce((e,t)=>e=Object.assign(Object.assign({},e),t),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),t),(0,o.Z)(e,{generateColorPalettes:h,generateNeutralColorPalettes:d})),(0,f.Z)(e.fontSize)),function(e){let{sizeUnit:t,sizeStep:n}=e;return{sizeXXL:t*(n+8),sizeXL:t*(n+4),sizeLG:t*(n+2),sizeMD:t*(n+1),sizeMS:t*n,size:t*n,sizeSM:t*(n-1),sizeXS:t*(n-2),sizeXXS:t*(n-3)}}(e)),(0,i.Z)(e)),function(e){let{motionUnit:t,motionBase:n,borderRadius:r,lineWidth:i}=e;return Object.assign({motionDurationFast:`${(n+t).toFixed(1)}s`,motionDurationMid:`${(n+2*t).toFixed(1)}s`,motionDurationSlow:`${(n+3*t).toFixed(1)}s`,lineWidthBold:i+1},a(r))}(e))}},2790:function(e,t,n){"use strict";n.d(t,{M:function(){return r}});let r={blue:"#1677ff",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#eb2f96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},i=Object.assign(Object.assign({},r),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1});t.Z=i},57:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(274);function i(e,t){let{generateColorPalettes:n,generateNeutralColorPalettes:i}=t,{colorSuccess:s,colorWarning:o,colorError:a,colorInfo:l,colorPrimary:u,colorBgBase:c,colorTextBase:h}=e,d=n(u),f=n(s),p=n(o),g=n(a),m=n(l),y=i(c,h);return Object.assign(Object.assign({},y),{colorPrimaryBg:d[1],colorPrimaryBgHover:d[2],colorPrimaryBorder:d[3],colorPrimaryBorderHover:d[4],colorPrimaryHover:d[5],colorPrimary:d[6],colorPrimaryActive:d[7],colorPrimaryTextHover:d[8],colorPrimaryText:d[9],colorPrimaryTextActive:d[10],colorSuccessBg:f[1],colorSuccessBgHover:f[2],colorSuccessBorder:f[3],colorSuccessBorderHover:f[4],colorSuccessHover:f[4],colorSuccess:f[6],colorSuccessActive:f[7],colorSuccessTextHover:f[8],colorSuccessText:f[9],colorSuccessTextActive:f[10],colorErrorBg:g[1],colorErrorBgHover:g[2],colorErrorBorder:g[3],colorErrorBorderHover:g[4],colorErrorHover:g[5],colorError:g[6],colorErrorActive:g[7],colorErrorTextHover:g[8],colorErrorText:g[9],colorErrorTextActive:g[10],colorWarningBg:p[1],colorWarningBgHover:p[2],colorWarningBorder:p[3],colorWarningBorderHover:p[4],colorWarningHover:p[4],colorWarning:p[6],colorWarningActive:p[7],colorWarningTextHover:p[8],colorWarningText:p[9],colorWarningTextActive:p[10],colorInfoBg:m[1],colorInfoBgHover:m[2],colorInfoBorder:m[3],colorInfoBorderHover:m[4],colorInfoHover:m[4],colorInfo:m[6],colorInfoActive:m[7],colorInfoTextHover:m[8],colorInfoText:m[9],colorInfoTextActive:m[10],colorBgMask:new r.C("#000").setAlpha(.45).toRgbString(),colorWhite:"#fff"})}},372:function(e,t){"use strict";let n=e=>{let{controlHeight:t}=e;return{controlHeightSM:.75*t,controlHeightXS:.5*t,controlHeightLG:1.25*t}};t.Z=n},8378:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});let r=e=>{let t=function(e){let t=Array(10).fill(null).map((t,n)=>{let r=e*Math.pow(2.71828,(n-1)/5);return 2*Math.floor((n>1?Math.floor(r):Math.ceil(r))/2)});return t[1]=e,t.map(e=>({size:e,lineHeight:(e+8)/e}))}(e),n=t.map(e=>e.size),r=t.map(e=>e.lineHeight);return{fontSizeSM:n[0],fontSize:n[1],fontSizeLG:n[2],fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:r[1],lineHeightLG:r[2],lineHeightSM:r[0],lineHeightHeading1:r[6],lineHeightHeading2:r[5],lineHeightHeading3:r[4],lineHeightHeading4:r[3],lineHeightHeading5:r[2]}};var i=r},3454:function(e,t,n){"use strict";var r,i;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(i=n.g.process)?void 0:i.env)?n.g.process:n(7663)},1118:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(8375)}])},4076:function(e,t,n){"use strict";let r,i,s,o,a,l,u,c,h,d,f;n.d(t,{I8:function(){return vb},Fv:function(){return vE},Er:function(){return vC},ul:function(){return vT},tO:function(){return vI}});var p,g,m,y,v,_,w,b=n(4444),I=n(740),T=n(5816),E=n(3333);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C{constructor(e,t){this._delegate=e,this.firebase=t,(0,T._addComponent)(e,new I.wA("app-compat",()=>this,"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise(e=>{this._delegate.checkDestroyed(),e()}).then(()=>(this.firebase.INTERNAL.removeApp(this.name),(0,T.deleteApp)(this._delegate)))}_getService(e,t=T._DEFAULT_ENTRY_NAME){var n;this._delegate.checkDestroyed();let r=this._delegate.container.getProvider(e);return r.isInitialized()||(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)!=="EXPLICIT"||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e,t=T._DEFAULT_ENTRY_NAME){this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){(0,T._addComponent)(this._delegate,e)}_addOrOverwriteComponent(e){(0,T._addOrOverwriteComponent)(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}let S=new b.LL("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."}),k=/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e(){let t=/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){let t={},n={__esModule:!0,initializeApp:function(r,i={}){let s=T.initializeApp(r,i);if((0,b.r3)(t,s.name))return t[s.name];let o=new e(s,n);return t[s.name]=o,o},app:r,registerVersion:T.registerVersion,setLogLevel:T.setLogLevel,onLog:T.onLog,apps:null,SDK_VERSION:T.SDK_VERSION,INTERNAL:{registerComponent:function(t){let i=t.name,s=i.replace("-compat","");if(T._registerComponent(t)&&"PUBLIC"===t.type){let o=(e=r())=>{if("function"!=typeof e[s])throw S.create("invalid-app-argument",{appName:i});return e[s]()};void 0!==t.serviceProps&&(0,b.ZB)(o,t.serviceProps),n[s]=o,e.prototype[s]=function(...e){let n=this._getService.bind(this,i);return n.apply(this,t.multipleInstances?e:[])}}return"PUBLIC"===t.type?n[s]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:T}};function r(e){if(e=e||T._DEFAULT_ENTRY_NAME,!(0,b.r3)(t,e))throw S.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map(e=>t[e])}}),r.App=e,n}(C);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){(0,b.ZB)(t,e)},createSubscribe:b.ne,ErrorFactory:b.LL,deepExtend:b.ZB}),t}(),x=new E.Yd("@firebase/app-compat");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if((0,b.jU)()&&void 0!==self.firebase){x.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);let e=self.firebase.SDK_VERSION;e&&e.indexOf("LITE")>=0&&x.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}(0,T.registerVersion)("@firebase/app-compat","0.2.9",void 0),/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */k.registerVersion("firebase","9.21.0","app-compat");var A=n(1720);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R(){return window}async function N(e,t,n){var r;let{BuildInfo:i}=R();(0,A.as)(t.sessionId,"AuthEvent did not contain a session ID");let s=await O(t.sessionId),o={};return(0,A.at)()?o.ibi=i.packageName:(0,A.au)()?o.apn=i.packageName:(0,A.av)(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,(0,A.aw)(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}async function P(e){let{BuildInfo:t}=R(),n={};(0,A.at)()?n.iosBundleId=t.packageName:(0,A.au)()?n.androidPackageName=t.packageName:(0,A.av)(e,"operation-not-supported-in-this-environment"),await (0,A.ax)(e,n)}async function D(e,t,n){let{cordova:r}=R(),i=()=>{};try{await new Promise((s,o)=>{let a=null;function l(){var e;s();let t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"==typeof t&&t(),"function"==typeof(null==n?void 0:n.close)&&n.close()}function u(){a||(a=window.setTimeout(()=>{o((0,A.az)(e,"redirect-cancelled-by-user"))},2e3))}function c(){(null==document?void 0:document.visibilityState)==="visible"&&u()}t.addPassiveListener(l),document.addEventListener("resume",u,!1),(0,A.au)()&&document.addEventListener("visibilitychange",c,!1),i=()=>{t.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",c,!1),a&&window.clearTimeout(a)}})}finally{i()}}async function O(e){let t=function(e){if((0,A.as)(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!=typeof TextEncoder)return new TextEncoder().encode(e);let t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let t=0;t<e.length;t++)n[t]=e.charCodeAt(t);return n}(e),n=await crypto.subtle.digest("SHA-256",t),r=Array.from(new Uint8Array(n));return r.map(e=>e.toString(16).padStart(2,"0")).join("")}class F extends A.aB{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise(e=>{this.resolveInialized=e})}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInialized(),this.passiveListeners.forEach(t=>t(e)),super.onEvent(e)}async initialized(){await this.initPromise}}async function L(e){let t=await M()._get(U(e));return t&&await M()._remove(U(e)),t}function M(){return(0,A.aC)(A.b)}function U(e){return(0,A.aD)("authEvent",e.config.apiKey,e.name)}function V(e){if(!(null==e?void 0:e.includes("?")))return{};let[t,...n]=e.split("?");return(0,b.zd)(n.join("?"))}let q=class{constructor(){this._redirectPersistence=A.a,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=A.aE,this._overrideRedirectResult=A.aF}async _initialize(e){let t=e._key(),n=this.eventManagers.get(t);return n||(n=new F(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){(0,A.av)(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,l,u,c;let h=R();(0,A.aA)("function"==typeof(null===(t=null==h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),(0,A.aA)(void 0!==(null===(n=null==h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),(0,A.aA)("function"==typeof(null===(s=null===(i=null===(r=null==h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,A.aA)("function"==typeof(null===(l=null===(a=null===(o=null==h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===l?void 0:l.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),(0,A.aA)("function"==typeof(null===(c=null===(u=null==h?void 0:h.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===c?void 0:c.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);let i=await this._initialize(e);await i.initialized(),i.resetRedirect(),(0,A.aG)(),await this._originValidation(e);let s=function(e,t,n=null){return{type:t,eventId:n,urlResponse:null,sessionId:function(){let e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){let n=Math.floor(Math.random()*t.length);e.push(t.charAt(n))}return e.join("")}(),postBody:null,tenantId:e.tenantId,error:(0,A.az)(e,"no-auth-event")}}(e,n,r);await M()._set(U(e),s);let o=await N(e,s,t),a=await function(e){let{cordova:t}=R();return new Promise(n=>{t.plugins.browsertab.isAvailable(r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,(0,A.ay)()?"_blank":"_system","location=yes"),n(i)})})}(o);return D(e,i,a)}_isIframeWebStorageSupported(e,t){throw Error("Method not implemented.")}_originValidation(e){let t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=P(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){let{universalLinks:n,handleOpenURL:r,BuildInfo:i}=R(),s=setTimeout(async()=>{await L(e),t.onEvent(j())},500),o=async n=>{clearTimeout(s);let r=await L(e),i=null;r&&(null==n?void 0:n.url)&&(i=function(e,t){var n,r;let i=function(e){let t=V(e),n=t.link?decodeURIComponent(t.link):void 0,r=V(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0,s=V(i).link;return s||i||r||n||e}(t);if(i.includes("/__/auth/callback")){let t=V(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(e){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null==s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?(0,A.az)(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}(r,n.url)),t.onEvent(i||j())};void 0!==n&&"function"==typeof n.subscribe&&n.subscribe(null,o);let a=`${i.packageName.toLowerCase()}://`;R().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(a)&&o({url:e}),"function"==typeof r)try{r(e)}catch(e){console.error(e)}}}};function j(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:(0,A.az)("no-auth-event")}}function B(){var e;return(null===(e=null==self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function z(e=(0,b.z$)()){return!!(("file:"===B()||"ionic:"===B()||"capacitor:"===B())&&e.toLowerCase().match(/iphone|ipad|ipod|android/))}function $(){try{let e=self.localStorage,t=A.aL();if(e){if(e.setItem(t,"1"),e.removeItem(t),function(e=(0,b.z$)()){return(0,b.w1)()&&(null==document?void 0:document.documentMode)===11||function(e=(0,b.z$)()){return/Edge\/\d+/.test(e)}(e)}())return(0,b.hl)();return!0}}catch(e){return H()&&(0,b.hl)()}return!1}function H(){return void 0!==n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function W(){return("http:"===B()||"https:"===B()||(0,b.ru)()||z())&&!((0,b.b$)()||(0,b.UG)())&&$()&&!H()}function G(){return z()&&"undefined"!=typeof document}async function K(){return!!G()&&new Promise(e=>{let t=setTimeout(()=>{e(!1)},1e3);document.addEventListener("deviceready",()=>{clearTimeout(t),e(!0)})})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z={LOCAL:"local",NONE:"none",SESSION:"session"},Q=A.aA,Y="persistence";async function X(e){await e._initializationPromise;let t=J(),n=A.aD(Y,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistence())}function J(){var e;try{return(null===(e="undefined"!=typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(e){return null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ee=A.aA;class et{constructor(){this.browserResolver=A.aC(A.k),this.cordovaResolver=A.aC(q),this.underlyingResolver=null,this._redirectPersistence=A.a,this._completeRedirectFn=A.aE,this._overrideRedirectResult=A.aF}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return G()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return ee(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;let e=await K();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function en(e){let t;let{_tokenResponse:n}=e instanceof b.ZR?e.customData:e;if(!n)return null;if(!(e instanceof b.ZR)&&"temporaryProof"in n&&"phoneNumber"in n)return A.P.credentialFromResult(e);let r=n.providerId;if(!r||r===A.p.PASSWORD)return null;switch(r){case A.p.GOOGLE:t=A.V;break;case A.p.FACEBOOK:t=A.U;break;case A.p.GITHUB:t=A.W;break;case A.p.TWITTER:t=A.Z;break;default:let{oauthIdToken:i,oauthAccessToken:s,oauthTokenSecret:o,pendingToken:a,nonce:l}=n;if(!s&&!o&&!i&&!a)return null;if(a){if(r.startsWith("saml."))return A.aO._create(r,a);return A.L._fromParams({providerId:r,signInMethod:r,pendingToken:a,idToken:i,accessToken:s})}return new A.X(r).credential({idToken:i,accessToken:s,rawNonce:l})}return e instanceof b.ZR?t.credentialFromError(e):t.credentialFromResult(e)}function er(e,t){return t.catch(t=>{throw t instanceof b.ZR&&function(e,t){var n;let r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if((null==t?void 0:t.code)==="auth/multi-factor-auth-required"){let n=t;n.resolver=new es(e,A.aq(e,t))}else if(r){let e=en(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}(e,t),t}).then(e=>{let t=e.operationType,n=e.user;return{operationType:t,credential:en(e),additionalUserInfo:A.ao(e),user:eo.getOrCreate(n)}})}async function ei(e,t){let n=await t;return{verificationId:n.verificationId,confirm:t=>er(e,n.confirm(t))}}class es{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return er(this.auth.unwrap(),this.resolver.resolveSignIn(e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eo{constructor(e){this._delegate=e,this.multiFactor=A.ar(e)}static getOrCreate(e){return eo.USER_MAP.has(e)||eo.USER_MAP.set(e,new eo(e)),eo.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return er(this.auth,A.a0(this._delegate,e))}async linkWithPhoneNumber(e,t){return ei(this.auth,A.l(this._delegate,e,t))}async linkWithPopup(e){return er(this.auth,A.d(this._delegate,e,et))}async linkWithRedirect(e){return await X(A.aH(this.auth)),A.g(this._delegate,e,et)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return er(this.auth,A.a1(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return ei(this.auth,A.r(this._delegate,e,t))}reauthenticateWithPopup(e){return er(this.auth,A.e(this._delegate,e,et))}async reauthenticateWithRedirect(e){return await X(A.aH(this.auth)),A.h(this._delegate,e,et)}sendEmailVerification(e){return A.ae(this._delegate,e)}async unlink(e){return await A.an(this._delegate,e),this}updateEmail(e){return A.aj(this._delegate,e)}updatePassword(e){return A.ak(this._delegate,e)}updatePhoneNumber(e){return A.u(this._delegate,e)}updateProfile(e){return A.ai(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return A.af(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}eo.USER_MAP=new WeakMap;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ea=A.aA;class el{constructor(e,t){if(this.app=e,t.isInitialized()){this._delegate=t.getImmediate(),this.linkUnderlyingAuth();return}let{apiKey:n}=e.options;ea(n,"invalid-api-key",{appName:e.name}),ea(n,"invalid-api-key",{appName:e.name});let r="undefined"!=typeof window?et:void 0;this._delegate=t.initialize({options:{persistence:function(e,t){let n=function(e,t){let n=J();if(!n)return[];let r=A.aD(Y,e,t),i=n.getItem(r);switch(i){case Z.NONE:return[A.N];case Z.LOCAL:return[A.i,A.a];case Z.SESSION:return[A.a];default:return[]}}(e,t);if("undefined"==typeof self||n.includes(A.i)||n.push(A.i),"undefined"!=typeof window)for(let e of[A.b,A.a])n.includes(e)||n.push(e);return n.includes(A.N)||n.push(A.N),n}(n,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(A.D),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?eo.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){A.I(this._delegate,e,t)}applyActionCode(e){return A.a5(this._delegate,e)}checkActionCode(e){return A.a6(this._delegate,e)}confirmPasswordReset(e,t){return A.a4(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return er(this._delegate,A.a8(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return A.ad(this._delegate,e)}isSignInWithEmailLink(e){return A.ab(this._delegate,e)}async getRedirectResult(){ea(W(),this._delegate,"operation-not-supported-in-this-environment");let e=await A.j(this._delegate,et);return e?er(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e,t){(0,A.aH)(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){let{next:r,error:i,complete:s}=eu(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){let{next:r,error:i,complete:s}=eu(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return A.aa(this._delegate,e,t)}sendPasswordResetEmail(e,t){return A.a3(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(!function(e,t){if(Q(Object.values(Z).includes(t),e,"invalid-persistence-type"),(0,b.b$)()){Q(t!==Z.SESSION,e,"unsupported-persistence-type");return}if((0,b.UG)()){Q(t===Z.NONE,e,"unsupported-persistence-type");return}if(H()){Q(t===Z.NONE||t===Z.LOCAL&&(0,b.hl)(),e,"unsupported-persistence-type");return}Q(t===Z.NONE||$(),e,"unsupported-persistence-type")}(this._delegate,e),e){case Z.SESSION:t=A.a;break;case Z.LOCAL:let n=await A.aC(A.i)._isAvailable();t=n?A.i:A.b;break;case Z.NONE:t=A.N;break;default:return A.av("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return er(this._delegate,A._(this._delegate))}signInWithCredential(e){return er(this._delegate,A.$(this._delegate,e))}signInWithCustomToken(e){return er(this._delegate,A.a2(this._delegate,e))}signInWithEmailAndPassword(e,t){return er(this._delegate,A.a9(this._delegate,e,t))}signInWithEmailLink(e,t){return er(this._delegate,A.ac(this._delegate,e,t))}signInWithPhoneNumber(e,t){return ei(this._delegate,A.s(this._delegate,e,t))}async signInWithPopup(e){return ea(W(),this._delegate,"operation-not-supported-in-this-environment"),er(this._delegate,A.c(this._delegate,e,et))}async signInWithRedirect(e){return ea(W(),this._delegate,"operation-not-supported-in-this-environment"),await X(this._delegate),A.f(this._delegate,e,et)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return A.a7(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function eu(e,t,n){let r=e;"function"!=typeof e&&({next:r,error:t,complete:n}=e);let i=r,s=e=>i(e&&eo.getOrCreate(e));return{next:s,error:t,complete:n}}el.Persistence=Z;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ec{constructor(){this.providerId="phone",this._delegate=new A.P(k.auth().unwrap())}static credential(e,t){return A.P.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}ec.PHONE_SIGN_IN_METHOD=A.P.PHONE_SIGN_IN_METHOD,ec.PROVIDER_ID=A.P.PROVIDER_ID;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let eh=A.aA;k.INTERNAL.registerComponent(new I.wA("auth-compat",e=>{let t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new el(t,n)},"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:A.A.EMAIL_SIGNIN,PASSWORD_RESET:A.A.PASSWORD_RESET,RECOVER_EMAIL:A.A.RECOVER_EMAIL,REVERT_SECOND_FACTOR_ADDITION:A.A.REVERT_SECOND_FACTOR_ADDITION,VERIFY_AND_CHANGE_EMAIL:A.A.VERIFY_AND_CHANGE_EMAIL,VERIFY_EMAIL:A.A.VERIFY_EMAIL}},EmailAuthProvider:A.Q,FacebookAuthProvider:A.U,GithubAuthProvider:A.W,GoogleAuthProvider:A.V,OAuthProvider:A.X,SAMLAuthProvider:A.Y,PhoneAuthProvider:ec,PhoneMultiFactorGenerator:A.m,RecaptchaVerifier:class{constructor(e,t,n=k.app()){var r;eh(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new A.R(e,t,n.auth()),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}},TwitterAuthProvider:A.Z,Auth:el,AuthCredential:A.J,Error:b.ZR}).setInstantiationMode("LAZY").setMultipleInstances(!1)),k.registerVersion("@firebase/auth-compat","0.4.1");var ed=n(3454);let ef="@firebase/database",ep="0.14.4",eg="";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class em{constructor(e){this.domStorage_=e,this.prefix_="firebase:"}set(e,t){null==t?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),(0,b.Wl)(t))}get(e){let t=this.domStorage_.getItem(this.prefixedName_(e));return null==t?null:(0,b.cI)(t)}remove(e){this.domStorage_.removeItem(this.prefixedName_(e))}prefixedName_(e){return this.prefix_+e}toString(){return this.domStorage_.toString()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ey{constructor(){this.cache_={},this.isInMemoryStorage=!0}set(e,t){null==t?delete this.cache_[e]:this.cache_[e]=t}get(e){return(0,b.r3)(this.cache_,e)?this.cache_[e]:null}remove(e){delete this.cache_[e]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ev=function(e){try{if("undefined"!=typeof window&&void 0!==window[e]){let t=window[e];return t.setItem("firebase:sentinel","cache"),t.removeItem("firebase:sentinel"),new em(t)}}catch(e){}return new ey},e_=ev("localStorage"),ew=ev("sessionStorage"),eb=new E.Yd("@firebase/database"),eI=(f=1,function(){return f++}),eT=function(e){let t=(0,b.dS)(e),n=new b.gQ;n.update(t);let r=n.digest();return b.US.encodeByteArray(r)},eE=function(...e){let t="";for(let n=0;n<e.length;n++){let r=e[n];Array.isArray(r)||r&&"object"==typeof r&&"number"==typeof r.length?t+=eE.apply(null,r):"object"==typeof r?t+=(0,b.Wl)(r):t+=r,t+=" "}return t},eC=null,eS=!0,ek=function(e,t){(0,b.hu)(!t||!0===e||!1===e,"Can't turn on custom loggers persistently."),!0===e?(eb.logLevel=E.in.VERBOSE,eC=eb.log.bind(eb),t&&ew.set("logging_enabled",!0)):"function"==typeof e?eC=e:(eC=null,ew.remove("logging_enabled"))},ex=function(...e){if(!0===eS&&(eS=!1,null===eC&&!0===ew.get("logging_enabled")&&ek(!0)),eC){let t=eE.apply(null,e);eC(t)}},eA=function(e){return function(...t){ex(e,...t)}},eR=function(...e){let t="FIREBASE INTERNAL ERROR: "+eE(...e);eb.error(t)},eN=function(...e){let t=`FIREBASE FATAL ERROR: ${eE(...e)}`;throw eb.error(t),Error(t)},eP=function(...e){let t="FIREBASE WARNING: "+eE(...e);eb.warn(t)},eD=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&eP("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},eO=function(e){return"number"==typeof e&&(e!=e||e===Number.POSITIVE_INFINITY||e===Number.NEGATIVE_INFINITY)},eF=function(e){if((0,b.Yr)()||"complete"===document.readyState)e();else{let t=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}t||(t=!0,e())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",()=>{"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},eL="[MIN_NAME]",eM="[MAX_NAME]",eU=function(e,t){if(e===t)return 0;if(e===eL||t===eM)return -1;if(t===eL||e===eM)return 1;{let n=eW(e),r=eW(t);return null!==n?null!==r?n-r==0?e.length-t.length:n-r:-1:null!==r?1:e<t?-1:1}},eV=function(e,t){return e===t?0:e<t?-1:1},eq=function(e,t){if(t&&e in t)return t[e];throw Error("Missing required key ("+e+") in object: "+(0,b.Wl)(t))},ej=function(e){if("object"!=typeof e||null===e)return(0,b.Wl)(e);let t=[];for(let n in e)t.push(n);t.sort();let n="{";for(let r=0;r<t.length;r++)0!==r&&(n+=","),n+=(0,b.Wl)(t[r])+":"+ej(e[t[r]]);return n+"}"},eB=function(e,t){let n=e.length;if(n<=t)return[e];let r=[];for(let i=0;i<n;i+=t)i+t>n?r.push(e.substring(i,n)):r.push(e.substring(i,i+t));return r};function ez(e,t){for(let n in e)e.hasOwnProperty(n)&&t(n,e[n])}let e$=function(e){let t,n,r,i,s;(0,b.hu)(!eO(e),"Invalid JSON number"),0===e?(n=0,r=0,t=1/e==-1/0?1:0):(t=e<0,(e=Math.abs(e))>=22250738585072014e-324?(n=(i=Math.min(Math.floor(Math.log(e)/Math.LN2),1023))+1023,r=Math.round(e*Math.pow(2,52-i)-4503599627370496)):(n=0,r=Math.round(e/5e-324)));let o=[];for(s=52;s;s-=1)o.push(r%2?1:0),r=Math.floor(r/2);for(s=11;s;s-=1)o.push(n%2?1:0),n=Math.floor(n/2);o.push(t?1:0),o.reverse();let a=o.join(""),l="";for(s=0;s<64;s+=8){let e=parseInt(a.substr(s,8),2).toString(16);1===e.length&&(e="0"+e),l+=e}return l.toLowerCase()},eH=RegExp("^-?(0*)\\d{1,10}$"),eW=function(e){if(eH.test(e)){let t=Number(e);if(t>=-2147483648&&t<=2147483647)return t}return null},eG=function(e){try{e()}catch(e){setTimeout(()=>{let t=e.stack||"";throw eP("Exception was thrown by user callback.",t),e},Math.floor(0))}},eK=function(){let e="object"==typeof window&&window.navigator&&window.navigator.userAgent||"";return e.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},eZ=function(e,t){let n=setTimeout(e,t);return"number"==typeof n&&"undefined"!=typeof Deno&&Deno.unrefTimer?Deno.unrefTimer(n):"object"==typeof n&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eQ{constructor(e,t){this.appName_=e,this.appCheckProvider=t,this.appCheck=null==t?void 0:t.getImmediate({optional:!0}),this.appCheck||null==t||t.get().then(e=>this.appCheck=e)}getToken(e){return this.appCheck?this.appCheck.getToken(e):new Promise((t,n)=>{setTimeout(()=>{this.appCheck?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){var t;null===(t=this.appCheckProvider)||void 0===t||t.get().then(t=>t.addTokenListener(e))}notifyForInvalidToken(){eP(`Provided AppCheck credentials for the app named "${this.appName_}" are invalid. This usually indicates your app was not initialized correctly.`)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eY{constructor(e,t,n){this.appName_=e,this.firebaseOptions_=t,this.authProvider_=n,this.auth_=null,this.auth_=n.getImmediate({optional:!0}),this.auth_||n.onInit(e=>this.auth_=e)}getToken(e){return this.auth_?this.auth_.getToken(e).catch(e=>e&&"auth/token-not-initialized"===e.code?(ex("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(e)):new Promise((t,n)=>{setTimeout(()=>{this.auth_?this.getToken(e).then(t,n):t(null)},0)})}addTokenChangeListener(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(t=>t.addAuthTokenListener(e))}removeTokenChangeListener(e){this.authProvider_.get().then(t=>t.removeAuthTokenListener(e))}notifyForInvalidToken(){let e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',eP(e)}}class eX{constructor(e){this.accessToken=e}getToken(e){return Promise.resolve({accessToken:this.accessToken})}addTokenChangeListener(e){e(this.accessToken)}removeTokenChangeListener(e){}notifyForInvalidToken(){}}eX.OWNER="owner";let eJ=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,e0="websocket",e1="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e2{constructor(e,t,n,r,i=!1,s="",o=!1,a=!1){this.secure=t,this.namespace=n,this.webSocketOnly=r,this.nodeAdmin=i,this.persistenceKey=s,this.includeNamespaceInQueryParams=o,this.isUsingEmulator=a,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=e_.get("host:"+e)||this._host}isCacheableHost(){return"s-"===this.internalHost.substr(0,2)}isCustomHost(){return"firebaseio.com"!==this._domain&&"firebaseio-demo.com"!==this._domain}get host(){return this._host}set host(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&e_.set("host:"+this._host,this.internalHost))}toString(){let e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e}toURLString(){let e=this.secure?"https://":"http://",t=this.includeNamespaceInQueryParams?`?ns=${this.namespace}`:"";return`${e}${this.host}/${t}`}}function e4(e,t,n){let r;if((0,b.hu)("string"==typeof t,"typeof type must == string"),(0,b.hu)("object"==typeof n,"typeof params must == object"),t===e0)r=(e.secure?"wss://":"ws://")+e.internalHost+"/.ws?";else if(t===e1)r=(e.secure?"https://":"http://")+e.internalHost+"/.lp?";else throw Error("Unknown connection type: "+t);(e.host!==e.internalHost||e.isCustomHost()||e.includeNamespaceInQueryParams)&&(n.ns=e.namespace);let i=[];return ez(n,(e,t)=>{i.push(e+"="+t)}),r+i.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e9{constructor(){this.counters_={}}incrementCounter(e,t=1){(0,b.r3)(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=t}get(){return(0,b.p$)(this.counters_)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e5={},e6={};function e3(e){let t=e.toString();return e5[t]||(e5[t]=new e9),e5[t]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e8{constructor(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}closeAfter(e,t){this.closeAfterResponse=e,this.onClose=t,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)}handleResponse(e,t){for(this.pendingResponses[e]=t;this.pendingResponses[this.currentResponseNum];){let e=this.pendingResponses[this.currentResponseNum];delete this.pendingResponses[this.currentResponseNum];for(let t=0;t<e.length;++t)e[t]&&eG(()=>{this.onMessage_(e[t])});if(this.currentResponseNum===this.closeAfterResponse){this.onClose&&(this.onClose(),this.onClose=null);break}this.currentResponseNum++}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let e7="start";class te{constructor(e,t,n,r,i,s,o){this.connId=e,this.repoInfo=t,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.transportSessionId=s,this.lastSessionId=o,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=eA(e),this.stats_=e3(t),this.urlFn=e=>(this.appCheckToken&&(e.ac=this.appCheckToken),e4(t,e1,e))}open(e,t){this.curSegmentNum=0,this.onDisconnect_=t,this.myPacketOrderer=new e8(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(()=>{this.log_("Timed out trying to connect."),this.onClosed_(),this.connectTimeoutTimer_=null},Math.floor(3e4)),eF(()=>{if(this.isClosed_)return;this.scriptTagHolder=new tt((...e)=>{let[t,n,r,i,s]=e;if(this.incrementIncomingBytes_(e),this.scriptTagHolder){if(this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null),this.everConnected_=!0,t===e7)this.id=n,this.password=r;else if("close"===t)n?(this.scriptTagHolder.sendNewPolls=!1,this.myPacketOrderer.closeAfter(n,()=>{this.onClosed_()})):this.onClosed_();else throw Error("Unrecognized command received: "+t)}},(...e)=>{let[t,n]=e;this.incrementIncomingBytes_(e),this.myPacketOrderer.handleResponse(t,n)},()=>{this.onClosed_()},this.urlFn);let e={};e[e7]="t",e.ser=Math.floor(1e8*Math.random()),this.scriptTagHolder.uniqueCallbackIdentifier&&(e.cb=this.scriptTagHolder.uniqueCallbackIdentifier),e.v="5",this.transportSessionId&&(e.s=this.transportSessionId),this.lastSessionId&&(e.ls=this.lastSessionId),this.applicationId&&(e.p=this.applicationId),this.appCheckToken&&(e.ac=this.appCheckToken),"undefined"!=typeof location&&location.hostname&&eJ.test(location.hostname)&&(e.r="f");let t=this.urlFn(e);this.log_("Connecting via long-poll to "+t),this.scriptTagHolder.addTag(t,()=>{})})}start(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)}static forceAllow(){te.forceAllow_=!0}static forceDisallow(){te.forceDisallow_=!0}static isAvailable(){return!(0,b.Yr)()&&(!!te.forceAllow_||!te.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!("object"==typeof window&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))&&!("object"==typeof Windows&&"object"==typeof Windows.UI))}markConnectionHealthy(){}shutdown_(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)}onClosed_(){!this.isClosed_&&(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))}close(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())}send(e){let t=(0,b.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let n=(0,b.h$)(t),r=eB(n,1840);for(let e=0;e<r.length;e++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[e]),this.curSegmentNum++}addDisconnectPingFrame(e,t){if((0,b.Yr)())return;this.myDisconnFrame=document.createElement("iframe");let n={};n.dframe="t",n.id=e,n.pw=t,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}incrementIncomingBytes_(e){let t=(0,b.Wl)(e).length;this.bytesReceived+=t,this.stats_.incrementCounter("bytes_received",t)}}class tt{constructor(e,t,n,r){if(this.onDisconnect=n,this.urlFn=r,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,(0,b.Yr)())this.commandCB=e,this.onMessageCB=t;else{this.uniqueCallbackIdentifier=eI(),window["pLPCommand"+this.uniqueCallbackIdentifier]=e,window["pRTLPCB"+this.uniqueCallbackIdentifier]=t,this.myIFrame=tt.createIFrame_();let n="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,11)){let e=document.domain;n='<script>document.domain="'+e+'";</script>'}let r="<html><body>"+n+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(r),this.myIFrame.doc.close()}catch(e){ex("frame writing exception"),e.stack&&ex(e.stack),ex(e)}}}static createIFrame_(){let e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{let t=e.contentWindow.document;t||ex("No IE domain setting required")}catch(n){let t=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+t+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e}close(){this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.textContent="",setTimeout(()=>{null!==this.myIFrame&&(document.body.removeChild(this.myIFrame),this.myIFrame=null)},Math.floor(0)));let e=this.onDisconnect;e&&(this.onDisconnect=null,e())}startLongPoll(e,t){for(this.myID=e,this.myPW=t,this.alive=!0;this.newRequest_(););}newRequest_(){if(!this.alive||!this.sendNewPolls||!(this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)))return!1;{this.currentSerial++;let e={};e.id=this.myID,e.pw=this.myPW,e.ser=this.currentSerial;let t=this.urlFn(e),n="",r=0;for(;this.pendingSegs.length>0;){let e=this.pendingSegs[0];if(e.d.length+30+n.length<=1870){let e=this.pendingSegs.shift();n=n+"&seg"+r+"="+e.seg+"&ts"+r+"="+e.ts+"&d"+r+"="+e.d,r++}else break}return t+=n,this.addLongPollTag_(t,this.currentSerial),!0}}enqueueSegment(e,t,n){this.pendingSegs.push({seg:e,ts:t,d:n}),this.alive&&this.newRequest_()}addLongPollTag_(e,t){this.outstandingRequests.add(t);let n=()=>{this.outstandingRequests.delete(t),this.newRequest_()},r=setTimeout(n,Math.floor(25e3)),i=()=>{clearTimeout(r),n()};this.addTag(e,i)}addTag(e,t){(0,b.Yr)()?this.doNodeLongPoll(e,t):setTimeout(()=>{try{if(!this.sendNewPolls)return;let n=this.myIFrame.doc.createElement("script");n.type="text/javascript",n.async=!0,n.src=e,n.onload=n.onreadystatechange=function(){let e=n.readyState;e&&"loaded"!==e&&"complete"!==e||(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),t())},n.onerror=()=>{ex("Long-poll script failed to load: "+e),this.sendNewPolls=!1,this.close()},this.myIFrame.doc.body.appendChild(n)}catch(e){}},Math.floor(1))}}let tn=null;"undefined"!=typeof MozWebSocket?tn=MozWebSocket:"undefined"!=typeof WebSocket&&(tn=WebSocket);class tr{constructor(e,t,n,r,i,s,o){this.connId=e,this.applicationId=n,this.appCheckToken=r,this.authToken=i,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=eA(this.connId),this.stats_=e3(t),this.connURL=tr.connectionURL_(t,s,o,r,n),this.nodeAdmin=t.nodeAdmin}static connectionURL_(e,t,n,r,i){let s={};return s.v="5",!(0,b.Yr)()&&"undefined"!=typeof location&&location.hostname&&eJ.test(location.hostname)&&(s.r="f"),t&&(s.s=t),n&&(s.ls=n),r&&(s.ac=r),i&&(s.p=i),e4(e,e0,s)}open(e,t){this.onDisconnect=t,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,e_.set("previous_websocket_failure",!0);try{let e;if((0,b.Yr)()){let t=this.nodeAdmin?"AdminNode":"Node";e={headers:{"User-Agent":`Firebase/5/${eg}/${ed.platform}/${t}`,"X-Firebase-GMPID":this.applicationId||""}},this.authToken&&(e.headers.Authorization=`Bearer ${this.authToken}`),this.appCheckToken&&(e.headers["X-Firebase-AppCheck"]=this.appCheckToken);let n=ed.env,r=0===this.connURL.indexOf("wss://")?n.HTTPS_PROXY||n.https_proxy:n.HTTP_PROXY||n.http_proxy;r&&(e.proxy={origin:r})}this.mySock=new tn(this.connURL,[],e)}catch(t){this.log_("Error instantiating WebSocket.");let e=t.message||t.data;e&&this.log_(e),this.onClosed_();return}this.mySock.onopen=()=>{this.log_("Websocket connected."),this.everConnected_=!0},this.mySock.onclose=()=>{this.log_("Websocket connection was disconnected."),this.mySock=null,this.onClosed_()},this.mySock.onmessage=e=>{this.handleIncomingFrame(e)},this.mySock.onerror=e=>{this.log_("WebSocket error.  Closing connection.");let t=e.message||e.data;t&&this.log_(t),this.onClosed_()}}start(){}static forceDisallow(){tr.forceDisallow_=!0}static isAvailable(){let e=!1;if("undefined"!=typeof navigator&&navigator.userAgent){let t=navigator.userAgent.match(/Android ([0-9]{0,}\.[0-9]{0,})/);t&&t.length>1&&4.4>parseFloat(t[1])&&(e=!0)}return!e&&null!==tn&&!tr.forceDisallow_}static previouslyFailed(){return e_.isInMemoryStorage||!0===e_.get("previous_websocket_failure")}markConnectionHealthy(){e_.remove("previous_websocket_failure")}appendFrame_(e){if(this.frames.push(e),this.frames.length===this.totalFrames){let e=this.frames.join("");this.frames=null;let t=(0,b.cI)(e);this.onMessage(t)}}handleNewFrameCount_(e){this.totalFrames=e,this.frames=[]}extractFrameCount_(e){if((0,b.hu)(null===this.frames,"We already have a frame buffer"),e.length<=6){let t=Number(e);if(!isNaN(t))return this.handleNewFrameCount_(t),null}return this.handleNewFrameCount_(1),e}handleIncomingFrame(e){if(null===this.mySock)return;let t=e.data;if(this.bytesReceived+=t.length,this.stats_.incrementCounter("bytes_received",t.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(t);else{let e=this.extractFrameCount_(t);null!==e&&this.appendFrame_(e)}}send(e){this.resetKeepAlive();let t=(0,b.Wl)(e);this.bytesSent+=t.length,this.stats_.incrementCounter("bytes_sent",t.length);let n=eB(t,16384);n.length>1&&this.sendString_(String(n.length));for(let e=0;e<n.length;e++)this.sendString_(n[e])}shutdown_(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)}onClosed_(){!this.isClosed_&&(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))}close(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())}resetKeepAlive(){clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(()=>{this.mySock&&this.sendString_("0"),this.resetKeepAlive()},Math.floor(45e3))}sendString_(e){try{this.mySock.send(e)}catch(e){this.log_("Exception thrown from WebSocket.send():",e.message||e.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}}}tr.responsesRequiredToBeHealthy=2,tr.healthyTimeout=3e4;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.initTransports_(e)}static get ALL_TRANSPORTS(){return[te,tr]}static get IS_TRANSPORT_INITIALIZED(){return this.globalTransportInitialized_}initTransports_(e){let t=tr&&tr.isAvailable(),n=t&&!tr.previouslyFailed();if(e.webSocketOnly&&(t||eP("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),n=!0),n)this.transports_=[tr];else{let e=this.transports_=[];for(let t of ti.ALL_TRANSPORTS)t&&t.isAvailable()&&e.push(t);ti.globalTransportInitialized_=!0}}initialTransport(){if(this.transports_.length>0)return this.transports_[0];throw Error("No transports available")}upgradeTransport(){return this.transports_.length>1?this.transports_[1]:null}}ti.globalTransportInitialized_=!1;class ts{constructor(e,t,n,r,i,s,o,a,l,u){this.id=e,this.repoInfo_=t,this.applicationId_=n,this.appCheckToken_=r,this.authToken_=i,this.onMessage_=s,this.onReady_=o,this.onDisconnect_=a,this.onKill_=l,this.lastSessionId=u,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=eA("c:"+this.id+":"),this.transportManager_=new ti(t),this.log_("Connection created"),this.start_()}start_(){let e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.conn_),n=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(()=>{this.conn_&&this.conn_.open(t,n)},Math.floor(0));let r=e.healthyTimeout||0;r>0&&(this.healthyTimeout_=eZ(()=>{this.healthyTimeout_=null,this.isHealthy_||(this.conn_&&this.conn_.bytesReceived>102400?(this.log_("Connection exceeded healthy timeout but has received "+this.conn_.bytesReceived+" bytes.  Marking connection healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()):this.conn_&&this.conn_.bytesSent>10240?this.log_("Connection exceeded healthy timeout but has sent "+this.conn_.bytesSent+" bytes.  Leaving connection alive."):(this.log_("Closing unhealthy connection after timeout."),this.close()))},Math.floor(r)))}nextTransportId_(){return"c:"+this.id+":"+this.connectionCount++}disconnReceiver_(e){return t=>{e===this.conn_?this.onConnectionLost_(t):e===this.secondaryConn_?(this.log_("Secondary connection lost."),this.onSecondaryConnectionLost_()):this.log_("closing an old connection")}}connReceiver_(e){return t=>{2!==this.state_&&(e===this.rx_?this.onPrimaryMessageReceived_(t):e===this.secondaryConn_?this.onSecondaryMessageReceived_(t):this.log_("message on old connection"))}}sendRequest(e){this.sendData_({t:"d",d:e})}tryCleanupConnection(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)}onSecondaryControl_(e){if("t"in e){let t=e.t;"a"===t?this.upgradeIfSecondaryHealthy_():"r"===t?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):"o"===t&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}}onSecondaryMessageReceived_(e){let t=eq("t",e),n=eq("d",e);if("c"===t)this.onSecondaryControl_(n);else if("d"===t)this.pendingDataMessages.push(n);else throw Error("Unknown protocol layer: "+t)}upgradeIfSecondaryHealthy_(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))}proceedWithUpgrade_(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()}onPrimaryMessageReceived_(e){let t=eq("t",e),n=eq("d",e);"c"===t?this.onControl_(n):"d"===t&&this.onDataMessage_(n)}onDataMessage_(e){this.onPrimaryResponse_(),this.onMessage_(e)}onPrimaryResponse_(){!this.isHealthy_&&(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))}onControl_(e){let t=eq("t",e);if("d"in e){let n=e.d;if("h"===t){let e=Object.assign({},n);this.repoInfo_.isUsingEmulator&&(e.h=this.repoInfo_.host),this.onHandshake_(e)}else if("n"===t){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(let e=0;e<this.pendingDataMessages.length;++e)this.onDataMessage_(this.pendingDataMessages[e]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===t?this.onConnectionShutdown_(n):"r"===t?this.onReset_(n):"e"===t?eR("Server Error: "+n):"o"===t?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):eR("Unknown control packet command: "+t)}}onHandshake_(e){let t=e.ts,n=e.v,r=e.h;this.sessionId=e.s,this.repoInfo_.host=r,0===this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,t),"5"!==n&&eP("Protocol version mismatch detected"),this.tryStartUpgrade_())}tryStartUpgrade_(){let e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)}startUpgrade_(e){this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;let t=this.connReceiver_(this.secondaryConn_),n=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(t,n),eZ(()=>{this.secondaryConn_&&(this.log_("Timed out trying to upgrade."),this.secondaryConn_.close())},Math.floor(6e4))}onReset_(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,1===this.state_?this.close():(this.closeConnections_(),this.start_())}onConnectionEstablished_(e,t){this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(t,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):eZ(()=>{this.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))}sendPingOnPrimaryIfNecessary_(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))}onSecondaryConnectionLost_(){let e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()}onConnectionLost_(e){this.conn_=null,e||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(e_.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()}onConnectionShutdown_(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()}sendData_(e){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(e)}close(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))}closeConnections_(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class to{put(e,t,n,r){}merge(e,t,n,r){}refreshAuthToken(e){}refreshAppCheckToken(e){}onDisconnectPut(e,t,n){}onDisconnectMerge(e,t,n){}onDisconnectCancel(e,t){}reportStats(e){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ta{constructor(e){this.allowedEvents_=e,this.listeners_={},(0,b.hu)(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}trigger(e,...t){if(Array.isArray(this.listeners_[e])){let n=[...this.listeners_[e]];for(let e=0;e<n.length;e++)n[e].callback.apply(n[e].context,t)}}on(e,t,n){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:t,context:n});let r=this.getInitialEvent(e);r&&t.apply(n,r)}off(e,t,n){this.validateEventType_(e);let r=this.listeners_[e]||[];for(let e=0;e<r.length;e++)if(r[e].callback===t&&(!n||n===r[e].context)){r.splice(e,1);return}}validateEventType_(e){(0,b.hu)(this.allowedEvents_.find(t=>t===e),"Unknown event: "+e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl extends ta{constructor(){super(["online"]),this.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||(0,b.uI)()||(window.addEventListener("online",()=>{this.online_||(this.online_=!0,this.trigger("online",!0))},!1),window.addEventListener("offline",()=>{this.online_&&(this.online_=!1,this.trigger("online",!1))},!1))}static getInstance(){return new tl}getInitialEvent(e){return(0,b.hu)("online"===e,"Unknown event type: "+e),[this.online_]}currentlyOnline(){return this.online_}}class tu{constructor(e,t){if(void 0===t){this.pieces_=e.split("/");let t=0;for(let e=0;e<this.pieces_.length;e++)this.pieces_[e].length>0&&(this.pieces_[t]=this.pieces_[e],t++);this.pieces_.length=t,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=t}toString(){let e="";for(let t=this.pieceNum_;t<this.pieces_.length;t++)""!==this.pieces_[t]&&(e+="/"+this.pieces_[t]);return e||"/"}}function tc(){return new tu("")}function th(e){return e.pieceNum_>=e.pieces_.length?null:e.pieces_[e.pieceNum_]}function td(e){return e.pieces_.length-e.pieceNum_}function tf(e){let t=e.pieceNum_;return t<e.pieces_.length&&t++,new tu(e.pieces_,t)}function tp(e){return e.pieceNum_<e.pieces_.length?e.pieces_[e.pieces_.length-1]:null}function tg(e,t=0){return e.pieces_.slice(e.pieceNum_+t)}function tm(e){if(e.pieceNum_>=e.pieces_.length)return null;let t=[];for(let n=e.pieceNum_;n<e.pieces_.length-1;n++)t.push(e.pieces_[n]);return new tu(t,0)}function ty(e,t){let n=[];for(let t=e.pieceNum_;t<e.pieces_.length;t++)n.push(e.pieces_[t]);if(t instanceof tu)for(let e=t.pieceNum_;e<t.pieces_.length;e++)n.push(t.pieces_[e]);else{let e=t.split("/");for(let t=0;t<e.length;t++)e[t].length>0&&n.push(e[t])}return new tu(n,0)}function tv(e){return e.pieceNum_>=e.pieces_.length}function t_(e,t){let n=th(e),r=th(t);if(null===n)return t;if(n===r)return t_(tf(e),tf(t));throw Error("INTERNAL ERROR: innerPath ("+t+") is not within outerPath ("+e+")")}function tw(e,t){let n=tg(e,0),r=tg(t,0);for(let e=0;e<n.length&&e<r.length;e++){let t=eU(n[e],r[e]);if(0!==t)return t}return n.length===r.length?0:n.length<r.length?-1:1}function tb(e,t){if(td(e)!==td(t))return!1;for(let n=e.pieceNum_,r=t.pieceNum_;n<=e.pieces_.length;n++,r++)if(e.pieces_[n]!==t.pieces_[r])return!1;return!0}function tI(e,t){let n=e.pieceNum_,r=t.pieceNum_;if(td(e)>td(t))return!1;for(;n<e.pieces_.length;){if(e.pieces_[n]!==t.pieces_[r])return!1;++n,++r}return!0}class tT{constructor(e,t){this.errorPrefix_=t,this.parts_=tg(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(let e=0;e<this.parts_.length;e++)this.byteLength_+=(0,b.ug)(this.parts_[e]);tE(this)}}function tE(e){if(e.byteLength_>768)throw Error(e.errorPrefix_+"has a key path longer than 768 bytes ("+e.byteLength_+").");if(e.parts_.length>32)throw Error(e.errorPrefix_+"path specified exceeds the maximum depth that can be written (32) or object contains a cycle "+tC(e))}function tC(e){return 0===e.parts_.length?"":"in property '"+e.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tS extends ta{constructor(){let e,t;super(["visible"]),"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(t="visibilitychange",e="hidden"):void 0!==document.mozHidden?(t="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(t="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(t="webkitvisibilitychange",e="webkitHidden")),this.visible_=!0,t&&document.addEventListener(t,()=>{let t=!document[e];t!==this.visible_&&(this.visible_=t,this.trigger("visible",t))},!1)}static getInstance(){return new tS}getInitialEvent(e){return(0,b.hu)("visible"===e,"Unknown event type: "+e),[this.visible_]}}class tk extends to{constructor(e,t,n,r,i,s,o,a){if(super(),this.repoInfo_=e,this.applicationId_=t,this.onDataUpdate_=n,this.onConnectStatus_=r,this.onServerInfoUpdate_=i,this.authTokenProvider_=s,this.appCheckTokenProvider_=o,this.authOverride_=a,this.id=tk.nextPersistentConnectionId_++,this.log_=eA("p:"+this.id+":"),this.interruptReasons_={},this.listens=new Map,this.outstandingPuts_=[],this.outstandingGets_=[],this.outstandingPutCount_=0,this.outstandingGetCount_=0,this.onDisconnectRequestQueue_=[],this.connected_=!1,this.reconnectDelay_=1e3,this.maxReconnectDelay_=3e5,this.securityDebugCallback_=null,this.lastSessionId=null,this.establishConnectionTimer_=null,this.visible_=!1,this.requestCBHash_={},this.requestNumber_=0,this.realtime_=null,this.authToken_=null,this.appCheckToken_=null,this.forceTokenRefresh_=!1,this.invalidAuthTokenCount_=0,this.invalidAppCheckTokenCount_=0,this.firstConnection_=!0,this.lastConnectionAttemptTime_=null,this.lastConnectionEstablishedTime_=null,a&&!(0,b.Yr)())throw Error("Auth override specified in options, but not supported on non Node.js platforms");tS.getInstance().on("visible",this.onVisible_,this),-1===e.host.indexOf("fblocal")&&tl.getInstance().on("online",this.onOnline_,this)}sendRequest(e,t,n){let r=++this.requestNumber_,i={r:r,a:e,b:t};this.log_((0,b.Wl)(i)),(0,b.hu)(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)}get(e){this.initConnection_();let t=new b.BH,n={p:e._path.toString(),q:e._queryObject};this.outstandingGets_.push({action:"g",request:n,onComplete:e=>{let n=e.d;"ok"===e.s?t.resolve(n):t.reject(n)}}),this.outstandingGetCount_++;let r=this.outstandingGets_.length-1;return this.connected_&&this.sendGet_(r),t.promise}listen(e,t,n,r){this.initConnection_();let i=e._queryIdentifier,s=e._path.toString();this.log_("Listen called for "+s+" "+i),this.listens.has(s)||this.listens.set(s,new Map),(0,b.hu)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"listen() called for non-default but complete query"),(0,b.hu)(!this.listens.get(s).has(i),"listen() called twice for same path/queryId.");let o={onComplete:r,hashFn:t,query:e,tag:n};this.listens.get(s).set(i,o),this.connected_&&this.sendListen_(o)}sendGet_(e){let t=this.outstandingGets_[e];this.sendRequest("g",t.request,n=>{delete this.outstandingGets_[e],this.outstandingGetCount_--,0===this.outstandingGetCount_&&(this.outstandingGets_=[]),t.onComplete&&t.onComplete(n)})}sendListen_(e){let t=e.query,n=t._path.toString(),r=t._queryIdentifier;this.log_("Listen on "+n+" for "+r);let i={p:n};e.tag&&(i.q=t._queryObject,i.t=e.tag),i.h=e.hashFn(),this.sendRequest("q",i,i=>{let s=i.d,o=i.s;tk.warnOnListenWarnings_(s,t);let a=this.listens.get(n)&&this.listens.get(n).get(r);a===e&&(this.log_("listen response",i),"ok"!==o&&this.removeListen_(n,r),e.onComplete&&e.onComplete(o,s))})}static warnOnListenWarnings_(e,t){if(e&&"object"==typeof e&&(0,b.r3)(e,"w")){let n=(0,b.DV)(e,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){let e='".indexOn": "'+t._queryParams.getIndex().toString()+'"',n=t._path.toString();eP(`Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding ${e} at ${n} to your security rules for better performance.`)}}}refreshAuthToken(e){this.authToken_=e,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},()=>{}),this.reduceReconnectDelayIfAdminCredential_(e)}reduceReconnectDelayIfAdminCredential_(e){let t=e&&40===e.length;(t||(0,b.GJ)(e))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)}refreshAppCheckToken(e){this.appCheckToken_=e,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},()=>{})}tryAuth(){if(this.connected_&&this.authToken_){let e=this.authToken_,t=(0,b.w9)(e)?"auth":"gauth",n={cred:e};null===this.authOverride_?n.noauth=!0:"object"==typeof this.authOverride_&&(n.authvar=this.authOverride_),this.sendRequest(t,n,t=>{let n=t.s,r=t.d||"error";this.authToken_===e&&("ok"===n?this.invalidAuthTokenCount_=0:this.onAuthRevoked_(n,r))})}}tryAppCheck(){this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},e=>{let t=e.s,n=e.d||"error";"ok"===t?this.invalidAppCheckTokenCount_=0:this.onAppCheckRevoked_(t,n)})}unlisten(e,t){let n=e._path.toString(),r=e._queryIdentifier;this.log_("Unlisten called for "+n+" "+r),(0,b.hu)(e._queryParams.isDefault()||!e._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");let i=this.removeListen_(n,r);i&&this.connected_&&this.sendUnlisten_(n,r,e._queryObject,t)}sendUnlisten_(e,t,n,r){this.log_("Unlisten on "+e+" for "+t);let i={p:e};r&&(i.q=n,i.t=r),this.sendRequest("n",i)}onDisconnectPut(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"o",data:t,onComplete:n})}onDisconnectMerge(e,t,n){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",e,t,n):this.onDisconnectRequestQueue_.push({pathString:e,action:"om",data:t,onComplete:n})}onDisconnectCancel(e,t){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",e,null,t):this.onDisconnectRequestQueue_.push({pathString:e,action:"oc",data:null,onComplete:t})}sendOnDisconnect_(e,t,n,r){let i={p:t,d:n};this.log_("onDisconnect "+e,i),this.sendRequest(e,i,e=>{r&&setTimeout(()=>{r(e.s,e.d)},Math.floor(0))})}put(e,t,n,r){this.putInternal("p",e,t,n,r)}merge(e,t,n,r){this.putInternal("m",e,t,n,r)}putInternal(e,t,n,r,i){this.initConnection_();let s={p:t,d:n};void 0!==i&&(s.h=i),this.outstandingPuts_.push({action:e,request:s,onComplete:r}),this.outstandingPutCount_++;let o=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(o):this.log_("Buffering put: "+t)}sendPut_(e){let t=this.outstandingPuts_[e].action,n=this.outstandingPuts_[e].request,r=this.outstandingPuts_[e].onComplete;this.outstandingPuts_[e].queued=this.connected_,this.sendRequest(t,n,n=>{this.log_(t+" response",n),delete this.outstandingPuts_[e],this.outstandingPutCount_--,0===this.outstandingPutCount_&&(this.outstandingPuts_=[]),r&&r(n.s,n.d)})}reportStats(e){if(this.connected_){let t={c:e};this.log_("reportStats",t),this.sendRequest("s",t,e=>{let t=e.s;if("ok"!==t){let t=e.d;this.log_("reportStats","Error sending stats: "+t)}})}}onDataMessage_(e){if("r"in e){this.log_("from server: "+(0,b.Wl)(e));let t=e.r,n=this.requestCBHash_[t];n&&(delete this.requestCBHash_[t],n(e.b))}else if("error"in e)throw"A server-side error has occurred: "+e.error;else"a"in e&&this.onDataPush_(e.a,e.b)}onDataPush_(e,t){this.log_("handleServerMessage",e,t),"d"===e?this.onDataUpdate_(t.p,t.d,!1,t.t):"m"===e?this.onDataUpdate_(t.p,t.d,!0,t.t):"c"===e?this.onListenRevoked_(t.p,t.q):"ac"===e?this.onAuthRevoked_(t.s,t.d):"apc"===e?this.onAppCheckRevoked_(t.s,t.d):"sd"===e?this.onSecurityDebugPacket_(t):eR("Unrecognized action received from server: "+(0,b.Wl)(e)+"\nAre you using the latest client?")}onReady_(e,t){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(e),this.lastSessionId=t,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)}scheduleConnect_(e){(0,b.hu)(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(()=>{this.establishConnectionTimer_=null,this.establishConnection_()},Math.floor(e))}initConnection_(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)}onVisible_(e){!e||this.visible_||this.reconnectDelay_!==this.maxReconnectDelay_||(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)),this.visible_=e}onOnline_(e){e?(this.log_("Browser went online."),this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())}onRealtimeDisconnect_(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){let e=new Date().getTime()-this.lastConnectionEstablishedTime_;e>3e4&&(this.reconnectDelay_=1e3),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime();let e=new Date().getTime()-this.lastConnectionAttemptTime_,t=Math.max(0,this.reconnectDelay_-e);t=Math.random()*t,this.log_("Trying to reconnect in "+t+"ms"),this.scheduleConnect_(t),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)}async establishConnection_(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null;let e=this.onDataMessage_.bind(this),t=this.onReady_.bind(this),n=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+tk.nextConnectionId_++,i=this.lastSessionId,s=!1,o=null,a=function(){o?o.close():(s=!0,n())};this.realtime_={close:a,sendRequest:function(e){(0,b.hu)(o,"sendRequest call when we're not connected not allowed."),o.sendRequest(e)}};let l=this.forceTokenRefresh_;this.forceTokenRefresh_=!1;try{let[a,u]=await Promise.all([this.authTokenProvider_.getToken(l),this.appCheckTokenProvider_.getToken(l)]);s?ex("getToken() completed but was canceled"):(ex("getToken() completed. Creating connection."),this.authToken_=a&&a.accessToken,this.appCheckToken_=u&&u.token,o=new ts(r,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,e,t,n,e=>{eP(e+" ("+this.repoInfo_.toString()+")"),this.interrupt("server_kill")},i))}catch(e){this.log_("Failed to get token: "+e),s||(this.repoInfo_.nodeAdmin&&eP(e),a())}}}interrupt(e){ex("Interrupting connection for reason: "+e),this.interruptReasons_[e]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())}resume(e){ex("Resuming connection for reason: "+e),delete this.interruptReasons_[e],(0,b.xb)(this.interruptReasons_)&&(this.reconnectDelay_=1e3,this.realtime_||this.scheduleConnect_(0))}handleTimestamp_(e){let t=e-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:t})}cancelSentTransactions_(){for(let e=0;e<this.outstandingPuts_.length;e++){let t=this.outstandingPuts_[e];t&&"h"in t.request&&t.queued&&(t.onComplete&&t.onComplete("disconnect"),delete this.outstandingPuts_[e],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])}onListenRevoked_(e,t){let n;n=t?t.map(e=>ej(e)).join("$"):"default";let r=this.removeListen_(e,n);r&&r.onComplete&&r.onComplete("permission_denied")}removeListen_(e,t){let n;let r=new tu(e).toString();if(this.listens.has(r)){let e=this.listens.get(r);n=e.get(t),e.delete(t),0===e.size&&this.listens.delete(r)}else n=void 0;return n}onAuthRevoked_(e,t){ex("Auth token revoked: "+e+"/"+t),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),("invalid_token"===e||"permission_denied"===e)&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken()))}onAppCheckRevoked_(e,t){ex("App check token revoked: "+e+"/"+t),this.appCheckToken_=null,this.forceTokenRefresh_=!0,("invalid_token"===e||"permission_denied"===e)&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=3&&this.appCheckTokenProvider_.notifyForInvalidToken())}onSecurityDebugPacket_(e){this.securityDebugCallback_?this.securityDebugCallback_(e):"msg"in e&&console.log("FIREBASE: "+e.msg.replace("\n","\nFIREBASE: "))}restoreState_(){for(let e of(this.tryAuth(),this.tryAppCheck(),this.listens.values()))for(let t of e.values())this.sendListen_(t);for(let e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){let e=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(e.action,e.pathString,e.data,e.onComplete)}for(let e=0;e<this.outstandingGets_.length;e++)this.outstandingGets_[e]&&this.sendGet_(e)}sendConnectStats_(){let e={},t="js";(0,b.Yr)()&&(t=this.repoInfo_.nodeAdmin?"admin_node":"node"),e["sdk."+t+"."+eg.replace(/\./g,"-")]=1,(0,b.uI)()?e["framework.cordova"]=1:(0,b.b$)()&&(e["framework.reactnative"]=1),this.reportStats(e)}shouldReconnect_(){let e=tl.getInstance().currentlyOnline();return(0,b.xb)(this.interruptReasons_)&&e}}tk.nextPersistentConnectionId_=0,tk.nextConnectionId_=0;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(e,t){this.name=e,this.node=t}static Wrap(e,t){return new tx(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tA{getCompare(){return this.compare.bind(this)}indexedValueChanged(e,t){let n=new tx(eL,e),r=new tx(eL,t);return 0!==this.compare(n,r)}minPost(){return tx.MIN}}class tR extends tA{static get __EMPTY_NODE(){return r}static set __EMPTY_NODE(e){r=e}compare(e,t){return eU(e.name,t.name)}isDefinedOn(e){throw(0,b.g5)("KeyIndex.isDefinedOn not expected to be called.")}indexedValueChanged(e,t){return!1}minPost(){return tx.MIN}maxPost(){return new tx(eM,r)}makePost(e,t){return(0,b.hu)("string"==typeof e,"KeyIndex indexValue must always be a string."),new tx(e,r)}toString(){return".key"}}let tN=new tR;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tP{constructor(e,t,n,r,i=null){this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,r&&(s*=-1),s<0)e=this.isReverse_?e.left:e.right;else if(0===s){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),e=this.isReverse_?e.right:e.left}getNext(){let e;if(0===this.nodeStack_.length)return null;let t=this.nodeStack_.pop();if(e=this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value},this.isReverse_)for(t=t.left;!t.isEmpty();)this.nodeStack_.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack_.push(t),t=t.left;return e}hasNext(){return this.nodeStack_.length>0}peek(){if(0===this.nodeStack_.length)return null;let e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}}}class tD{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:tD.RED,this.left=null!=r?r:tO.EMPTY_NODE,this.right=null!=i?i:tO.EMPTY_NODE}copy(e,t,n,r,i){return new tD(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}count(){return this.left.count()+1+this.right.count()}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min_(){return this.left.isEmpty()?this:this.left.min_()}minKey(){return this.min_().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp_()}removeMin_(){if(this.left.isEmpty())return tO.EMPTY_NODE;let e=this;return e.left.isRed_()||e.left.left.isRed_()||(e=e.moveRedLeft_()),(e=e.copy(null,null,null,e.left.removeMin_(),null)).fixUp_()}remove(e,t){let n,r;if(n=this,0>t(e,n.key))n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(e,t),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===t(e,n.key)){if(n.right.isEmpty())return tO.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(e,t))}return n.fixUp_()}isRed_(){return this.color}fixUp_(){let e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e}moveRedLeft_(){let e=this.colorFlip_();return e.right.left.isRed_()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight_())).rotateLeft_()).colorFlip_()),e}moveRedRight_(){let e=this.colorFlip_();return e.left.left.isRed_()&&(e=(e=e.rotateRight_()).colorFlip_()),e}rotateLeft_(){let e=this.copy(null,null,tD.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight_(){let e=this.copy(null,null,tD.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip_(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth_(){let e=this.check_();return Math.pow(2,e)<=this.count()+1}check_(){if(this.isRed_()&&this.left.isRed_())throw Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw Error("Right child of ("+this.key+","+this.value+") is red");let e=this.left.check_();if(e===this.right.check_())return e+(this.isRed_()?0:1);throw Error("Black depths differ")}}tD.RED=!0,tD.BLACK=!1;class tO{constructor(e,t=tO.EMPTY_NODE){this.comparator_=e,this.root_=t}insert(e,t){return new tO(this.comparator_,this.root_.insert(e,t,this.comparator_).copy(null,null,tD.BLACK,null,null))}remove(e){return new tO(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,tD.BLACK,null,null))}get(e){let t;let n=this.root_;for(;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key)))return n.value;t<0?n=n.left:t>0&&(n=n.right)}return null}getPredecessorKey(e){let t,n=this.root_,r=null;for(;!n.isEmpty();){if(0===(t=this.comparator_(e,n.key))){if(n.left.isEmpty()){if(r)return r.key;return null}for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}t<0?n=n.left:t>0&&(r=n,n=n.right)}throw Error("Attempted to find predecessor key for a nonexistent key.  What gives?")}isEmpty(){return this.root_.isEmpty()}count(){return this.root_.count()}minKey(){return this.root_.minKey()}maxKey(){return this.root_.maxKey()}inorderTraversal(e){return this.root_.inorderTraversal(e)}reverseTraversal(e){return this.root_.reverseTraversal(e)}getIterator(e){return new tP(this.root_,null,this.comparator_,!1,e)}getIteratorFrom(e,t){return new tP(this.root_,e,this.comparator_,!1,t)}getReverseIteratorFrom(e,t){return new tP(this.root_,e,this.comparator_,!0,t)}getReverseIterator(e){return new tP(this.root_,null,this.comparator_,!0,e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tF(e,t){return eU(e.name,t.name)}function tL(e,t){return eU(e,t)}tO.EMPTY_NODE=new class{copy(e,t,n,r,i){return this}insert(e,t,n){return new tD(e,t,null)}remove(e,t){return this}count(){return 0}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}check_(){return 0}isRed_(){return!1}};let tM=function(e){return"number"==typeof e?"number:"+e$(e):"string:"+e},tU=function(e){if(e.isLeafNode()){let t=e.val();(0,b.hu)("string"==typeof t||"number"==typeof t||"object"==typeof t&&(0,b.r3)(t,".sv"),"Priority must be a string or number.")}else(0,b.hu)(e===i||e.isEmpty(),"priority of unexpected type.");(0,b.hu)(e===i||e.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};class tV{constructor(e,t=tV.__childrenNodeConstructor.EMPTY_NODE){this.value_=e,this.priorityNode_=t,this.lazyHash_=null,(0,b.hu)(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),tU(this.priorityNode_)}static set __childrenNodeConstructor(e){s=e}static get __childrenNodeConstructor(){return s}isLeafNode(){return!0}getPriority(){return this.priorityNode_}updatePriority(e){return new tV(this.value_,e)}getImmediateChild(e){return".priority"===e?this.priorityNode_:tV.__childrenNodeConstructor.EMPTY_NODE}getChild(e){return tv(e)?this:".priority"===th(e)?this.priorityNode_:tV.__childrenNodeConstructor.EMPTY_NODE}hasChild(){return!1}getPredecessorChildName(e,t){return null}updateImmediateChild(e,t){return".priority"===e?this.updatePriority(t):t.isEmpty()&&".priority"!==e?this:tV.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,t).updatePriority(this.priorityNode_)}updateChild(e,t){let n=th(e);return null===n?t:t.isEmpty()&&".priority"!==n?this:((0,b.hu)(".priority"!==n||1===td(e),".priority must be the last token in a path"),this.updateImmediateChild(n,tV.__childrenNodeConstructor.EMPTY_NODE.updateChild(tf(e),t)))}isEmpty(){return!1}numChildren(){return 0}forEachChild(e,t){return!1}val(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()}hash(){if(null===this.lazyHash_){let e="";this.priorityNode_.isEmpty()||(e+="priority:"+tM(this.priorityNode_.val())+":");let t=typeof this.value_;e+=t+":","number"===t?e+=e$(this.value_):e+=this.value_,this.lazyHash_=eT(e)}return this.lazyHash_}getValue(){return this.value_}compareTo(e){return e===tV.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof tV.__childrenNodeConstructor?-1:((0,b.hu)(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))}compareToLeafNode_(e){let t=typeof e.value_,n=typeof this.value_,r=tV.VALUE_TYPE_ORDER.indexOf(t),i=tV.VALUE_TYPE_ORDER.indexOf(n);return((0,b.hu)(r>=0,"Unknown leaf type: "+t),(0,b.hu)(i>=0,"Unknown leaf type: "+n),r!==i)?i-r:"object"===n?0:this.value_<e.value_?-1:this.value_===e.value_?0:1}withIndex(){return this}isIndexed(){return!0}equals(e){return e===this||!!e.isLeafNode()&&this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}}tV.VALUE_TYPE_ORDER=["object","boolean","number","string"];let tq=new class extends tA{compare(e,t){let n=e.node.getPriority(),r=t.node.getPriority(),i=n.compareTo(r);return 0===i?eU(e.name,t.name):i}isDefinedOn(e){return!e.getPriority().isEmpty()}indexedValueChanged(e,t){return!e.getPriority().equals(t.getPriority())}minPost(){return tx.MIN}maxPost(){return new tx(eM,new tV("[PRIORITY-POST]",a))}makePost(e,t){let n=o(e);return new tx(t,new tV("[PRIORITY-POST]",n))}toString(){return".priority"}},tj=Math.log(2);class tB{constructor(e){this.count=parseInt(Math.log(e+1)/tj,10),this.current_=this.count-1;let t=parseInt(Array(this.count+1).join("1"),2);this.bits_=e+1&t}nextBitIsOne(){let e=!(this.bits_&1<<this.current_);return this.current_--,e}}let tz=function(e,t,n,r){e.sort(t);let i=function(t,r){let s,o;let a=r-t;if(0===a)return null;if(1===a)return s=e[t],o=n?n(s):s,new tD(o,s.node,tD.BLACK,null,null);{let l=parseInt(a/2,10)+t,u=i(t,l),c=i(l+1,r);return s=e[l],o=n?n(s):s,new tD(o,s.node,tD.BLACK,u,c)}},s=new tB(e.length),o=function(t){let r=null,s=null,o=e.length,a=function(t,r){let s=o-t,a=o;o-=t;let u=i(s+1,a),c=e[s],h=n?n(c):c;l(new tD(h,c.node,r,null,u))},l=function(e){r?(r.left=e,r=e):(s=e,r=e)};for(let e=0;e<t.count;++e){let n=t.nextBitIsOne(),r=Math.pow(2,t.count-(e+1));n?a(r,tD.BLACK):(a(r,tD.BLACK),a(r,tD.RED))}return s}(s);return new tO(r||t,o)},t$={};class tH{constructor(e,t){this.indexes_=e,this.indexSet_=t}static get Default(){return(0,b.hu)(t$&&tq,"ChildrenNode.ts has not been loaded"),l=l||new tH({".priority":t$},{".priority":tq})}get(e){let t=(0,b.DV)(this.indexes_,e);if(!t)throw Error("No index defined for "+e);return t instanceof tO?t:null}hasIndex(e){return(0,b.r3)(this.indexSet_,e.toString())}addIndex(e,t){let n;(0,b.hu)(e!==tN,"KeyIndex always exists and isn't meant to be added to the IndexMap.");let r=[],i=!1,s=t.getIterator(tx.Wrap),o=s.getNext();for(;o;)i=i||e.isDefinedOn(o.node),r.push(o),o=s.getNext();n=i?tz(r,e.getCompare()):t$;let a=e.toString(),l=Object.assign({},this.indexSet_);l[a]=e;let u=Object.assign({},this.indexes_);return u[a]=n,new tH(u,l)}addToIndexes(e,t){let n=(0,b.UI)(this.indexes_,(n,r)=>{let i=(0,b.DV)(this.indexSet_,r);if((0,b.hu)(i,"Missing index implementation for "+r),n===t$){if(!i.isDefinedOn(e.node))return t$;{let n=[],r=t.getIterator(tx.Wrap),s=r.getNext();for(;s;)s.name!==e.name&&n.push(s),s=r.getNext();return n.push(e),tz(n,i.getCompare())}}{let r=t.get(e.name),i=n;return r&&(i=i.remove(new tx(e.name,r))),i.insert(e,e.node)}});return new tH(n,this.indexSet_)}removeFromIndexes(e,t){let n=(0,b.UI)(this.indexes_,n=>{if(n===t$)return n;{let r=t.get(e.name);return r?n.remove(new tx(e.name,r)):n}});return new tH(n,this.indexSet_)}}class tW{constructor(e,t,n){this.children_=e,this.priorityNode_=t,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&tU(this.priorityNode_),this.children_.isEmpty()&&(0,b.hu)(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}static get EMPTY_NODE(){return u||(u=new tW(new tO(tL),null,tH.Default))}isLeafNode(){return!1}getPriority(){return this.priorityNode_||u}updatePriority(e){return this.children_.isEmpty()?this:new tW(this.children_,e,this.indexMap_)}getImmediateChild(e){if(".priority"===e)return this.getPriority();{let t=this.children_.get(e);return null===t?u:t}}getChild(e){let t=th(e);return null===t?this:this.getImmediateChild(t).getChild(tf(e))}hasChild(e){return null!==this.children_.get(e)}updateImmediateChild(e,t){if((0,b.hu)(t,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(t);{let n,r;let i=new tx(e,t);t.isEmpty()?(n=this.children_.remove(e),r=this.indexMap_.removeFromIndexes(i,this.children_)):(n=this.children_.insert(e,t),r=this.indexMap_.addToIndexes(i,this.children_));let s=n.isEmpty()?u:this.priorityNode_;return new tW(n,s,r)}}updateChild(e,t){let n=th(e);if(null===n)return t;{(0,b.hu)(".priority"!==th(e)||1===td(e),".priority must be the last token in a path");let r=this.getImmediateChild(n).updateChild(tf(e),t);return this.updateImmediateChild(n,r)}}isEmpty(){return this.children_.isEmpty()}numChildren(){return this.children_.count()}val(e){if(this.isEmpty())return null;let t={},n=0,r=0,i=!0;if(this.forEachChild(tq,(s,o)=>{t[s]=o.val(e),n++,i&&tW.INTEGER_REGEXP_.test(s)?r=Math.max(r,Number(s)):i=!1}),e||!i||!(r<2*n))return e&&!this.getPriority().isEmpty()&&(t[".priority"]=this.getPriority().val()),t;{let e=[];for(let n in t)e[n]=t[n];return e}}hash(){if(null===this.lazyHash_){let e="";this.getPriority().isEmpty()||(e+="priority:"+tM(this.getPriority().val())+":"),this.forEachChild(tq,(t,n)=>{let r=n.hash();""!==r&&(e+=":"+t+":"+r)}),this.lazyHash_=""===e?"":eT(e)}return this.lazyHash_}getPredecessorChildName(e,t,n){let r=this.resolveIndex_(n);if(!r)return this.children_.getPredecessorKey(e);{let n=r.getPredecessorKey(new tx(e,t));return n?n.name:null}}getFirstChildName(e){let t=this.resolveIndex_(e);if(!t)return this.children_.minKey();{let e=t.minKey();return e&&e.name}}getFirstChild(e){let t=this.getFirstChildName(e);return t?new tx(t,this.children_.get(t)):null}getLastChildName(e){let t=this.resolveIndex_(e);if(!t)return this.children_.maxKey();{let e=t.maxKey();return e&&e.name}}getLastChild(e){let t=this.getLastChildName(e);return t?new tx(t,this.children_.get(t)):null}forEachChild(e,t){let n=this.resolveIndex_(e);return n?n.inorderTraversal(e=>t(e.name,e.node)):this.children_.inorderTraversal(t)}getIterator(e){return this.getIteratorFrom(e.minPost(),e)}getIteratorFrom(e,t){let n=this.resolveIndex_(t);if(n)return n.getIteratorFrom(e,e=>e);{let n=this.children_.getIteratorFrom(e.name,tx.Wrap),r=n.peek();for(;null!=r&&0>t.compare(r,e);)n.getNext(),r=n.peek();return n}}getReverseIterator(e){return this.getReverseIteratorFrom(e.maxPost(),e)}getReverseIteratorFrom(e,t){let n=this.resolveIndex_(t);if(n)return n.getReverseIteratorFrom(e,e=>e);{let n=this.children_.getReverseIteratorFrom(e.name,tx.Wrap),r=n.peek();for(;null!=r&&t.compare(r,e)>0;)n.getNext(),r=n.peek();return n}}compareTo(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===tG?-1:0}withIndex(e){if(e===tN||this.indexMap_.hasIndex(e))return this;{let t=this.indexMap_.addIndex(e,this.children_);return new tW(this.children_,this.priorityNode_,t)}}isIndexed(e){return e===tN||this.indexMap_.hasIndex(e)}equals(e){if(e===this)return!0;if(e.isLeafNode()||!this.getPriority().equals(e.getPriority())||this.children_.count()!==e.children_.count())return!1;{let t=this.getIterator(tq),n=e.getIterator(tq),r=t.getNext(),i=n.getNext();for(;r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=t.getNext(),i=n.getNext()}return null===r&&null===i}}resolveIndex_(e){return e===tN?null:this.indexMap_.get(e.toString())}}tW.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/;let tG=new class extends tW{constructor(){super(new tO(tL),tW.EMPTY_NODE,tH.Default)}compareTo(e){return e===this?0:1}equals(e){return e===this}getPriority(){return this}getImmediateChild(e){return tW.EMPTY_NODE}isEmpty(){return!1}};function tK(e,t=null){if(null===e)return tW.EMPTY_NODE;if("object"==typeof e&&".priority"in e&&(t=e[".priority"]),(0,b.hu)(null===t||"string"==typeof t||"number"==typeof t||"object"==typeof t&&".sv"in t,"Invalid priority type found: "+typeof t),"object"==typeof e&&".value"in e&&null!==e[".value"]&&(e=e[".value"]),"object"!=typeof e||".sv"in e){let n=e;return new tV(n,tK(t))}if(e instanceof Array){let n=tW.EMPTY_NODE;return ez(e,(t,r)=>{if((0,b.r3)(e,t)&&"."!==t.substring(0,1)){let e=tK(r);(e.isLeafNode()||!e.isEmpty())&&(n=n.updateImmediateChild(t,e))}}),n.updatePriority(tK(t))}{let n=[],r=!1,i=e;if(ez(i,(e,t)=>{if("."!==e.substring(0,1)){let i=tK(t);i.isEmpty()||(r=r||!i.getPriority().isEmpty(),n.push(new tx(e,i)))}}),0===n.length)return tW.EMPTY_NODE;let s=tz(n,tF,e=>e.name,tL);if(!r)return new tW(s,tK(t),tH.Default);{let e=tz(n,tq.getCompare());return new tW(s,tK(t),new tH({".priority":e},{".priority":tq}))}}}Object.defineProperties(tx,{MIN:{value:new tx(eL,tW.EMPTY_NODE)},MAX:{value:new tx(eM,tG)}}),tR.__EMPTY_NODE=tW.EMPTY_NODE,tV.__childrenNodeConstructor=tW,i=tG,a=tG,o=tK;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tZ extends tA{constructor(e){super(),this.indexPath_=e,(0,b.hu)(!tv(e)&&".priority"!==th(e),"Can't create PathIndex with empty path or .priority key")}extractChild(e){return e.getChild(this.indexPath_)}isDefinedOn(e){return!e.getChild(this.indexPath_).isEmpty()}compare(e,t){let n=this.extractChild(e.node),r=this.extractChild(t.node),i=n.compareTo(r);return 0===i?eU(e.name,t.name):i}makePost(e,t){let n=tK(e),r=tW.EMPTY_NODE.updateChild(this.indexPath_,n);return new tx(t,r)}maxPost(){let e=tW.EMPTY_NODE.updateChild(this.indexPath_,tG);return new tx(eM,e)}toString(){return tg(this.indexPath_,0).join("/")}}let tQ=new /**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class extends tA{compare(e,t){let n=e.node.compareTo(t.node);return 0===n?eU(e.name,t.name):n}isDefinedOn(e){return!0}indexedValueChanged(e,t){return!e.equals(t)}minPost(){return tx.MIN}maxPost(){return tx.MAX}makePost(e,t){let n=tK(e);return new tx(t,n)}toString(){return".value"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tY(e){return{type:"value",snapshotNode:e}}function tX(e,t){return{type:"child_added",snapshotNode:t,childName:e}}function tJ(e,t){return{type:"child_removed",snapshotNode:t,childName:e}}function t0(e,t,n){return{type:"child_changed",snapshotNode:t,childName:e,oldSnap:n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t1{constructor(e){this.index_=e}updateChild(e,t,n,r,i,s){(0,b.hu)(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");let o=e.getImmediateChild(t);return o.getChild(r).equals(n.getChild(r))&&o.isEmpty()===n.isEmpty()?e:(null!=s&&(n.isEmpty()?e.hasChild(t)?s.trackChildChange(tJ(t,o)):(0,b.hu)(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):o.isEmpty()?s.trackChildChange(tX(t,n)):s.trackChildChange(t0(t,n,o))),e.isLeafNode()&&n.isEmpty())?e:e.updateImmediateChild(t,n).withIndex(this.index_)}updateFullNode(e,t,n){return null==n||(e.isLeafNode()||e.forEachChild(tq,(e,r)=>{t.hasChild(e)||n.trackChildChange(tJ(e,r))}),t.isLeafNode()||t.forEachChild(tq,(t,r)=>{if(e.hasChild(t)){let i=e.getImmediateChild(t);i.equals(r)||n.trackChildChange(t0(t,r,i))}else n.trackChildChange(tX(t,r))})),t.withIndex(this.index_)}updatePriority(e,t){return e.isEmpty()?tW.EMPTY_NODE:e.updatePriority(t)}filtersNodes(){return!1}getIndexedFilter(){return this}getIndex(){return this.index_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e){this.indexedFilter_=new t1(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t2.getStartPost_(e),this.endPost_=t2.getEndPost_(e),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}getStartPost(){return this.startPost_}getEndPost(){return this.endPost_}matches(e){let t=this.startIsInclusive_?0>=this.index_.compare(this.getStartPost(),e):0>this.index_.compare(this.getStartPost(),e),n=this.endIsInclusive_?0>=this.index_.compare(e,this.getEndPost()):0>this.index_.compare(e,this.getEndPost());return t&&n}updateChild(e,t,n,r,i,s){return this.matches(new tx(t,n))||(n=tW.EMPTY_NODE),this.indexedFilter_.updateChild(e,t,n,r,i,s)}updateFullNode(e,t,n){t.isLeafNode()&&(t=tW.EMPTY_NODE);let r=t.withIndex(this.index_);r=r.updatePriority(tW.EMPTY_NODE);let i=this;return t.forEachChild(tq,(e,t)=>{i.matches(new tx(e,t))||(r=r.updateImmediateChild(e,tW.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.indexedFilter_}getIndex(){return this.index_}static getStartPost_(e){if(!e.hasStart())return e.getIndex().minPost();{let t=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),t)}}static getEndPost_(e){if(!e.hasEnd())return e.getIndex().maxPost();{let t=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),t)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t4{constructor(e){this.withinDirectionalStart=e=>this.reverse_?this.withinEndPost(e):this.withinStartPost(e),this.withinDirectionalEnd=e=>this.reverse_?this.withinStartPost(e):this.withinEndPost(e),this.withinStartPost=e=>{let t=this.index_.compare(this.rangedFilter_.getStartPost(),e);return this.startIsInclusive_?t<=0:t<0},this.withinEndPost=e=>{let t=this.index_.compare(e,this.rangedFilter_.getEndPost());return this.endIsInclusive_?t<=0:t<0},this.rangedFilter_=new t2(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft(),this.startIsInclusive_=!e.startAfterSet_,this.endIsInclusive_=!e.endBeforeSet_}updateChild(e,t,n,r,i,s){return(this.rangedFilter_.matches(new tx(t,n))||(n=tW.EMPTY_NODE),e.getImmediateChild(t).equals(n))?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,t,n,r,i,s):this.fullLimitUpdateChild_(e,t,n,i,s)}updateFullNode(e,t,n){let r;if(t.isLeafNode()||t.isEmpty())r=tW.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<t.numChildren()&&t.isIndexed(this.index_)){let e;r=tW.EMPTY_NODE.withIndex(this.index_),e=this.reverse_?t.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):t.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);let n=0;for(;e.hasNext()&&n<this.limit_;){let t=e.getNext();if(this.withinDirectionalStart(t)){if(this.withinDirectionalEnd(t))r=r.updateImmediateChild(t.name,t.node),n++;else break}}}else{let e;r=(r=t.withIndex(this.index_)).updatePriority(tW.EMPTY_NODE),e=this.reverse_?r.getReverseIterator(this.index_):r.getIterator(this.index_);let n=0;for(;e.hasNext();){let t=e.getNext(),i=n<this.limit_&&this.withinDirectionalStart(t)&&this.withinDirectionalEnd(t);i?n++:r=r.updateImmediateChild(t.name,tW.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,r,n)}updatePriority(e,t){return e}filtersNodes(){return!0}getIndexedFilter(){return this.rangedFilter_.getIndexedFilter()}getIndex(){return this.index_}fullLimitUpdateChild_(e,t,n,r,i){let s;if(this.reverse_){let e=this.index_.getCompare();s=(t,n)=>e(n,t)}else s=this.index_.getCompare();(0,b.hu)(e.numChildren()===this.limit_,"");let o=new tx(t,n),a=this.reverse_?e.getFirstChild(this.index_):e.getLastChild(this.index_),l=this.rangedFilter_.matches(o);if(e.hasChild(t)){let u=e.getImmediateChild(t),c=r.getChildAfterChild(this.index_,a,this.reverse_);for(;null!=c&&(c.name===t||e.hasChild(c.name));)c=r.getChildAfterChild(this.index_,c,this.reverse_);let h=null==c?1:s(c,o),d=l&&!n.isEmpty()&&h>=0;if(d)return null!=i&&i.trackChildChange(t0(t,n,u)),e.updateImmediateChild(t,n);{null!=i&&i.trackChildChange(tJ(t,u));let n=e.updateImmediateChild(t,tW.EMPTY_NODE),r=null!=c&&this.rangedFilter_.matches(c);return r?(null!=i&&i.trackChildChange(tX(c.name,c.node)),n.updateImmediateChild(c.name,c.node)):n}}return n.isEmpty()?e:l&&s(a,o)>=0?(null!=i&&(i.trackChildChange(tJ(a.name,a.node)),i.trackChildChange(tX(t,n))),e.updateImmediateChild(t,n).updateImmediateChild(a.name,tW.EMPTY_NODE)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t9{constructor(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=tq}hasStart(){return this.startSet_}isViewFromLeft(){return""===this.viewFrom_?this.startSet_:"l"===this.viewFrom_}getIndexStartValue(){return(0,b.hu)(this.startSet_,"Only valid if start has been set"),this.indexStartValue_}getIndexStartName(){return((0,b.hu)(this.startSet_,"Only valid if start has been set"),this.startNameSet_)?this.indexStartName_:eL}hasEnd(){return this.endSet_}getIndexEndValue(){return(0,b.hu)(this.endSet_,"Only valid if end has been set"),this.indexEndValue_}getIndexEndName(){return((0,b.hu)(this.endSet_,"Only valid if end has been set"),this.endNameSet_)?this.indexEndName_:eM}hasLimit(){return this.limitSet_}hasAnchoredLimit(){return this.limitSet_&&""!==this.viewFrom_}getLimit(){return(0,b.hu)(this.limitSet_,"Only valid if limit has been set"),this.limit_}getIndex(){return this.index_}loadsAllData(){return!(this.startSet_||this.endSet_||this.limitSet_)}isDefault(){return this.loadsAllData()&&this.index_===tq}copy(){let e=new t9;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.startAfterSet_=this.startAfterSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.endBeforeSet_=this.endBeforeSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e}}function t5(e,t,n){let r=e.copy();return r.startSet_=!0,void 0===t&&(t=null),r.indexStartValue_=t,null!=n?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function t6(e,t,n){let r=e.copy();return r.endSet_=!0,void 0===t&&(t=null),r.indexEndValue_=t,void 0!==n?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function t3(e,t){let n=e.copy();return n.index_=t,n}function t8(e){let t;let n={};if(e.isDefault())return n;if(e.index_===tq?t="$priority":e.index_===tQ?t="$value":e.index_===tN?t="$key":((0,b.hu)(e.index_ instanceof tZ,"Unrecognized index type!"),t=e.index_.toString()),n.orderBy=(0,b.Wl)(t),e.startSet_){let t=e.startAfterSet_?"startAfter":"startAt";n[t]=(0,b.Wl)(e.indexStartValue_),e.startNameSet_&&(n[t]+=","+(0,b.Wl)(e.indexStartName_))}if(e.endSet_){let t=e.endBeforeSet_?"endBefore":"endAt";n[t]=(0,b.Wl)(e.indexEndValue_),e.endNameSet_&&(n[t]+=","+(0,b.Wl)(e.indexEndName_))}return e.limitSet_&&(e.isViewFromLeft()?n.limitToFirst=e.limit_:n.limitToLast=e.limit_),n}function t7(e){let t={};if(e.startSet_&&(t.sp=e.indexStartValue_,e.startNameSet_&&(t.sn=e.indexStartName_),t.sin=!e.startAfterSet_),e.endSet_&&(t.ep=e.indexEndValue_,e.endNameSet_&&(t.en=e.indexEndName_),t.ein=!e.endBeforeSet_),e.limitSet_){t.l=e.limit_;let n=e.viewFrom_;""===n&&(n=e.isViewFromLeft()?"l":"r"),t.vf=n}return e.index_!==tq&&(t.i=e.index_.toString()),t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ne extends to{constructor(e,t,n,r){super(),this.repoInfo_=e,this.onDataUpdate_=t,this.authTokenProvider_=n,this.appCheckTokenProvider_=r,this.log_=eA("p:rest:"),this.listens_={}}reportStats(e){throw Error("Method not implemented.")}static getListenId_(e,t){return void 0!==t?"tag$"+t:((0,b.hu)(e._queryParams.isDefault(),"should have a tag if it's not a default query."),e._path.toString())}listen(e,t,n,r){let i=e._path.toString();this.log_("Listen called for "+i+" "+e._queryIdentifier);let s=ne.getListenId_(e,n),o={};this.listens_[s]=o;let a=t8(e._queryParams);this.restRequest_(i+".json",a,(e,t)=>{let a=t;404===e&&(a=null,e=null),null===e&&this.onDataUpdate_(i,a,!1,n),(0,b.DV)(this.listens_,s)===o&&r(e?401===e?"permission_denied":"rest_error:"+e:"ok",null)})}unlisten(e,t){let n=ne.getListenId_(e,t);delete this.listens_[n]}get(e){let t=t8(e._queryParams),n=e._path.toString(),r=new b.BH;return this.restRequest_(n+".json",t,(e,t)=>{let i=t;404===e&&(i=null,e=null),null===e?(this.onDataUpdate_(n,i,!1,null),r.resolve(i)):r.reject(Error(i))}),r.promise}refreshAuthToken(e){}restRequest_(e,t={},n){return t.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(([r,i])=>{r&&r.accessToken&&(t.auth=r.accessToken),i&&i.token&&(t.ac=i.token);let s=(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host+e+"?ns="+this.repoInfo_.namespace+(0,b.xO)(t);this.log_("Sending REST request for "+s);let o=new XMLHttpRequest;o.onreadystatechange=()=>{if(n&&4===o.readyState){this.log_("REST Response for "+s+" received. status:",o.status,"response:",o.responseText);let e=null;if(o.status>=200&&o.status<300){try{e=(0,b.cI)(o.responseText)}catch(e){eP("Failed to parse JSON response for "+s+": "+o.responseText)}n(null,e)}else 401!==o.status&&404!==o.status&&eP("Got unsuccessful REST response for "+s+" Status: "+o.status),n(o.status);n=null}},o.open("GET",s,!0),o.send()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nt{constructor(){this.rootNode_=tW.EMPTY_NODE}getNode(e){return this.rootNode_.getChild(e)}updateSnapshot(e,t){this.rootNode_=this.rootNode_.updateChild(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nn(){return{value:null,children:new Map}}function nr(e,t,n){if(tv(t))e.value=n,e.children.clear();else if(null!==e.value)e.value=e.value.updateChild(t,n);else{let r=th(t);e.children.has(r)||e.children.set(r,nn());let i=e.children.get(r);nr(i,t=tf(t),n)}}function ni(e,t,n){null!==e.value?n(t,e.value):function(e,t){e.children.forEach((e,n)=>{t(n,e)})}(e,(e,r)=>{let i=new tu(t.toString()+"/"+e);ni(r,i,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ns{constructor(e){this.collection_=e,this.last_=null}get(){let e=this.collection_.get(),t=Object.assign({},e);return this.last_&&ez(this.last_,(e,n)=>{t[e]=t[e]-n}),this.last_=e,t}}class no{constructor(e,t){this.server_=t,this.statsToReport_={},this.statsListener_=new ns(e),eZ(this.reportStats_.bind(this),Math.floor(1e4+2e4*Math.random()))}reportStats_(){let e=this.statsListener_.get(),t={},n=!1;ez(e,(e,r)=>{r>0&&(0,b.r3)(this.statsToReport_,e)&&(t[e]=r,n=!0)}),n&&this.server_.reportStats(t),eZ(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))}}function na(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function nl(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function nu(e){return{fromUser:!1,fromServer:!0,queryId:e,tagged:!0}}(su=sc||(sc={}))[su.OVERWRITE=0]="OVERWRITE",su[su.MERGE=1]="MERGE",su[su.ACK_USER_WRITE=2]="ACK_USER_WRITE",su[su.LISTEN_COMPLETE=3]="LISTEN_COMPLETE";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,t,n){this.path=e,this.affectedTree=t,this.revert=n,this.type=sc.ACK_USER_WRITE,this.source=na()}operationForChild(e){if(!tv(this.path))return(0,b.hu)(th(this.path)===e,"operationForChild called for unrelated child."),new nc(tf(this.path),this.affectedTree,this.revert);if(null!=this.affectedTree.value)return(0,b.hu)(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;{let t=this.affectedTree.subtree(new tu(e));return new nc(tc(),t,this.revert)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nh{constructor(e,t){this.source=e,this.path=t,this.type=sc.LISTEN_COMPLETE}operationForChild(e){return tv(this.path)?new nh(this.source,tc()):new nh(this.source,tf(this.path))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e,t,n){this.source=e,this.path=t,this.snap=n,this.type=sc.OVERWRITE}operationForChild(e){return tv(this.path)?new nd(this.source,tc(),this.snap.getImmediateChild(e)):new nd(this.source,tf(this.path),this.snap)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,t,n){this.source=e,this.path=t,this.children=n,this.type=sc.MERGE}operationForChild(e){if(!tv(this.path))return(0,b.hu)(th(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new nf(this.source,tf(this.path),this.children);{let t=this.children.subtree(new tu(e));return t.isEmpty()?null:t.value?new nd(this.source,tc(),t.value):new nf(this.source,tc(),t)}}toString(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class np{constructor(e,t,n){this.node_=e,this.fullyInitialized_=t,this.filtered_=n}isFullyInitialized(){return this.fullyInitialized_}isFiltered(){return this.filtered_}isCompleteForPath(e){if(tv(e))return this.isFullyInitialized()&&!this.filtered_;let t=th(e);return this.isCompleteForChild(t)}isCompleteForChild(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)}getNode(){return this.node_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ng{constructor(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}}function nm(e,t,n,r,i,s){let o=r.filter(e=>e.type===n);o.sort((t,n)=>(function(e,t,n){if(null==t.childName||null==n.childName)throw(0,b.g5)("Should only compare child_ events.");let r=new tx(t.childName,t.snapshotNode),i=new tx(n.childName,n.snapshotNode);return e.index_.compare(r,i)})(e,t,n)),o.forEach(n=>{var r;let o=("value"===(r=n).type||"child_removed"===r.type||(r.prevName=s.getPredecessorChildName(r.childName,r.snapshotNode,e.index_)),r);i.forEach(r=>{r.respondsTo(n.type)&&t.push(r.createEvent(o,e.query_))})})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ny(e,t){return{eventCache:e,serverCache:t}}function nv(e,t,n,r){return ny(new np(t,n,r),e.serverCache)}function n_(e,t,n,r){return ny(e.eventCache,new np(t,n,r))}function nw(e){return e.eventCache.isFullyInitialized()?e.eventCache.getNode():null}function nb(e){return e.serverCache.isFullyInitialized()?e.serverCache.getNode():null}let nI=()=>(c||(c=new tO(eV)),c);class nT{constructor(e,t=nI()){this.value=e,this.children=t}static fromObject(e){let t=new nT(null);return ez(e,(e,n)=>{t=t.set(new tu(e),n)}),t}isEmpty(){return null===this.value&&this.children.isEmpty()}findRootMostMatchingPathAndValue(e,t){if(null!=this.value&&t(this.value))return{path:tc(),value:this.value};if(tv(e))return null;{let n=th(e),r=this.children.get(n);if(null===r)return null;{let i=r.findRootMostMatchingPathAndValue(tf(e),t);if(null==i)return null;{let e=ty(new tu(n),i.path);return{path:e,value:i.value}}}}}findRootMostValueAndPath(e){return this.findRootMostMatchingPathAndValue(e,()=>!0)}subtree(e){if(tv(e))return this;{let t=th(e),n=this.children.get(t);return null!==n?n.subtree(tf(e)):new nT(null)}}set(e,t){if(tv(e))return new nT(t,this.children);{let n=th(e),r=this.children.get(n)||new nT(null),i=r.set(tf(e),t),s=this.children.insert(n,i);return new nT(this.value,s)}}remove(e){if(tv(e))return this.children.isEmpty()?new nT(null):new nT(null,this.children);{let t=th(e),n=this.children.get(t);if(!n)return this;{let r;let i=n.remove(tf(e));return(r=i.isEmpty()?this.children.remove(t):this.children.insert(t,i),null===this.value&&r.isEmpty())?new nT(null):new nT(this.value,r)}}}get(e){if(tv(e))return this.value;{let t=th(e),n=this.children.get(t);return n?n.get(tf(e)):null}}setTree(e,t){if(tv(e))return t;{let n;let r=th(e),i=this.children.get(r)||new nT(null),s=i.setTree(tf(e),t);return n=s.isEmpty()?this.children.remove(r):this.children.insert(r,s),new nT(this.value,n)}}fold(e){return this.fold_(tc(),e)}fold_(e,t){let n={};return this.children.inorderTraversal((r,i)=>{n[r]=i.fold_(ty(e,r),t)}),t(e,this.value,n)}findOnPath(e,t){return this.findOnPath_(e,tc(),t)}findOnPath_(e,t,n){let r=!!this.value&&n(t,this.value);if(r)return r;if(tv(e))return null;{let r=th(e),i=this.children.get(r);return i?i.findOnPath_(tf(e),ty(t,r),n):null}}foreachOnPath(e,t){return this.foreachOnPath_(e,tc(),t)}foreachOnPath_(e,t,n){if(tv(e))return this;{this.value&&n(t,this.value);let r=th(e),i=this.children.get(r);return i?i.foreachOnPath_(tf(e),ty(t,r),n):new nT(null)}}foreach(e){this.foreach_(tc(),e)}foreach_(e,t){this.children.inorderTraversal((n,r)=>{r.foreach_(ty(e,n),t)}),this.value&&t(e,this.value)}foreachChild(e){this.children.inorderTraversal((t,n)=>{n.value&&e(t,n.value)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nE{constructor(e){this.writeTree_=e}static empty(){return new nE(new nT(null))}}function nC(e,t,n){if(tv(t))return new nE(new nT(n));{let r=e.writeTree_.findRootMostValueAndPath(t);if(null!=r){let i=r.path,s=r.value,o=t_(i,t);return s=s.updateChild(o,n),new nE(e.writeTree_.set(i,s))}{let r=new nT(n),i=e.writeTree_.setTree(t,r);return new nE(i)}}}function nS(e,t,n){let r=e;return ez(n,(e,n)=>{r=nC(r,ty(t,e),n)}),r}function nk(e,t){if(tv(t))return nE.empty();{let n=e.writeTree_.setTree(t,new nT(null));return new nE(n)}}function nx(e,t){return null!=nA(e,t)}function nA(e,t){let n=e.writeTree_.findRootMostValueAndPath(t);return null!=n?e.writeTree_.get(n.path).getChild(t_(n.path,t)):null}function nR(e){let t=[],n=e.writeTree_.value;return null!=n?n.isLeafNode()||n.forEachChild(tq,(e,n)=>{t.push(new tx(e,n))}):e.writeTree_.children.inorderTraversal((e,n)=>{null!=n.value&&t.push(new tx(e,n.value))}),t}function nN(e,t){if(tv(t))return e;{let n=nA(e,t);return new nE(null!=n?new nT(n):e.writeTree_.subtree(t))}}function nP(e){return e.writeTree_.isEmpty()}function nD(e,t){return function e(t,n,r){if(null!=n.value)return r.updateChild(t,n.value);{let i=null;return n.children.inorderTraversal((n,s)=>{".priority"===n?((0,b.hu)(null!==s.value,"Priority writes must always be leaf nodes"),i=s.value):r=e(ty(t,n),s,r)}),r.getChild(t).isEmpty()||null===i||(r=r.updateChild(ty(t,".priority"),i)),r}}(tc(),e.writeTree_,t)}function nO(e){return e.visible}function nF(e,t,n){let r=nE.empty();for(let i=0;i<e.length;++i){let s=e[i];if(t(s)){let e;let t=s.path;if(s.snap)tI(n,t)?r=nC(r,e=t_(n,t),s.snap):tI(t,n)&&(e=t_(t,n),r=nC(r,tc(),s.snap.getChild(e)));else if(s.children){if(tI(n,t))r=nS(r,e=t_(n,t),s.children);else if(tI(t,n)){if(tv(e=t_(t,n)))r=nS(r,tc(),s.children);else{let t=(0,b.DV)(s.children,th(e));if(t){let n=t.getChild(tf(e));r=nC(r,tc(),n)}}}}else throw(0,b.g5)("WriteRecord should have .snap or .children")}}return r}function nL(e,t,n,r,i){if(r||i){let s=nN(e.visibleWrites,t);if(!i&&nP(s))return n;if(!i&&null==n&&!nx(s,tc()))return null;{let s=nF(e.allWrites,function(e){return(e.visible||i)&&(!r||!~r.indexOf(e.writeId))&&(tI(e.path,t)||tI(t,e.path))},t),o=n||tW.EMPTY_NODE;return nD(s,o)}}{let r=nA(e.visibleWrites,t);if(null!=r)return r;{let r=nN(e.visibleWrites,t);if(nP(r))return n;if(null==n&&!nx(r,tc()))return null;{let e=n||tW.EMPTY_NODE;return nD(r,e)}}}}function nM(e,t,n,r){return nL(e.writeTree,e.treePath,t,n,r)}function nU(e,t){return function(e,t,n){let r=tW.EMPTY_NODE,i=nA(e.visibleWrites,t);if(i)return i.isLeafNode()||i.forEachChild(tq,(e,t)=>{r=r.updateImmediateChild(e,t)}),r;if(n){let i=nN(e.visibleWrites,t);return n.forEachChild(tq,(e,t)=>{let n=nD(nN(i,new tu(e)),t);r=r.updateImmediateChild(e,n)}),nR(i).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}{let n=nN(e.visibleWrites,t);return nR(n).forEach(e=>{r=r.updateImmediateChild(e.name,e.node)}),r}}(e.writeTree,e.treePath,t)}function nV(e,t,n,r){return function(e,t,n,r,i){(0,b.hu)(r||i,"Either existingEventSnap or existingServerSnap must exist");let s=ty(t,n);if(nx(e.visibleWrites,s))return null;{let t=nN(e.visibleWrites,s);return nP(t)?i.getChild(n):nD(t,i.getChild(n))}}(e.writeTree,e.treePath,t,n,r)}function nq(e,t){var n,r;return n=e.writeTree,r=ty(e.treePath,t),nA(n.visibleWrites,r)}function nj(e,t,n){return function(e,t,n,r){let i=ty(t,n),s=nA(e.visibleWrites,i);if(null!=s)return s;if(!r.isCompleteForChild(n))return null;{let t=nN(e.visibleWrites,i);return nD(t,r.getNode().getImmediateChild(n))}}(e.writeTree,e.treePath,t,n)}function nB(e,t){return nz(ty(e.treePath,t),e.writeTree)}function nz(e,t){return{treePath:e,writeTree:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n${constructor(){this.changeMap=new Map}trackChildChange(e){let t=e.type,n=e.childName;(0,b.hu)("child_added"===t||"child_changed"===t||"child_removed"===t,"Only child changes supported for tracking"),(0,b.hu)(".priority"!==n,"Only non-priority child changes can be tracked.");let r=this.changeMap.get(n);if(r){let i=r.type;if("child_added"===t&&"child_removed"===i)this.changeMap.set(n,t0(n,e.snapshotNode,r.snapshotNode));else if("child_removed"===t&&"child_added"===i)this.changeMap.delete(n);else if("child_removed"===t&&"child_changed"===i)this.changeMap.set(n,tJ(n,r.oldSnap));else if("child_changed"===t&&"child_added"===i)this.changeMap.set(n,tX(n,e.snapshotNode));else if("child_changed"===t&&"child_changed"===i)this.changeMap.set(n,t0(n,e.snapshotNode,r.oldSnap));else throw(0,b.g5)("Illegal combination of changes: "+e+" occurred after "+r)}else this.changeMap.set(n,e)}getChanges(){return Array.from(this.changeMap.values())}}let nH=new /**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class{getCompleteChild(e){return null}getChildAfterChild(e,t,n){return null}};class nW{constructor(e,t,n=null){this.writes_=e,this.viewCache_=t,this.optCompleteServerCache_=n}getCompleteChild(e){let t=this.viewCache_.eventCache;if(t.isCompleteForChild(e))return t.getNode().getImmediateChild(e);{let t=null!=this.optCompleteServerCache_?new np(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return nj(this.writes_,e,t)}}getChildAfterChild(e,t,n){var r;let i=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:nb(this.viewCache_),s=function(e,t,n,r,i,s,o){let a;let l=nN(e.visibleWrites,t),u=nA(l,tc());if(null!=u)a=u;else{if(null==n)return[];a=nD(l,n)}if((a=a.withIndex(o)).isEmpty()||a.isLeafNode())return[];{let e=[],t=o.getCompare(),n=s?a.getReverseIteratorFrom(r,o):a.getIteratorFrom(r,o),i=n.getNext();for(;i&&e.length<1;)0!==t(i,r)&&e.push(i),i=n.getNext();return e}}((r=this.writes_).writeTree,r.treePath,i,t,0,n,e);return 0===s.length?null:s[0]}}function nG(e,t,n,r,i,s){let o=t.eventCache;if(null!=nq(r,n))return t;{let a,l;if(tv(n)){if((0,b.hu)(t.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),t.serverCache.isFiltered()){let n=nb(t),i=n instanceof tW?n:tW.EMPTY_NODE,o=nU(r,i);a=e.filter.updateFullNode(t.eventCache.getNode(),o,s)}else{let n=nM(r,nb(t));a=e.filter.updateFullNode(t.eventCache.getNode(),n,s)}}else{let u=th(n);if(".priority"===u){(0,b.hu)(1===td(n),"Can't have a priority with additional path components");let i=o.getNode();l=t.serverCache.getNode();let s=nV(r,n,i,l);a=null!=s?e.filter.updatePriority(i,s):o.getNode()}else{let c;let h=tf(n);if(o.isCompleteForChild(u)){l=t.serverCache.getNode();let e=nV(r,n,o.getNode(),l);c=null!=e?o.getNode().getImmediateChild(u).updateChild(h,e):o.getNode().getImmediateChild(u)}else c=nj(r,u,t.serverCache);a=null!=c?e.filter.updateChild(o.getNode(),u,c,h,i,s):o.getNode()}}return nv(t,a,o.isFullyInitialized()||tv(n),e.filter.filtersNodes())}}function nK(e,t,n,r,i,s,o,a){let l;let u=t.serverCache,c=o?e.filter:e.filter.getIndexedFilter();if(tv(n))l=c.updateFullNode(u.getNode(),r,null);else if(c.filtersNodes()&&!u.isFiltered()){let e=u.getNode().updateChild(n,r);l=c.updateFullNode(u.getNode(),e,null)}else{let e=th(n);if(!u.isCompleteForPath(n)&&td(n)>1)return t;let i=tf(n),s=u.getNode().getImmediateChild(e),o=s.updateChild(i,r);l=".priority"===e?c.updatePriority(u.getNode(),o):c.updateChild(u.getNode(),e,o,i,nH,null)}let h=n_(t,l,u.isFullyInitialized()||tv(n),c.filtersNodes()),d=new nW(i,h,s);return nG(e,h,n,i,d,a)}function nZ(e,t,n,r,i,s,o){let a,l;let u=t.eventCache,c=new nW(i,t,s);if(tv(n))l=e.filter.updateFullNode(t.eventCache.getNode(),r,o),a=nv(t,l,!0,e.filter.filtersNodes());else{let i=th(n);if(".priority"===i)l=e.filter.updatePriority(t.eventCache.getNode(),r),a=nv(t,l,u.isFullyInitialized(),u.isFiltered());else{let s;let l=tf(n),h=u.getNode().getImmediateChild(i);if(tv(l))s=r;else{let e=c.getCompleteChild(i);s=null!=e?".priority"===tp(l)&&e.getChild(tm(l)).isEmpty()?e:e.updateChild(l,r):tW.EMPTY_NODE}if(h.equals(s))a=t;else{let n=e.filter.updateChild(u.getNode(),i,s,l,c,o);a=nv(t,n,u.isFullyInitialized(),e.filter.filtersNodes())}}}return a}function nQ(e,t){return e.eventCache.isCompleteForChild(t)}function nY(e,t,n){return n.foreach((e,n)=>{t=t.updateChild(e,n)}),t}function nX(e,t,n,r,i,s,o,a){let l;if(t.serverCache.getNode().isEmpty()&&!t.serverCache.isFullyInitialized())return t;let u=t;l=tv(n)?r:new nT(null).setTree(n,r);let c=t.serverCache.getNode();return l.children.inorderTraversal((n,r)=>{if(c.hasChild(n)){let l=t.serverCache.getNode().getImmediateChild(n),c=nY(e,l,r);u=nK(e,u,new tu(n),c,i,s,o,a)}}),l.children.inorderTraversal((n,r)=>{let l=!t.serverCache.isCompleteForChild(n)&&null===r.value;if(!c.hasChild(n)&&!l){let l=t.serverCache.getNode().getImmediateChild(n),c=nY(e,l,r);u=nK(e,u,new tu(n),c,i,s,o,a)}}),u}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nJ{constructor(e,t){this.query_=e,this.eventRegistrations_=[];let n=this.query_._queryParams,r=new t1(n.getIndex()),i=n.loadsAllData()?new t1(n.getIndex()):n.hasLimit()?new t4(n):new t2(n);this.processor_={filter:i};let s=t.serverCache,o=t.eventCache,a=r.updateFullNode(tW.EMPTY_NODE,s.getNode(),null),l=i.updateFullNode(tW.EMPTY_NODE,o.getNode(),null),u=new np(a,s.isFullyInitialized(),r.filtersNodes()),c=new np(l,o.isFullyInitialized(),i.filtersNodes());this.viewCache_=ny(c,u),this.eventGenerator_=new ng(this.query_)}get query(){return this.query_}}function n0(e){return 0===e.eventRegistrations_.length}function n1(e,t,n){let r=[];if(n){(0,b.hu)(null==t,"A cancel should cancel all event registrations.");let i=e.query._path;e.eventRegistrations_.forEach(e=>{let t=e.createCancelEvent(n,i);t&&r.push(t)})}if(t){let n=[];for(let r=0;r<e.eventRegistrations_.length;++r){let i=e.eventRegistrations_[r];if(i.matches(t)){if(t.hasAnyCallback()){n=n.concat(e.eventRegistrations_.slice(r+1));break}}else n.push(i)}e.eventRegistrations_=n}else e.eventRegistrations_=[];return r}function n2(e,t,n,r){var i,s;t.type===sc.MERGE&&null!==t.source.queryId&&((0,b.hu)(nb(e.viewCache_),"We should always have a full cache before handling merges"),(0,b.hu)(nw(e.viewCache_),"Missing event cache, even though we have a server cache"));let o=e.viewCache_,a=function(e,t,n,r,i){let s,o;let a=new n$;if(n.type===sc.OVERWRITE)n.source.fromUser?s=nZ(e,t,n.path,n.snap,r,i,a):((0,b.hu)(n.source.fromServer,"Unknown source."),o=n.source.tagged||t.serverCache.isFiltered()&&!tv(n.path),s=nK(e,t,n.path,n.snap,r,i,o,a));else if(n.type===sc.MERGE){var l,u;let c;n.source.fromUser?(l=n.path,u=n.children,c=t,u.foreach((n,s)=>{let o=ty(l,n);nQ(t,th(o))&&(c=nZ(e,c,o,s,r,i,a))}),u.foreach((n,s)=>{let o=ty(l,n);nQ(t,th(o))||(c=nZ(e,c,o,s,r,i,a))}),s=c):((0,b.hu)(n.source.fromServer,"Unknown source."),o=n.source.tagged||t.serverCache.isFiltered(),s=nX(e,t,n.path,n.children,r,i,o,a))}else if(n.type===sc.ACK_USER_WRITE)s=n.revert?function(e,t,n,r,i,s){let o;if(null!=nq(r,n))return t;{let a;let l=new nW(r,t,i),u=t.eventCache.getNode();if(tv(n)||".priority"===th(n)){let n;if(t.serverCache.isFullyInitialized())n=nM(r,nb(t));else{let e=t.serverCache.getNode();(0,b.hu)(e instanceof tW,"serverChildren would be complete if leaf node"),n=nU(r,e)}a=e.filter.updateFullNode(u,n,s)}else{let i=th(n),c=nj(r,i,t.serverCache);null==c&&t.serverCache.isCompleteForChild(i)&&(c=u.getImmediateChild(i)),(a=null!=c?e.filter.updateChild(u,i,c,tf(n),l,s):t.eventCache.getNode().hasChild(i)?e.filter.updateChild(u,i,tW.EMPTY_NODE,tf(n),l,s):u).isEmpty()&&t.serverCache.isFullyInitialized()&&(o=nM(r,nb(t))).isLeafNode()&&(a=e.filter.updateFullNode(a,o,s))}return o=t.serverCache.isFullyInitialized()||null!=nq(r,tc()),nv(t,a,o,e.filter.filtersNodes())}}(e,t,n.path,r,i,a):function(e,t,n,r,i,s,o){if(null!=nq(i,n))return t;let a=t.serverCache.isFiltered(),l=t.serverCache;if(null!=r.value){if(tv(n)&&l.isFullyInitialized()||l.isCompleteForPath(n))return nK(e,t,n,l.getNode().getChild(n),i,s,a,o);if(!tv(n))return t;{let r=new nT(null);return l.getNode().forEachChild(tN,(e,t)=>{r=r.set(new tu(e),t)}),nX(e,t,n,r,i,s,a,o)}}{let u=new nT(null);return r.foreach((e,t)=>{let r=ty(n,e);l.isCompleteForPath(r)&&(u=u.set(e,l.getNode().getChild(r)))}),nX(e,t,n,u,i,s,a,o)}}(e,t,n.path,n.affectedTree,r,i,a);else if(n.type===sc.LISTEN_COMPLETE)s=function(e,t,n,r,i){let s=t.serverCache,o=n_(t,s.getNode(),s.isFullyInitialized()||tv(n),s.isFiltered());return nG(e,o,n,r,nH,i)}(e,t,n.path,r,a);else throw(0,b.g5)("Unknown operation type: "+n.type);let c=a.getChanges();return function(e,t,n){let r=t.eventCache;if(r.isFullyInitialized()){let i=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=nw(e);!(n.length>0)&&e.eventCache.isFullyInitialized()&&(!i||r.getNode().equals(s))&&r.getNode().getPriority().equals(s.getPriority())||n.push(tY(nw(t)))}}(t,s,c),{viewCache:s,changes:c}}(e.processor_,o,t,n,r);return i=e.processor_,s=a.viewCache,(0,b.hu)(s.eventCache.getNode().isIndexed(i.filter.getIndex()),"Event snap not indexed"),(0,b.hu)(s.serverCache.getNode().isIndexed(i.filter.getIndex()),"Server snap not indexed"),(0,b.hu)(a.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),e.viewCache_=a.viewCache,n4(e,a.changes,a.viewCache.eventCache.getNode(),null)}function n4(e,t,n,r){let i=r?[r]:e.eventRegistrations_;return function(e,t,n,r){let i=[],s=[];return t.forEach(t=>{if("child_changed"===t.type&&e.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)){var n;s.push((n=t.childName,{type:"child_moved",snapshotNode:t.snapshotNode,childName:n}))}}),nm(e,i,"child_removed",t,r,n),nm(e,i,"child_added",t,r,n),nm(e,i,"child_moved",s,r,n),nm(e,i,"child_changed",t,r,n),nm(e,i,"value",t,r,n),i}(e.eventGenerator_,t,n,i)}class n9{constructor(){this.views=new Map}}function n5(e,t,n,r){let i=t.source.queryId;if(null!==i){let s=e.views.get(i);return(0,b.hu)(null!=s,"SyncTree gave us an op for an invalid query."),n2(s,t,n,r)}{let i=[];for(let s of e.views.values())i=i.concat(n2(s,t,n,r));return i}}function n6(e,t,n,r,i){let s=t._queryIdentifier,o=e.views.get(s);if(!o){let e=nM(n,i?r:null),s=!1;e?s=!0:r instanceof tW?(e=nU(n,r),s=!1):(e=tW.EMPTY_NODE,s=!1);let o=ny(new np(e,s,!1),new np(r,i,!1));return new nJ(t,o)}return o}function n3(e){let t=[];for(let n of e.views.values())n.query._queryParams.loadsAllData()||t.push(n);return t}function n8(e,t){let n=null;for(let r of e.views.values())n=n||function(e,t){let n=nb(e.viewCache_);return n&&(e.query._queryParams.loadsAllData()||!tv(t)&&!n.getImmediateChild(th(t)).isEmpty())?n.getChild(t):null}(r,t);return n}function n7(e,t){let n=t._queryParams;if(n.loadsAllData())return rt(e);{let n=t._queryIdentifier;return e.views.get(n)}}function re(e){return null!=rt(e)}function rt(e){for(let t of e.views.values())if(t.query._queryParams.loadsAllData())return t;return null}let rn=1;class rr{constructor(e){this.listenProvider_=e,this.syncPointTree_=new nT(null),this.pendingWriteTree_={visibleWrites:nE.empty(),allWrites:[],lastWriteId:-1},this.tagToQueryMap=new Map,this.queryToTagMap=new Map}}function ri(e,t,n,r,i){var s,o;return(s=e.pendingWriteTree_,o=i,(0,b.hu)(r>s.lastWriteId,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),s.allWrites.push({path:t,snap:n,writeId:r,visible:o}),o&&(s.visibleWrites=nC(s.visibleWrites,t,n)),s.lastWriteId=r,i)?rh(e,new nd(na(),t,n)):[]}function rs(e,t,n=!1){let r=function(e,t){for(let n=0;n<e.allWrites.length;n++){let r=e.allWrites[n];if(r.writeId===t)return r}return null}(e.pendingWriteTree_,t),i=function(e,t){let n=e.allWrites.findIndex(e=>e.writeId===t);(0,b.hu)(n>=0,"removeWrite called with nonexistent writeId.");let r=e.allWrites[n];e.allWrites.splice(n,1);let i=r.visible,s=!1,o=e.allWrites.length-1;for(;i&&o>=0;){let t=e.allWrites[o];t.visible&&(o>=n&&function(e,t){if(e.snap)return tI(e.path,t);for(let n in e.children)if(e.children.hasOwnProperty(n)&&tI(ty(e.path,n),t))return!0;return!1}(t,r.path)?i=!1:tI(r.path,t.path)&&(s=!0)),o--}if(!i)return!1;if(s){var a;return(a=e).visibleWrites=nF(a.allWrites,nO,tc()),a.allWrites.length>0?a.lastWriteId=a.allWrites[a.allWrites.length-1].writeId:a.lastWriteId=-1,!0}if(r.snap)e.visibleWrites=nk(e.visibleWrites,r.path);else{let t=r.children;ez(t,t=>{e.visibleWrites=nk(e.visibleWrites,ty(r.path,t))})}return!0}(e.pendingWriteTree_,t);if(!i)return[];{let t=new nT(null);return null!=r.snap?t=t.set(tc(),!0):ez(r.children,e=>{t=t.set(new tu(e),!0)}),rh(e,new nc(r.path,t,n))}}function ro(e,t,n){return rh(e,new nd(nl(),t,n))}function ra(e,t,n,r,i=!1){let s=t._path,o=e.syncPointTree_.get(s),a=[];if(o&&("default"===t._queryIdentifier||null!=n7(o,t))){let l=function(e,t,n,r){let i=t._queryIdentifier,s=[],o=[],a=re(e);if("default"===i)for(let[t,i]of e.views.entries())o=o.concat(n1(i,n,r)),n0(i)&&(e.views.delete(t),i.query._queryParams.loadsAllData()||s.push(i.query));else{let t=e.views.get(i);t&&(o=o.concat(n1(t,n,r)),n0(t)&&(e.views.delete(i),t.query._queryParams.loadsAllData()||s.push(t.query)))}return a&&!re(e)&&s.push(new((0,b.hu)(h,"Reference.ts has not been loaded"),h)(t._repo,t._path)),{removed:s,events:o}}(o,t,n,r);0===o.views.size&&(e.syncPointTree_=e.syncPointTree_.remove(s));let u=l.removed;if(a=l.events,!i){let n=-1!==u.findIndex(e=>e._queryParams.loadsAllData()),i=e.syncPointTree_.findOnPath(s,(e,t)=>re(t));if(n&&!i){let t=e.syncPointTree_.subtree(s);if(!t.isEmpty()){let n=t.fold((e,t,n)=>{if(t&&re(t)){let e=rt(t);return[e]}{let e=[];return t&&(e=n3(t)),ez(n,(t,n)=>{e=e.concat(n)}),e}});for(let t=0;t<n.length;++t){let r=n[t],i=r.query,s=rd(e,r);e.listenProvider_.startListening(rv(i),rf(e,i),s.hashFn,s.onComplete)}}}i||!(u.length>0)||r||(n?e.listenProvider_.stopListening(rv(t),null):u.forEach(t=>{let n=e.queryToTagMap.get(rp(t));e.listenProvider_.stopListening(rv(t),n)}))}!function(e,t){for(let n=0;n<t.length;++n){let r=t[n];if(!r._queryParams.loadsAllData()){let t=rp(r),n=e.queryToTagMap.get(t);e.queryToTagMap.delete(t),e.tagToQueryMap.delete(n)}}}(e,u)}return a}function rl(e,t,n,r){let i=rg(e,r);if(null==i)return[];{let r=rm(i),s=r.path,o=r.queryId,a=t_(s,t),l=new nd(nu(o),a,n);return ry(e,s,l)}}function ru(e,t,n,r=!1){var i;let s;let o=t._path,a=null,l=!1;e.syncPointTree_.foreachOnPath(o,(e,t)=>{let n=t_(e,o);a=a||n8(t,n),l=l||re(t)});let u=e.syncPointTree_.get(o);if(u?(l=l||re(u),a=a||n8(u,tc())):(u=new n9,e.syncPointTree_=e.syncPointTree_.set(o,u)),null!=a)s=!0;else{s=!1,a=tW.EMPTY_NODE;let t=e.syncPointTree_.subtree(o);t.foreachChild((e,t)=>{let n=n8(t,tc());n&&(a=a.updateImmediateChild(e,n))})}let c=null!=n7(u,t);if(!c&&!t._queryParams.loadsAllData()){let n=rp(t);(0,b.hu)(!e.queryToTagMap.has(n),"View does not exist, but we have a tag");let r=rn++;e.queryToTagMap.set(n,r),e.tagToQueryMap.set(r,n)}let h=(i=e.pendingWriteTree_,nz(o,i)),d=function(e,t,n,r,i,s){let o=n6(e,t,r,i,s);return e.views.has(t._queryIdentifier)||e.views.set(t._queryIdentifier,o),!function(e,t){e.eventRegistrations_.push(t)}(o,n),function(e,t){let n=e.viewCache_.eventCache,r=[];if(!n.getNode().isLeafNode()){let e=n.getNode();e.forEachChild(tq,(e,t)=>{r.push(tX(e,t))})}return n.isFullyInitialized()&&r.push(tY(n.getNode())),n4(e,r,n.getNode(),t)}(o,n)}(u,t,n,h,a,s);if(!c&&!l&&!r){let n=n7(u,t);d=d.concat(function(e,t,n){let r=t._path,i=rf(e,t),s=rd(e,n),o=e.listenProvider_.startListening(rv(t),i,s.hashFn,s.onComplete),a=e.syncPointTree_.subtree(r);if(i)(0,b.hu)(!re(a.value),"If we're adding a query, it shouldn't be shadowed");else{let t=a.fold((e,t,n)=>{if(!tv(e)&&t&&re(t))return[rt(t).query];{let e=[];return t&&(e=e.concat(n3(t).map(e=>e.query))),ez(n,(t,n)=>{e=e.concat(n)}),e}});for(let n=0;n<t.length;++n){let r=t[n];e.listenProvider_.stopListening(rv(r),rf(e,r))}}return o}(e,t,n))}return d}function rc(e,t,n){let r=e.pendingWriteTree_,i=e.syncPointTree_.findOnPath(t,(e,n)=>{let r=t_(e,t),i=n8(n,r);if(i)return i});return nL(r,t,i,n,!0)}function rh(e,t){var n;return function e(t,n,r,i){if(tv(t.path))return function e(t,n,r,i){let s=n.get(tc());null==r&&null!=s&&(r=n8(s,tc()));let o=[];return n.children.inorderTraversal((n,s)=>{let a=r?r.getImmediateChild(n):null,l=nB(i,n),u=t.operationForChild(n);u&&(o=o.concat(e(u,s,a,l)))}),s&&(o=o.concat(n5(s,t,i,r))),o}(t,n,r,i);{let s=n.get(tc());null==r&&null!=s&&(r=n8(s,tc()));let o=[],a=th(t.path),l=t.operationForChild(a),u=n.children.get(a);if(u&&l){let t=r?r.getImmediateChild(a):null,n=nB(i,a);o=o.concat(e(l,u,t,n))}return s&&(o=o.concat(n5(s,t,i,r))),o}}(t,e.syncPointTree_,null,(n=e.pendingWriteTree_,nz(tc(),n)))}function rd(e,t){let n=t.query,r=rf(e,n);return{hashFn:()=>{let e=t.viewCache_.serverCache.getNode()||tW.EMPTY_NODE;return e.hash()},onComplete:t=>{if("ok"===t){var i;return r?function(e,t,n){let r=rg(e,n);if(!r)return[];{let n=rm(r),i=n.path,s=n.queryId,o=t_(i,t),a=new nh(nu(s),o);return ry(e,i,a)}}(e,n._path,r):(i=n._path,rh(e,new nh(nl(),i)))}{let r=function(e,t){let n="Unknown Error";"too_big"===e?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"===e?n="Client doesn't have permission to access the desired data.":"unavailable"===e&&(n="The service is unavailable");let r=Error(e+" at "+t._path.toString()+": "+n);return r.code=e.toUpperCase(),r}(t,n);return ra(e,n,null,r)}}}}function rf(e,t){let n=rp(t);return e.queryToTagMap.get(n)}function rp(e){return e._path.toString()+"$"+e._queryIdentifier}function rg(e,t){return e.tagToQueryMap.get(t)}function rm(e){let t=e.indexOf("$");return(0,b.hu)(-1!==t&&t<e.length-1,"Bad queryKey."),{queryId:e.substr(t+1),path:new tu(e.substr(0,t))}}function ry(e,t,n){let r=e.syncPointTree_.get(t);(0,b.hu)(r,"Missing sync point for query tag that we're tracking");let i=nz(t,e.pendingWriteTree_);return n5(r,n,i,null)}function rv(e){return e._queryParams.loadsAllData()&&!e._queryParams.isDefault()?new((0,b.hu)(d,"Reference.ts has not been loaded"),d)(e._repo,e._path):e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r_{constructor(e){this.node_=e}getImmediateChild(e){let t=this.node_.getImmediateChild(e);return new r_(t)}node(){return this.node_}}class rw{constructor(e,t){this.syncTree_=e,this.path_=t}getImmediateChild(e){let t=ty(this.path_,e);return new rw(this.syncTree_,t)}node(){return rc(this.syncTree_,this.path_)}}let rb=function(e,t,n){return e&&"object"==typeof e?((0,b.hu)(".sv"in e,"Unexpected leaf node or priority contents"),"string"==typeof e[".sv"])?rI(e[".sv"],t,n):"object"==typeof e[".sv"]?rT(e[".sv"],t):void(0,b.hu)(!1,"Unexpected server value: "+JSON.stringify(e,null,2)):e},rI=function(e,t,n){if("timestamp"===e)return n.timestamp;(0,b.hu)(!1,"Unexpected server value: "+e)},rT=function(e,t,n){e.hasOwnProperty("increment")||(0,b.hu)(!1,"Unexpected server value: "+JSON.stringify(e,null,2));let r=e.increment;"number"!=typeof r&&(0,b.hu)(!1,"Unexpected increment value: "+r);let i=t.node();if((0,b.hu)(null!=i,"Expected ChildrenNode.EMPTY_NODE for nulls"),!i.isLeafNode())return r;let s=i.getValue();return"number"!=typeof s?r:s+r},rE=function(e,t,n,r){return rS(t,new rw(n,e),r)},rC=function(e,t,n){return rS(e,new r_(t),n)};function rS(e,t,n){let r;let i=e.getPriority().val(),s=rb(i,t.getImmediateChild(".priority"),n);if(!e.isLeafNode())return r=e,s!==e.getPriority().val()&&(r=r.updatePriority(new tV(s))),e.forEachChild(tq,(e,i)=>{let s=rS(i,t.getImmediateChild(e),n);s!==i&&(r=r.updateImmediateChild(e,s))}),r;{let r=rb(e.getValue(),t,n);return r!==e.getValue()||s!==e.getPriority().val()?new tV(r,tK(s)):e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e="",t=null,n={children:{},childCount:0}){this.name=e,this.parent=t,this.node=n}}function rx(e,t){let n=t instanceof tu?t:new tu(t),r=e,i=th(n);for(;null!==i;){let e=(0,b.DV)(r.node.children,i)||{children:{},childCount:0};r=new rk(i,r,e),i=th(n=tf(n))}return r}function rA(e){return e.node.value}function rR(e,t){e.node.value=t,function e(t){null!==t.parent&&function(t,n,r){let i=void 0===rA(r)&&!rN(r),s=(0,b.r3)(t.node.children,n);i&&s?(delete t.node.children[n],t.node.childCount--,e(t)):i||s||(t.node.children[n]=r.node,t.node.childCount++,e(t))}(t.parent,t.name,t)}(e)}function rN(e){return e.node.childCount>0}function rP(e,t){ez(e.node.children,(n,r)=>{t(new rk(n,e,r))})}function rD(e){return new tu(null===e.parent?e.name:rD(e.parent)+"/"+e.name)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rO=/[\[\].#$\/\u0000-\u001F\u007F]/,rF=/[\[\].#$\u0000-\u001F\u007F]/,rL=function(e){return"string"==typeof e&&0!==e.length&&!rO.test(e)},rM=function(e){return"string"==typeof e&&0!==e.length&&!rF.test(e)},rU=function(e){return null===e||"string"==typeof e||"number"==typeof e&&!eO(e)||e&&"object"==typeof e&&(0,b.r3)(e,".sv")},rV=function(e,t,n,r){r&&void 0===t||rq((0,b.gK)(e,"value"),t,n)},rq=function(e,t,n){let r=n instanceof tu?new tT(n,e):n;if(void 0===t)throw Error(e+"contains undefined "+tC(r));if("function"==typeof t)throw Error(e+"contains a function "+tC(r)+" with contents = "+t.toString());if(eO(t))throw Error(e+"contains "+t.toString()+" "+tC(r));if("string"==typeof t&&t.length>3495253.3333333335&&(0,b.ug)(t)>10485760)throw Error(e+"contains a string greater than 10485760 utf8 bytes "+tC(r)+" ('"+t.substring(0,50)+"...')");if(t&&"object"==typeof t){let n=!1,i=!1;if(ez(t,(t,s)=>{var o;if(".value"===t)n=!0;else if(".priority"!==t&&".sv"!==t&&(i=!0,!rL(t)))throw Error(e+" contains an invalid key ("+t+") "+tC(r)+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');(o=r).parts_.length>0&&(o.byteLength_+=1),o.parts_.push(t),o.byteLength_+=(0,b.ug)(t),tE(o),rq(e,s,r),function(e){let t=e.parts_.pop();e.byteLength_-=(0,b.ug)(t),e.parts_.length>0&&(e.byteLength_-=1)}(r)}),n&&i)throw Error(e+' contains ".value" child '+tC(r)+" in addition to actual children.")}},rj=function(e,t){let n,r;for(n=0;n<t.length;n++){r=t[n];let i=tg(r);for(let t=0;t<i.length;t++)if(".priority"===i[t]&&t===i.length-1);else if(!rL(i[t]))throw Error(e+"contains an invalid key ("+i[t]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}t.sort(tw);let i=null;for(n=0;n<t.length;n++){if(r=t[n],null!==i&&tI(i,r))throw Error(e+"contains a path "+i.toString()+" that is ancestor of another path "+r.toString());i=r}},rB=function(e,t,n,r){if(r&&void 0===t)return;let i=(0,b.gK)(e,"values");if(!(t&&"object"==typeof t)||Array.isArray(t))throw Error(i+" must be an object containing the children to replace.");let s=[];ez(t,(e,t)=>{let r=new tu(e);if(rq(i,t,ty(n,r)),".priority"===tp(r)&&!rU(t))throw Error(i+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(r)}),rj(i,s)},rz=function(e,t,n){if(!n||void 0!==t){if(eO(t))throw Error((0,b.gK)(e,"priority")+"is "+t.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!rU(t))throw Error((0,b.gK)(e,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},r$=function(e,t,n,r){if((!r||void 0!==n)&&!rL(n))throw Error((0,b.gK)(e,t)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},rH=function(e,t,n,r){if((!r||void 0!==n)&&!rM(n))throw Error((0,b.gK)(e,t)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},rW=function(e,t,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),rH(e,t,n,r)},rG=function(e,t){if(".info"===th(t))throw Error(e+" failed = Can't modify data under /.info/")},rK=function(e,t){var n;let r=t.path.toString();if("string"!=typeof t.repoInfo.host||0===t.repoInfo.host.length||!rL(t.repoInfo.namespace)&&"localhost"!==t.repoInfo.host.split(":")[0]||0!==r.length&&((n=r)&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),!rM(n)))throw Error((0,b.gK)(e,"url")+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rZ{constructor(){this.eventLists_=[],this.recursionDepth_=0}}function rQ(e,t){let n=null;for(let r=0;r<t.length;r++){let i=t[r],s=i.getPath();null===n||tb(s,n.path)||(e.eventLists_.push(n),n=null),null===n&&(n={events:[],path:s}),n.events.push(i)}n&&e.eventLists_.push(n)}function rY(e,t,n){rQ(e,n),rJ(e,e=>tb(e,t))}function rX(e,t,n){rQ(e,n),rJ(e,e=>tI(e,t)||tI(t,e))}function rJ(e,t){e.recursionDepth_++;let n=!0;for(let r=0;r<e.eventLists_.length;r++){let i=e.eventLists_[r];if(i){let s=i.path;t(s)?(function(e){for(let t=0;t<e.events.length;t++){let n=e.events[t];if(null!==n){e.events[t]=null;let r=n.getEventRunner();eC&&ex("event: "+n.toString()),eG(r)}}}(e.eventLists_[r]),e.eventLists_[r]=null):n=!1}}n&&(e.eventLists_=[]),e.recursionDepth_--}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let r0="repo_interrupt";class r1{constructor(e,t,n,r){this.repoInfo_=e,this.forceRestClient_=t,this.authTokenProvider_=n,this.appCheckProvider_=r,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new rZ,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=nn(),this.transactionQueueTree_=new rk,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}toString(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host}}function r2(e){let t=e.infoData_.getNode(new tu(".info/serverTimeOffset")),n=t.val()||0;return new Date().getTime()+n}function r4(e){var t;return(t=t={timestamp:r2(e)}).timestamp=t.timestamp||new Date().getTime(),t}function r9(e,t,n,r,i){e.dataUpdateCount++;let s=new tu(t);n=e.interceptServerDataCallback_?e.interceptServerDataCallback_(t,n):n;let o=[];if(i){if(r){let t=(0,b.UI)(n,e=>tK(e));o=function(e,t,n,r){let i=rg(e,r);if(!i)return[];{let r=rm(i),s=r.path,o=r.queryId,a=t_(s,t),l=nT.fromObject(n),u=new nf(nu(o),a,l);return ry(e,s,u)}}(e.serverSyncTree_,s,t,i)}else{let t=tK(n);o=rl(e.serverSyncTree_,s,t,i)}}else if(r){let t=(0,b.UI)(n,e=>tK(e));o=function(e,t,n){let r=nT.fromObject(n);return rh(e,new nf(nl(),t,r))}(e.serverSyncTree_,s,t)}else{let t=tK(n);o=ro(e.serverSyncTree_,s,t)}let a=s;o.length>0&&(a=ia(e,s)),rX(e.eventQueue_,a,o)}function r5(e,t){r6(e,"connected",t),!1===t&&function(e){ir(e,"onDisconnectEvents");let t=r4(e),n=nn();ni(e.onDisconnect_,tc(),(r,i)=>{let s=rE(r,i,e.serverSyncTree_,t);nr(n,r,s)});let r=[];ni(n,tc(),(t,n)=>{r=r.concat(ro(e.serverSyncTree_,t,n));let i=ih(e,t);ia(e,i)}),e.onDisconnect_=nn(),rX(e.eventQueue_,tc(),r)}(e)}function r6(e,t,n){let r=new tu("/.info/"+t),i=tK(n);e.infoData_.updateSnapshot(r,i);let s=ro(e.infoSyncTree_,r,i);rX(e.eventQueue_,r,s)}function r3(e){return e.nextWriteId_++}function r8(e,t,n,r,i){ir(e,"set",{path:t.toString(),value:n,priority:r});let s=r4(e),o=tK(n,r),a=rc(e.serverSyncTree_,t),l=rC(o,a,s),u=r3(e),c=ri(e.serverSyncTree_,t,l,u,!0);rQ(e.eventQueue_,c),e.server_.put(t.toString(),o.val(!0),(n,r)=>{let s="ok"===n;s||eP("set at "+t+" failed: "+n);let o=rs(e.serverSyncTree_,u,!s);rX(e.eventQueue_,t,o),ii(e,i,n,r)});let h=ih(e,t);ia(e,h),rX(e.eventQueue_,h,[])}function r7(e,t,n,r){let i=tK(n);e.server_.onDisconnectPut(t.toString(),i.val(!0),(n,s)=>{"ok"===n&&nr(e.onDisconnect_,t,i),ii(e,r,n,s)})}function ie(e,t,n){let r;r=".info"===th(t._path)?ra(e.infoSyncTree_,t,n):ra(e.serverSyncTree_,t,n),rY(e.eventQueue_,t._path,r)}function it(e){e.persistentConnection_&&e.persistentConnection_.interrupt(r0)}function ir(e,...t){let n="";e.persistentConnection_&&(n=e.persistentConnection_.id+":"),ex(n,...t)}function ii(e,t,n,r){t&&eG(()=>{if("ok"===n)t(null);else{let e=(n||"error").toUpperCase(),i=e;r&&(i+=": "+r);let s=Error(i);s.code=e,t(s)}})}function is(e,t,n){return rc(e.serverSyncTree_,t,n)||tW.EMPTY_NODE}function io(e,t=e.transactionQueueTree_){if(t||ic(e,t),rA(t)){let n=iu(e,t);(0,b.hu)(n.length>0,"Sending zero length transaction queue");let r=n.every(e=>0===e.status);r&&function(e,t,n){let r=n.map(e=>e.currentWriteId),i=is(e,t,r),s=i,o=i.hash();for(let e=0;e<n.length;e++){let r=n[e];(0,b.hu)(0===r.status,"tryToSendTransactionQueue_: items in queue should all be run."),r.status=1,r.retryCount++;let i=t_(t,r.path);s=s.updateChild(i,r.currentOutputSnapshotRaw)}let a=s.val(!0);e.server_.put(t.toString(),a,r=>{ir(e,"transaction put response",{path:t.toString(),status:r});let i=[];if("ok"===r){let r=[];for(let t=0;t<n.length;t++)n[t].status=2,i=i.concat(rs(e.serverSyncTree_,n[t].currentWriteId)),n[t].onComplete&&r.push(()=>n[t].onComplete(null,!0,n[t].currentOutputSnapshotResolved)),n[t].unwatcher();ic(e,rx(e.transactionQueueTree_,t)),io(e,e.transactionQueueTree_),rX(e.eventQueue_,t,i);for(let e=0;e<r.length;e++)eG(r[e])}else{if("datastale"===r)for(let e=0;e<n.length;e++)3===n[e].status?n[e].status=4:n[e].status=0;else{eP("transaction at "+t.toString()+" failed: "+r);for(let e=0;e<n.length;e++)n[e].status=4,n[e].abortReason=r}ia(e,t)}},o)}(e,rD(t),n)}else rN(t)&&rP(t,t=>{io(e,t)})}function ia(e,t){let n=il(e,t),r=rD(n),i=iu(e,n);return function(e,t,n){if(0===t.length)return;let r=[],i=[],s=t.filter(e=>0===e.status),o=s.map(e=>e.currentWriteId);for(let s=0;s<t.length;s++){let a=t[s],l=t_(n,a.path),u=!1,c;if((0,b.hu)(null!==l,"rerunTransactionsUnderNode_: relativePath should not be null."),4===a.status)u=!0,c=a.abortReason,i=i.concat(rs(e.serverSyncTree_,a.currentWriteId,!0));else if(0===a.status){if(a.retryCount>=25)u=!0,c="maxretry",i=i.concat(rs(e.serverSyncTree_,a.currentWriteId,!0));else{let n=is(e,a.path,o);a.currentInputSnapshot=n;let r=t[s].update(n.val());if(void 0!==r){rq("transaction failed: Data returned ",r,a.path);let t=tK(r),s="object"==typeof r&&null!=r&&(0,b.r3)(r,".priority");s||(t=t.updatePriority(n.getPriority()));let l=a.currentWriteId,u=r4(e),c=rC(t,n,u);a.currentOutputSnapshotRaw=t,a.currentOutputSnapshotResolved=c,a.currentWriteId=r3(e),o.splice(o.indexOf(l),1),i=(i=i.concat(ri(e.serverSyncTree_,a.path,c,a.currentWriteId,a.applyLocally))).concat(rs(e.serverSyncTree_,l,!0))}else u=!0,c="nodata",i=i.concat(rs(e.serverSyncTree_,a.currentWriteId,!0))}}rX(e.eventQueue_,n,i),i=[],u&&(t[s].status=2,setTimeout(t[s].unwatcher,Math.floor(0)),t[s].onComplete&&("nodata"===c?r.push(()=>t[s].onComplete(null,!1,t[s].currentInputSnapshot)):r.push(()=>t[s].onComplete(Error(c),!1,null))))}ic(e,e.transactionQueueTree_);for(let e=0;e<r.length;e++)eG(r[e]);io(e,e.transactionQueueTree_)}(e,i,r),r}function il(e,t){let n;let r=e.transactionQueueTree_;for(n=th(t);null!==n&&void 0===rA(r);)r=rx(r,n),n=th(t=tf(t));return r}function iu(e,t){let n=[];return function e(t,n,r){let i=rA(n);if(i)for(let e=0;e<i.length;e++)r.push(i[e]);rP(n,n=>{e(t,n,r)})}(e,t,n),n.sort((e,t)=>e.order-t.order),n}function ic(e,t){let n=rA(t);if(n){let e=0;for(let t=0;t<n.length;t++)2!==n[t].status&&(n[e]=n[t],e++);n.length=e,rR(t,n.length>0?n:void 0)}rP(t,t=>{ic(e,t)})}function ih(e,t){let n=rD(il(e,t)),r=rx(e.transactionQueueTree_,t);return!function(e,t,n){let r=e.parent;for(;null!==r;){if(t(r))return!0;r=r.parent}}(r,t=>{id(e,t)}),id(e,r),!function e(t,n,r,i){r&&!i&&n(t),rP(t,t=>{e(t,n,!0,i)}),r&&i&&n(t)}(r,t=>{id(e,t)}),n}function id(e,t){let n=rA(t);if(n){let r=[],i=[],s=-1;for(let t=0;t<n.length;t++)3===n[t].status||(1===n[t].status?((0,b.hu)(s===t-1,"All SENT items should be at beginning of queue."),s=t,n[t].status=3,n[t].abortReason="set"):((0,b.hu)(0===n[t].status,"Unexpected transaction status in abort"),n[t].unwatcher(),i=i.concat(rs(e.serverSyncTree_,n[t].currentWriteId,!0)),n[t].onComplete&&r.push(n[t].onComplete.bind(null,Error("set"),!1,null))));-1===s?rR(t,void 0):n.length=s+1,rX(e.eventQueue_,rD(t),i);for(let e=0;e<r.length;e++)eG(r[e])}}let ip=function(e,t){let n=ig(e),r=n.namespace;"firebase.com"===n.domain&&eN(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),r&&"undefined"!==r||"localhost"===n.domain||eN("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||eD();let i="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new e2(n.host,n.secure,r,i,t,"",r!==n.subdomain),path:new tu(n.pathString)}},ig=function(e){let t="",n="",r="",i="",s="",o=!0,a="https",l=443;if("string"==typeof e){let u=e.indexOf("//");u>=0&&(a=e.substring(0,u-1),e=e.substring(u+2));let c=e.indexOf("/");-1===c&&(c=e.length);let h=e.indexOf("?");-1===h&&(h=e.length),t=e.substring(0,Math.min(c,h)),c<h&&(i=/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){let t="",n=e.split("/");for(let e=0;e<n.length;e++)if(n[e].length>0){let r=n[e];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(e){}t+="/"+r}return t}(e.substring(c,h)));let d=function(e){let t={};for(let n of("?"===e.charAt(0)&&(e=e.substring(1)),e.split("&"))){if(0===n.length)continue;let r=n.split("=");2===r.length?t[decodeURIComponent(r[0])]=decodeURIComponent(r[1]):eP(`Invalid query segment '${n}' in query '${e}'`)}return t}(e.substring(Math.min(e.length,h)));(u=t.indexOf(":"))>=0?(o="https"===a||"wss"===a,l=parseInt(t.substring(u+1),10)):u=t.length;let f=t.slice(0,u);if("localhost"===f.toLowerCase())n="localhost";else if(f.split(".").length<=2)n=f;else{let e=t.indexOf(".");r=t.substring(0,e).toLowerCase(),n=t.substring(e+1),s=r}"ns"in d&&(s=d.ns)}return{host:t,port:l,domain:n,subdomain:r,secure:o,scheme:a,pathString:i,namespace:s}},im="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",iy=function(){let e=0,t=[];return function(n){let r;let i=n===e;e=n;let s=Array(8);for(r=7;r>=0;r--)s[r]=im.charAt(n%64),n=Math.floor(n/64);(0,b.hu)(0===n,"Cannot push at time == 0");let o=s.join("");if(i){for(r=11;r>=0&&63===t[r];r--)t[r]=0;t[r]++}else for(r=0;r<12;r++)t[r]=Math.floor(64*Math.random());for(r=0;r<12;r++)o+=im.charAt(t[r]);return(0,b.hu)(20===o.length,"nextPushId: Length should be 20."),o}}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,t,n,r){this.eventType=e,this.eventRegistration=t,this.snapshot=n,this.prevName=r}getPath(){let e=this.snapshot.ref;return"value"===this.eventType?e._path:e.parent._path}getEventType(){return this.eventType}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.getPath().toString()+":"+this.eventType+":"+(0,b.Wl)(this.snapshot.exportVal())}}class i_{constructor(e,t,n){this.eventRegistration=e,this.error=t,this.path=n}getPath(){return this.path}getEventType(){return"cancel"}getEventRunner(){return this.eventRegistration.getEventRunner(this)}toString(){return this.path.toString()+":cancel"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iw{constructor(e,t){this.snapshotCallback=e,this.cancelCallback=t}onValue(e,t){this.snapshotCallback.call(null,e,t)}onCancel(e){return(0,b.hu)(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)}get hasCancelCallback(){return!!this.cancelCallback}matches(e){return this.snapshotCallback===e.snapshotCallback||void 0!==this.snapshotCallback.userCallback&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ib{constructor(e,t){this._repo=e,this._path=t}cancel(){let e=new b.BH;return!function(e,t,n){e.server_.onDisconnectCancel(t.toString(),(r,i)=>{"ok"===r&&function e(t,n){if(tv(n))return t.value=null,t.children.clear(),!0;if(null!==t.value){if(t.value.isLeafNode())return!1;{let r=t.value;return t.value=null,r.forEachChild(tq,(e,n)=>{nr(t,new tu(e),n)}),e(t,n)}}if(!(t.children.size>0))return!0;{let r=th(n);if(n=tf(n),t.children.has(r)){let i=e(t.children.get(r),n);i&&t.children.delete(r)}return 0===t.children.size}}(e.onDisconnect_,t),ii(e,n,r,i)})}(this._repo,this._path,e.wrapCallback(()=>{})),e.promise}remove(){rG("OnDisconnect.remove",this._path);let e=new b.BH;return r7(this._repo,this._path,null,e.wrapCallback(()=>{})),e.promise}set(e){rG("OnDisconnect.set",this._path),rV("OnDisconnect.set",e,this._path,!1);let t=new b.BH;return r7(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}setWithPriority(e,t){rG("OnDisconnect.setWithPriority",this._path),rV("OnDisconnect.setWithPriority",e,this._path,!1),rz("OnDisconnect.setWithPriority",t,!1);let n=new b.BH;return!function(e,t,n,r,i){let s=tK(n,r);e.server_.onDisconnectPut(t.toString(),s.val(!0),(n,r)=>{"ok"===n&&nr(e.onDisconnect_,t,s),ii(e,i,n,r)})}(this._repo,this._path,e,t,n.wrapCallback(()=>{})),n.promise}update(e){rG("OnDisconnect.update",this._path),rB("OnDisconnect.update",e,this._path,!1);let t=new b.BH;return!function(e,t,n,r){if((0,b.xb)(n)){ex("onDisconnect().update() called with empty data.  Don't do anything."),ii(e,r,"ok",void 0);return}e.server_.onDisconnectMerge(t.toString(),n,(i,s)=>{"ok"===i&&ez(n,(n,r)=>{let i=tK(r);nr(e.onDisconnect_,ty(t,n),i)}),ii(e,r,i,s)})}(this._repo,this._path,e,t.wrapCallback(()=>{})),t.promise}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e,t,n,r){this._repo=e,this._path=t,this._queryParams=n,this._orderByCalled=r}get key(){return tv(this._path)?null:tp(this._path)}get ref(){return new iS(this._repo,this._path)}get _queryIdentifier(){let e=t7(this._queryParams),t=ej(e);return"{}"===t?"default":t}get _queryObject(){return t7(this._queryParams)}isEqual(e){if(!((e=(0,b.m9)(e))instanceof iI))return!1;let t=this._repo===e._repo,n=tb(this._path,e._path),r=this._queryIdentifier===e._queryIdentifier;return t&&n&&r}toJSON(){return this.toString()}toString(){return this._repo.toString()+function(e){let t="";for(let n=e.pieceNum_;n<e.pieces_.length;n++)""!==e.pieces_[n]&&(t+="/"+encodeURIComponent(String(e.pieces_[n])));return t||"/"}(this._path)}}function iT(e,t){if(!0===e._orderByCalled)throw Error(t+": You can't combine multiple orderBy calls.")}function iE(e){let t=null,n=null;if(e.hasStart()&&(t=e.getIndexStartValue()),e.hasEnd()&&(n=e.getIndexEndValue()),e.getIndex()===tN){let r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(e.hasStart()){let n=e.getIndexStartName();if(n!==eL)throw Error(r);if("string"!=typeof t)throw Error(i)}if(e.hasEnd()){let t=e.getIndexEndName();if(t!==eM)throw Error(r);if("string"!=typeof n)throw Error(i)}}else if(e.getIndex()===tq){if(null!=t&&!rU(t)||null!=n&&!rU(n))throw Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if((0,b.hu)(e.getIndex() instanceof tZ||e.getIndex()===tQ,"unknown index type."),null!=t&&"object"==typeof t||null!=n&&"object"==typeof n)throw Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function iC(e){if(e.hasStart()&&e.hasEnd()&&e.hasLimit()&&!e.hasAnchoredLimit())throw Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}class iS extends iI{constructor(e,t){super(e,t,new t9,!1)}get parent(){let e=tm(this._path);return null===e?null:new iS(this._repo,e)}get root(){let e=this;for(;null!==e.parent;)e=e.parent;return e}}class ik{constructor(e,t,n){this._node=e,this.ref=t,this._index=n}get priority(){return this._node.getPriority().val()}get key(){return this.ref.key}get size(){return this._node.numChildren()}child(e){let t=new tu(e),n=iR(this.ref,e);return new ik(this._node.getChild(t),n,tq)}exists(){return!this._node.isEmpty()}exportVal(){return this._node.val(!0)}forEach(e){if(this._node.isLeafNode())return!1;let t=this._node;return!!t.forEachChild(this._index,(t,n)=>e(new ik(n,iR(this.ref,t),tq)))}hasChild(e){let t=new tu(e);return!this._node.getChild(t).isEmpty()}hasChildren(){return!this._node.isLeafNode()&&!this._node.isEmpty()}toJSON(){return this.exportVal()}val(){return this._node.val()}}function ix(e,t){return(e=(0,b.m9)(e))._checkNotDeleted("ref"),void 0!==t?iR(e._root,t):e._root}function iA(e,t){(e=(0,b.m9)(e))._checkNotDeleted("refFromURL");let n=ip(t,e._repo.repoInfo_.nodeAdmin);rK("refFromURL",n);let r=n.repoInfo;return e._repo.repoInfo_.isCustomHost()||r.host===e._repo.repoInfo_.host||eN("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+e._repo.repoInfo_.host+")"),ix(e,n.path.toString())}function iR(e,t){return null===th((e=(0,b.m9)(e))._path)?rW("child","path",t,!1):rH("child","path",t,!1),new iS(e._repo,ty(e._path,t))}function iN(e,t){rG("set",(e=(0,b.m9)(e))._path),rV("set",t,e._path,!1);let n=new b.BH;return r8(e._repo,e._path,t,null,n.wrapCallback(()=>{})),n.promise}class iP{constructor(e){this.callbackContext=e}respondsTo(e){return"value"===e}createEvent(e,t){let n=t._queryParams.getIndex();return new iv("value",this,new ik(e.snapshotNode,new iS(t._repo,t._path),n))}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,null)}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new i_(this,e,t):null}matches(e){return e instanceof iP&&(!e.callbackContext||!this.callbackContext||e.callbackContext.matches(this.callbackContext))}hasAnyCallback(){return null!==this.callbackContext}}class iD{constructor(e,t){this.eventType=e,this.callbackContext=t}respondsTo(e){let t="children_added"===e?"child_added":e;return t="children_removed"===t?"child_removed":t,this.eventType===t}createCancelEvent(e,t){return this.callbackContext.hasCancelCallback?new i_(this,e,t):null}createEvent(e,t){(0,b.hu)(null!=e.childName,"Child events should have a childName.");let n=iR(new iS(t._repo,t._path),e.childName),r=t._queryParams.getIndex();return new iv(e.type,this,new ik(e.snapshotNode,n,r),e.prevName)}getEventRunner(e){return"cancel"===e.getEventType()?()=>this.callbackContext.onCancel(e.error):()=>this.callbackContext.onValue(e.snapshot,e.prevName)}matches(e){return e instanceof iD&&this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext))}hasAnyCallback(){return!!this.callbackContext}}function iO(e,t,n,r,i){var s;let o,a;if("object"==typeof r&&(o=void 0,i=r),"function"==typeof r&&(o=r),i&&i.onlyOnce){let t=n,r=(n,r)=>{ie(e._repo,e,u),t(n,r)};r.userCallback=n.userCallback,r.context=n.context,n=r}let l=new iw(n,o||void 0),u="value"===t?new iP(l):new iD(t,l);return s=e._repo,a=".info"===th(e._path)?ru(s.infoSyncTree_,e,u):ru(s.serverSyncTree_,e,u),rY(s.eventQueue_,e._path,a),()=>ie(e._repo,e,u)}function iF(e,t,n,r){return iO(e,"value",t,n,r)}function iL(e,t,n,r){return iO(e,"child_added",t,n,r)}function iM(e,t,n,r){return iO(e,"child_changed",t,n,r)}function iU(e,t,n,r){return iO(e,"child_moved",t,n,r)}function iV(e,t,n,r){return iO(e,"child_removed",t,n,r)}function iq(e,t,n){let r=null,i=n?new iw(n):null;"value"===t?r=new iP(i):t&&(r=new iD(t,i)),ie(e._repo,e,r)}class ij{}class iB extends ij{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){rV("endAt",this._value,e._path,!0);let t=t6(e._queryParams,this._value,this._key);if(iC(t),iE(t),e._queryParams.hasEnd())throw Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new iI(e._repo,e._path,t,e._orderByCalled)}}class iz extends ij{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){var t,n,r;let i;rV("endBefore",this._value,e._path,!1);let s=(t=e._queryParams,n=this._value,r=this._key,(i=t.index_===tN||r?t6(t,n,r):t6(t,n,eL)).endBeforeSet_=!0,i);if(iC(s),iE(s),e._queryParams.hasEnd())throw Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new iI(e._repo,e._path,s,e._orderByCalled)}}class i$ extends ij{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){rV("startAt",this._value,e._path,!0);let t=t5(e._queryParams,this._value,this._key);if(iC(t),iE(t),e._queryParams.hasStart())throw Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new iI(e._repo,e._path,t,e._orderByCalled)}}class iH extends ij{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){var t,n,r;let i;rV("startAfter",this._value,e._path,!1);let s=(t=e._queryParams,n=this._value,r=this._key,(i=t.index_===tN||r?t5(t,n,r):t5(t,n,eM)).startAfterSet_=!0,i);if(iC(s),iE(s),e._queryParams.hasStart())throw Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new iI(e._repo,e._path,s,e._orderByCalled)}}class iW extends ij{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new iI(e._repo,e._path,function(e,t){let n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="l",n}(e._queryParams,this._limit),e._orderByCalled)}}class iG extends ij{constructor(e){super(),this._limit=e}_apply(e){if(e._queryParams.hasLimit())throw Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new iI(e._repo,e._path,function(e,t){let n=e.copy();return n.limitSet_=!0,n.limit_=t,n.viewFrom_="r",n}(e._queryParams,this._limit),e._orderByCalled)}}class iK extends ij{constructor(e){super(),this._path=e}_apply(e){iT(e,"orderByChild");let t=new tu(this._path);if(tv(t))throw Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");let n=new tZ(t),r=t3(e._queryParams,n);return iE(r),new iI(e._repo,e._path,r,!0)}}class iZ extends ij{_apply(e){iT(e,"orderByKey");let t=t3(e._queryParams,tN);return iE(t),new iI(e._repo,e._path,t,!0)}}class iQ extends ij{_apply(e){iT(e,"orderByPriority");let t=t3(e._queryParams,tq);return iE(t),new iI(e._repo,e._path,t,!0)}}class iY extends ij{_apply(e){iT(e,"orderByValue");let t=t3(e._queryParams,tQ);return iE(t),new iI(e._repo,e._path,t,!0)}}class iX extends ij{constructor(e,t){super(),this._value=e,this._key=t}_apply(e){if(rV("equalTo",this._value,e._path,!1),e._queryParams.hasStart())throw Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(e._queryParams.hasEnd())throw Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new iB(this._value,this._key)._apply(new i$(this._value,this._key)._apply(e))}}function iJ(e,...t){let n=(0,b.m9)(e);for(let e of t)n=e._apply(n);return n}(0,b.hu)(!h,"__referenceConstructor has already been defined"),h=iS,(0,b.hu)(!d,"__referenceConstructor has already been defined"),d=iS;let i0={};function i1(e,t,n,r,i){var s,o,a;let l,u,c,h,d=r||e.options.databaseURL;void 0===d&&(e.options.projectId||eN("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),ex("Using default host for project ",e.options.projectId),d=`${e.options.projectId}-default-rtdb.firebaseio.com`);let f=ip(d,i),p=f.repoInfo;void 0!==ed&&ed.env&&(c=ed.env.FIREBASE_DATABASE_EMULATOR_HOST),c?(h=!0,p=(f=ip(d=`http://${c}?ns=${p.namespace}`,i)).repoInfo):h=!f.repoInfo.secure;let g=i&&h?new eX(eX.OWNER):new eY(e.name,e.options,t);rK("Invalid Firebase Database URL",f),tv(f.path)||eN("Database URL must point to the root of a Firebase Database (not including a child path).");let m=(s=p,o=e,a=new eQ(e.name,n),(l=i0[o.name])||(l={},i0[o.name]=l),(u=l[s.toURLString()])&&eN("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),u=new r1(s,!1,g,a),l[s.toURLString()]=u,u);return new i2(m,e)}class i2{constructor(e,t){this._repoInternal=e,this.app=t,this.type="database",this._instanceStarted=!1}get _repo(){return this._instanceStarted||(function(e,t,n){if(e.stats_=e3(e.repoInfo_),e.forceRestClient_||eK())e.server_=new ne(e.repoInfo_,(t,n,r,i)=>{r9(e,t,n,r,i)},e.authTokenProvider_,e.appCheckProvider_),setTimeout(()=>r5(e,!0),0);else{if(null!=n){if("object"!=typeof n)throw Error("Only objects are supported for option databaseAuthVariableOverride");try{(0,b.Wl)(n)}catch(e){throw Error("Invalid authOverride provided: "+e)}}e.persistentConnection_=new tk(e.repoInfo_,t,(t,n,r,i)=>{r9(e,t,n,r,i)},t=>{r5(e,t)},t=>{ez(t,(t,n)=>{r6(e,t,n)})},e.authTokenProvider_,e.appCheckProvider_,n),e.server_=e.persistentConnection_}e.authTokenProvider_.addTokenChangeListener(t=>{e.server_.refreshAuthToken(t)}),e.appCheckProvider_.addTokenChangeListener(t=>{e.server_.refreshAppCheckToken(t.token)}),e.statsReporter_=function(e,t){let n=e.toString();return e6[n]||(e6[n]=t()),e6[n]}(e.repoInfo_,()=>new no(e.stats_,e.server_)),e.infoData_=new nt,e.infoSyncTree_=new rr({startListening:(t,n,r,i)=>{let s=[],o=e.infoData_.getNode(t._path);return o.isEmpty()||(s=ro(e.infoSyncTree_,t._path,o),setTimeout(()=>{i("ok")},0)),s},stopListening:()=>{}}),r6(e,"connected",!1),e.serverSyncTree_=new rr({startListening:(t,n,r,i)=>(e.server_.listen(t,r,n,(n,r)=>{let s=i(n,r);rX(e.eventQueue_,t._path,s)}),[]),stopListening:(t,n)=>{e.server_.unlisten(t,n)}})}(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal}get _root(){return this._rootInternal||(this._rootInternal=new iS(this._repo,tc())),this._rootInternal}_delete(){return null!==this._rootInternal&&(function(e,t){let n=i0[t];n&&n[e.key]===e||eN(`Database ${t}(${e.repoInfo_}) has already been deleted.`),it(e),delete n[e.key]}(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()}_checkNotDeleted(e){null===this._rootInternal&&eN("Cannot call "+e+" on a deleted database.")}}function i4(){ti.IS_TRANSPORT_INITIALIZED&&eP("Transport has already been initialized. Please call this function before calling ref or setting up a listener")}function i9(){i4(),te.forceDisallow()}function i5(){i4(),tr.forceDisallow(),te.forceAllow()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i6{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}}}tk.prototype.simpleListen=function(e,t){this.sendRequest("q",{p:e},t)},tk.prototype.echo=function(e,t){this.sendRequest("echo",{d:e},t)},eg=T.SDK_VERSION,(0,T._registerComponent)(new I.wA("database",(e,{instanceIdentifier:t})=>{let n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("app-check-internal");return i1(n,r,i,t)},"PUBLIC").setMultipleInstances(!0)),(0,T.registerVersion)(ef,ep,void 0),(0,T.registerVersion)(ef,ep,"esm2017");/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let i3=new E.Yd("@firebase/database-compat"),i8=function(e){i3.warn("FIREBASE WARNING: "+e)},i7=function(e,t,n,r){if((!r||void 0!==n)&&"boolean"!=typeof n)throw Error((0,b.gK)(e,t)+"must be a boolean.")},se=function(e,t,n){if(!n||void 0!==t)switch(t){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw Error((0,b.gK)(e,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class st{constructor(e){this._delegate=e}cancel(e){(0,b.Dv)("OnDisconnect.cancel",0,1,arguments.length),(0,b.Wj)("OnDisconnect.cancel","onComplete",e,!0);let t=this._delegate.cancel();return e&&t.then(()=>e(null),t=>e(t)),t}remove(e){(0,b.Dv)("OnDisconnect.remove",0,1,arguments.length),(0,b.Wj)("OnDisconnect.remove","onComplete",e,!0);let t=this._delegate.remove();return e&&t.then(()=>e(null),t=>e(t)),t}set(e,t){(0,b.Dv)("OnDisconnect.set",1,2,arguments.length),(0,b.Wj)("OnDisconnect.set","onComplete",t,!0);let n=this._delegate.set(e);return t&&n.then(()=>t(null),e=>t(e)),n}setWithPriority(e,t,n){(0,b.Dv)("OnDisconnect.setWithPriority",2,3,arguments.length),(0,b.Wj)("OnDisconnect.setWithPriority","onComplete",n,!0);let r=this._delegate.setWithPriority(e,t);return n&&r.then(()=>n(null),e=>n(e)),r}update(e,t){if((0,b.Dv)("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){let t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,i8("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}(0,b.Wj)("OnDisconnect.update","onComplete",t,!0);let n=this._delegate.update(e);return t&&n.then(()=>t(null),e=>t(e)),n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sn{constructor(e,t){this.committed=e,this.snapshot=t}toJSON(){return(0,b.Dv)("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sr{constructor(e,t){this._database=e,this._delegate=t}val(){return(0,b.Dv)("DataSnapshot.val",0,0,arguments.length),this._delegate.val()}exportVal(){return(0,b.Dv)("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()}toJSON(){return(0,b.Dv)("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()}exists(){return(0,b.Dv)("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()}child(e){return(0,b.Dv)("DataSnapshot.child",0,1,arguments.length),rH("DataSnapshot.child","path",e=String(e),!1),new sr(this._database,this._delegate.child(e))}hasChild(e){return(0,b.Dv)("DataSnapshot.hasChild",1,1,arguments.length),rH("DataSnapshot.hasChild","path",e,!1),this._delegate.hasChild(e)}getPriority(){return(0,b.Dv)("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority}forEach(e){return(0,b.Dv)("DataSnapshot.forEach",1,1,arguments.length),(0,b.Wj)("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(t=>e(new sr(this._database,t)))}hasChildren(){return(0,b.Dv)("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()}get key(){return this._delegate.key}numChildren(){return(0,b.Dv)("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size}getRef(){return(0,b.Dv)("DataSnapshot.ref",0,0,arguments.length),new ss(this._database,this._delegate.ref)}get ref(){return this.getRef()}}class si{constructor(e,t){this.database=e,this._delegate=t}on(e,t,n,r){var i;(0,b.Dv)("Query.on",2,4,arguments.length),(0,b.Wj)("Query.on","callback",t,!1);let s=si.getCancelAndContextArgs_("Query.on",n,r),o=(e,n)=>{t.call(s.context,new sr(this.database,e),n)};o.userCallback=t,o.context=s.context;let a=null===(i=s.cancel)||void 0===i?void 0:i.bind(s.context);switch(e){case"value":return iF(this._delegate,o,a),t;case"child_added":return iL(this._delegate,o,a),t;case"child_removed":return iV(this._delegate,o,a),t;case"child_changed":return iM(this._delegate,o,a),t;case"child_moved":return iU(this._delegate,o,a),t;default:throw Error((0,b.gK)("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}}off(e,t,n){if((0,b.Dv)("Query.off",0,3,arguments.length),se("Query.off",e,!0),(0,b.Wj)("Query.off","callback",t,!0),(0,b.lb)("Query.off","context",n,!0),t){let r=()=>{};r.userCallback=t,r.context=n,iq(this._delegate,e,r)}else iq(this._delegate,e)}get(){return(function(e){e=(0,b.m9)(e);let t=new iw(()=>{}),n=new iP(t);return(function(e,t,n){let r=function(e,t){var n;let r=t._path,i=null;e.syncPointTree_.foreachOnPath(r,(e,t)=>{let n=t_(e,r);i=i||n8(t,n)});let s=e.syncPointTree_.get(r);s?i=i||n8(s,tc()):(s=new n9,e.syncPointTree_=e.syncPointTree_.set(r,s));let o=null!=i,a=o?new np(i,!0,!1):null,l=(n=e.pendingWriteTree_,nz(t._path,n)),u=n6(s,t,l,o?a.getNode():tW.EMPTY_NODE,o);return nw(u.viewCache_)}(e.serverSyncTree_,t);return null!=r?Promise.resolve(r):e.server_.get(t).then(r=>{let i;let s=tK(r).withIndex(t._queryParams.getIndex());if(ru(e.serverSyncTree_,t,n,!0),t._queryParams.loadsAllData())i=ro(e.serverSyncTree_,t._path,s);else{let n=rf(e.serverSyncTree_,t);i=rl(e.serverSyncTree_,t._path,s,n)}return rX(e.eventQueue_,t._path,i),ra(e.serverSyncTree_,t,n,null,!0),s},n=>(ir(e,"get for query "+(0,b.Wl)(t)+" failed: "+n),Promise.reject(Error(n))))})(e._repo,e,n).then(t=>new ik(t,new iS(e._repo,e._path),e._queryParams.getIndex()))})(this._delegate).then(e=>new sr(this.database,e))}once(e,t,n,r){(0,b.Dv)("Query.once",1,4,arguments.length),(0,b.Wj)("Query.once","callback",t,!0);let i=si.getCancelAndContextArgs_("Query.once",n,r),s=new b.BH,o=(e,n)=>{let r=new sr(this.database,e);t&&t.call(i.context,r,n),s.resolve(r)};o.userCallback=t,o.context=i.context;let a=e=>{i.cancel&&i.cancel.call(i.context,e),s.reject(e)};switch(e){case"value":iF(this._delegate,o,a,{onlyOnce:!0});break;case"child_added":iL(this._delegate,o,a,{onlyOnce:!0});break;case"child_removed":iV(this._delegate,o,a,{onlyOnce:!0});break;case"child_changed":iM(this._delegate,o,a,{onlyOnce:!0});break;case"child_moved":iU(this._delegate,o,a,{onlyOnce:!0});break;default:throw Error((0,b.gK)("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return s.promise}limitToFirst(e){return(0,b.Dv)("Query.limitToFirst",1,1,arguments.length),new si(this.database,iJ(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw Error("limitToFirst: First argument must be a positive integer.");return new iW(e)}(e)))}limitToLast(e){return(0,b.Dv)("Query.limitToLast",1,1,arguments.length),new si(this.database,iJ(this._delegate,function(e){if("number"!=typeof e||Math.floor(e)!==e||e<=0)throw Error("limitToLast: First argument must be a positive integer.");return new iG(e)}(e)))}orderByChild(e){return(0,b.Dv)("Query.orderByChild",1,1,arguments.length),new si(this.database,iJ(this._delegate,function(e){if("$key"===e)throw Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if("$priority"===e)throw Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if("$value"===e)throw Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return rH("orderByChild","path",e,!1),new iK(e)}(e)))}orderByKey(){return(0,b.Dv)("Query.orderByKey",0,0,arguments.length),new si(this.database,iJ(this._delegate,new iZ))}orderByPriority(){return(0,b.Dv)("Query.orderByPriority",0,0,arguments.length),new si(this.database,iJ(this._delegate,new iQ))}orderByValue(){return(0,b.Dv)("Query.orderByValue",0,0,arguments.length),new si(this.database,iJ(this._delegate,new iY))}startAt(e=null,t){return(0,b.Dv)("Query.startAt",0,2,arguments.length),new si(this.database,iJ(this._delegate,function(e=null,t){return r$("startAt","key",t,!0),new i$(e,t)}(e,t)))}startAfter(e=null,t){return(0,b.Dv)("Query.startAfter",0,2,arguments.length),new si(this.database,iJ(this._delegate,(r$("startAfter","key",t,!0),new iH(e,t))))}endAt(e=null,t){return(0,b.Dv)("Query.endAt",0,2,arguments.length),new si(this.database,iJ(this._delegate,(r$("endAt","key",t,!0),new iB(e,t))))}endBefore(e=null,t){return(0,b.Dv)("Query.endBefore",0,2,arguments.length),new si(this.database,iJ(this._delegate,(r$("endBefore","key",t,!0),new iz(e,t))))}equalTo(e,t){return(0,b.Dv)("Query.equalTo",1,2,arguments.length),new si(this.database,iJ(this._delegate,(r$("equalTo","key",t,!0),new iX(e,t))))}toString(){return(0,b.Dv)("Query.toString",0,0,arguments.length),this._delegate.toString()}toJSON(){return(0,b.Dv)("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()}isEqual(e){if((0,b.Dv)("Query.isEqual",1,1,arguments.length),!(e instanceof si))throw Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.");return this._delegate.isEqual(e._delegate)}static getCancelAndContextArgs_(e,t,n){let r={cancel:void 0,context:void 0};if(t&&n)r.cancel=t,(0,b.Wj)(e,"cancel",r.cancel,!0),r.context=n,(0,b.lb)(e,"context",r.context,!0);else if(t){if("object"==typeof t&&null!==t)r.context=t;else if("function"==typeof t)r.cancel=t;else throw Error((0,b.gK)(e,"cancelOrContext")+" must either be a cancel callback or a context object.")}return r}get ref(){return new ss(this.database,new iS(this._delegate._repo,this._delegate._path))}}class ss extends si{constructor(e,t){super(e,new iI(t._repo,t._path,new t9,!1)),this.database=e,this._delegate=t}getKey(){return(0,b.Dv)("Reference.key",0,0,arguments.length),this._delegate.key}child(e){return(0,b.Dv)("Reference.child",1,1,arguments.length),"number"==typeof e&&(e=String(e)),new ss(this.database,iR(this._delegate,e))}getParent(){(0,b.Dv)("Reference.parent",0,0,arguments.length);let e=this._delegate.parent;return e?new ss(this.database,e):null}getRoot(){return(0,b.Dv)("Reference.root",0,0,arguments.length),new ss(this.database,this._delegate.root)}set(e,t){(0,b.Dv)("Reference.set",1,2,arguments.length),(0,b.Wj)("Reference.set","onComplete",t,!0);let n=iN(this._delegate,e);return t&&n.then(()=>t(null),e=>t(e)),n}update(e,t){if((0,b.Dv)("Reference.update",1,2,arguments.length),Array.isArray(e)){let t={};for(let n=0;n<e.length;++n)t[""+n]=e[n];e=t,i8("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}rG("Reference.update",this._delegate._path),(0,b.Wj)("Reference.update","onComplete",t,!0);let n=function(e,t){rB("update",t,e._path,!1);let n=new b.BH;return!function(e,t,n,r){ir(e,"update",{path:t.toString(),value:n});let i=!0,s=r4(e),o={};if(ez(n,(n,r)=>{i=!1,o[n]=rE(ty(t,n),tK(r),e.serverSyncTree_,s)}),i)ex("update() called with empty data.  Don't do anything."),ii(e,r,"ok",void 0);else{let i=r3(e),s=function(e,t,n,r){var i;i=e.pendingWriteTree_,(0,b.hu)(r>i.lastWriteId,"Stacking an older merge on top of newer ones"),i.allWrites.push({path:t,children:n,writeId:r,visible:!0}),i.visibleWrites=nS(i.visibleWrites,t,n),i.lastWriteId=r;let s=nT.fromObject(n);return rh(e,new nf(na(),t,s))}(e.serverSyncTree_,t,o,i);rQ(e.eventQueue_,s),e.server_.merge(t.toString(),n,(n,s)=>{let o="ok"===n;o||eP("update at "+t+" failed: "+n);let a=rs(e.serverSyncTree_,i,!o),l=a.length>0?ia(e,t):t;rX(e.eventQueue_,l,a),ii(e,r,n,s)}),ez(n,n=>{let r=ih(e,ty(t,n));ia(e,r)}),rX(e.eventQueue_,t,[])}}(e._repo,e._path,t,n.wrapCallback(()=>{})),n.promise}(this._delegate,e);return t&&n.then(()=>t(null),e=>t(e)),n}setWithPriority(e,t,n){(0,b.Dv)("Reference.setWithPriority",2,3,arguments.length),(0,b.Wj)("Reference.setWithPriority","onComplete",n,!0);let r=function(e,t,n){if(rG("setWithPriority",e._path),rV("setWithPriority",t,e._path,!1),rz("setWithPriority",n,!1),".length"===e.key||".keys"===e.key)throw"setWithPriority failed: "+e.key+" is a read-only object.";let r=new b.BH;return r8(e._repo,e._path,t,n,r.wrapCallback(()=>{})),r.promise}(this._delegate,e,t);return n&&r.then(()=>n(null),e=>n(e)),r}remove(e){var t;(0,b.Dv)("Reference.remove",0,1,arguments.length),(0,b.Wj)("Reference.remove","onComplete",e,!0);let n=(rG("remove",(t=this._delegate)._path),iN(t,null));return e&&n.then(()=>e(null),t=>e(t)),n}transaction(e,t,n){(0,b.Dv)("Reference.transaction",1,3,arguments.length),(0,b.Wj)("Reference.transaction","transactionUpdate",e,!1),(0,b.Wj)("Reference.transaction","onComplete",t,!0),i7("Reference.transaction","applyLocally",n,!0);let r=(function(e,t,n){var r;if(rG("Reference.transaction",(e=(0,b.m9)(e))._path),".length"===e.key||".keys"===e.key)throw"Reference.transaction failed: "+e.key+" is a read-only object.";let i=null===(r=null==n?void 0:n.applyLocally)||void 0===r||r,s=new b.BH,o=(t,n,r)=>{let i=null;t?s.reject(t):(i=new ik(r,new iS(e._repo,e._path),tq),s.resolve(new i6(n,i)))},a=iF(e,()=>{});return!function(e,t,n,r,i,s){ir(e,"transaction on "+t);let o={path:t,update:n,onComplete:r,status:null,order:eI(),applyLocally:s,retryCount:0,unwatcher:i,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},a=is(e,t,void 0);o.currentInputSnapshot=a;let l=o.update(a.val());if(void 0===l)o.unwatcher(),o.currentOutputSnapshotRaw=null,o.currentOutputSnapshotResolved=null,o.onComplete&&o.onComplete(null,!1,o.currentInputSnapshot);else{let n;rq("transaction failed: Data returned ",l,o.path),o.status=0;let r=rx(e.transactionQueueTree_,t),i=rA(r)||[];if(i.push(o),rR(r,i),"object"==typeof l&&null!==l&&(0,b.r3)(l,".priority"))n=(0,b.DV)(l,".priority"),(0,b.hu)(rU(n),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{let r=rc(e.serverSyncTree_,t)||tW.EMPTY_NODE;n=r.getPriority().val()}let s=r4(e),u=tK(l,n),c=rC(u,a,s);o.currentOutputSnapshotRaw=u,o.currentOutputSnapshotResolved=c,o.currentWriteId=r3(e);let h=ri(e.serverSyncTree_,t,c,o.currentWriteId,o.applyLocally);rX(e.eventQueue_,t,h),io(e,e.transactionQueueTree_)}}(e._repo,e._path,t,o,a,i),s.promise})(this._delegate,e,{applyLocally:n}).then(e=>new sn(e.committed,new sr(this.database,e.snapshot)));return t&&r.then(e=>t(null,e.committed,e.snapshot),e=>t(e,!1,null)),r}setPriority(e,t){(0,b.Dv)("Reference.setPriority",1,2,arguments.length),(0,b.Wj)("Reference.setPriority","onComplete",t,!0);let n=function(e,t){rG("setPriority",(e=(0,b.m9)(e))._path),rz("setPriority",t,!1);let n=new b.BH;return r8(e._repo,ty(e._path,".priority"),t,null,n.wrapCallback(()=>{})),n.promise}(this._delegate,e);return t&&n.then(()=>t(null),e=>t(e)),n}push(e,t){(0,b.Dv)("Reference.push",0,2,arguments.length),(0,b.Wj)("Reference.push","onComplete",t,!0);let n=function(e,t){let n;rG("push",(e=(0,b.m9)(e))._path),rV("push",t,e._path,!0);let r=r2(e._repo),i=iy(r),s=iR(e,i),o=iR(e,i);return n=null!=t?iN(o,t).then(()=>o):Promise.resolve(o),s.then=n.then.bind(n),s.catch=n.then.bind(n,void 0),s}(this._delegate,e),r=n.then(e=>new ss(this.database,e));t&&r.then(()=>t(null),e=>t(e));let i=new ss(this.database,n);return i.then=r.then.bind(r),i.catch=r.catch.bind(r,void 0),i}onDisconnect(){return rG("Reference.onDisconnect",this._delegate._path),new st(new ib(this._delegate._repo,this._delegate._path))}get key(){return this.getKey()}get parent(){return this.getParent()}get root(){return this.getRoot()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class so{constructor(e,t){this._delegate=e,this.app=t,this.INTERNAL={delete:()=>this._delegate._delete(),forceWebSockets:i9,forceLongPolling:i5}}useEmulator(e,t,n={}){!function(e,t,n,r={}){var i,s;let o;(e=(0,b.m9)(e))._checkNotDeleted("useEmulator"),e._instanceStarted&&eN("Cannot call useEmulator() after instance has already been initialized.");let a=e._repoInternal;if(a.repoInfo_.nodeAdmin)r.mockUserToken&&eN('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),o=new eX(eX.OWNER);else if(r.mockUserToken){let t="string"==typeof r.mockUserToken?r.mockUserToken:(0,b.Sg)(r.mockUserToken,e.app.options.projectId);o=new eX(t)}i=a,s=o,i.repoInfo_=new e2(`${t}:${n}`,!1,i.repoInfo_.namespace,i.repoInfo_.webSocketOnly,i.repoInfo_.nodeAdmin,i.repoInfo_.persistenceKey,i.repoInfo_.includeNamespaceInQueryParams,!0),s&&(i.authTokenProvider_=s)}(this._delegate,e,t,n)}ref(e){if((0,b.Dv)("database.ref",0,1,arguments.length),e instanceof ss){let t=iA(this._delegate,e.toString());return new ss(this,t)}{let t=ix(this._delegate,e);return new ss(this,t)}}refFromURL(e){(0,b.Dv)("database.refFromURL",1,1,arguments.length);let t=iA(this._delegate,e);return new ss(this,t)}goOffline(){var e;return(0,b.Dv)("database.goOffline",0,0,arguments.length),e=this._delegate,void((e=(0,b.m9)(e))._checkNotDeleted("goOffline"),it(e._repo))}goOnline(){var e,t;return(0,b.Dv)("database.goOnline",0,0,arguments.length),e=this._delegate,void((e=(0,b.m9)(e))._checkNotDeleted("goOnline"),(t=e._repo).persistentConnection_&&t.persistentConnection_.resume(r0))}}so.ServerValue={TIMESTAMP:{".sv":"timestamp"},increment:e=>({".sv":{increment:e}})};var sa=Object.freeze({__proto__:null,initStandalone:/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function({app:e,url:t,version:n,customAuthImpl:r,namespace:i,nodeAdmin:s=!1}){eg=n;let o=new I.zt("auth-internal",new I.H0("database-standalone"));return o.setComponent(new I.wA("auth-internal",()=>r,"PRIVATE")),{instance:new so(i1(e,o,void 0,t,s),e),namespace:i}}});/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sl=so.ServerValue;k.INTERNAL.registerComponent(new I.wA("database-compat",(e,{instanceIdentifier:t})=>{let n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("database").getImmediate({identifier:t});return new so(r,n)},"PUBLIC").setServiceProps({Reference:ss,Query:si,Database:so,DataSnapshot:sr,enableLogging:function(e,t){ek(e,t)},INTERNAL:sa,ServerValue:sl}).setMultipleInstances(!0)),k.registerVersion("@firebase/database-compat","0.3.4");var su,sc,sh,sd="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},sf={},sp=sp||{},sg=sd||self;function sm(){}function sy(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function sv(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function s_(e,t,n){return e.call.apply(e.bind,arguments)}function sw(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function sb(e,t,n){return(sb=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?s_:sw).apply(null,arguments)}function sI(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function sT(e,t){function n(){}n.prototype=t.prototype,e.$=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.ac=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function sE(){this.s=this.s,this.o=this.o}sE.prototype.s=!1,sE.prototype.ra=function(){this.s||(this.s=!0,this.N())},sE.prototype.N=function(){if(this.o)for(;this.o.length;)this.o.shift()()};let sC=Array.prototype.indexOf?function(e,t){return Array.prototype.indexOf.call(e,t,void 0)}:function(e,t){if("string"==typeof e)return"string"!=typeof t||1!=t.length?-1:e.indexOf(t,0);for(let n=0;n<e.length;n++)if(n in e&&e[n]===t)return n;return -1};function sS(e){let t=e.length;if(0<t){let n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function sk(e,t){for(let t=1;t<arguments.length;t++){let n=arguments[t];if(sy(n)){let t=e.length||0,r=n.length||0;e.length=t+r;for(let i=0;i<r;i++)e[t+i]=n[i]}else e.push(n)}}function sx(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}sx.prototype.h=function(){this.defaultPrevented=!0};var sA=function(){if(!sg.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{sg.addEventListener("test",sm,t),sg.removeEventListener("test",sm,t)}catch(e){}return e}();function sR(e){return/^[\s\xa0]*$/.test(e)}var sN=String.prototype.trim?function(e){return e.trim()}:function(e){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(e)[1]};function sP(e,t){return e<t?-1:e>t?1:0}function sD(){var e=sg.navigator;return e&&(e=e.userAgent)?e:""}function sO(e){return -1!=sD().indexOf(e)}function sF(e){return sF[" "](e),e}function sL(e,t,n){return Object.prototype.hasOwnProperty.call(e,t)?e[t]:e[t]=n(t)}sF[" "]=sm;var sM=sO("Opera"),sU=sO("Trident")||sO("MSIE"),sV=sO("Edge"),sq=sV||sU,sj=sO("Gecko")&&!(-1!=sD().toLowerCase().indexOf("webkit")&&!sO("Edge"))&&!(sO("Trident")||sO("MSIE"))&&!sO("Edge"),sB=-1!=sD().toLowerCase().indexOf("webkit")&&!sO("Edge");function sz(){var e=sg.document;return e?e.documentMode:void 0}e:{var s$,sH="",sW=(s$=sD(),sj?/rv:([^\);]+)(\)|;)/.exec(s$):sV?/Edge\/([\d\.]+)/.exec(s$):sU?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(s$):sB?/WebKit\/(\S+)/.exec(s$):sM?/(?:Version)[ \/]?(\S+)/.exec(s$):void 0);if(sW&&(sH=sW?sW[1]:""),sU){var sG=sz();if(null!=sG&&sG>parseFloat(sH)){g=String(sG);break e}}g=sH}var sK={},sZ=sg.document&&sU&&(sz()||parseInt(g,10))||void 0;function sQ(e,t){if(sx.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(sj){e:{try{sF(t.nodeName);var i=!0;break e}catch(e){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"==typeof e.pointerType?e.pointerType:sY[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&sQ.$.h.call(this)}}sT(sQ,sx);var sY={2:"touch",3:"pen",4:"mouse"};sQ.prototype.h=function(){sQ.$.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var sX="closure_listenable_"+(1e6*Math.random()|0),sJ=0;function s0(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.la=i,this.key=++sJ,this.fa=this.ia=!1}function s1(e){e.fa=!0,e.listener=null,e.proxy=null,e.src=null,e.la=null}function s2(e,t,n){for(let r in e)t.call(n,e[r],r,e)}function s4(e){let t={};for(let n in e)t[n]=e[n];return t}let s9="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function s5(e,t){let n,r;for(let t=1;t<arguments.length;t++){for(n in r=arguments[t])e[n]=r[n];for(let t=0;t<s9.length;t++)n=s9[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function s6(e){this.src=e,this.g={},this.h=0}function s3(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=sC(i,t);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(s1(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function s8(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.fa&&s.listener==t&&!!n==s.capture&&s.la==r)return i}return -1}s6.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=s8(e,t,r,i);return -1<o?(t=e[o],n||(t.ia=!1)):((t=new s0(t,this.src,s,!!r,i)).ia=n,e.push(t)),t};var s7="closure_lm_"+(1e6*Math.random()|0),oe={};function ot(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var o=sv(i)?!!i.capture:!!i,a=os(e);if(a||(e[s7]=a=new s6(e)),(n=a.add(t,n,r,o,s)).proxy)return n;if(r=function e(t){return oi.call(e.src,e.listener,t)},n.proxy=r,r.src=e,r.listener=n,e.addEventListener)sA||(i=o),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(or(t.toString()),r);else if(e.addListener&&e.removeListener)e.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function on(e){if("number"!=typeof e&&e&&!e.fa){var t=e.src;if(t&&t[sX])s3(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(or(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=os(t))?(s3(n,e),0==n.h&&(n.src=null,t[s7]=null)):s1(e)}}}function or(e){return e in oe?oe[e]:oe[e]="on"+e}function oi(e,t){if(e.fa)e=!0;else{t=new sQ(t,this);var n=e.listener,r=e.la||e.src;e.ia&&on(e),e=n.call(r,t)}return e}function os(e){return(e=e[s7])instanceof s6?e:null}var oo="__closure_events_fn_"+(1e9*Math.random()>>>0);function oa(e){return"function"==typeof e?e:(e[oo]||(e[oo]=function(t){return e.handleEvent(t)}),e[oo])}function ol(){sE.call(this),this.i=new s6(this),this.S=this,this.J=null}function ou(e,t){var n,r=e.J;if(r)for(n=[];r;r=r.J)n.push(r);if(e=e.S,r=t.type||t,"string"==typeof t)t=new sx(t,e);else if(t instanceof sx)t.target=t.target||e;else{var i=t;s5(t=new sx(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=oc(o,r,!0,t)&&i}if(i=oc(o=t.g=e,r,!0,t)&&i,i=oc(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=oc(o=t.g=n[s],r,!1,t)&&i}function oc(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.fa&&o.capture==n){var a=o.listener,l=o.la||o.src;o.ia&&s3(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}sT(ol,sE),ol.prototype[sX]=!0,ol.prototype.removeEventListener=function(e,t,n,r){!function e(t,n,r,i,s){if(Array.isArray(n))for(var o=0;o<n.length;o++)e(t,n[o],r,i,s);else(i=sv(i)?!!i.capture:!!i,r=oa(r),t&&t[sX])?(t=t.i,(n=String(n).toString())in t.g&&-1<(r=s8(o=t.g[n],r,i,s))&&(s1(o[r]),Array.prototype.splice.call(o,r,1),0==o.length&&(delete t.g[n],t.h--))):t&&(t=os(t))&&(n=t.g[n.toString()],t=-1,n&&(t=s8(n,r,i,s)),(r=-1<t?n[t]:null)&&on(r))}(this,e,t,n,r)},ol.prototype.N=function(){if(ol.$.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)s1(n[r]);delete t.g[e],t.h--}}this.J=null},ol.prototype.O=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ol.prototype.P=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};var oh=sg.JSON.stringify,od=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}(()=>new of,e=>e.reset());class of{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}function op(e,t){var n;y||(n=sg.Promise.resolve(void 0),y=function(){n.then(oy)}),og||(y(),og=!0),om.add(e,t)}var og=!1,om=new class{constructor(){this.h=this.g=null}add(e,t){let n=od.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}};function oy(){let e;for(;e=null,(t=om).g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),n=e;){try{n.h.call(n.g)}catch(e){!function(e){sg.setTimeout(()=>{throw e},0)}(e)}var t,n,r=od;r.j(n),100>r.h&&(r.h++,n.next=r.g,r.g=n)}og=!1}function ov(e,t){ol.call(this),this.h=e||1,this.g=t||sg,this.j=sb(this.qb,this),this.l=Date.now()}function o_(e){e.ga=!1,e.T&&(e.g.clearTimeout(e.T),e.T=null)}function ow(e,t,n){if("function"==typeof e)n&&(e=sb(e,n));else if(e&&"function"==typeof e.handleEvent)e=sb(e.handleEvent,e);else throw Error("Invalid listener argument");return 2147483647<Number(t)?-1:sg.setTimeout(e,t||0)}sT(ov,ol),(sh=ov.prototype).ga=!1,sh.T=null,sh.qb=function(){if(this.ga){var e=Date.now()-this.l;0<e&&e<.8*this.h?this.T=this.g.setTimeout(this.j,this.h-e):(this.T&&(this.g.clearTimeout(this.T),this.T=null),ou(this,"tick"),this.ga&&(o_(this),this.start()))}},sh.start=function(){this.ga=!0,this.T||(this.T=this.g.setTimeout(this.j,this.h),this.l=Date.now())},sh.N=function(){ov.$.N.call(this),o_(this),delete this.g};class ob extends sE{constructor(e,t){super(),this.m=e,this.j=t,this.h=null,this.i=!1,this.g=null}l(e){this.h=arguments,this.g?this.i=!0:function e(t){t.g=ow(()=>{t.g=null,t.i&&(t.i=!1,e(t))},t.j);let n=t.h;t.h=null,t.m.apply(null,n)}(this)}N(){super.N(),this.g&&(sg.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function oI(e){sE.call(this),this.h=e,this.g={}}sT(oI,sE);var oT=[];function oE(e,t,n,r){Array.isArray(n)||(n&&(oT[0]=n.toString()),n=oT);for(var i=0;i<n.length;i++){var s=function e(t,n,r,i,s){if(i&&i.once)return function e(t,n,r,i,s){if(Array.isArray(n)){for(var o=0;o<n.length;o++)e(t,n[o],r,i,s);return null}return r=oa(r),t&&t[sX]?t.P(n,r,sv(i)?!!i.capture:!!i,s):ot(t,n,r,!0,i,s)}(t,n,r,i,s);if(Array.isArray(n)){for(var o=0;o<n.length;o++)e(t,n[o],r,i,s);return null}return r=oa(r),t&&t[sX]?t.O(n,r,sv(i)?!!i.capture:!!i,s):ot(t,n,r,!1,i,s)}(t,n[i],r||e.handleEvent,!1,e.h||e);if(!s)break;e.g[s.key]=s}}function oC(e){s2(e.g,function(e,t){this.g.hasOwnProperty(t)&&on(e)},e),e.g={}}function oS(){this.g=!0}function ok(e,t,n,r){e.info(function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n){for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}}return oh(n)}catch(e){return t}}(e,n)+(r?" "+r:"")})}oI.prototype.N=function(){oI.$.N.call(this),oC(this)},oI.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},oS.prototype.Ea=function(){this.g=!1},oS.prototype.info=function(){};var ox={},oA=null;function oR(){return oA=oA||new ol}function oN(e){sx.call(this,ox.Ta,e)}function oP(e){let t=oR();ou(t,new oN(t))}function oD(e,t){sx.call(this,ox.STAT_EVENT,e),this.stat=t}function oO(e){let t=oR();ou(t,new oD(t,e))}function oF(e,t){sx.call(this,ox.Ua,e),this.size=t}function oL(e,t){if("function"!=typeof e)throw Error("Fn must not be null and must be a function");return sg.setTimeout(function(){e()},t)}ox.Ta="serverreachability",sT(oN,sx),ox.STAT_EVENT="statevent",sT(oD,sx),ox.Ua="timingevent",sT(oF,sx);var oM={NO_ERROR:0,rb:1,Eb:2,Db:3,yb:4,Cb:5,Fb:6,Qa:7,TIMEOUT:8,Ib:9},oU={wb:"complete",Sb:"success",Ra:"error",Qa:"abort",Kb:"ready",Lb:"readystatechange",TIMEOUT:"timeout",Gb:"incrementaldata",Jb:"progress",zb:"downloadprogress",$b:"uploadprogress"};function oV(){}function oq(e){return e.h||(e.h=e.i())}function oj(){}oV.prototype.h=null;var oB={OPEN:"a",vb:"b",Ra:"c",Hb:"d"};function oz(){sx.call(this,"d")}function o$(){sx.call(this,"c")}function oH(){}function oW(e,t,n,r){this.l=e,this.j=t,this.m=n,this.W=r||1,this.U=new oI(this),this.P=oK,e=sq?125:void 0,this.V=new ov(e),this.I=null,this.i=!1,this.s=this.A=this.v=this.L=this.G=this.Y=this.B=null,this.F=[],this.g=null,this.C=0,this.o=this.u=null,this.aa=-1,this.J=!1,this.O=0,this.M=null,this.ca=this.K=this.ba=this.S=!1,this.h=new oG}function oG(){this.i=null,this.g="",this.h=!1}sT(oz,sx),sT(o$,sx),sT(oH,oV),oH.prototype.g=function(){return new XMLHttpRequest},oH.prototype.i=function(){return{}},v=new oH;var oK=45e3,oZ={},oQ={};function oY(e,t,n){e.L=1,e.v=as(ae(t)),e.s=n,e.S=!0,oX(e,null)}function oX(e,t){e.G=Date.now(),o1(e),e.A=ae(e.v);var n=e.A,r=e.W;Array.isArray(r)||(r=[String(r)]),av(n.i,"t",r),e.C=0,n=e.l.I,e.h=new oG,e.g=la(e.l,n?t:null,!e.s),0<e.O&&(e.M=new ob(sb(e.Pa,e,e.g),e.O)),oE(e.U,e.g,"readystatechange",e.nb),t=e.I?s4(e.I):{},e.s?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ha(e.A,e.u,e.s,t)):(e.u="GET",e.g.ha(e.A,e.u,null,t)),oP(),function(e,t,n,r,i,s){e.info(function(){if(e.g){if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");o=2<=h.length&&"type"==h[1]?o+(c+"=")+u+"&":o+(c+"=redacted&")}}else o=null}else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o})}(e.j,e.u,e.A,e.m,e.W,e.s)}function oJ(e){return!!e.g&&"GET"==e.u&&2!=e.L&&e.l.Ha}function o0(e,t,n){let r=!0,i;for(;!e.J&&e.C<n.length;)if((i=function(e,t){var n=e.C,r=t.indexOf("\n",n);return -1==r?oQ:isNaN(n=Number(t.substring(n,r)))?oZ:(r+=1)+n>t.length?oQ:(t=t.substr(r,n),e.C=r+n,t)}(e,n))==oQ){4==t&&(e.o=4,oO(14),r=!1),ok(e.j,e.m,null,"[Incomplete Response]");break}else if(i==oZ){e.o=4,oO(15),ok(e.j,e.m,n,"[Invalid Chunk]"),r=!1;break}else ok(e.j,e.m,i,null),o6(e,i);oJ(e)&&i!=oQ&&i!=oZ&&(e.h.g="",e.C=0),4!=t||0!=n.length||e.h.h||(e.o=1,oO(16),r=!1),e.i=e.i&&r,r?0<n.length&&!e.ca&&(e.ca=!0,(t=e.l).g==e&&t.ca&&!t.L&&(t.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),a7(t),t.L=!0,oO(11))):(ok(e.j,e.m,n,"[Invalid Chunked Response]"),o5(e),o9(e))}function o1(e){e.Y=Date.now()+e.P,o2(e,e.P)}function o2(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=oL(sb(e.lb,e),t)}function o4(e){e.B&&(sg.clearTimeout(e.B),e.B=null)}function o9(e){0==e.l.H||e.J||ln(e.l,e)}function o5(e){o4(e);var t=e.M;t&&"function"==typeof t.ra&&t.ra(),e.M=null,o_(e.V),oC(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ra())}function o6(e,t){try{var n=e.l;if(0!=n.H&&(n.g==e||aC(n.h,e))){if(!e.K&&aC(n.h,e)&&3==n.H){try{var r=n.Ja.g.parse(t)}catch(e){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(n.g.G+3e3<e.G)lt(n),a1(n);else break e}a8(n),oO(18)}}else n.Fa=i[1],0<n.Fa-n.V&&37500>i[2]&&n.M&&0==n.A&&!n.v&&(n.v=oL(sb(n.ib,n),6e3));if(1>=aE(n.h)&&n.na){try{n.na()}catch(e){}n.na=void 0}}else li(n,11)}else if((e.K||n.g==e)&&lt(n),!sR(t))for(i=n.Ja.g.parse(t),t=0;t<i.length;t++){let a=i[t];if(n.V=a[0],a=a[1],2==n.H){if("c"==a[0]){n.J=a[1],n.oa=a[2];let t=a[3];null!=t&&(n.qa=t,n.j.info("VER="+n.qa));let i=a[4];null!=i&&(n.Ga=i,n.j.info("SVER="+n.Ga));let l=a[5];null!=l&&"number"==typeof l&&0<l&&(r=1.5*l,n.K=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;let u=e.g;if(u){let e=u.g?u.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(aS(s,s.h),s.h=null))}if(r.F){let e=u.g?u.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.Da=e,ai(r.G,r.F,e))}}if(n.H=3,n.l&&n.l.Ba(),n.ca&&(n.S=Date.now()-e.G,n.j.info("Handshake RTT: "+n.S+"ms")),(r=n).wa=lo(r,r.I?r.oa:null,r.Y),e.K){ak(r.h,e);var o=r.K;o&&e.setTimeout(o),e.B&&(o4(e),o1(e)),r.g=e}else a3(r);0<n.i.length&&a4(n)}else"stop"!=a[0]&&"close"!=a[0]||li(n,7)}else 3==n.H&&("stop"==a[0]||"close"==a[0]?"stop"==a[0]?li(n,7):a0(n):"noop"!=a[0]&&n.l&&n.l.Aa(a),n.A=0)}}oP(4)}catch(e){}}function o3(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(sy(e)||"string"==typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.sa&&"function"==typeof e.sa)return e.sa();if(!e.Z||"function"!=typeof e.Z){if("undefined"!=typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!=typeof Set&&e instanceof Set)){if(sy(e)||"string"==typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}for(let r in t=[],n=0,e)t[n++]=r;return t}}}(e),r=function(e){if(e.Z&&"function"==typeof e.Z)return e.Z();if("undefined"!=typeof Map&&e instanceof Map||"undefined"!=typeof Set&&e instanceof Set)return Array.from(e.values());if("string"==typeof e)return e.split("");if(sy(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,s=0;s<i;s++)t.call(void 0,r[s],n&&n[s],e)}(sh=oW.prototype).setTimeout=function(e){this.P=e},sh.nb=function(e){e=e.target;let t=this.M;t&&3==aK(e)?t.l():this.Pa(e)},sh.Pa=function(e){try{if(e==this.g)e:{let c=aK(this.g);var t=this.g.Ia();let h=this.g.da();if(!(3>c)&&(3!=c||sq||this.g&&(this.h.h||this.g.ja()||aZ(this.g)))){this.J||4!=c||7==t||(8==t||0>=h?oP(3):oP(2)),o4(this);var n=this.g.da();this.aa=n;t:if(oJ(this)){var r=aZ(this.g);e="";var i=r.length,s=4==aK(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){o5(this),o9(this);var o="";break t}this.h.i=new sg.TextDecoder}for(t=0;t<i;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:s&&t==i-1});r.splice(0,i),this.h.g+=e,this.C=0,o=this.h.g}else o=this.g.ja();if(this.i=200==n,function(e,t,n,r,i,s,o){e.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o})}(this.j,this.u,this.A,this.m,this.W,c,n),this.i){if(this.ba&&!this.K){t:{if(this.g){var a,l=this.g;if((a=l.g?l.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!sR(a)){var u=a;break t}}u=null}if(n=u)ok(this.j,this.m,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,o6(this,n);else{this.i=!1,this.o=3,oO(12),o5(this),o9(this);break e}}this.S?(o0(this,c,o),sq&&this.i&&3==c&&(oE(this.U,this.V,"tick",this.mb),this.V.start())):(ok(this.j,this.m,o,null),o6(this,o)),4==c&&o5(this),this.i&&!this.J&&(4==c?ln(this.l,this):(this.i=!1,o1(this)))}else 400==n&&0<o.indexOf("Unknown SID")?(this.o=3,oO(12)):(this.o=0,oO(13)),o5(this),o9(this)}}}catch(e){}finally{}},sh.mb=function(){if(this.g){var e=aK(this.g),t=this.g.ja();this.C<t.length&&(o4(this),o0(this,e,t),this.i&&4!=e&&o1(this))}},sh.cancel=function(){this.J=!0,o5(this)},sh.lb=function(){this.B=null;let e=Date.now();0<=e-this.Y?(function(e,t){e.info(function(){return"TIMEOUT: "+t})}(this.j,this.A),2!=this.L&&(oP(),oO(17)),o5(this),this.o=2,o9(this)):o2(this,this.Y-e)};var o8=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function o7(e,t){if(this.g=this.s=this.j="",this.m=null,this.o=this.l="",this.h=!1,e instanceof o7){this.h=void 0!==t?t:e.h,at(this,e.j),this.s=e.s,this.g=e.g,an(this,e.m),this.l=e.l,t=e.i;var n=new ap;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ar(this,n),this.o=e.o}else e&&(n=String(e).match(o8))?(this.h=!!t,at(this,n[1]||"",!0),this.s=ao(n[2]||""),this.g=ao(n[3]||"",!0),an(this,n[4]),this.l=ao(n[5]||"",!0),ar(this,n[6]||"",!0),this.o=ao(n[7]||"")):(this.h=!!t,this.i=new ap(null,this.h))}function ae(e){return new o7(e)}function at(e,t,n){e.j=n?ao(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function an(e,t){if(t){if(isNaN(t=Number(t))||0>t)throw Error("Bad port number "+t);e.m=t}else e.m=null}function ar(e,t,n){var r,i;t instanceof ap?(e.i=t,r=e.i,(i=e.h)&&!r.j&&(ag(r),r.i=null,r.g.forEach(function(e,t){var n=t.toLowerCase();t!=n&&(am(this,t),av(this,n,e))},r)),r.j=i):(n||(t=aa(t,ad)),e.i=new ap(t,e.h))}function ai(e,t,n){e.i.set(t,n)}function as(e){return ai(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function ao(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function aa(e,t,n){return"string"==typeof e?(e=encodeURI(e).replace(t,al),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function al(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}o7.prototype.toString=function(){var e=[],t=this.j;t&&e.push(aa(t,au,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.s)&&e.push(aa(t,au,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.m)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(aa(n,"/"==n.charAt(0)?ah:ac,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.o)&&e.push("#",aa(n,af)),e.join("")};var au=/[#\/\?@]/g,ac=/[#\?:]/g,ah=/[#\?]/g,ad=/[#\?@]/g,af=/#/g;function ap(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function ag(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)}))}function am(e,t){ag(e),t=a_(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function ay(e,t){return ag(e),t=a_(e,t),e.g.has(t)}function av(e,t,n){am(e,t),0<n.length&&(e.i=null,e.g.set(a_(e,t),sS(n)),e.h+=n.length)}function a_(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}(sh=ap.prototype).add=function(e,t){ag(this),this.i=null,e=a_(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},sh.forEach=function(e,t){ag(this),this.g.forEach(function(n,r){n.forEach(function(n){e.call(t,n,r,this)},this)},this)},sh.sa=function(){ag(this);let e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){let i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},sh.Z=function(e){ag(this);let t=[];if("string"==typeof e)ay(this,e)&&(t=t.concat(this.g.get(a_(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},sh.set=function(e,t){return ag(this),this.i=null,ay(this,e=a_(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},sh.get=function(e,t){return e&&0<(e=this.Z(e)).length?String(e[0]):t},sh.toString=function(){if(this.i)return this.i;if(!this.g)return"";let e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];let s=encodeURIComponent(String(r)),o=this.Z(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")};var aw=class{constructor(e,t){this.h=e,this.g=t}};function ab(e){this.l=e||aI,e=sg.PerformanceNavigationTiming?0<(e=sg.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):!!(sg.g&&sg.g.Ka&&sg.g.Ka()&&sg.g.Ka().ec),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var aI=10;function aT(e){return!!e.h||!!e.g&&e.g.size>=e.j}function aE(e){return e.h?1:e.g?e.g.size:0}function aC(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function aS(e,t){e.g?e.g.add(t):e.h=t}function ak(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ax(e){if(null!=e.h)return e.i.concat(e.h.F);if(null!=e.g&&0!==e.g.size){let t=e.i;for(let n of e.g.values())t=t.concat(n.F);return t}return sS(e.i)}function aA(){}function aR(){this.g=new aA}function aN(e,t,n,r,i){try{t.onload=null,t.onerror=null,t.onabort=null,t.ontimeout=null,i(r)}catch(e){}}function aP(e){this.l=e.fc||null,this.j=e.ob||!1}function aD(e,t){ol.call(this),this.F=e,this.u=t,this.m=void 0,this.readyState=aO,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ab.prototype.cancel=function(){if(this.i=ax(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(let e of this.g.values())e.cancel();this.g.clear()}},aA.prototype.stringify=function(e){return sg.JSON.stringify(e,void 0)},aA.prototype.parse=function(e){return sg.JSON.parse(e,void 0)},sT(aP,oV),aP.prototype.g=function(){return new aD(this.l,this.j)},aP.prototype.i=(p={},function(){return p}),sT(aD,ol);var aO=0;function aF(e){e.j.read().then(e.Xa.bind(e)).catch(e.ka.bind(e))}function aL(e){e.readyState=4,e.l=null,e.j=null,e.A=null,aM(e)}function aM(e){e.onreadystatechange&&e.onreadystatechange.call(e)}(sh=aD.prototype).open=function(e,t){if(this.readyState!=aO)throw this.abort(),Error("Error reopening a connection");this.C=e,this.B=t,this.readyState=1,aM(this)},sh.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;let t={headers:this.v,method:this.C,credentials:this.m,cache:void 0};e&&(t.body=e),(this.F||sg).fetch(new Request(this.B,t)).then(this.$a.bind(this),this.ka.bind(this))},sh.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,aL(this)),this.readyState=aO},sh.$a=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,aM(this)),this.g&&(this.readyState=3,aM(this),this.g))){if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Ya.bind(this),this.ka.bind(this));else if(void 0!==sg.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;aF(this)}else e.text().then(this.Za.bind(this),this.ka.bind(this))}},sh.Xa=function(e){if(this.g){if(this.u&&e.value)this.response.push(e.value);else if(!this.u){var t=e.value?e.value:new Uint8Array(0);(t=this.A.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?aL(this):aM(this),3==this.readyState&&aF(this)}},sh.Za=function(e){this.g&&(this.response=this.responseText=e,aL(this))},sh.Ya=function(e){this.g&&(this.response=e,aL(this))},sh.ka=function(){this.g&&aL(this)},sh.setRequestHeader=function(e,t){this.v.append(e,t)},sh.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},sh.getAllResponseHeaders=function(){if(!this.h)return"";let e=[],t=this.h.entries();for(var n=t.next();!n.done;)e.push((n=n.value)[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(aD.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}});var aU=sg.JSON.parse;function aV(e){ol.call(this),this.headers=new Map,this.u=e||null,this.h=!1,this.C=this.g=null,this.I="",this.m=0,this.j="",this.l=this.G=this.v=this.F=!1,this.B=0,this.A=null,this.K=aq,this.L=this.M=!1}sT(aV,ol);var aq="",aj=/^https?$/i,aB=["POST","PUT"];function az(e,t){e.h=!1,e.g&&(e.l=!0,e.g.abort(),e.l=!1),e.j=t,e.m=5,a$(e),aW(e)}function a$(e){e.F||(e.F=!0,ou(e,"complete"),ou(e,"error"))}function aH(e){if(e.h&&void 0!==sp&&(!e.C[1]||4!=aK(e)||2!=e.da())){if(e.v&&4==aK(e))ow(e.La,0,e);else if(ou(e,"readystatechange"),4==aK(e)){e.h=!1;try{let a=e.da();e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t,n,r=!0;break e;default:r=!1}if(!(t=r)){if(n=0===a){var i=String(e.I).match(o8)[1]||null;if(!i&&sg.self&&sg.self.location){var s=sg.self.location.protocol;i=s.substr(0,s.length-1)}n=!aj.test(i?i.toLowerCase():"")}t=n}if(t)ou(e,"complete"),ou(e,"success");else{e.m=6;try{var o=2<aK(e)?e.g.statusText:""}catch(e){o=""}e.j=o+" ["+e.da()+"]",a$(e)}}finally{aW(e)}}}}function aW(e,t){if(e.g){aG(e);let n=e.g,r=e.C[0]?sm:null;e.g=null,e.C=null,t||ou(e,"ready");try{n.onreadystatechange=r}catch(e){}}}function aG(e){e.g&&e.L&&(e.g.ontimeout=null),e.A&&(sg.clearTimeout(e.A),e.A=null)}function aK(e){return e.g?e.g.readyState:0}function aZ(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.K){case aq:case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(e){return null}}function aQ(e){let t="";return s2(e,function(e,n){t+=n+":"+e+"\r\n"}),t}function aY(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=aQ(n),"string"==typeof e?null!=n&&encodeURIComponent(String(n)):ai(e,t,n))}function aX(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function aJ(e){this.Ga=0,this.i=[],this.j=new oS,this.oa=this.wa=this.G=this.Y=this.g=this.Da=this.F=this.ma=this.o=this.U=this.s=null,this.fb=this.W=0,this.cb=aX("failFast",!1,e),this.M=this.v=this.u=this.m=this.l=null,this.aa=!0,this.ta=this.Fa=this.V=-1,this.ba=this.A=this.C=0,this.ab=aX("baseRetryDelayMs",5e3,e),this.hb=aX("retryDelaySeedMs",1e4,e),this.eb=aX("forwardChannelMaxRetries",2,e),this.xa=aX("forwardChannelRequestTimeoutMs",2e4,e),this.va=e&&e.xmlHttpFactory||void 0,this.Ha=e&&e.dc||!1,this.K=void 0,this.I=e&&e.supportsCrossDomainXhr||!1,this.J="",this.h=new ab(e&&e.concurrentRequestLimit),this.Ja=new aR,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.bb=e&&e.bc||!1,e&&e.Ea&&this.j.Ea(),e&&e.forceLongPolling&&(this.aa=!1),this.ca=!this.P&&this.aa&&e&&e.detectBufferingProxy||!1,this.na=void 0,this.S=0,this.L=!1,this.pa=this.B=null}function a0(e){if(a2(e),3==e.H){var t=e.W++,n=ae(e.G);ai(n,"SID",e.J),ai(n,"RID",t),ai(n,"TYPE","terminate"),a5(e,n),(t=new oW(e,e.j,t,void 0)).L=2,t.v=as(ae(n)),n=!1,sg.navigator&&sg.navigator.sendBeacon&&(n=sg.navigator.sendBeacon(t.v.toString(),"")),!n&&sg.Image&&((new Image).src=t.v,n=!0),n||(t.g=la(t.l,null),t.g.ha(t.v)),t.G=Date.now(),o1(t)}ls(e)}function a1(e){e.g&&(a7(e),e.g.cancel(),e.g=null)}function a2(e){a1(e),e.u&&(sg.clearTimeout(e.u),e.u=null),lt(e),e.h.cancel(),e.m&&("number"==typeof e.m&&sg.clearTimeout(e.m),e.m=null)}function a4(e){aT(e.h)||e.m||(e.m=!0,op(e.Na,e),e.C=0)}function a9(e,t){var n;n=t?t.m:e.W++;let r=ae(e.G);ai(r,"SID",e.J),ai(r,"RID",n),ai(r,"AID",e.V),a5(e,r),e.o&&e.s&&aY(r,e.o,e.s),n=new oW(e,e.j,n,e.C+1),null===e.o&&(n.I=e.s),t&&(e.i=t.F.concat(e.i)),t=a6(e,n,1e3),n.setTimeout(Math.round(.5*e.xa)+Math.round(.5*e.xa*Math.random())),aS(e.h,n),oY(n,r,t)}function a5(e,t){e.ma&&s2(e.ma,function(e,n){ai(t,n,e)}),e.l&&o3({},function(e,n){ai(t,n,e)})}function a6(e,t,n){n=Math.min(e.i.length,n);var r=e.l?sb(e.l.Va,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){let e=["count="+n];-1==t?0<n?(t=i[0].h,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].h,a=i[o].g;if(0>(n-=t))t=Math.max(0,i[o].h-100),s=!1;else try{!function(e,t,n){let r=n||"";try{o3(e,function(e,n){let i=e;sv(e)&&(i=oh(e)),t.push(r+n+"="+encodeURIComponent(i))})}catch(e){throw t.push(r+"type="+encodeURIComponent("_badmap")),e}}(a,e,"req"+n+"_")}catch(e){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.F=e,r}function a3(e){e.g||e.u||(e.ba=1,op(e.Ma,e),e.A=0)}function a8(e){return!e.g&&!e.u&&!(3<=e.A)&&(e.ba++,e.u=oL(sb(e.Ma,e),lr(e,e.A)),e.A++,!0)}function a7(e){null!=e.B&&(sg.clearTimeout(e.B),e.B=null)}function le(e){e.g=new oW(e,e.j,"rpc",e.ba),null===e.o&&(e.g.I=e.s),e.g.O=0;var t=ae(e.wa);ai(t,"RID","rpc"),ai(t,"SID",e.J),ai(t,"CI",e.M?"0":"1"),ai(t,"AID",e.V),ai(t,"TYPE","xmlhttp"),a5(e,t),e.o&&e.s&&aY(t,e.o,e.s),e.K&&e.g.setTimeout(e.K);var n=e.g;e=e.oa,n.L=1,n.v=as(ae(t)),n.s=null,n.S=!0,oX(n,e)}function lt(e){null!=e.v&&(sg.clearTimeout(e.v),e.v=null)}function ln(e,t){var n=null;if(e.g==t){lt(e),a7(e),e.g=null;var r=2}else{if(!aC(e.h,t))return;n=t.F,ak(e.h,t),r=1}if(0!=e.H){if(e.ta=t.aa,t.i){if(1==r){n=t.s?t.s.length:0,t=Date.now()-t.G;var i,s,o=e.C;ou(r=oR(),new oF(r,n)),a4(e)}else a3(e)}else if(3==(o=t.o)||0==o&&0<e.ta||!(1==r&&(i=e,s=t,!(aE(i.h)>=i.h.j-(i.m?1:0))&&(i.m?(i.i=s.F.concat(i.i),!0):1!=i.H&&2!=i.H&&!(i.C>=(i.cb?0:i.eb))&&(i.m=oL(sb(i.Na,i,s),lr(i,i.C)),i.C++,!0)))||2==r&&a8(e)))switch(n&&0<n.length&&((t=e.h).i=t.i.concat(n)),o){case 1:li(e,5);break;case 4:li(e,10);break;case 3:li(e,6);break;default:li(e,2)}}}function lr(e,t){let n=e.ab+Math.floor(Math.random()*e.hb);return e.l||(n*=2),n*t}function li(e,t){if(e.j.info("Error code "+t),2==t){var n=null;e.l&&(n=null);var r=sb(e.pb,e);n||(n=new o7("//www.google.com/images/cleardot.gif"),sg.location&&"http"==sg.location.protocol||at(n,"https"),as(n)),function(e,t){let n=new oS;if(sg.Image){let r=new Image;r.onload=sI(aN,n,r,"TestLoadImage: loaded",!0,t),r.onerror=sI(aN,n,r,"TestLoadImage: error",!1,t),r.onabort=sI(aN,n,r,"TestLoadImage: abort",!1,t),r.ontimeout=sI(aN,n,r,"TestLoadImage: timeout",!1,t),sg.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=e}else t(!1)}(n.toString(),r)}else oO(2);e.H=0,e.l&&e.l.za(t),ls(e),a2(e)}function ls(e){if(e.H=0,e.pa=[],e.l){let t=ax(e.h);(0!=t.length||0!=e.i.length)&&(sk(e.pa,t),sk(e.pa,e.i),e.h.i.length=0,sS(e.i),e.i.length=0),e.l.ya()}}function lo(e,t,n){var r=n instanceof o7?ae(n):new o7(n,void 0);if(""!=r.g)t&&(r.g=t+"."+r.g),an(r,r.m);else{var i=sg.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;var s=new o7(null,void 0);r&&at(s,r),t&&(s.g=t),i&&an(s,i),n&&(s.l=n),r=s}return n=e.F,t=e.Da,n&&t&&ai(r,n,t),ai(r,"VER",e.qa),a5(e,r),r}function la(e,t,n){if(t&&!e.I)throw Error("Can't create secondary domain capable XhrIo object.");return(t=new aV(n&&e.Ha&&!e.va?new aP({ob:!0}):e.va)).Oa(e.I),t}function ll(){}function lu(){if(sU&&!(10<=Number(sZ)))throw Error("Environmental error: no available transport.")}function lc(e,t){ol.call(this),this.g=new aJ(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.s=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.Ca&&(e?e["X-WebChannel-Client-Profile"]=t.Ca:e={"X-WebChannel-Client-Profile":t.Ca}),this.g.U=e,(e=t&&t.cc)&&!sR(e)&&(this.g.o=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!sR(t)&&(this.g.F=t,null!==(e=this.h)&&t in e&&t in(e=this.h)&&delete e[t]),this.j=new lf(this)}function lh(e){oz.call(this);var t=e.__sm__;if(t){e:{for(let n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function ld(){o$.call(this),this.status=1}function lf(e){this.g=e}function lp(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.m=Array(this.blockSize),this.i=this.h=0,this.reset()}function lg(e,t,n){n||(n=0);var r=Array(16);if("string"==typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=s+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[1]+3905402710&4294967295,o=i+(n^(s=t+(o<<12&4294967295|o>>>20))&(t^n))+r[2]+606105819&4294967295,o=n+(t^(i=s+(o<<17&4294967295|o>>>15))&(s^t))+r[3]+3250441966&4294967295,o=t+(s^(n=i+(o<<22&4294967295|o>>>10))&(i^s))+r[4]+4118548399&4294967295,o=s+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[5]+1200080426&4294967295,o=i+(n^(s=t+(o<<12&4294967295|o>>>20))&(t^n))+r[6]+2821735955&4294967295,o=n+(t^(i=s+(o<<17&4294967295|o>>>15))&(s^t))+r[7]+4249261313&4294967295,o=t+(s^(n=i+(o<<22&4294967295|o>>>10))&(i^s))+r[8]+1770035416&4294967295,o=s+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[9]+2336552879&4294967295,o=i+(n^(s=t+(o<<12&4294967295|o>>>20))&(t^n))+r[10]+4294925233&4294967295,o=n+(t^(i=s+(o<<17&4294967295|o>>>15))&(s^t))+r[11]+2304563134&4294967295,o=t+(s^(n=i+(o<<22&4294967295|o>>>10))&(i^s))+r[12]+1804603682&4294967295,o=s+(i^(t=n+(o<<7&4294967295|o>>>25))&(n^i))+r[13]+4254626195&4294967295,o=i+(n^(s=t+(o<<12&4294967295|o>>>20))&(t^n))+r[14]+2792965006&4294967295,o=n+(t^(i=s+(o<<17&4294967295|o>>>15))&(s^t))+r[15]+1236535329&4294967295,n=i+(o<<22&4294967295|o>>>10),o=t+(i^s&(n^i))+r[1]+4129170786&4294967295,t=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(t^n))+r[6]+3225465664&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[11]+643717713&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^t&(i^s))+r[0]+3921069994&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^s&(n^i))+r[5]+3593408605&4294967295,t=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(t^n))+r[10]+38016083&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[15]+3634488961&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^t&(i^s))+r[4]+3889429448&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^s&(n^i))+r[9]+568446438&4294967295,t=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(t^n))+r[14]+3275163606&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[3]+4107603335&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^t&(i^s))+r[8]+1163531501&4294967295,n=i+(o<<20&4294967295|o>>>12),o=t+(i^s&(n^i))+r[13]+2850285829&4294967295,t=n+(o<<5&4294967295|o>>>27),o=s+(n^i&(t^n))+r[2]+4243563512&4294967295,s=t+(o<<9&4294967295|o>>>23),o=i+(t^n&(s^t))+r[7]+1735328473&4294967295,i=s+(o<<14&4294967295|o>>>18),o=n+(s^t&(i^s))+r[12]+2368359562&4294967295,o=t+((n=i+(o<<20&4294967295|o>>>12))^i^s)+r[5]+4294588738&4294967295,o=s+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[8]+2272392833&4294967295,o=i+((s=t+(o<<11&4294967295|o>>>21))^t^n)+r[11]+1839030562&4294967295,o=n+((i=s+(o<<16&4294967295|o>>>16))^s^t)+r[14]+4259657740&4294967295,o=t+((n=i+(o<<23&4294967295|o>>>9))^i^s)+r[1]+2763975236&4294967295,o=s+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[4]+1272893353&4294967295,o=i+((s=t+(o<<11&4294967295|o>>>21))^t^n)+r[7]+4139469664&4294967295,o=n+((i=s+(o<<16&4294967295|o>>>16))^s^t)+r[10]+3200236656&4294967295,o=t+((n=i+(o<<23&4294967295|o>>>9))^i^s)+r[13]+681279174&4294967295,o=s+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[0]+3936430074&4294967295,o=i+((s=t+(o<<11&4294967295|o>>>21))^t^n)+r[3]+3572445317&4294967295,o=n+((i=s+(o<<16&4294967295|o>>>16))^s^t)+r[6]+76029189&4294967295,o=t+((n=i+(o<<23&4294967295|o>>>9))^i^s)+r[9]+3654602809&4294967295,o=s+((t=n+(o<<4&4294967295|o>>>28))^n^i)+r[12]+3873151461&4294967295,o=i+((s=t+(o<<11&4294967295|o>>>21))^t^n)+r[15]+530742520&4294967295,o=n+((i=s+(o<<16&4294967295|o>>>16))^s^t)+r[2]+3299628645&4294967295,n=i+(o<<23&4294967295|o>>>9),o=t+(i^(n|~s))+r[0]+4096336452&4294967295,t=n+(o<<6&4294967295|o>>>26),o=s+(n^(t|~i))+r[7]+1126891415&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[14]+2878612391&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~t))+r[5]+4237533241&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~s))+r[12]+1700485571&4294967295,t=n+(o<<6&4294967295|o>>>26),o=s+(n^(t|~i))+r[3]+2399980690&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[10]+4293915773&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~t))+r[1]+2240044497&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~s))+r[8]+1873313359&4294967295,t=n+(o<<6&4294967295|o>>>26),o=s+(n^(t|~i))+r[15]+4264355552&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[6]+2734768916&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~t))+r[13]+1309151649&4294967295,n=i+(o<<21&4294967295|o>>>11),o=t+(i^(n|~s))+r[4]+4149444226&4294967295,t=n+(o<<6&4294967295|o>>>26),o=s+(n^(t|~i))+r[11]+3174756917&4294967295,s=t+(o<<10&4294967295|o>>>22),o=i+(t^(s|~n))+r[2]+718787259&4294967295,i=s+(o<<15&4294967295|o>>>17),o=n+(s^(i|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function lm(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}(sh=aV.prototype).Oa=function(e){this.M=e},sh.ha=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.I+"; newUri="+e);t=t?t.toUpperCase():"GET",this.I=e,this.j="",this.m=0,this.F=!1,this.h=!0,this.g=this.u?this.u.g():v.g(),this.C=this.u?oq(this.u):oq(v),this.g.onreadystatechange=sb(this.La,this);try{this.G=!0,this.g.open(t,String(e),!0),this.G=!1}catch(e){az(this,e);return}if(e=n||"",n=new Map(this.headers),r){if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else if("function"==typeof r.keys&&"function"==typeof r.get)for(let e of r.keys())n.set(e,r.get(e));else throw Error("Unknown input type for opt_headers: "+String(r))}for(let[s,o]of(r=Array.from(n.keys()).find(e=>"content-type"==e.toLowerCase()),i=sg.FormData&&e instanceof sg.FormData,!(0<=sC(aB,t))||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),n))this.g.setRequestHeader(s,o);this.K&&(this.g.responseType=this.K),"withCredentials"in this.g&&this.g.withCredentials!==this.M&&(this.g.withCredentials=this.M);try{var s;aG(this),0<this.B&&((this.L=(s=this.g,sU&&sL(sK,9,function(){let e=0,t=sN(String(g)).split("."),n=sN("9").split("."),r=Math.max(t.length,n.length);for(let o=0;0==e&&o<r;o++){var i=t[o]||"",s=n[o]||"";do{if(i=/(\d*)(\D*)(.*)/.exec(i)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==i[0].length&&0==s[0].length)break;e=sP(0==i[1].length?0:parseInt(i[1],10),0==s[1].length?0:parseInt(s[1],10))||sP(0==i[2].length,0==s[2].length)||sP(i[2],s[2]),i=i[3],s=s[3]}while(0==e)}return 0<=e})&&"number"==typeof s.timeout&&void 0!==s.ontimeout))?(this.g.timeout=this.B,this.g.ontimeout=sb(this.ua,this)):this.A=ow(this.ua,this.B,this)),this.v=!0,this.g.send(e),this.v=!1}catch(e){az(this,e)}},sh.ua=function(){void 0!==sp&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,ou(this,"timeout"),this.abort(8))},sh.abort=function(e){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=e||7,ou(this,"complete"),ou(this,"abort"),aW(this))},sh.N=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),aW(this,!0)),aV.$.N.call(this)},sh.La=function(){this.s||(this.G||this.v||this.l?aH(this):this.kb())},sh.kb=function(){aH(this)},sh.da=function(){try{return 2<aK(this)?this.g.status:-1}catch(e){return -1}},sh.ja=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},sh.Wa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),aU(t)}},sh.Ia=function(){return this.m},sh.Sa=function(){return"string"==typeof this.j?this.j:String(this.j)},(sh=aJ.prototype).qa=8,sh.H=1,sh.Na=function(e){if(this.m){if(this.m=null,1==this.H){if(!e){this.W=Math.floor(1e5*Math.random()),e=this.W++;let i=new oW(this,this.j,e,void 0),s=this.s;if(this.U&&(s?s5(s=s4(s),this.U):s=this.U),null!==this.o||this.O||(i.I=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){t:{var r=this.i[n];if("__data__"in r.g&&"string"==typeof(r=r.g.__data__)){r=r.length;break t}r=void 0}if(void 0===r)break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=a6(this,i,t),ai(n=ae(this.G),"RID",e),ai(n,"CVER",22),this.F&&ai(n,"X-HTTP-Session-Id",this.F),a5(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(aQ(s)))+"&"+t:this.o&&aY(n,this.o,s)),aS(this.h,i),this.bb&&ai(n,"TYPE","init"),this.P?(ai(n,"$req",t),ai(n,"SID","null"),i.ba=!0,oY(i,n,null)):oY(i,n,t),this.H=2}}else 3==this.H&&(e?a9(this,e):0==this.i.length||aT(this.h)||a9(this))}},sh.Ma=function(){if(this.u=null,le(this),this.ca&&!(this.L||null==this.g||0>=this.S)){var e=2*this.S;this.j.info("BP detection timer enabled: "+e),this.B=oL(sb(this.jb,this),e)}},sh.jb=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.M=!1,this.L=!0,oO(10),a1(this),le(this))},sh.ib=function(){null!=this.v&&(this.v=null,a1(this),a8(this),oO(19))},sh.pb=function(e){e?(this.j.info("Successfully pinged google.com"),oO(2)):(this.j.info("Failed to ping google.com"),oO(1))},(sh=ll.prototype).Ba=function(){},sh.Aa=function(){},sh.za=function(){},sh.ya=function(){},sh.Va=function(){},lu.prototype.g=function(e,t){return new lc(e,t)},sT(lc,ol),lc.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.I=!0);var e=this.g,t=this.l,n=this.h||void 0;oO(0),e.Y=t,e.ma=n||{},e.M=e.aa,e.G=lo(e,null,e.Y),a4(e)},lc.prototype.close=function(){a0(this.g)},lc.prototype.u=function(e){var t=this.g;if("string"==typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=oh(e),e=n);t.i.push(new aw(t.fb++,e)),3==t.H&&a4(t)},lc.prototype.N=function(){this.g.l=null,delete this.j,a0(this.g),delete this.g,lc.$.N.call(this)},sT(lh,oz),sT(ld,o$),sT(lf,ll),lf.prototype.Ba=function(){ou(this.g,"a")},lf.prototype.Aa=function(e){ou(this.g,new lh(e))},lf.prototype.za=function(e){ou(this.g,new ld)},lf.prototype.ya=function(){ou(this.g,"b")},sT(lp,function(){this.blockSize=-1}),lp.prototype.reset=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.i=this.h=0},lp.prototype.j=function(e,t){void 0===t&&(t=e.length);for(var n=t-this.blockSize,r=this.m,i=this.h,s=0;s<t;){if(0==i)for(;s<=n;)lg(this,e,s),s+=this.blockSize;if("string"==typeof e){for(;s<t;)if(r[i++]=e.charCodeAt(s++),i==this.blockSize){lg(this,r),i=0;break}}else for(;s<t;)if(r[i++]=e[s++],i==this.blockSize){lg(this,r),i=0;break}}this.h=i,this.i+=t},lp.prototype.l=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.i;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.j(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var ly={};function lv(e){return -128<=e&&128>e?sL(ly,e,function(e){return new lm([0|e],0>e?-1:0)}):new lm([0|e],0>e?-1:0)}function l_(e){if(isNaN(e)||!isFinite(e))return lb;if(0>e)return lS(l_(-e));for(var t=[],n=1,r=0;e>=n;r++)t[r]=e/n|0,n*=lw;return new lm(t,0)}var lw=4294967296,lb=lv(0),lI=lv(1),lT=lv(16777216);function lE(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function lC(e){return -1==e.h}function lS(e){for(var t=e.g.length,n=[],r=0;r<t;r++)n[r]=~e.g[r];return new lm(n,~e.h).add(lI)}function lk(e,t){return e.add(lS(t))}function lx(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function lA(e,t){this.g=e,this.h=t}function lR(e,t){if(lE(t))throw Error("division by zero");if(lE(e))return new lA(lb,lb);if(lC(e))return t=lR(lS(e),t),new lA(lS(t.g),lS(t.h));if(lC(t))return t=lR(e,lS(t)),new lA(lS(t.g),t.h);if(30<e.g.length){if(lC(e)||lC(t))throw Error("slowDivide_ only works with positive integers.");for(var n=lI,r=t;0>=r.X(e);)n=lN(n),r=lN(r);var i=lP(n,1),s=lP(r,1);for(r=lP(r,2),n=lP(n,2);!lE(r);){var o=s.add(r);0>=o.X(e)&&(i=i.add(n),s=o),r=lP(r,1),n=lP(n,1)}return t=lk(e,i.R(t)),new lA(i,t)}for(i=lb;0<=e.X(t);){for(r=48>=(r=Math.ceil(Math.log(n=Math.max(1,Math.floor(e.ea()/t.ea())))/Math.LN2))?1:Math.pow(2,r-48),o=(s=l_(n)).R(t);lC(o)||0<o.X(e);)n-=r,o=(s=l_(n)).R(t);lE(s)&&(s=lI),i=i.add(s),e=lk(e,o)}return new lA(i,e)}function lN(e){for(var t=e.g.length+1,n=[],r=0;r<t;r++)n[r]=e.D(r)<<1|e.D(r-1)>>>31;return new lm(n,e.h)}function lP(e,t){var n=t>>5;t%=32;for(var r=e.g.length-n,i=[],s=0;s<r;s++)i[s]=0<t?e.D(s+n)>>>t|e.D(s+n+1)<<32-t:e.D(s+n);return new lm(i,e.h)}(sh=lm.prototype).ea=function(){if(lC(this))return-lS(this).ea();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.D(n);e+=(0<=r?r:lw+r)*t,t*=lw}return e},sh.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(lE(this))return"0";if(lC(this))return"-"+lS(this).toString(e);for(var t=l_(Math.pow(e,6)),n=this,r="";;){var i=lR(n,t).g,s=((0<(n=lk(n,i.R(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(lE(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},sh.D=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},sh.X=function(e){return lC(e=lk(this,e))?-1:lE(e)?0:1},sh.abs=function(){return lC(this)?lS(this):this},sh.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0,i=0;i<=t;i++){var s=r+(65535&this.D(i))+(65535&e.D(i)),o=(s>>>16)+(this.D(i)>>>16)+(e.D(i)>>>16);r=o>>>16,s&=65535,o&=65535,n[i]=o<<16|s}return new lm(n,-2147483648&n[n.length-1]?-1:0)},sh.R=function(e){if(lE(this)||lE(e))return lb;if(lC(this))return lC(e)?lS(this).R(lS(e)):lS(lS(this).R(e));if(lC(e))return lS(this.R(lS(e)));if(0>this.X(lT)&&0>e.X(lT))return l_(this.ea()*e.ea());for(var t=this.g.length+e.g.length,n=[],r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(var i=0;i<e.g.length;i++){var s=this.D(r)>>>16,o=65535&this.D(r),a=e.D(i)>>>16,l=65535&e.D(i);n[2*r+2*i]+=o*l,lx(n,2*r+2*i),n[2*r+2*i+1]+=s*l,lx(n,2*r+2*i+1),n[2*r+2*i+1]+=o*a,lx(n,2*r+2*i+1),n[2*r+2*i+2]+=s*a,lx(n,2*r+2*i+2)}for(r=0;r<t;r++)n[r]=n[2*r+1]<<16|n[2*r];for(r=t;r<2*t;r++)n[r]=0;return new lm(n,0)},sh.gb=function(e){return lR(this,e).h},sh.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)&e.D(r);return new lm(n,this.h&e.h)},sh.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)|e.D(r);return new lm(n,this.h|e.h)},sh.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],r=0;r<t;r++)n[r]=this.D(r)^e.D(r);return new lm(n,this.h^e.h)},lu.prototype.createWebChannel=lu.prototype.g,lc.prototype.send=lc.prototype.u,lc.prototype.open=lc.prototype.m,lc.prototype.close=lc.prototype.close,oM.NO_ERROR=0,oM.TIMEOUT=8,oM.HTTP_ERROR=6,oU.COMPLETE="complete",oj.EventType=oB,oB.OPEN="a",oB.CLOSE="b",oB.ERROR="c",oB.MESSAGE="d",ol.prototype.listen=ol.prototype.O,aV.prototype.listenOnce=aV.prototype.P,aV.prototype.getLastError=aV.prototype.Sa,aV.prototype.getLastErrorCode=aV.prototype.Ia,aV.prototype.getStatus=aV.prototype.da,aV.prototype.getResponseJson=aV.prototype.Wa,aV.prototype.getResponseText=aV.prototype.ja,aV.prototype.send=aV.prototype.ha,aV.prototype.setWithCredentials=aV.prototype.Oa,lp.prototype.digest=lp.prototype.l,lp.prototype.reset=lp.prototype.reset,lp.prototype.update=lp.prototype.j,lm.prototype.add=lm.prototype.add,lm.prototype.multiply=lm.prototype.R,lm.prototype.modulo=lm.prototype.gb,lm.prototype.compare=lm.prototype.X,lm.prototype.toNumber=lm.prototype.ea,lm.prototype.toString=lm.prototype.toString,lm.prototype.getBits=lm.prototype.D,lm.fromNumber=l_,lm.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return lS(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=l_(Math.pow(n,8)),i=lb,s=0;s<t.length;s+=8){var o=Math.min(8,t.length-s),a=parseInt(t.substring(s,s+o),n);8>o?(o=l_(Math.pow(n,o)),i=i.R(o).add(l_(a))):i=(i=i.R(r)).add(l_(a))}return i};var lD=sf.createWebChannelTransport=function(){return new lu},lO=sf.getStatEventTarget=function(){return oR()},lF=sf.ErrorCode=oM,lL=sf.EventType=oU,lM=sf.Event=ox,lU=sf.Stat={xb:0,Ab:1,Bb:2,Ub:3,Zb:4,Wb:5,Xb:6,Vb:7,Tb:8,Yb:9,PROXY:10,NOPROXY:11,Rb:12,Nb:13,Ob:14,Mb:15,Pb:16,Qb:17,tb:18,sb:19,ub:20},lV=sf.FetchXmlHttpFactory=aP,lq=sf.WebChannel=oj,lj=sf.XhrIo=aV,lB=sf.Md5=lp,lz=sf.Integer=lm,l$=n(3454);let lH="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lW{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}lW.UNAUTHENTICATED=new lW(null),lW.GOOGLE_CREDENTIALS=new lW("google-credentials-uid"),lW.FIRST_PARTY=new lW("first-party-uid"),lW.MOCK_USER=new lW("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let lG="9.21.0",lK=new E.Yd("@firebase/firestore");function lZ(){return lK.logLevel}function lQ(e,...t){if(lK.logLevel<=E.in.DEBUG){let n=t.map(lJ);lK.debug(`Firestore (${lG}): ${e}`,...n)}}function lY(e,...t){if(lK.logLevel<=E.in.ERROR){let n=t.map(lJ);lK.error(`Firestore (${lG}): ${e}`,...n)}}function lX(e,...t){if(lK.logLevel<=E.in.WARN){let n=t.map(lJ);lK.warn(`Firestore (${lG}): ${e}`,...n)}}function lJ(e){if("string"==typeof e)return e;try{return JSON.stringify(e)}catch(t){return e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function l0(e="Unexpected state"){let t=`FIRESTORE (${lG}) INTERNAL ASSERTION FAILED: `+e;throw lY(t),Error(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let l1={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class l2 extends b.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l4{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l9{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class l5{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(lW.UNAUTHENTICATED))}shutdown(){}}class l6{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class l3{constructor(e){this.t=e,this.currentUser=lW.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){let n=this.i,r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve(),i=new l4;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new l4,e.enqueueRetryable(()=>r(this.currentUser))};let s=()=>{let t=i;e.enqueueRetryable(async()=>{await t.promise,await r(this.currentUser)})},o=e=>{lQ("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.auth.addAuthTokenListener(this.o),s()};this.t.onInit(e=>o(e)),setTimeout(()=>{if(!this.auth){let e=this.t.getImmediate({optional:!0});e?o(e):(lQ("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new l4)}},0),s()}getToken(){let e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(t=>this.i!==e?(lQ("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?("string"==typeof t.accessToken||l0(),new l9(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let e=this.auth&&this.auth.getUid();return null===e||"string"==typeof e||l0(),new lW(e)}}class l8{constructor(e,t,n){this.h=e,this.l=t,this.m=n,this.type="FirstParty",this.user=lW.FIRST_PARTY,this.g=new Map}p(){return this.m?this.m():null}get headers(){this.g.set("X-Goog-AuthUser",this.h);let e=this.p();return e&&this.g.set("Authorization",e),this.l&&this.g.set("X-Goog-Iam-Authorization-Token",this.l),this.g}}class l7{constructor(e,t,n){this.h=e,this.l=t,this.m=n}getToken(){return Promise.resolve(new l8(this.h,this.l,this.m))}start(e,t){e.enqueueRetryable(()=>t(lW.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ue{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class ut{constructor(e){this.I=e,this.forceRefresh=!1,this.appCheck=null,this.T=null}start(e,t){let n=e=>{null!=e.error&&lQ("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let n=e.token!==this.T;return this.T=e.token,lQ("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable(()=>n(t))};let r=e=>{lQ("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.appCheck.addTokenListener(this.o)};this.I.onInit(e=>r(e)),setTimeout(()=>{if(!this.appCheck){let e=this.I.getImmediate({optional:!0});e?r(e):lQ("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(e=>e?("string"==typeof e.token||l0(),this.T=e.token,new ue(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class un{static A(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,n="";for(;n.length<20;){let r=/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){let t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let t=0;t<e;t++)n[t]=Math.floor(256*Math.random());return n}(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%e.length))}return n}}function ur(e,t){return e<t?-1:e>t?1:0}function ui(e,t,n){return e.length===t.length&&e.every((e,r)=>n(e,t[r]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class us{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new l2(l1.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800||e>=253402300800)throw new l2(l1.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return us.fromMillis(Date.now())}static fromDate(e){return us.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3);return new us(t,Math.floor(1e6*(e-1e3*t)))}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?ur(this.nanoseconds,e.nanoseconds):ur(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e){this.timestamp=e}static fromTimestamp(e){return new uo(e)}static min(){return new uo(new us(0,0))}static max(){return new uo(new us(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ua{constructor(e,t,n){void 0===t?t=0:t>e.length&&l0(),void 0===n?n=e.length-t:n>e.length-t&&l0(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ua.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof ua?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let n=Math.min(e.length,t.length);for(let r=0;r<n;r++){let n=e.get(r),i=t.get(r);if(n<i)return -1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class ul extends ua{construct(e,t,n){return new ul(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...e){let t=[];for(let n of e){if(n.indexOf("//")>=0)throw new l2(l1.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(e=>e.length>0))}return new ul(t)}static emptyPath(){return new ul([])}}let uu=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class uc extends ua{construct(e,t,n){return new uc(e,t,n)}static isValidIdentifier(e){return uu.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),uc.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new uc(["__name__"])}static fromServerFormat(e){let t=[],n="",r=0,i=()=>{if(0===n.length)throw new l2(l1.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""},s=!1;for(;r<e.length;){let t=e[r];if("\\"===t){if(r+1===e.length)throw new l2(l1.INVALID_ARGUMENT,"Path has trailing escape character: "+e);let t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new l2(l1.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new l2(l1.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new uc(t)}static emptyPath(){return new uc([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uh{constructor(e){this.path=e}static fromPath(e){return new uh(ul.fromString(e))}static fromName(e){return new uh(ul.fromString(e).popFirst(5))}static empty(){return new uh(ul.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===ul.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return ul.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new uh(new ul(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ud{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function uf(e){return e.fields.find(e=>2===e.kind)}function up(e){return e.fields.filter(e=>2!==e.kind)}ud.UNKNOWN_ID=-1;class ug{constructor(e,t){this.fieldPath=e,this.kind=t}}class um{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new um(0,u_.min())}}function uy(e,t){let n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=uo.fromTimestamp(1e9===r?new us(n+1,0):new us(n,r));return new u_(i,uh.empty(),t)}function uv(e){return new u_(e.readTime,e.key,-1)}class u_{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new u_(uo.min(),uh.empty(),-1)}static max(){return new u_(uo.max(),uh.empty(),-1)}}function uw(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:0!==(n=uh.comparator(e.documentKey,t.documentKey))?n:ur(e.largestBatchId,t.largestBatchId)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ub="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class uI{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uT(e){if(e.code!==l1.FAILED_PRECONDITION||e.message!==ub)throw e;lQ("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uE{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&l0(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new uE((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();return t instanceof uE?t:uE.resolve(t)}catch(e){return uE.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):uE.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):uE.reject(t)}static resolve(e){return new uE((t,n)=>{t(e)})}static reject(e){return new uE((t,n)=>{n(e)})}static waitFor(e){return new uE((t,n)=>{let r=0,i=0,s=!1;e.forEach(e=>{++r,e.next(()=>{++i,s&&i===r&&t()},e=>n(e))}),s=!0,i===r&&t()})}static or(e){let t=uE.resolve(!1);for(let n of e)t=t.next(e=>e?uE.resolve(e):n());return t}static forEach(e,t){let n=[];return e.forEach((e,r)=>{n.push(t.call(this,e,r))}),this.waitFor(n)}static mapArray(e,t){return new uE((n,r)=>{let i=e.length,s=Array(i),o=0;for(let a=0;a<i;a++){let l=a;t(e[l]).next(e=>{s[l]=e,++o===i&&n(s)},e=>r(e))}})}static doWhile(e,t){return new uE((n,r)=>{let i=()=>{!0===e()?t().next(()=>{i()},r):n()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.R=new l4,this.transaction.oncomplete=()=>{this.R.resolve()},this.transaction.onabort=()=>{t.error?this.R.reject(new ux(e,t.error)):this.R.resolve()},this.transaction.onerror=t=>{let n=uD(t.target.error);this.R.reject(new ux(e,n))}}static open(e,t,n,r){try{return new uC(t,e.transaction(r,n))}catch(e){throw new ux(t,e)}}get v(){return this.R.promise}abort(e){e&&this.R.reject(e),this.aborted||(lQ("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}P(){let e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){let t=this.transaction.objectStore(e);return new uR(t)}}class uS{constructor(e,t,n){this.name=e,this.version=t,this.V=n,12.2===uS.S((0,b.z$)())&&lY("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return lQ("SimpleDb","Removing database:",e),uN(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!(0,b.hl)())return!1;if(uS.C())return!0;let e=(0,b.z$)(),t=uS.S(e),n=uS.N(e);return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||0<t&&t<10||0<n&&n<4.5)}static C(){var e;return void 0!==l$&&"YES"===(null===(e=l$.env)||void 0===e?void 0:e.k)}static M(e,t){return e.store(t)}static S(e){let t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}static N(e){let t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}async O(e){return this.db||(lQ("SimpleDb","Opening database:",this.name),this.db=await new Promise((t,n)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{let n=e.target.result;t(n)},r.onblocked=()=>{n(new ux(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{let r=t.target.error;"VersionError"===r.name?n(new l2(l1.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new l2(l1.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new ux(e,r))},r.onupgradeneeded=e=>{lQ("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);let t=e.target.result;this.V.$(t,r.transaction,e.oldVersion,this.version).next(()=>{lQ("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.F&&(this.db.onversionchange=e=>this.F(e)),this.db}B(e){this.F=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){let i="readonly"===t,s=0;for(;;){++s;try{this.db=await this.O(e);let t=uC.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next(e=>(t.P(),e)).catch(e=>(t.abort(e),uE.reject(e))).toPromise();return s.catch(()=>{}),await t.v,s}catch(t){let e="FirebaseError"!==t.name&&s<3;if(lQ("SimpleDb","Transaction failed with error:",t.message,"Retrying:",e),this.close(),!e)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}class uk{constructor(e){this.L=e,this.q=!1,this.U=null}get isDone(){return this.q}get K(){return this.U}set cursor(e){this.L=e}done(){this.q=!0}G(e){this.U=e}delete(){return uN(this.L.delete())}}class ux extends l2{constructor(e,t){super(l1.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function uA(e){return"IndexedDbTransactionError"===e.name}class uR{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(lQ("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(lQ("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),uN(n)}add(e){return lQ("SimpleDb","ADD",this.store.name,e,e),uN(this.store.add(e))}get(e){return uN(this.store.get(e)).next(t=>(void 0===t&&(t=null),lQ("SimpleDb","GET",this.store.name,e,t),t))}delete(e){return lQ("SimpleDb","DELETE",this.store.name,e),uN(this.store.delete(e))}count(){return lQ("SimpleDb","COUNT",this.store.name),uN(this.store.count())}j(e,t){let n=this.options(e,t);if(n.index||"function"!=typeof this.store.getAll){let e=this.cursor(n),t=[];return this.W(e,(e,n)=>{t.push(n)}).next(()=>t)}{let e=this.store.getAll(n.range);return new uE((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}})}}H(e,t){let n=this.store.getAll(e,null===t?void 0:t);return new uE((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}})}J(e,t){lQ("SimpleDb","DELETE ALL",this.store.name);let n=this.options(e,t);n.Y=!1;let r=this.cursor(n);return this.W(r,(e,t,n)=>n.delete())}X(e,t){let n;t?n=e:(n={},t=e);let r=this.cursor(n);return this.W(r,t)}Z(e){let t=this.cursor({});return new uE((n,r)=>{t.onerror=e=>{let t=uD(e.target.error);r(t)},t.onsuccess=t=>{let r=t.target.result;r?e(r.primaryKey,r.value).next(e=>{e?r.continue():n()}):n()}})}W(e,t){let n=[];return new uE((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{let i=e.target.result;if(!i)return void r();let s=new uk(i),o=t(i.primaryKey,i.value,s);if(o instanceof uE){let e=o.catch(e=>(s.done(),uE.reject(e)));n.push(e)}s.isDone?r():null===s.K?i.continue():i.continue(s.K)}}).next(()=>uE.waitFor(n))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){let n=this.store.index(e.index);return e.Y?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function uN(e){return new uE((t,n)=>{e.onsuccess=e=>{let n=e.target.result;t(n)},e.onerror=e=>{let t=uD(e.target.error);n(t)}})}let uP=!1;function uD(e){let t=uS.S((0,b.z$)());if(t>=12.2&&t<13){let t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){let e=new l2("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return uP||(uP=!0,setTimeout(()=>{throw e},0)),e}}return e}class uO{constructor(e,t){this.asyncQueue=e,this.tt=t,this.task=null}start(){this.et(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}et(e){lQ("IndexBackiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{lQ("IndexBackiller",`Documents written: ${await this.tt.nt()}`)}catch(e){uA(e)?lQ("IndexBackiller","Ignoring IndexedDB error during index backfill: ",e):await uT(e)}await this.et(6e4)})}}class uF{constructor(e,t){this.localStore=e,this.persistence=t}async nt(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.st(t,e))}st(e,t){let n=new Set,r=t,i=!0;return uE.doWhile(()=>!0===i&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(t=>{if(null!==t&&!n.has(t))return lQ("IndexBackiller",`Processing collection: ${t}`),this.it(e,t,r).next(e=>{r-=e,n.add(t)});i=!1})).next(()=>t-r)}it(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next(n=>{let i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next(()=>this.rt(r,n)).next(n=>(lQ("IndexBackiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n))).next(()=>i.size)}))}rt(e,t){let n=e;return t.changes.forEach((e,t)=>{let r=uv(t);uw(r,n)>0&&(n=r)}),new u_(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uL{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ot(e),this.ut=e=>t.writeSequenceNumber(e))}ot(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.ut&&this.ut(e),e}}function uM(e){return null==e}function uU(e){return 0===e&&1/e==-1/0}function uV(e){return"number"==typeof e&&Number.isInteger(e)&&!uU(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uq(e){var t,n;let r="";for(let t=0;t<e.length;t++)r.length>0&&(r+="\x01\x01"),r=function(e,t){let n=t,r=e.length;for(let t=0;t<r;t++){let r=e.charAt(t);switch(r){case"\x00":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=r}}return n}(e.get(t),r);return r+"\x01\x01"}function uj(e){let t=e.length;if(t>=2||l0(),2===t)return"\x01"===e.charAt(0)&&"\x01"===e.charAt(1)||l0(),ul.emptyPath();let n=t-2,r=[],i="";for(let s=0;s<t;){let t=e.indexOf("\x01",s);switch((t<0||t>n)&&l0(),e.charAt(t+1)){case"\x01":let o;let a=e.substring(s,t);0===i.length?o=a:(i+=a,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t)+"\x00";break;case"\x11":i+=e.substring(s,t+1);break;default:l0()}s=t+2}return new ul(r)}uL.ct=-1;/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uB=["userId","batchId"],uz={},u$=["prefixPath","collectionGroup","readTime","documentId"],uH=["prefixPath","collectionGroup","documentId"],uW=["collectionGroup","readTime","prefixPath","documentId"],uG=["canonicalId","targetId"],uK=["targetId","path"],uZ=["path","targetId"],uQ=["collectionId","parent"],uY=["indexId","uid"],uX=["uid","sequenceNumber"],uJ=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],u0=["indexId","uid","orderedDocumentKey"],u1=["userId","collectionPath","documentId"],u2=["userId","collectionPath","largestBatchId"],u4=["userId","collectionGroup","largestBatchId"],u9=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],u5=[...u9,"documentOverlays"],u6=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],u3=[...u6,"indexConfiguration","indexState","indexEntries"];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8 extends uI{constructor(e,t){super(),this.at=e,this.currentSequenceNumber=t}}function u7(e,t){return uS.M(e.at,t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ce(e){let t=0;for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ct(e,t){for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function cn(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cr{constructor(e,t){this.comparator=e,this.root=t||cs.EMPTY}insert(e,t){return new cr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,cs.BLACK,null,null))}remove(e){return new cr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,cs.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){let r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){let e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ci(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ci(this.root,e,this.comparator,!1)}getReverseIterator(){return new ci(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ci(this.root,e,this.comparator,!0)}}class ci{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class cs{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:cs.RED,this.left=null!=r?r:cs.EMPTY,this.right=null!=i?i:cs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new cs(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this,i=n(e,r.key);return(r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n))).fixUp()}removeMin(){if(this.left.isEmpty())return cs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let n,r=this;if(0>t(e,r.key))r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return cs.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,cs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,cs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){let e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw l0();let e=this.left.check();if(e!==this.right.check())throw l0();return e+(this.isRed()?0:1)}}cs.EMPTY=null,cs.RED=!0,cs.BLACK=!1,cs.EMPTY=new class{constructor(){this.size=0}get key(){throw l0()}get value(){throw l0()}get color(){throw l0()}get left(){throw l0()}get right(){throw l0()}copy(e,t,n,r,i){return this}insert(e,t,n){return new cs(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class co{constructor(e){this.comparator=e,this.data=new cr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){let n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){let r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ca(this.data.getIterator())}getIteratorFrom(e){return new ca(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof co)||this.size!==e.size)return!1;let t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new co(this.comparator);return t.data=e,t}}class ca{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function cl(e){return e.hasNext()?e.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cu{constructor(e){this.fields=e,e.sort(uc.comparator)}static empty(){return new cu([])}unionWith(e){let t=new co(uc.comparator);for(let e of this.fields)t=t.add(e);for(let n of e)t=t.add(n);return new cu(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ui(this.fields,e.fields,(e,t)=>e.isEqual(t))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cc extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ch{constructor(e){this.binaryString=e}static fromBase64String(e){let t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new cc("Invalid base64 string: "+e):e}}(e);return new ch(t)}static fromUint8Array(e){let t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new ch(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return btoa(this.binaryString)}toUint8Array(){return function(e){let t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return ur(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}ch.EMPTY_BYTE_STRING=new ch("");let cd=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function cf(e){if(e||l0(),"string"==typeof e){let t=0,n=cd.exec(e);if(n||l0(),n[1]){let e=n[1];t=Number(e=(e+"000000000").substr(0,9))}let r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:cp(e.seconds),nanos:cp(e.nanos)}}function cp(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function cg(e){return"string"==typeof e?ch.fromBase64String(e):ch.fromUint8Array(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function cy(e){let t=e.mapValue.fields.__previous_value__;return cm(t)?cy(t):t}function cv(e){let t=cf(e.mapValue.fields.__local_write_time__.timestampValue);return new us(t.seconds,t.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c_{constructor(e,t,n,r,i,s,o,a){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.useFetchStreams=a}}class cw{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new cw("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof cw&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let cb={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},cI={nullValue:"NULL_VALUE"};function cT(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?cm(e)?4:cL(e)?9007199254740991:10:l0()}function cE(e,t){if(e===t)return!0;let n=cT(e);if(n!==cT(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return cv(e).isEqual(cv(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let n=cf(e.timestampValue),r=cf(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return cg(e.bytesValue).isEqual(cg(t.bytesValue));case 7:return e.referenceValue===t.referenceValue;case 8:return cp(e.geoPointValue.latitude)===cp(t.geoPointValue.latitude)&&cp(e.geoPointValue.longitude)===cp(t.geoPointValue.longitude);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return cp(e.integerValue)===cp(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let n=cp(e.doubleValue),r=cp(t.doubleValue);return n===r?uU(n)===uU(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ui(e.arrayValue.values||[],t.arrayValue.values||[],cE);case 10:return function(e,t){let n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(ce(n)!==ce(r))return!1;for(let e in n)if(n.hasOwnProperty(e)&&(void 0===r[e]||!cE(n[e],r[e])))return!1;return!0}(e,t);default:return l0()}}function cC(e,t){return void 0!==(e.values||[]).find(e=>cE(e,t))}function cS(e,t){if(e===t)return 0;let n=cT(e),r=cT(t);if(n!==r)return ur(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return ur(e.booleanValue,t.booleanValue);case 2:return function(e,t){let n=cp(e.integerValue||e.doubleValue),r=cp(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ck(e.timestampValue,t.timestampValue);case 4:return ck(cv(e),cv(t));case 5:return ur(e.stringValue,t.stringValue);case 6:return function(e,t){let n=cg(e),r=cg(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){let n=e.split("/"),r=t.split("/");for(let e=0;e<n.length&&e<r.length;e++){let t=ur(n[e],r[e]);if(0!==t)return t}return ur(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){let n=ur(cp(e.latitude),cp(t.latitude));return 0!==n?n:ur(cp(e.longitude),cp(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return function(e,t){let n=e.values||[],r=t.values||[];for(let e=0;e<n.length&&e<r.length;++e){let t=cS(n[e],r[e]);if(t)return t}return ur(n.length,r.length)}(e.arrayValue,t.arrayValue);case 10:return function(e,t){if(e===cb.mapValue&&t===cb.mapValue)return 0;if(e===cb.mapValue)return 1;if(t===cb.mapValue)return -1;let n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let e=0;e<r.length&&e<s.length;++e){let t=ur(r[e],s[e]);if(0!==t)return t;let o=cS(n[r[e]],i[s[e]]);if(0!==o)return o}return ur(r.length,s.length)}(e.mapValue,t.mapValue);default:throw l0()}}function ck(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return ur(e,t);let n=cf(e),r=cf(t),i=ur(n.seconds,r.seconds);return 0!==i?i:ur(n.nanos,r.nanos)}function cx(e){var t,n;return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){let t=cf(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?cg(e.bytesValue).toBase64():"referenceValue"in e?(n=e.referenceValue,uh.fromName(n).toString()):"geoPointValue"in e?`geo(${(t=e.geoPointValue).latitude},${t.longitude})`:"arrayValue"in e?function(e){let t="[",n=!0;for(let r of e.values||[])n?n=!1:t+=",",t+=cx(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){let t=Object.keys(e.fields||{}).sort(),n="{",r=!0;for(let i of t)r?r=!1:n+=",",n+=`${i}:${cx(e.fields[i])}`;return n+"}"}(e.mapValue):l0()}function cA(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function cR(e){return!!e&&"integerValue"in e}function cN(e){return!!e&&"arrayValue"in e}function cP(e){return!!e&&"nullValue"in e}function cD(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function cO(e){return!!e&&"mapValue"in e}function cF(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){let t={mapValue:{fields:{}}};return ct(e.mapValue.fields,(e,n)=>t.mapValue.fields[e]=cF(n)),t}if(e.arrayValue){let t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=cF(e.arrayValue.values[n]);return t}return Object.assign({},e)}function cL(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}function cM(e,t){let n=cS(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function cU(e,t){let n=cS(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cV{constructor(e){this.value=e}static empty(){return new cV({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(!cO(t=(t.mapValue.fields||{})[e.get(n)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=cF(t)}setAll(e){let t=uc.emptyPath(),n={},r=[];e.forEach((e,i)=>{if(!t.isImmediateParentOf(i)){let e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=cF(e):r.push(i.lastSegment())});let i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){let t=this.field(e.popLast());cO(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return cE(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];cO(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){for(let r of(ct(t,(t,n)=>e[t]=n),n))delete e[r]}clone(){return new cV(cF(this.value))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cq{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new cq(e,0,uo.min(),uo.min(),uo.min(),cV.empty(),0)}static newFoundDocument(e,t,n,r){return new cq(e,1,t,uo.min(),n,r,0)}static newNoDocument(e,t){return new cq(e,2,t,uo.min(),uo.min(),cV.empty(),0)}static newUnknownDocument(e,t){return new cq(e,3,t,uo.min(),uo.min(),cV.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(uo.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=cV.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=cV.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=uo.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof cq&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new cq(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cj{constructor(e,t){this.position=e,this.inclusive=t}}function cB(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){let s=t[i],o=e.position[i];if(r=s.field.isKeyField()?uh.comparator(uh.fromName(o.referenceValue),n.key):cS(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function cz(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!cE(e.position[n],t.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c${constructor(e,t="asc"){this.field=e,this.dir=t}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cH{}class cW extends cH{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new cJ(e,t,n):"array-contains"===t?new c4(e,n):"in"===t?new c9(e,n):"not-in"===t?new c5(e,n):"array-contains-any"===t?new c6(e,n):new cW(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new c0(e,n):new c1(e,n)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(cS(t,this.value)):null!==t&&cT(this.value)===cT(t)&&this.matchesComparison(cS(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return l0()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}getFirstInequalityField(){return this.isInequality()?this.field:null}}class cG extends cH{constructor(e,t){super(),this.filters=e,this.op=t,this.ht=null}static create(e,t){return new cG(e,t)}matches(e){return cK(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.ht||(this.ht=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.ht}getFilters(){return Object.assign([],this.filters)}getFirstInequalityField(){let e=this.lt(e=>e.isInequality());return null!==e?e.field:null}lt(e){for(let t of this.getFlattenedFilters())if(e(t))return t;return null}}function cK(e){return"and"===e.op}function cZ(e){return"or"===e.op}function cQ(e){return cY(e)&&cK(e)}function cY(e){for(let t of e.filters)if(t instanceof cG)return!1;return!0}function cX(e,t){let n=e.filters.concat(t);return cG.create(n,e.op)}class cJ extends cW{constructor(e,t,n){super(e,t,n),this.key=uh.fromName(n.referenceValue)}matches(e){let t=uh.comparator(e.key,this.key);return this.matchesComparison(t)}}class c0 extends cW{constructor(e,t){super(e,"in",t),this.keys=c2("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class c1 extends cW{constructor(e,t){super(e,"not-in",t),this.keys=c2("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function c2(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map(e=>uh.fromName(e.referenceValue))}class c4 extends cW{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return cN(t)&&cC(t.arrayValue,this.value)}}class c9 extends cW{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&cC(this.value.arrayValue,t)}}class c5 extends cW{constructor(e,t){super(e,"not-in",t)}matches(e){if(cC(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&!cC(this.value.arrayValue,t)}}class c6 extends cW{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!(!cN(t)||!t.arrayValue.values)&&t.arrayValue.values.some(e=>cC(this.value.arrayValue,e))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c3{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ft=null}}function c8(e,t=null,n=[],r=[],i=null,s=null,o=null){return new c3(e,t,n,r,i,s,o)}function c7(e){let t=e;if(null===t.ft){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:"+t.filters.map(e=>(function e(t){if(t instanceof cW)return t.field.canonicalString()+t.op.toString()+cx(t.value);if(cQ(t))return t.filters.map(t=>e(t)).join(",");{let n=t.filters.map(t=>e(t)).join(",");return`${t.op}(${n})`}})(e)).join(",")+"|ob:"+t.orderBy.map(e=>e.field.canonicalString()+e.dir).join(","),uM(t.limit)||(e+="|l:"+t.limit),t.startAt&&(e+="|lb:"+(t.startAt.inclusive?"b:":"a:")+t.startAt.position.map(e=>cx(e)).join(",")),t.endAt&&(e+="|ub:"+(t.endAt.inclusive?"a:":"b:")+t.endAt.position.map(e=>cx(e)).join(",")),t.ft=e}return t.ft}function he(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let i=0;i<e.orderBy.length;i++){var n,r;if(n=e.orderBy[i],r=t.orderBy[i],!(n.dir===r.dir&&n.field.isEqual(r.field)))return!1}if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!function e(t,n){return t instanceof cW?n instanceof cW&&t.op===n.op&&t.field.isEqual(n.field)&&cE(t.value,n.value):t instanceof cG?n instanceof cG&&t.op===n.op&&t.filters.length===n.filters.length&&t.filters.reduce((t,r,i)=>t&&e(r,n.filters[i]),!0):void l0()}(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!cz(e.startAt,t.startAt)&&cz(e.endAt,t.endAt)}function ht(e){return uh.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function hn(e,t){return e.filters.filter(e=>e instanceof cW&&e.field.isEqual(t))}function hr(e,t,n){let r=cI,i=!0;for(let n of hn(e,t)){let e=cI,t=!0;switch(n.op){case"<":case"<=":var s;e="nullValue"in(s=n.value)?cI:"booleanValue"in s?{booleanValue:!1}:"integerValue"in s||"doubleValue"in s?{doubleValue:NaN}:"timestampValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in s?{stringValue:""}:"bytesValue"in s?{bytesValue:""}:"referenceValue"in s?cA(cw.empty(),uh.empty()):"geoPointValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in s?{arrayValue:{}}:"mapValue"in s?{mapValue:{}}:l0();break;case"==":case"in":case">=":e=n.value;break;case">":e=n.value,t=!1;break;case"!=":case"not-in":e=cI}0>cM({value:r,inclusive:i},{value:e,inclusive:t})&&(r=e,i=t)}if(null!==n){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=n.position[s];0>cM({value:r,inclusive:i},{value:e,inclusive:n.inclusive})&&(r=e,i=n.inclusive);break}}return{value:r,inclusive:i}}function hi(e,t,n){let r=cb,i=!0;for(let n of hn(e,t)){let e=cb,t=!0;switch(n.op){case">=":case">":var s;e="nullValue"in(s=n.value)?{booleanValue:!1}:"booleanValue"in s?{doubleValue:NaN}:"integerValue"in s||"doubleValue"in s?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in s?{stringValue:""}:"stringValue"in s?{bytesValue:""}:"bytesValue"in s?cA(cw.empty(),uh.empty()):"referenceValue"in s?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in s?{arrayValue:{}}:"arrayValue"in s?{mapValue:{}}:"mapValue"in s?cb:l0(),t=!1;break;case"==":case"in":case"<=":e=n.value;break;case"<":e=n.value,t=!1;break;case"!=":case"not-in":e=cb}cU({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n){for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){let e=n.position[s];cU({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hs{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.dt=null,this._t=null,this.startAt,this.endAt}}function ho(e){return new hs(e)}function ha(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function hl(e){return e.explicitOrderBy.length>0?e.explicitOrderBy[0].field:null}function hu(e){for(let t of e.filters){let e=t.getFirstInequalityField();if(null!==e)return e}return null}function hc(e){return null!==e.collectionGroup}function hh(e){let t=e;if(null===t.dt){t.dt=[];let e=hu(t),n=hl(t);if(null!==e&&null===n)e.isKeyField()||t.dt.push(new c$(e)),t.dt.push(new c$(uc.keyField(),"asc"));else{let e=!1;for(let n of t.explicitOrderBy)t.dt.push(n),n.field.isKeyField()&&(e=!0);if(!e){let e=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";t.dt.push(new c$(uc.keyField(),e))}}}return t.dt}function hd(e){let t=e;if(!t._t){if("F"===t.limitType)t._t=c8(t.path,t.collectionGroup,hh(t),t.filters,t.limit,t.startAt,t.endAt);else{let e=[];for(let n of hh(t)){let t="desc"===n.dir?"asc":"desc";e.push(new c$(n.field,t))}let n=t.endAt?new cj(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new cj(t.startAt.position,t.startAt.inclusive):null;t._t=c8(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}return t._t}function hf(e,t){t.getFirstInequalityField(),hu(e);let n=e.filters.concat([t]);return new hs(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function hp(e,t,n){return new hs(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function hg(e,t){return he(hd(e),hd(t))&&e.limitType===t.limitType}function hm(e){return`${c7(hd(e))}|lt:${e.limitType}`}function hy(e){var t;let n;return`Query(target=${n=(t=hd(e)).path.canonicalString(),null!==t.collectionGroup&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(e=>(function e(t){return t instanceof cW?`${t.field.canonicalString()} ${t.op} ${cx(t.value)}`:t instanceof cG?t.op.toString()+" {"+t.getFilters().map(e).join(" ,")+"}":"Filter"})(e)).join(", ")}]`),uM(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(e=>`${e.field.canonicalString()} (${e.dir})`).join(", ")}]`),t.startAt&&(n+=", startAt: "+(t.startAt.inclusive?"b:":"a:")+t.startAt.position.map(e=>cx(e)).join(",")),t.endAt&&(n+=", endAt: "+(t.endAt.inclusive?"a:":"b:")+t.endAt.position.map(e=>cx(e)).join(",")),`Target(${n})`}; limitType=${e.limitType})`}function hv(e,t){return t.isFoundDocument()&&function(e,t){let n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):uh.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(let n of hh(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(let n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&(!e.startAt||!!function(e,t,n){let r=cB(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,hh(e),t))&&(!e.endAt||!!function(e,t,n){let r=cB(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,hh(e),t))}function h_(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function hw(e){return(t,n)=>{let r=!1;for(let i of hh(e)){let e=function(e,t,n){let r=e.field.isKeyField()?uh.comparator(t.key,n.key):function(e,t,n){let r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?cS(r,i):l0()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return -1*r;default:return l0()}}(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n){for(let[t,r]of n)if(this.equalsFn(t,e))return r}}has(e){return void 0!==this.get(e)}set(e,t){let n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let n=0;n<r.length;n++)if(this.equalsFn(r[n][0],e))return void(r[n]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ct(this.inner,(t,n)=>{for(let[t,r]of n)e(t,r)})}isEmpty(){return cn(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hI=new cr(uh.comparator),hT=new cr(uh.comparator);function hE(...e){let t=hT;for(let n of e)t=t.insert(n.key,n);return t}function hC(e){let t=hT;return e.forEach((e,n)=>t=t.insert(e,n.overlayedDocument)),t}function hS(){return new hb(e=>e.toString(),(e,t)=>e.isEqual(t))}let hk=new cr(uh.comparator),hx=new co(uh.comparator);function hA(...e){let t=hx;for(let n of e)t=t.add(n);return t}let hR=new co(ur);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hN(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:uU(t)?"-0":t}}function hP(e){return{integerValue:""+e}}function hD(e,t){return uV(t)?hP(t):hN(e,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hO{constructor(){this._=void 0}}function hF(e,t){return e instanceof hj?cR(t)||t&&"doubleValue"in t?t:{integerValue:0}:null}class hL extends hO{}class hM extends hO{constructor(e){super(),this.elements=e}}function hU(e,t){let n=hz(t);for(let t of e.elements)n.some(e=>cE(e,t))||n.push(t);return{arrayValue:{values:n}}}class hV extends hO{constructor(e){super(),this.elements=e}}function hq(e,t){let n=hz(t);for(let t of e.elements)n=n.filter(e=>!cE(e,t));return{arrayValue:{values:n}}}class hj extends hO{constructor(e,t){super(),this.serializer=e,this.wt=t}}function hB(e){return cp(e.integerValue||e.doubleValue)}function hz(e){return cN(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h${constructor(e,t){this.field=e,this.transform=t}}class hH{constructor(e,t){this.version=e,this.transformResults=t}}class hW{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hW}static exists(e){return new hW(void 0,e)}static updateTime(e){return new hW(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function hG(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class hK{}function hZ(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new h4(e.key,hW.none()):new hX(e.key,e.data,hW.none());{let n=e.data,r=cV.empty(),i=new co(uc.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new hJ(e.key,r,new cu(i.toArray()),hW.none())}}function hQ(e,t,n,r){return e instanceof hX?function(e,t,n,r){if(!hG(e.precondition,t))return n;let i=e.value.clone(),s=h2(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof hJ?function(e,t,n,r){if(!hG(e.precondition,t))return n;let i=h2(e.fieldTransforms,r,t),s=t.data;return(s.setAll(h0(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n)?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}(e,t,n,r):hG(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}function hY(e,t){var n,r;return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&(n=e.fieldTransforms,r=t.fieldTransforms,!!(void 0===n&&void 0===r||!(!n||!r)&&ui(n,r,(e,t)=>{var n,r;return e.field.isEqual(t.field)&&(n=e.transform,r=t.transform,n instanceof hM&&r instanceof hM||n instanceof hV&&r instanceof hV?ui(n.elements,r.elements,cE):n instanceof hj&&r instanceof hj?cE(n.wt,r.wt):n instanceof hL&&r instanceof hL)})))&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class hX extends hK{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class hJ extends hK{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function h0(e){let t=new Map;return e.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){let r=e.data.field(n);t.set(n,r)}}),t}function h1(e,t,n){var r;let i=new Map;e.length===n.length||l0();for(let s=0;s<n.length;s++){let o=e[s],a=o.transform,l=t.data.field(o.field);i.set(o.field,(r=n[s],a instanceof hM?hU(a,l):a instanceof hV?hq(a,l):r))}return i}function h2(e,t,n){let r=new Map;for(let i of e){let e=i.transform,s=n.data.field(i.field);r.set(i.field,e instanceof hL?function(e,t){let n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&cm(t)&&(t=cy(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(t,s):e instanceof hM?hU(e,s):e instanceof hV?hq(e,s):function(e,t){let n=hF(e,t),r=hB(n)+hB(e.wt);return cR(n)&&cR(e.wt)?hP(r):hN(e.serializer,r)}(e,s))}return r}class h4 extends hK{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class h9 extends hK{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h5{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){let n=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let i=this.mutations[t];if(i.key.isEqual(e.key)){var r;r=n[t],i instanceof hX?function(e,t,n){let r=e.value.clone(),i=h1(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(i,e,r):i instanceof hJ?function(e,t,n){if(!hG(e.precondition,t))return void t.convertToUnknownDocument(n.version);let r=h1(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(h0(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(i,e,r):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,e,r)}}}applyToLocalView(e,t){for(let n of this.baseMutations)n.key.isEqual(e.key)&&(t=hQ(n,e,t,this.localWriteTime));for(let n of this.mutations)n.key.isEqual(e.key)&&(t=hQ(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let n=hS();return this.mutations.forEach(r=>{let i=e.get(r.key),s=i.overlayedDocument,o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;let a=hZ(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(uo.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),hA())}isEqual(e){return this.batchId===e.batchId&&ui(this.mutations,e.mutations,(e,t)=>hY(e,t))&&ui(this.baseMutations,e.baseMutations,(e,t)=>hY(e,t))}}class h6{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){e.mutations.length===n.length||l0();let r=hk,i=e.mutations;for(let e=0;e<i.length;e++)r=r.insert(i[e].key,n[e].version);return new h6(e,t,n,r)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h3{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h8{constructor(e,t){this.count=e,this.unchangedNames=t}}function h7(e){switch(e){default:return l0();case l1.CANCELLED:case l1.UNKNOWN:case l1.DEADLINE_EXCEEDED:case l1.RESOURCE_EXHAUSTED:case l1.INTERNAL:case l1.UNAVAILABLE:case l1.UNAUTHENTICATED:return!1;case l1.INVALID_ARGUMENT:case l1.NOT_FOUND:case l1.ALREADY_EXISTS:case l1.PERMISSION_DENIED:case l1.FAILED_PRECONDITION:case l1.ABORTED:case l1.OUT_OF_RANGE:case l1.UNIMPLEMENTED:case l1.DATA_LOSS:return!0}}function de(e){if(void 0===e)return lY("GRPC error has no .code"),l1.UNKNOWN;switch(e){case _.OK:return l1.OK;case _.CANCELLED:return l1.CANCELLED;case _.UNKNOWN:return l1.UNKNOWN;case _.DEADLINE_EXCEEDED:return l1.DEADLINE_EXCEEDED;case _.RESOURCE_EXHAUSTED:return l1.RESOURCE_EXHAUSTED;case _.INTERNAL:return l1.INTERNAL;case _.UNAVAILABLE:return l1.UNAVAILABLE;case _.UNAUTHENTICATED:return l1.UNAUTHENTICATED;case _.INVALID_ARGUMENT:return l1.INVALID_ARGUMENT;case _.NOT_FOUND:return l1.NOT_FOUND;case _.ALREADY_EXISTS:return l1.ALREADY_EXISTS;case _.PERMISSION_DENIED:return l1.PERMISSION_DENIED;case _.FAILED_PRECONDITION:return l1.FAILED_PRECONDITION;case _.ABORTED:return l1.ABORTED;case _.OUT_OF_RANGE:return l1.OUT_OF_RANGE;case _.UNIMPLEMENTED:return l1.UNIMPLEMENTED;case _.DATA_LOSS:return l1.DATA_LOSS;default:return l0()}}(w=_||(_={}))[w.OK=0]="OK",w[w.CANCELLED=1]="CANCELLED",w[w.UNKNOWN=2]="UNKNOWN",w[w.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",w[w.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",w[w.NOT_FOUND=5]="NOT_FOUND",w[w.ALREADY_EXISTS=6]="ALREADY_EXISTS",w[w.PERMISSION_DENIED=7]="PERMISSION_DENIED",w[w.UNAUTHENTICATED=16]="UNAUTHENTICATED",w[w.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",w[w.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",w[w.ABORTED=10]="ABORTED",w[w.OUT_OF_RANGE=11]="OUT_OF_RANGE",w[w.UNIMPLEMENTED=12]="UNIMPLEMENTED",w[w.INTERNAL=13]="INTERNAL",w[w.UNAVAILABLE=14]="UNAVAILABLE",w[w.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(){this.onExistenceFilterMismatchCallbacks=new Map}static get instance(){return dn}static getOrCreateInstance(){return null===dn&&(dn=new dt),dn}onExistenceFilterMismatch(e){let t=Symbol();return this.onExistenceFilterMismatchCallbacks.set(t,e),()=>this.onExistenceFilterMismatchCallbacks.delete(t)}notifyOnExistenceFilterMismatch(e){this.onExistenceFilterMismatchCallbacks.forEach(t=>t(e))}}let dn=null;/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dr(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let di=new lz([4294967295,4294967295],0);function ds(e){let t=dr().encode(e),n=new lB;return n.update(t),new Uint8Array(n.digest())}function da(e){let t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new lz([n,r],0),new lz([i,s],0)]}class dl{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new du(`Invalid padding: ${t}`);if(n<0||e.length>0&&0===this.hashCount)throw new du(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new du(`Invalid padding when bitmap length is 0: ${t}`);this.yt=8*e.length-t,this.It=lz.fromNumber(this.yt)}Tt(e,t,n){let r=e.add(t.multiply(lz.fromNumber(n)));return 1===r.compare(di)&&(r=new lz([r.getBits(0),r.getBits(1)],0)),r.modulo(this.It).toNumber()}Et(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}At(e){if(0===this.yt)return!1;let t=ds(e),[n,r]=da(t);for(let e=0;e<this.hashCount;e++){let t=this.Tt(n,r,e);if(!this.Et(t))return!1}return!0}static create(e,t,n){let r=new Uint8Array(Math.ceil(e/8)),i=new dl(r,e%8==0?0:8-e%8,t);return n.forEach(e=>i.insert(e)),i}insert(e){if(0===this.yt)return;let t=ds(e),[n,r]=da(t);for(let e=0;e<this.hashCount;e++){let t=this.Tt(n,r,e);this.Rt(t)}}Rt(e){this.bitmap[Math.floor(e/8)]|=1<<e%8}}class du extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dc{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){let r=new Map;return r.set(e,dh.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new dc(uo.min(),r,new cr(ur),hI,hA())}}class dh{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new dh(n,t,hA(),hA(),hA())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{constructor(e,t,n,r){this.vt=e,this.removedTargetIds=t,this.key=n,this.Pt=r}}class df{constructor(e,t){this.targetId=e,this.bt=t}}class dp{constructor(e,t,n=ch.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class dg{constructor(){this.Vt=0,this.St=dv(),this.Dt=ch.EMPTY_BYTE_STRING,this.Ct=!1,this.xt=!0}get current(){return this.Ct}get resumeToken(){return this.Dt}get Nt(){return 0!==this.Vt}get kt(){return this.xt}Mt(e){e.approximateByteSize()>0&&(this.xt=!0,this.Dt=e)}Ot(){let e=hA(),t=hA(),n=hA();return this.St.forEach((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:l0()}}),new dh(this.Dt,this.Ct,e,t,n)}$t(){this.xt=!1,this.St=dv()}Ft(e,t){this.xt=!0,this.St=this.St.insert(e,t)}Bt(e){this.xt=!0,this.St=this.St.remove(e)}Lt(){this.Vt+=1}qt(){this.Vt-=1}Ut(){this.xt=!0,this.Ct=!0}}class dm{constructor(e){this.Kt=e,this.Gt=new Map,this.Qt=hI,this.jt=dy(),this.zt=new cr(ur)}Wt(e){for(let t of e.vt)e.Pt&&e.Pt.isFoundDocument()?this.Ht(t,e.Pt):this.Jt(t,e.key,e.Pt);for(let t of e.removedTargetIds)this.Jt(t,e.key,e.Pt)}Yt(e){this.forEachTarget(e,t=>{let n=this.Xt(t);switch(e.state){case 0:this.Zt(t)&&n.Mt(e.resumeToken);break;case 1:n.qt(),n.Nt||n.$t(),n.Mt(e.resumeToken);break;case 2:n.qt(),n.Nt||this.removeTarget(t);break;case 3:this.Zt(t)&&(n.Ut(),n.Mt(e.resumeToken));break;case 4:this.Zt(t)&&(this.te(t),n.Mt(e.resumeToken));break;default:l0()}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Gt.forEach((e,n)=>{this.Zt(n)&&t(n)})}ee(e){var t;let n=e.targetId,r=e.bt.count,i=this.ne(n);if(i){let s=i.target;if(ht(s)){if(0===r){let e=new uh(s.path);this.Jt(n,e,cq.newNoDocument(e,uo.min()))}else 1===r||l0()}else{let i=this.se(n);if(i!==r){let r=this.ie(e,i);0!==r&&(this.te(n),this.zt=this.zt.insert(n,2===r?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch")),null===(t=dt.instance)||void 0===t||t.notifyOnExistenceFilterMismatch(function(e,t,n){var r,i,s,o,a,l;let u={localCacheCount:t,existenceFilterCount:n.count},c=n.unchangedNames;return c&&(u.bloomFilter={applied:0===e,hashCount:null!==(r=null==c?void 0:c.hashCount)&&void 0!==r?r:0,bitmapLength:null!==(o=null===(s=null===(i=null==c?void 0:c.bits)||void 0===i?void 0:i.bitmap)||void 0===s?void 0:s.length)&&void 0!==o?o:0,padding:null!==(l=null===(a=null==c?void 0:c.bits)||void 0===a?void 0:a.padding)&&void 0!==l?l:0}),u}(r,i,e.bt))}}}}ie(e,t){let n,r;let{unchangedNames:i,count:s}=e.bt;if(!i||!i.bits)return 1;let{bits:{bitmap:o="",padding:a=0},hashCount:l=0}=i;try{n=cg(o).toUint8Array()}catch(e){if(e instanceof cc)return lX("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),1;throw e}try{r=new dl(n,a,l)}catch(e){return lX(e instanceof du?"BloomFilter error: ":"Applying bloom filter failed: ",e),1}return 0===r.yt?1:s!==t-this.re(e.targetId,r)?2:0}re(e,t){let n=this.Kt.getRemoteKeysForTarget(e),r=0;return n.forEach(n=>{let i=this.Kt.oe(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;t.At(s)||(this.Jt(e,n,null),r++)}),r}ue(e){let t=new Map;this.Gt.forEach((n,r)=>{let i=this.ne(r);if(i){if(n.current&&ht(i.target)){let t=new uh(i.target.path);null!==this.Qt.get(t)||this.ce(r,t)||this.Jt(r,t,cq.newNoDocument(t,e))}n.kt&&(t.set(r,n.Ot()),n.$t())}});let n=hA();this.jt.forEach((e,t)=>{let r=!0;t.forEachWhile(e=>{let t=this.ne(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)}),r&&(n=n.add(e))}),this.Qt.forEach((t,n)=>n.setReadTime(e));let r=new dc(e,t,this.zt,this.Qt,n);return this.Qt=hI,this.jt=dy(),this.zt=new cr(ur),r}Ht(e,t){if(!this.Zt(e))return;let n=this.ce(e,t.key)?2:0;this.Xt(e).Ft(t.key,n),this.Qt=this.Qt.insert(t.key,t),this.jt=this.jt.insert(t.key,this.ae(t.key).add(e))}Jt(e,t,n){if(!this.Zt(e))return;let r=this.Xt(e);this.ce(e,t)?r.Ft(t,1):r.Bt(t),this.jt=this.jt.insert(t,this.ae(t).delete(e)),n&&(this.Qt=this.Qt.insert(t,n))}removeTarget(e){this.Gt.delete(e)}se(e){let t=this.Xt(e).Ot();return this.Kt.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Lt(e){this.Xt(e).Lt()}Xt(e){let t=this.Gt.get(e);return t||(t=new dg,this.Gt.set(e,t)),t}ae(e){let t=this.jt.get(e);return t||(t=new co(ur),this.jt=this.jt.insert(e,t)),t}Zt(e){let t=null!==this.ne(e);return t||lQ("WatchChangeAggregator","Detected inactive target",e),t}ne(e){let t=this.Gt.get(e);return t&&t.Nt?null:this.Kt.he(e)}te(e){this.Gt.set(e,new dg),this.Kt.getRemoteKeysForTarget(e).forEach(t=>{this.Jt(e,t,null)})}ce(e,t){return this.Kt.getRemoteKeysForTarget(e).has(t)}}function dy(){return new cr(uh.comparator)}function dv(){return new cr(uh.comparator)}let d_={asc:"ASCENDING",desc:"DESCENDING"},dw={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},db={and:"AND",or:"OR"};class dI{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function dT(e,t){return e.useProto3Json||uM(t)?t:{value:t}}function dE(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function dC(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function dS(e){return e||l0(),uo.fromTimestamp(function(e){let t=cf(e);return new us(t.seconds,t.nanos)}(e))}function dk(e,t){return new ul(["projects",e.projectId,"databases",e.database]).child("documents").child(t).canonicalString()}function dx(e){let t=ul.fromString(e);return d$(t)||l0(),t}function dA(e,t){return dk(e.databaseId,t.path)}function dR(e,t){let n=dx(t);if(n.get(1)!==e.databaseId.projectId)throw new l2(l1.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new l2(l1.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new uh(dO(n))}function dN(e,t){return dk(e.databaseId,t)}function dP(e){let t=dx(e);return 4===t.length?ul.emptyPath():dO(t)}function dD(e){return new ul(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function dO(e){return e.length>4&&"documents"===e.get(4)||l0(),e.popFirst(5)}function dF(e,t,n){return{name:dA(e,t),fields:n.value.mapValue.fields}}function dL(e,t,n){let r=dR(e,t.name),i=dS(t.updateTime),s=t.createTime?dS(t.createTime):uo.min(),o=new cV({mapValue:{fields:t.fields}}),a=cq.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function dM(e,t){var n;let r;if(t instanceof hX)r={update:dF(e,t.key,t.value)};else if(t instanceof h4)r={delete:dA(e,t.key)};else if(t instanceof hJ)r={update:dF(e,t.key,t.data),updateMask:function(e){let t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}(t.fieldMask)};else{if(!(t instanceof h9))return l0();r={verify:dA(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(e=>(function(e,t){let n=t.transform;if(n instanceof hL)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof hM)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof hV)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof hj)return{fieldPath:t.field.canonicalString(),increment:n.wt};throw l0()})(0,e))),t.precondition.isNone||(r.currentDocument=void 0!==(n=t.precondition).updateTime?{updateTime:dE(e,n.updateTime.toTimestamp())}:void 0!==n.exists?{exists:n.exists}:l0()),r}function dU(e,t){var n;let r=t.currentDocument?void 0!==(n=t.currentDocument).updateTime?hW.updateTime(dS(n.updateTime)):void 0!==n.exists?hW.exists(n.exists):hW.none():hW.none(),i=t.updateTransforms?t.updateTransforms.map(t=>(function(e,t){let n=null;if("setToServerValue"in t)"REQUEST_TIME"===t.setToServerValue||l0(),n=new hL;else if("appendMissingElements"in t){let e=t.appendMissingElements.values||[];n=new hM(e)}else if("removeAllFromArray"in t){let e=t.removeAllFromArray.values||[];n=new hV(e)}else"increment"in t?n=new hj(e,t.increment):l0();let r=uc.fromServerFormat(t.fieldPath);return new h$(r,n)})(e,t)):[];if(t.update){t.update.name;let n=dR(e,t.update.name),s=new cV({mapValue:{fields:t.update.fields}});if(t.updateMask){let e=function(e){let t=e.fieldPaths||[];return new cu(t.map(e=>uc.fromServerFormat(e)))}(t.updateMask);return new hJ(n,s,e,r,i)}return new hX(n,s,r,i)}if(t.delete){let n=dR(e,t.delete);return new h4(n,r)}if(t.verify){let n=dR(e,t.verify);return new h9(n,r)}return l0()}function dV(e,t){return{documents:[dN(e,t.path)]}}function dq(e,t){var n,r;let i={structuredQuery:{}},s=t.path;null!==t.collectionGroup?(i.parent=dN(e,s),i.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i.parent=dN(e,s.popLast()),i.structuredQuery.from=[{collectionId:s.lastSegment()}]);let o=function(e){if(0!==e.length)return function e(t){return t instanceof cW?function(e){if("=="===e.op){if(cD(e.value))return{unaryFilter:{field:dB(e.field),op:"IS_NAN"}};if(cP(e.value))return{unaryFilter:{field:dB(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(cD(e.value))return{unaryFilter:{field:dB(e.field),op:"IS_NOT_NAN"}};if(cP(e.value))return{unaryFilter:{field:dB(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:dB(e.field),op:dw[e.op],value:e.value}}}(t):t instanceof cG?function(t){let n=t.getFilters().map(t=>e(t));return 1===n.length?n[0]:{compositeFilter:{op:db[t.op],filters:n}}}(t):l0()}(cG.create(e,"and"))}(t.filters);o&&(i.structuredQuery.where=o);let a=function(e){if(0!==e.length)return e.map(e=>({field:dB(e.field),direction:d_[e.dir]}))}(t.orderBy);a&&(i.structuredQuery.orderBy=a);let l=dT(e,t.limit);return null!==l&&(i.structuredQuery.limit=l),t.startAt&&(i.structuredQuery.startAt={before:(n=t.startAt).inclusive,values:n.position}),t.endAt&&(i.structuredQuery.endAt={before:!(r=t.endAt).inclusive,values:r.position}),i}function dj(e){var t,n,r,i,s,o,a,l;let u,c=dP(e.parent),h=e.structuredQuery,d=h.from?h.from.length:0,f=null;if(d>0){1===d||l0();let e=h.from[0];e.allDescendants?f=e.collectionId:c=c.child(e.collectionId)}let p=[];h.where&&(p=function(e){let t=function e(t){return void 0!==t.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":let t=dz(e.unaryFilter.field);return cW.create(t,"==",{doubleValue:NaN});case"IS_NULL":let n=dz(e.unaryFilter.field);return cW.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let r=dz(e.unaryFilter.field);return cW.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let i=dz(e.unaryFilter.field);return cW.create(i,"!=",{nullValue:"NULL_VALUE"});default:return l0()}}(t):void 0!==t.fieldFilter?cW.create(dz(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return l0()}}(t.fieldFilter.op),t.fieldFilter.value):void 0!==t.compositeFilter?cG.create(t.compositeFilter.filters.map(t=>e(t)),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return l0()}}(t.compositeFilter.op)):l0()}(e);return t instanceof cG&&cQ(t)?t.getFilters():[t]}(h.where));let g=[];h.orderBy&&(g=h.orderBy.map(e=>new c$(dz(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))));let m=null;h.limit&&(m=uM(u="object"==typeof(t=h.limit)?t.value:t)?null:u);let y=null;h.startAt&&(y=function(e){let t=!!e.before,n=e.values||[];return new cj(n,t)}(h.startAt));let v=null;return h.endAt&&(v=function(e){let t=!e.before,n=e.values||[];return new cj(n,t)}(h.endAt)),n=c,r=f,i=g,s=p,o=m,a=y,l=v,new hs(n,r,i,s,o,"F",a,l)}function dB(e){return{fieldPath:e.canonicalString()}}function dz(e){return uc.fromServerFormat(e.fieldPath)}function d$(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dH{constructor(e,t,n,r,i=uo.min(),s=uo.min(),o=ch.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new dH(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new dH(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new dH(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new dH(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dW{constructor(e){this.le=e}}function dG(e,t){let n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:dK(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument()){var i;r.document={name:dA(i=e.le,t.key),fields:t.data.value.mapValue.fields,updateTime:dE(i,t.version.toTimestamp()),createTime:dE(i,t.createTime.toTimestamp())}}else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:dZ(t.version)};else{if(!t.isUnknownDocument())return l0();r.unknownDocument={path:n.path.toArray(),version:dZ(t.version)}}return r}function dK(e){let t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function dZ(e){let t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function dQ(e){let t=new us(e.seconds,e.nanoseconds);return uo.fromTimestamp(t)}function dY(e,t){let n=(t.baseMutations||[]).map(t=>dU(e.le,t));for(let e=0;e<t.mutations.length-1;++e){let n=t.mutations[e];if(e+1<t.mutations.length&&void 0!==t.mutations[e+1].transform){let r=t.mutations[e+1];n.updateTransforms=r.transform.fieldTransforms,t.mutations.splice(e+1,1),++e}}let r=t.mutations.map(t=>dU(e.le,t)),i=us.fromMillis(t.localWriteTimeMs);return new h5(t.batchId,i,n,r)}function dX(e){var t;let n;let r=dQ(e.readTime),i=void 0!==e.lastLimboFreeSnapshotVersion?dQ(e.lastLimboFreeSnapshotVersion):uo.min();return void 0!==e.query.documents?(1===(t=e.query).documents.length||l0(),n=hd(ho(dP(t.documents[0])))):n=hd(dj(e.query)),new dH(n,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,r,i,ch.fromBase64String(e.resumeToken))}function dJ(e,t){let n;let r=dZ(t.snapshotVersion),i=dZ(t.lastLimboFreeSnapshotVersion);n=ht(t.target)?dV(e.le,t.target):dq(e.le,t.target);let s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:c7(t.target),readTime:r,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:n}}function d0(e){let t=dj({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?hp(t,t.limit,"L"):t}function d1(e,t){return new h3(t.largestBatchId,dU(e.le,t.overlayMutation))}function d2(e,t){let n=t.path.lastSegment();return[e,uq(t.path.popLast()),n]}function d4(e,t,n,r){return{indexId:e,uid:t.uid||"",sequenceNumber:n,readTime:dZ(r.readTime),documentKey:uq(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d9{getBundleMetadata(e,t){return d5(e).get(t).next(e=>{if(e)return{id:e.bundleId,createTime:dQ(e.createTime),version:e.version}})}saveBundleMetadata(e,t){return d5(e).put({bundleId:t.id,createTime:dZ(dS(t.createTime)),version:t.version})}getNamedQuery(e,t){return d6(e).get(t).next(e=>{if(e)return{name:e.name,query:d0(e.bundledQuery),readTime:dQ(e.readTime)}})}saveNamedQuery(e,t){return d6(e).put({name:t.name,readTime:dZ(dS(t.readTime)),bundledQuery:t.bundledQuery})}}function d5(e){return u7(e,"bundles")}function d6(e){return u7(e,"namedQueries")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d3{constructor(e,t){this.serializer=e,this.userId=t}static fe(e,t){let n=t.uid||"";return new d3(e,n)}getOverlay(e,t){return d8(e).get(d2(this.userId,t)).next(e=>e?d1(this.serializer,e):null)}getOverlays(e,t){let n=hS();return uE.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){let r=[];return n.forEach((n,i)=>{let s=new h3(t,i);r.push(this.de(e,s))}),uE.waitFor(r)}removeOverlaysForBatchId(e,t,n){let r=new Set;t.forEach(e=>r.add(uq(e.getCollectionPath())));let i=[];return r.forEach(t=>{let r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(d8(e).J("collectionPathOverlayIndex",r))}),uE.waitFor(i)}getOverlaysForCollection(e,t,n){let r=hS(),i=uq(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return d8(e).j("collectionPathOverlayIndex",s).next(e=>{for(let t of e){let e=d1(this.serializer,t);r.set(e.getKey(),e)}return r})}getOverlaysForCollectionGroup(e,t,n,r){let i;let s=hS(),o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return d8(e).X({index:"collectionGroupOverlayIndex",range:o},(e,t,n)=>{let o=d1(this.serializer,t);s.size()<r||o.largestBatchId===i?(s.set(o.getKey(),o),i=o.largestBatchId):n.done()}).next(()=>s)}de(e,t){return d8(e).put(function(e,t,n){let[r,i,s]=d2(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:dM(e.le,n.mutation)}}(this.serializer,this.userId,t))}}function d8(e){return u7(e,"documentOverlays")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d7{constructor(){}_e(e,t){this.we(e,t),t.me()}we(e,t){if("nullValue"in e)this.ge(t,5);else if("booleanValue"in e)this.ge(t,10),t.ye(e.booleanValue?1:0);else if("integerValue"in e)this.ge(t,15),t.ye(cp(e.integerValue));else if("doubleValue"in e){let n=cp(e.doubleValue);isNaN(n)?this.ge(t,13):(this.ge(t,15),uU(n)?t.ye(0):t.ye(n))}else if("timestampValue"in e){let n=e.timestampValue;this.ge(t,20),"string"==typeof n?t.pe(n):(t.pe(`${n.seconds||""}`),t.ye(n.nanos||0))}else if("stringValue"in e)this.Ie(e.stringValue,t),this.Te(t);else if("bytesValue"in e)this.ge(t,30),t.Ee(cg(e.bytesValue)),this.Te(t);else if("referenceValue"in e)this.Ae(e.referenceValue,t);else if("geoPointValue"in e){let n=e.geoPointValue;this.ge(t,45),t.ye(n.latitude||0),t.ye(n.longitude||0)}else"mapValue"in e?cL(e)?this.ge(t,Number.MAX_SAFE_INTEGER):(this.Re(e.mapValue,t),this.Te(t)):"arrayValue"in e?(this.ve(e.arrayValue,t),this.Te(t)):l0()}Ie(e,t){this.ge(t,25),this.Pe(e,t)}Pe(e,t){t.pe(e)}Re(e,t){let n=e.fields||{};for(let e of(this.ge(t,55),Object.keys(n)))this.Ie(e,t),this.we(n[e],t)}ve(e,t){let n=e.values||[];for(let e of(this.ge(t,50),n))this.we(e,t)}Ae(e,t){this.ge(t,37),uh.fromName(e).path.forEach(e=>{this.ge(t,60),this.Pe(e,t)})}ge(e,t){e.ye(t)}Te(e){e.ye(2)}}function fe(e){let t=64-function(e){let t=0;for(let n=0;n<8;++n){let r=function(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}d7.be=new d7;class ft{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ve(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.Se(n.value),n=t.next();this.De()}Ce(e){let t=e[Symbol.iterator](),n=t.next();for(;!n.done;)this.xe(n.value),n=t.next();this.Ne()}ke(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.Se(e);else if(e<2048)this.Se(960|e>>>6),this.Se(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Se(480|e>>>12),this.Se(128|63&e>>>6),this.Se(128|63&e);else{let e=t.codePointAt(0);this.Se(240|e>>>18),this.Se(128|63&e>>>12),this.Se(128|63&e>>>6),this.Se(128|63&e)}}this.De()}Me(e){for(let t of e){let e=t.charCodeAt(0);if(e<128)this.xe(e);else if(e<2048)this.xe(960|e>>>6),this.xe(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.xe(480|e>>>12),this.xe(128|63&e>>>6),this.xe(128|63&e);else{let e=t.codePointAt(0);this.xe(240|e>>>18),this.xe(128|63&e>>>12),this.xe(128|63&e>>>6),this.xe(128|63&e)}}this.Ne()}Oe(e){let t=this.$e(e),n=fe(t);this.Fe(1+n),this.buffer[this.position++]=255&n;for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=255&t[e]}Be(e){let t=this.$e(e),n=fe(t);this.Fe(1+n),this.buffer[this.position++]=~(255&n);for(let e=t.length-n;e<t.length;++e)this.buffer[this.position++]=~(255&t[e])}Le(){this.qe(255),this.qe(255)}Ue(){this.Ke(255),this.Ke(255)}reset(){this.position=0}seed(e){this.Fe(e.length),this.buffer.set(e,this.position),this.position+=e.length}Ge(){return this.buffer.slice(0,this.position)}$e(e){let t=function(e){let t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let e=1;e<t.length;++e)t[e]^=n?255:0;return t}Se(e){let t=255&e;0===t?(this.qe(0),this.qe(255)):255===t?(this.qe(255),this.qe(0)):this.qe(t)}xe(e){let t=255&e;0===t?(this.Ke(0),this.Ke(255)):255===t?(this.Ke(255),this.Ke(0)):this.Ke(e)}De(){this.qe(0),this.qe(1)}Ne(){this.Ke(0),this.Ke(1)}qe(e){this.Fe(1),this.buffer[this.position++]=e}Ke(e){this.Fe(1),this.buffer[this.position++]=~e}Fe(e){let t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);let r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class fn{constructor(e){this.Qe=e}Ee(e){this.Qe.Ve(e)}pe(e){this.Qe.ke(e)}ye(e){this.Qe.Oe(e)}me(){this.Qe.Le()}}class fr{constructor(e){this.Qe=e}Ee(e){this.Qe.Ce(e)}pe(e){this.Qe.Me(e)}ye(e){this.Qe.Be(e)}me(){this.Qe.Ue()}}class fi{constructor(){this.Qe=new ft,this.je=new fn(this.Qe),this.ze=new fr(this.Qe)}seed(e){this.Qe.seed(e)}We(e){return 0===e?this.je:this.ze}Ge(){return this.Qe.Ge()}reset(){this.Qe.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}He(){let e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new fs(this.indexId,this.documentKey,this.arrayValue,n)}}function fo(e,t){let n=e.indexId-t.indexId;return 0!==n?n:0!==(n=fa(e.arrayValue,t.arrayValue))?n:0!==(n=fa(e.directionalValue,t.directionalValue))?n:uh.comparator(e.documentKey,t.documentKey)}function fa(e,t){for(let n=0;n<e.length&&n<t.length;++n){let r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fl{constructor(e){for(let t of(this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.Je=e.orderBy,this.Ye=[],e.filters)){let e=t;e.isInequality()?this.Xe=e:this.Ye.push(e)}}Ze(e){e.collectionGroup===this.collectionId||l0();let t=uf(e);if(void 0!==t&&!this.tn(t))return!1;let n=up(e),r=0,i=0;for(;r<n.length&&this.tn(n[r]);++r);if(r===n.length)return!0;if(void 0!==this.Xe){let e=n[r];if(!this.en(this.Xe,e)||!this.nn(this.Je[i++],e))return!1;++r}for(;r<n.length;++r){let e=n[r];if(i>=this.Je.length||!this.nn(this.Je[i++],e))return!1}return!0}tn(e){for(let t of this.Ye)if(this.en(t,e))return!0;return!1}en(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;let n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}nn(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function fu(e){return e instanceof cW}function fc(e){return e instanceof cG&&cQ(e)}function fh(e){return fu(e)||fc(e)||function(e){if(e instanceof cG&&cZ(e)){for(let t of e.getFilters())if(!fu(t)&&!fc(t))return!1;return!0}return!1}(e)}function fd(e,t){return e instanceof cW||e instanceof cG||l0(),t instanceof cW||t instanceof cG||l0(),fp(e instanceof cW?t instanceof cW?cG.create([e,t],"and"):ff(e,t):t instanceof cW?ff(t,e):function(e,t){if(e.filters.length>0&&t.filters.length>0||l0(),cK(e)&&cK(t))return cX(e,t.getFilters());let n=cZ(e)?e:t,r=cZ(e)?t:e,i=n.filters.map(e=>fd(e,r));return cG.create(i,"or")}(e,t))}function ff(e,t){if(cK(t))return cX(t,e.getFilters());{let n=t.filters.map(t=>fd(e,t));return cG.create(n,"or")}}function fp(e){if(e instanceof cW||e instanceof cG||l0(),e instanceof cW)return e;let t=e.getFilters();if(1===t.length)return fp(t[0]);if(cY(e))return e;let n=t.map(e=>fp(e)),r=[];return n.forEach(t=>{t instanceof cW?r.push(t):t instanceof cG&&(t.op===e.op?r.push(...t.filters):r.push(t))}),1===r.length?r[0]:cG.create(r,e.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fg{constructor(){this.sn=new fm}addToCollectionParentIndex(e,t){return this.sn.add(t),uE.resolve()}getCollectionParents(e,t){return uE.resolve(this.sn.getEntries(t))}addFieldIndex(e,t){return uE.resolve()}deleteFieldIndex(e,t){return uE.resolve()}getDocumentsMatchingTarget(e,t){return uE.resolve(null)}getIndexType(e,t){return uE.resolve(0)}getFieldIndexes(e,t){return uE.resolve([])}getNextCollectionGroupToUpdate(e){return uE.resolve(null)}getMinOffset(e,t){return uE.resolve(u_.min())}getMinOffsetFromCollectionGroup(e,t){return uE.resolve(u_.min())}updateCollectionGroup(e,t,n){return uE.resolve()}updateIndexEntries(e,t){return uE.resolve()}}class fm{constructor(){this.index={}}add(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new co(ul.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){let t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new co(ul.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fy=new Uint8Array(0);class fv{constructor(e,t){this.user=e,this.databaseId=t,this.rn=new fm,this.on=new hb(e=>c7(e),(e,t)=>he(e,t)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.rn.has(t)){let n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener(()=>{this.rn.add(t)});let i={collectionId:n,parent:uq(r)};return f_(e).put(i)}return uE.resolve()}getCollectionParents(e,t){let n=[],r=IDBKeyRange.bound([t,""],[t+"\x00",""],!1,!0);return f_(e).j(r).next(e=>{for(let r of e){if(r.collectionId!==t)break;n.push(uj(r.parent))}return n})}addFieldIndex(e,t){let n=fb(e),r={indexId:t.indexId,collectionGroup:t.collectionGroup,fields:t.fields.map(e=>[e.fieldPath.canonicalString(),e.kind])};delete r.indexId;let i=n.add(r);if(t.indexState){let n=fI(e);return i.next(e=>{n.put(d4(e,this.user,t.indexState.sequenceNumber,t.indexState.offset))})}return i.next()}deleteFieldIndex(e,t){let n=fb(e),r=fI(e),i=fw(e);return n.delete(t.indexId).next(()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}getDocumentsMatchingTarget(e,t){let n=fw(e),r=!0,i=new Map;return uE.forEach(this.un(t),t=>this.cn(e,t).next(e=>{r&&(r=!!e),i.set(t,e)})).next(()=>{if(r){let e=hA(),r=[];return uE.forEach(i,(i,s)=>{lQ("IndexedDbIndexManager",`Using index id=${i.indexId}|cg=${i.collectionGroup}|f=${i.fields.map(e=>`${e.fieldPath}:${e.kind}`).join(",")} to execute ${c7(t)}`);let o=function(e,t){let n=uf(t);if(void 0===n)return null;for(let t of hn(e,n.fieldPath))switch(t.op){case"array-contains-any":return t.value.arrayValue.values||[];case"array-contains":return[t.value]}return null}(s,i),a=function(e,t){let n=new Map;for(let r of up(t))for(let t of hn(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),l=function(e,t){let n=[],r=!0;for(let i of up(t)){let t=0===i.kind?hr(e,i.fieldPath,e.startAt):hi(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new cj(n,r)}(s,i),u=function(e,t){let n=[],r=!0;for(let i of up(t)){let t=0===i.kind?hi(e,i.fieldPath,e.endAt):hr(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new cj(n,r)}(s,i),c=this.an(i,s,l),h=this.an(i,s,u),d=this.hn(i,s,a),f=this.ln(i.indexId,o,c,l.inclusive,h,u.inclusive,d);return uE.forEach(f,i=>n.H(i,t.limit).next(t=>{t.forEach(t=>{let n=uh.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))})}))}).next(()=>r)}return uE.resolve(null)})}un(e){let t=this.on.get(e);return t||(t=0===e.filters.length?[e]:(function(e){if(0===e.getFilters().length)return[];let t=function e(t){if(t instanceof cW||t instanceof cG||l0(),t instanceof cW)return t;if(1===t.filters.length)return e(t.filters[0]);let n=t.filters.map(t=>e(t)),r=cG.create(n,t.op);return fh(r=fp(r))?r:(r instanceof cG||l0(),cK(r)||l0(),r.filters.length>1||l0(),r.filters.reduce((e,t)=>fd(e,t)))}(/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function e(t){var n,r;if(t instanceof cW||t instanceof cG||l0(),t instanceof cW){if(t instanceof c9){let e=(null===(r=null===(n=t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map(e=>cW.create(t.field,"==",e)))||[];return cG.create(e,"or")}return t}let i=t.filters.map(t=>e(t));return cG.create(i,t.op)}(e));return fh(t)||l0(),fu(t)||fc(t)?[t]:t.getFilters()})(cG.create(e.filters,"and")).map(t=>c8(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt)),this.on.set(e,t)),t}ln(e,t,n,r,i,s,o){let a=(null!=t?t.length:1)*Math.max(n.length,i.length),l=a/(null!=t?t.length:1),u=[];for(let c=0;c<a;++c){let a=t?this.fn(t[c/l]):fy,h=this.dn(e,a,n[c%l],r),d=this._n(e,a,i[c%l],s),f=o.map(t=>this.dn(e,a,t,!0));u.push(...this.createRange(h,d,f))}return u}dn(e,t,n,r){let i=new fs(e,uh.empty(),t,n);return r?i:i.He()}_n(e,t,n,r){let i=new fs(e,uh.empty(),t,n);return r?i.He():i}cn(e,t){let n=new fl(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next(e=>{let t=null;for(let r of e)n.Ze(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t})}getIndexType(e,t){let n=2,r=this.un(t);return uE.forEach(r,t=>this.cn(e,t).next(e=>{e?0!==n&&e.fields.length<function(e){let t=new co(uc.comparator),n=!1;for(let r of e.filters)for(let e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(let n of e.orderBy)n.field.isKeyField()||(t=t.add(n.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})).next(()=>null!==t.limit&&r.length>1&&2===n?1:n)}wn(e,t){let n=new fi;for(let r of up(e)){let e=t.data.field(r.fieldPath);if(null==e)return null;let i=n.We(r.kind);d7.be._e(e,i)}return n.Ge()}fn(e){let t=new fi;return d7.be._e(e,t.We(0)),t.Ge()}mn(e,t){let n=new fi;return d7.be._e(cA(this.databaseId,t),n.We(function(e){let t=up(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.Ge()}hn(e,t,n){if(null===n)return[];let r=[];r.push(new fi);let i=0;for(let s of up(e)){let e=n[i++];for(let n of r)if(this.gn(t,s.fieldPath)&&cN(e))r=this.yn(r,s,e);else{let t=n.We(s.kind);d7.be._e(e,t)}}return this.pn(r)}an(e,t,n){return this.hn(e,t,n.position)}pn(e){let t=[];for(let n=0;n<e.length;++n)t[n]=e[n].Ge();return t}yn(e,t,n){let r=[...e],i=[];for(let e of n.arrayValue.values||[])for(let n of r){let r=new fi;r.seed(n.Ge()),d7.be._e(e,r.We(t.kind)),i.push(r)}return i}gn(e,t){return!!e.filters.find(e=>e instanceof cW&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op))}getFieldIndexes(e,t){let n=fb(e),r=fI(e);return(t?n.j("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.j()).next(e=>{let t=[];return uE.forEach(e,e=>r.get([e.indexId,this.uid]).next(n=>{t.push(function(e,t){let n=t?new um(t.sequenceNumber,new u_(dQ(t.readTime),new uh(uj(t.documentKey)),t.largestBatchId)):um.empty(),r=e.fields.map(([e,t])=>new ug(uc.fromServerFormat(e),t));return new ud(e.indexId,e.collectionGroup,r,n)}(e,n))})).next(()=>t)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(e=>0===e.length?null:(e.sort((e,t)=>{let n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:ur(e.collectionGroup,t.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(e,t,n){let r=fb(e),i=fI(e);return this.In(e).next(e=>r.j("collectionGroupIndex",IDBKeyRange.bound(t,t)).next(t=>uE.forEach(t,t=>i.put(d4(t.indexId,this.user,e,n)))))}updateIndexEntries(e,t){let n=new Map;return uE.forEach(t,(t,r)=>{let i=n.get(t.collectionGroup);return(i?uE.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next(i=>(n.set(t.collectionGroup,i),uE.forEach(i,n=>this.Tn(e,t,n).next(t=>{let i=this.En(r,n);return t.isEqual(i)?uE.resolve():this.An(e,r,n,t,i)}))))})}Rn(e,t,n,r){return fw(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,r){return fw(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}Tn(e,t,n){let r=fw(e),i=new co(fo);return r.X({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},(e,r)=>{i=i.add(new fs(n.indexId,t,r.arrayValue,r.directionalValue))}).next(()=>i)}En(e,t){let n=new co(fo),r=this.wn(t,e);if(null==r)return n;let i=uf(t);if(null!=i){let s=e.data.field(i.fieldPath);if(cN(s))for(let i of s.arrayValue.values||[])n=n.add(new fs(t.indexId,e.key,this.fn(i),r))}else n=n.add(new fs(t.indexId,e.key,fy,r));return n}An(e,t,n,r,i){lQ("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);let s=[];return function(e,t,n,r,i){let s=e.getIterator(),o=t.getIterator(),a=cl(s),l=cl(o);for(;a||l;){let e=!1,t=!1;if(a&&l){let r=n(a,l);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(l),l=cl(o)):t?(i(a),a=cl(s)):(a=cl(s),l=cl(o))}}(r,i,fo,r=>{s.push(this.Rn(e,t,n,r))},r=>{s.push(this.vn(e,t,n,r))}),uE.waitFor(s)}In(e){let t=1;return fI(e).X({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(e,n,r)=>{r.done(),t=n.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((e,t)=>fo(e,t)).filter((e,t,n)=>!t||0!==fo(e,n[t-1]));let r=[];for(let i of(r.push(e),n)){let n=fo(i,e),s=fo(i,t);if(0===n)r[0]=e.He();else if(n>0&&s<0)r.push(i),r.push(i.He());else if(s>0)break}r.push(t);let i=[];for(let e=0;e<r.length;e+=2){if(this.Pn(r[e],r[e+1]))return[];let t=[r[e].indexId,this.uid,r[e].arrayValue,r[e].directionalValue,fy,[]],n=[r[e+1].indexId,this.uid,r[e+1].arrayValue,r[e+1].directionalValue,fy,[]];i.push(IDBKeyRange.bound(t,n))}return i}Pn(e,t){return fo(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(fT)}getMinOffset(e,t){return uE.mapArray(this.un(t),t=>this.cn(e,t).next(e=>e||l0())).next(fT)}}function f_(e){return u7(e,"collectionParents")}function fw(e){return u7(e,"indexEntries")}function fb(e){return u7(e,"indexConfiguration")}function fI(e){return u7(e,"indexState")}function fT(e){0!==e.length||l0();let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){let i=e[r].indexState.offset;0>uw(i,t)&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new u_(t.readTime,t.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fE={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class fC{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new fC(e,fC.DEFAULT_COLLECTION_PERCENTILE,fC.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fS(e,t,n){let r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId),a=0,l=r.X({range:o},(e,t,n)=>(a++,n.delete()));s.push(l.next(()=>{1===a||l0()}));let u=[];for(let e of n.mutations){var c,h;let r=(c=e.key.path,h=n.batchId,[t,uq(c),h]);s.push(i.delete(r)),u.push(e.key)}return uE.waitFor(s).next(()=>u)}function fk(e){let t;if(!e)return 0;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw l0();t=e.noDocument}return JSON.stringify(t).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */fC.DEFAULT_COLLECTION_PERCENTILE=10,fC.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,fC.DEFAULT=new fC(41943040,fC.DEFAULT_COLLECTION_PERCENTILE,fC.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),fC.DISABLED=new fC(-1,0,0);class fx{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.bn={}}static fe(e,t,n,r){""!==e.uid||l0();let i=e.isAuthenticated()?e.uid:"";return new fx(i,t,n,r)}checkEmpty(e){let t=!0,n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return fR(e).X({index:"userMutationsIndex",range:n},(e,n,r)=>{t=!1,r.done()}).next(()=>t)}addMutationBatch(e,t,n,r){let i=fN(e),s=fR(e);return s.add({}).next(o=>{"number"==typeof o||l0();let a=new h5(o,t,n,r),l=function(e,t,n){let r=n.baseMutations.map(t=>dM(e.le,t)),i=n.mutations.map(t=>dM(e.le,t));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),u=[],c=new co((e,t)=>ur(e.canonicalString(),t.canonicalString()));for(let e of r){let t=[this.userId,uq(e.key.path),o];c=c.add(e.key.path.popLast()),u.push(s.put(l)),u.push(i.put(t,uz))}return c.forEach(t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))}),e.addOnCommittedListener(()=>{this.bn[o]=a.keys()}),uE.waitFor(u).next(()=>a)})}lookupMutationBatch(e,t){return fR(e).get(t).next(e=>e?(e.userId===this.userId||l0(),dY(this.serializer,e)):null)}Vn(e,t){return this.bn[t]?uE.resolve(this.bn[t]):this.lookupMutationBatch(e,t).next(e=>{if(e){let n=e.keys();return this.bn[t]=n,n}return null})}getNextMutationBatchAfterBatchId(e,t){let n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]),i=null;return fR(e).X({index:"userMutationsIndex",range:r},(e,t,r)=>{t.userId===this.userId&&(t.batchId>=n||l0(),i=dY(this.serializer,t)),r.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){let t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),n=-1;return fR(e).X({index:"userMutationsIndex",range:t,reverse:!0},(e,t,r)=>{n=t.batchId,r.done()}).next(()=>n)}getAllMutationBatches(e){let t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return fR(e).j("userMutationsIndex",t).next(e=>e.map(e=>dY(this.serializer,e)))}getAllMutationBatchesAffectingDocumentKey(e,t){let n=[this.userId,uq(t.path)],r=IDBKeyRange.lowerBound(n),i=[];return fN(e).X({range:r},(n,r,s)=>{let[o,a,l]=n,u=uj(a);if(o===this.userId&&t.path.isEqual(u))return fR(e).get(l).next(e=>{if(!e)throw l0();e.userId===this.userId||l0(),i.push(dY(this.serializer,e))});s.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new co(ur),r=[];return t.forEach(t=>{let i=[this.userId,uq(t.path)],s=IDBKeyRange.lowerBound(i),o=fN(e).X({range:s},(e,r,i)=>{let[s,o,a]=e,l=uj(o);s===this.userId&&t.path.isEqual(l)?n=n.add(a):i.done()});r.push(o)}),uE.waitFor(r).next(()=>this.Sn(e,n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=[this.userId,uq(n)],s=IDBKeyRange.lowerBound(i),o=new co(ur);return fN(e).X({range:s},(e,t,i)=>{let[s,a,l]=e,u=uj(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(l)):i.done()}).next(()=>this.Sn(e,o))}Sn(e,t){let n=[],r=[];return t.forEach(t=>{r.push(fR(e).get(t).next(e=>{if(null===e)throw l0();e.userId===this.userId||l0(),n.push(dY(this.serializer,e))}))}),uE.waitFor(r).next(()=>n)}removeMutationBatch(e,t){return fS(e.at,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.Dn(t.batchId)}),uE.forEach(n,t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))}Dn(e){delete this.bn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return uE.resolve();let n=IDBKeyRange.lowerBound([this.userId]),r=[];return fN(e).X({range:n},(e,t,n)=>{if(e[0]===this.userId){let t=uj(e[1]);r.push(t)}else n.done()}).next(()=>{0===r.length||l0()})})}containsKey(e,t){return fA(e,this.userId,t)}Cn(e){return fP(e).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}}function fA(e,t,n){let r=[t,uq(n.path)],i=r[1],s=IDBKeyRange.lowerBound(r),o=!1;return fN(e).X({range:s,Y:!0},(e,n,r)=>{let[s,a,l]=e;s===t&&a===i&&(o=!0),r.done()}).next(()=>o)}function fR(e){return u7(e,"mutations")}function fN(e){return u7(e,"documentMutations")}function fP(e){return u7(e,"mutationQueues")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fD{constructor(e){this.xn=e}next(){return this.xn+=2,this.xn}static Nn(){return new fD(0)}static kn(){return new fD(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fO{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.Mn(e).next(t=>{let n=new fD(t.highestTargetId);return t.highestTargetId=n.next(),this.On(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.Mn(e).next(e=>uo.fromTimestamp(new us(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.Mn(e).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.Mn(e).next(r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.On(e,r)))}addTargetData(e,t){return this.$n(e,t).next(()=>this.Mn(e).next(n=>(n.targetCount+=1,this.Fn(t,n),this.On(e,n))))}updateTargetData(e,t){return this.$n(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>fF(e).delete(t.targetId)).next(()=>this.Mn(e)).next(t=>(t.targetCount>0||l0(),t.targetCount-=1,this.On(e,t)))}removeTargets(e,t,n){let r=0,i=[];return fF(e).X((s,o)=>{let a=dX(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))}).next(()=>uE.waitFor(i)).next(()=>r)}forEachTarget(e,t){return fF(e).X((e,n)=>{let r=dX(n);t(r)})}Mn(e){return fL(e).get("targetGlobalKey").next(e=>(null!==e||l0(),e))}On(e,t){return fL(e).put("targetGlobalKey",t)}$n(e,t){return fF(e).put(dJ(this.serializer,t))}Fn(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.Mn(e).next(e=>e.targetCount)}getTargetData(e,t){let n=c7(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]),i=null;return fF(e).X({range:r,index:"queryTargetsIndex"},(e,n,r)=>{let s=dX(n);he(t,s.target)&&(i=s,r.done())}).next(()=>i)}addMatchingKeys(e,t,n){let r=[],i=fM(e);return t.forEach(t=>{let s=uq(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))}),uE.waitFor(r)}removeMatchingKeys(e,t,n){let r=fM(e);return uE.forEach(t,t=>{let i=uq(t.path);return uE.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])})}removeMatchingKeysForTargetId(e,t){let n=fM(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){let n=IDBKeyRange.bound([t],[t+1],!1,!0),r=fM(e),i=hA();return r.X({range:n,Y:!0},(e,t,n)=>{let r=uj(e[1]),s=new uh(r);i=i.add(s)}).next(()=>i)}containsKey(e,t){let n=uq(t.path),r=IDBKeyRange.bound([n],[n+"\x00"],!1,!0),i=0;return fM(e).X({index:"documentTargetsIndex",Y:!0,range:r},([e,t],n,r)=>{0!==e&&(i++,r.done())}).next(()=>i>0)}he(e,t){return fF(e).get(t).next(e=>e?dX(e):null)}}function fF(e){return u7(e,"targets")}function fL(e){return u7(e,"targetGlobal")}function fM(e){return u7(e,"targetDocuments")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fU([e,t],[n,r]){let i=ur(e,n);return 0===i?ur(t,r):i}class fV{constructor(e){this.Bn=e,this.buffer=new co(fU),this.Ln=0}qn(){return++this.Ln}Un(e){let t=[e,this.qn()];if(this.buffer.size<this.Bn)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();0>fU(t,e)&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class fq{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Kn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Gn(6e4)}stop(){this.Kn&&(this.Kn.cancel(),this.Kn=null)}get started(){return null!==this.Kn}Gn(e){lQ("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.Kn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Kn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){uA(e)?lQ("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await uT(e)}await this.Gn(3e5)})}}class fj{constructor(e,t){this.Qn=e,this.params=t}calculateTargetCount(e,t){return this.Qn.jn(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return uE.resolve(uL.ct);let n=new fV(t);return this.Qn.forEachTarget(e,e=>n.Un(e.sequenceNumber)).next(()=>this.Qn.zn(e,e=>n.Un(e))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.Qn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Qn.removeOrphanedDocuments(e,t)}collect(e,t){return -1===this.params.cacheSizeCollectionThreshold?(lQ("LruGarbageCollector","Garbage collection skipped; disabled"),uE.resolve(fE)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(lQ("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fE):this.Wn(e,t))}getCacheSize(e){return this.Qn.getCacheSize(e)}Wn(e,t){let n,r,i,s,o,a,l;let u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(lQ("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r))).next(r=>(n=r,o=Date.now(),this.removeTargets(e,n,t))).next(t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n))).next(e=>(l=Date.now(),lZ()<=E.in.DEBUG&&lQ("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${s-u}ms
	Determined least recently used ${r} in `+(o-s)+"ms\n"+`	Removed ${i} targets in `+(a-o)+"ms\n"+`	Removed ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-u}ms`),uE.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e})))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fB{constructor(e,t){this.db=e,this.garbageCollector=new fj(this,t)}jn(e){let t=this.Hn(e);return this.db.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}Hn(e){let t=0;return this.zn(e,e=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}zn(e,t){return this.Jn(e,(e,n)=>t(n))}addReference(e,t,n){return fz(e,n)}removeReference(e,t,n){return fz(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return fz(e,t)}Yn(e,t){let n;return n=!1,fP(e).Z(r=>fA(e,r,t).next(e=>(e&&(n=!0),uE.resolve(!e)))).next(()=>n)}removeOrphanedDocuments(e,t){let n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[],i=0;return this.Jn(e,(s,o)=>{if(o<=t){let t=this.Yn(e,s).next(t=>{if(!t)return i++,n.getEntry(e,s).next(()=>(n.removeEntry(s,uo.min()),fM(e).delete([0,uq(s.path)])))});r.push(t)}}).next(()=>uE.waitFor(r)).next(()=>n.apply(e)).next(()=>i)}removeTarget(e,t){let n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return fz(e,t)}Jn(e,t){let n=fM(e),r,i=uL.ct;return n.X({index:"documentTargetsIndex"},([e,n],{path:s,sequenceNumber:o})=>{0===e?(i!==uL.ct&&t(new uh(uj(r)),i),i=o,r=s):i=uL.ct}).next(()=>{i!==uL.ct&&t(new uh(uj(r)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function fz(e,t){var n;return fM(e).put((n=e.currentSequenceNumber,{targetId:0,path:uq(t.path),sequenceNumber:n}))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f${constructor(){this.changes=new hb(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,cq.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let n=this.changes.get(t);return void 0!==n?uE.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fH{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return fK(e).put(n)}removeEntry(e,t,n){return fK(e).delete(function(e,t){let n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],dK(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.Xn(e,n)))}getEntry(e,t){let n=cq.newInvalidDocument(t);return fK(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(fZ(t))},(e,r)=>{n=this.Zn(t,r)}).next(()=>n)}ts(e,t){let n={size:0,document:cq.newInvalidDocument(t)};return fK(e).X({index:"documentKeyIndex",range:IDBKeyRange.only(fZ(t))},(e,r)=>{n={document:this.Zn(t,r),size:fk(r)}}).next(()=>n)}getEntries(e,t){let n=hI;return this.es(e,t,(e,t)=>{let r=this.Zn(e,t);n=n.insert(e,r)}).next(()=>n)}ns(e,t){let n=hI,r=new cr(uh.comparator);return this.es(e,t,(e,t)=>{let i=this.Zn(e,t);n=n.insert(e,i),r=r.insert(e,fk(t))}).next(()=>({documents:n,ss:r}))}es(e,t,n){if(t.isEmpty())return uE.resolve();let r=new co(fY);t.forEach(e=>r=r.add(e));let i=IDBKeyRange.bound(fZ(r.first()),fZ(r.last())),s=r.getIterator(),o=s.getNext();return fK(e).X({index:"documentKeyIndex",range:i},(e,t,r)=>{let i=uh.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&0>fY(o,i);)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.G(fZ(o)):r.done()}).next(()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null})}getDocumentsMatchingQuery(e,t,n,r){let i=t.path,s=[i.popLast().toArray(),i.lastSegment(),dK(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],o=[i.popLast().toArray(),i.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return fK(e).j(IDBKeyRange.bound(s,o,!0)).next(e=>{let n=hI;for(let i of e){let e=this.Zn(uh.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(hv(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n})}getAllFromCollectionGroup(e,t,n,r){let i=hI,s=fQ(t,n),o=fQ(t,u_.max());return fK(e).X({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},(e,t,n)=>{let s=this.Zn(uh.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);(i=i.insert(s.key,s)).size===r&&n.done()}).next(()=>i)}newChangeBuffer(e){return new fW(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(e=>e.byteSize)}getMetadata(e){return fG(e).get("remoteDocumentGlobalKey").next(e=>(e||l0(),e))}Xn(e,t){return fG(e).put("remoteDocumentGlobalKey",t)}Zn(e,t){if(t){let e=function(e,t){let n;if(t.document)n=dL(e.le,t.document,!!t.hasCommittedMutations);else if(t.noDocument){let e=uh.fromSegments(t.noDocument.path),r=dQ(t.noDocument.readTime);n=cq.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return l0();{let e=uh.fromSegments(t.unknownDocument.path),r=dQ(t.unknownDocument.version);n=cq.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){let t=new us(e[0],e[1]);return uo.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!(e.isNoDocument()&&e.version.isEqual(uo.min())))return e}return cq.newInvalidDocument(e)}}class fW extends f${constructor(e,t){super(),this.rs=e,this.trackRemovals=t,this.os=new hb(e=>e.toString(),(e,t)=>e.isEqual(t))}applyChanges(e){let t=[],n=0,r=new co((e,t)=>ur(e.canonicalString(),t.canonicalString()));return this.changes.forEach((i,s)=>{let o=this.os.get(i);if(t.push(this.rs.removeEntry(e,i,o.readTime)),s.isValidDocument()){let a=dG(this.rs.serializer,s);r=r.add(i.path.popLast());let l=fk(a);n+=l-o.size,t.push(this.rs.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){let n=dG(this.rs.serializer,s.convertToNoDocument(uo.min()));t.push(this.rs.addEntry(e,i,n))}}),r.forEach(n=>{t.push(this.rs.indexManager.addToCollectionParentIndex(e,n))}),t.push(this.rs.updateMetadata(e,n)),uE.waitFor(t)}getFromCache(e,t){return this.rs.ts(e,t).next(e=>(this.os.set(t,{size:e.size,readTime:e.document.readTime}),e.document))}getAllFromCache(e,t){return this.rs.ns(e,t).next(({documents:e,ss:t})=>(t.forEach((t,n)=>{this.os.set(t,{size:n,readTime:e.get(t).readTime})}),e))}}function fG(e){return u7(e,"remoteDocumentGlobal")}function fK(e){return u7(e,"remoteDocumentsV14")}function fZ(e){let t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function fQ(e,t){let n=t.documentKey.path.toArray();return[e,dK(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function fY(e,t){let n=e.path.toArray(),r=t.path.toArray(),i=0;for(let e=0;e<n.length-2&&e<r.length-2;++e)if(i=ur(n[e],r[e]))return i;return(i=ur(n.length,r.length))||(i=ur(n[n.length-2],r[r.length-2]))||ur(n[n.length-1],r[r.length-1])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fX{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fJ{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(r=>(n=r,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==n&&hQ(n.mutation,e,cu.empty(),us.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,hA()).next(()=>t))}getLocalViewOfDocuments(e,t,n=hA()){let r=hS();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,n).next(e=>{let t=hE();return e.forEach((e,n)=>{t=t.insert(e,n.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let n=hS();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,hA()))}populateOverlays(e,t,n){let r=[];return n.forEach(e=>{t.has(e)||r.push(e)}),this.documentOverlayCache.getOverlays(e,r).next(e=>{e.forEach((e,n)=>{t.set(e,n)})})}computeViews(e,t,n,r){let i=hI,s=hS(),o=hS();return t.forEach((e,t)=>{let o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof hJ)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),hQ(o.mutation,t,o.mutation.getFieldMask(),us.now())):s.set(t.key,cu.empty())}),this.recalculateAndSaveOverlays(e,i).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>{var n;return o.set(e,new fX(t,null!==(n=s.get(e))&&void 0!==n?n:null))}),o))}recalculateAndSaveOverlays(e,t){let n=hS(),r=new cr((e,t)=>e-t),i=hA();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let i of e)i.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let o=n.get(e)||cu.empty();o=i.applyToLocalView(s,o),n.set(e,o);let a=(r.get(i.batchId)||hA()).add(e);r=r.insert(i.batchId,a)})}).next(()=>{let s=[],o=r.getReverseIterator();for(;o.hasNext();){let r=o.getNext(),a=r.key,l=r.value,u=hS();l.forEach(e=>{if(!i.has(e)){let r=hZ(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return uE.waitFor(s)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,n){return uh.isDocumentKey(t.path)&&null===t.collectionGroup&&0===t.filters.length?this.getDocumentsMatchingDocumentQuery(e,t.path):hc(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n):this.getDocumentsMatchingCollectionQuery(e,t,n)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next(i=>{let s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):uE.resolve(hS()),o=-1,a=i;return s.next(t=>uE.forEach(t,(t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?uE.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{a=a.insert(t,e)}))).next(()=>this.populateOverlays(e,t,i)).next(()=>this.computeViews(e,a,t,hA())).next(e=>({batchId:o,changes:hC(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new uh(t)).next(e=>{let t=hE();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,n){let r=t.collectionGroup,i=hE();return this.indexManager.getCollectionParents(e,r).next(s=>uE.forEach(s,s=>{var o;let a=(o=s.child(r),new hs(o,null,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,t.endAt));return this.getDocumentsMatchingCollectionQuery(e,a,n).next(e=>{e.forEach((e,t)=>{i=i.insert(e,t)})})}).next(()=>i))}getDocumentsMatchingCollectionQuery(e,t,n){let r;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(i=>(r=i,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,r))).next(e=>{r.forEach((t,n)=>{let r=n.getKey();null===e.get(r)&&(e=e.insert(r,cq.newInvalidDocument(r)))});let n=hE();return e.forEach((e,i)=>{let s=r.get(e);void 0!==s&&hQ(s.mutation,i,cu.empty(),us.now()),hv(t,i)&&(n=n.insert(e,i))}),n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f0{constructor(e){this.serializer=e,this.us=new Map,this.cs=new Map}getBundleMetadata(e,t){return uE.resolve(this.us.get(t))}saveBundleMetadata(e,t){return this.us.set(t.id,{id:t.id,version:t.version,createTime:dS(t.createTime)}),uE.resolve()}getNamedQuery(e,t){return uE.resolve(this.cs.get(t))}saveNamedQuery(e,t){return this.cs.set(t.name,{name:t.name,query:d0(t.bundledQuery),readTime:dS(t.readTime)}),uE.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f1{constructor(){this.overlays=new cr(uh.comparator),this.hs=new Map}getOverlay(e,t){return uE.resolve(this.overlays.get(t))}getOverlays(e,t){let n=hS();return uE.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&n.set(t,e)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((n,r)=>{this.de(e,t,r)}),uE.resolve()}removeOverlaysForBatchId(e,t,n){let r=this.hs.get(n);return void 0!==r&&(r.forEach(e=>this.overlays=this.overlays.remove(e)),this.hs.delete(n)),uE.resolve()}getOverlaysForCollection(e,t,n){let r=hS(),i=t.length+1,s=new uh(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){let e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return uE.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new cr((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=hS(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let o=hS(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach((e,t)=>o.set(e,t)),!(o.size()>=r)););return uE.resolve(o)}de(e,t,n){let r=this.overlays.get(n.key);if(null!==r){let e=this.hs.get(r.largestBatchId).delete(n.key);this.hs.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new h3(t,n));let i=this.hs.get(t);void 0===i&&(i=hA(),this.hs.set(t,i)),this.hs.set(t,i.add(n.key))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f2{constructor(){this.ls=new co(f4.fs),this.ds=new co(f4._s)}isEmpty(){return this.ls.isEmpty()}addReference(e,t){let n=new f4(e,t);this.ls=this.ls.add(n),this.ds=this.ds.add(n)}ws(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.gs(new f4(e,t))}ys(e,t){e.forEach(e=>this.removeReference(e,t))}ps(e){let t=new uh(new ul([])),n=new f4(t,e),r=new f4(t,e+1),i=[];return this.ds.forEachInRange([n,r],e=>{this.gs(e),i.push(e.key)}),i}Is(){this.ls.forEach(e=>this.gs(e))}gs(e){this.ls=this.ls.delete(e),this.ds=this.ds.delete(e)}Ts(e){let t=new uh(new ul([])),n=new f4(t,e),r=new f4(t,e+1),i=hA();return this.ds.forEachInRange([n,r],e=>{i=i.add(e.key)}),i}containsKey(e){let t=new f4(e,0),n=this.ls.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class f4{constructor(e,t){this.key=e,this.Es=t}static fs(e,t){return uh.comparator(e.key,t.key)||ur(e.Es,t.Es)}static _s(e,t){return ur(e.Es,t.Es)||uh.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f9{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.As=1,this.Rs=new co(f4.fs)}checkEmpty(e){return uE.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){let i=this.As;this.As++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new h5(i,t,n,r);for(let t of(this.mutationQueue.push(s),r))this.Rs=this.Rs.add(new f4(t.key,i)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return uE.resolve(s)}lookupMutationBatch(e,t){return uE.resolve(this.vs(t))}getNextMutationBatchAfterBatchId(e,t){let n=this.Ps(t+1),r=n<0?0:n;return uE.resolve(this.mutationQueue.length>r?this.mutationQueue[r]:null)}getHighestUnacknowledgedBatchId(){return uE.resolve(0===this.mutationQueue.length?-1:this.As-1)}getAllMutationBatches(e){return uE.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let n=new f4(t,0),r=new f4(t,Number.POSITIVE_INFINITY),i=[];return this.Rs.forEachInRange([n,r],e=>{let t=this.vs(e.Es);i.push(t)}),uE.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new co(ur);return t.forEach(e=>{let t=new f4(e,0),r=new f4(e,Number.POSITIVE_INFINITY);this.Rs.forEachInRange([t,r],e=>{n=n.add(e.Es)})}),uE.resolve(this.bs(n))}getAllMutationBatchesAffectingQuery(e,t){let n=t.path,r=n.length+1,i=n;uh.isDocumentKey(i)||(i=i.child(""));let s=new f4(new uh(i),0),o=new co(ur);return this.Rs.forEachWhile(e=>{let t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Es)),!0)},s),uE.resolve(this.bs(o))}bs(e){let t=[];return e.forEach(e=>{let n=this.vs(e);null!==n&&t.push(n)}),t}removeMutationBatch(e,t){0===this.Vs(t.batchId,"removed")||l0(),this.mutationQueue.shift();let n=this.Rs;return uE.forEach(t.mutations,r=>{let i=new f4(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)}).next(()=>{this.Rs=n})}Dn(e){}containsKey(e,t){let n=new f4(t,0),r=this.Rs.firstAfterOrEqual(n);return uE.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,uE.resolve()}Vs(e,t){return this.Ps(e)}Ps(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}vs(e){let t=this.Ps(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f5{constructor(e){this.Ss=e,this.docs=new cr(uh.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Ss(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let n=this.docs.get(t);return uE.resolve(n?n.document.mutableCopy():cq.newInvalidDocument(t))}getEntries(e,t){let n=hI;return t.forEach(e=>{let t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():cq.newInvalidDocument(e))}),uE.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=hI,s=t.path,o=new uh(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){let{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||0>=uw(uv(o),n)||(r.has(o.key)||hv(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return uE.resolve(i)}getAllFromCollectionGroup(e,t,n,r){l0()}Ds(e,t){return uE.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new f6(this)}getSize(e){return uE.resolve(this.size)}}class f6 extends f${constructor(e){super(),this.rs=e}applyChanges(e){let t=[];return this.changes.forEach((n,r)=>{r.isValidDocument()?t.push(this.rs.addEntry(e,r)):this.rs.removeEntry(n)}),uE.waitFor(t)}getFromCache(e,t){return this.rs.getEntry(e,t)}getAllFromCache(e,t){return this.rs.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f3{constructor(e){this.persistence=e,this.Cs=new hb(e=>c7(e),he),this.lastRemoteSnapshotVersion=uo.min(),this.highestTargetId=0,this.xs=0,this.Ns=new f2,this.targetCount=0,this.ks=fD.Nn()}forEachTarget(e,t){return this.Cs.forEach((e,n)=>t(n)),uE.resolve()}getLastRemoteSnapshotVersion(e){return uE.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return uE.resolve(this.xs)}allocateTargetId(e){return this.highestTargetId=this.ks.next(),uE.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.xs&&(this.xs=t),uE.resolve()}$n(e){this.Cs.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.ks=new fD(t),this.highestTargetId=t),e.sequenceNumber>this.xs&&(this.xs=e.sequenceNumber)}addTargetData(e,t){return this.$n(t),this.targetCount+=1,uE.resolve()}updateTargetData(e,t){return this.$n(t),uE.resolve()}removeTargetData(e,t){return this.Cs.delete(t.target),this.Ns.ps(t.targetId),this.targetCount-=1,uE.resolve()}removeTargets(e,t,n){let r=0,i=[];return this.Cs.forEach((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Cs.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)}),uE.waitFor(i).next(()=>r)}getTargetCount(e){return uE.resolve(this.targetCount)}getTargetData(e,t){let n=this.Cs.get(t)||null;return uE.resolve(n)}addMatchingKeys(e,t,n){return this.Ns.ws(t,n),uE.resolve()}removeMatchingKeys(e,t,n){this.Ns.ys(t,n);let r=this.persistence.referenceDelegate,i=[];return r&&t.forEach(t=>{i.push(r.markPotentiallyOrphaned(e,t))}),uE.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Ns.ps(t),uE.resolve()}getMatchingKeysForTargetId(e,t){let n=this.Ns.Ts(t);return uE.resolve(n)}containsKey(e,t){return uE.resolve(this.Ns.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f8{constructor(e,t){var n;this.Ms={},this.overlays={},this.Os=new uL(0),this.$s=!1,this.$s=!0,this.referenceDelegate=e(this),this.Fs=new f3(this),this.indexManager=new fg,this.remoteDocumentCache=(n=e=>this.referenceDelegate.Bs(e),new f5(n)),this.serializer=new dW(t),this.Ls=new f0(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.$s=!1,Promise.resolve()}get started(){return this.$s}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new f1,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.Ms[e.toKey()];return n||(n=new f9(t,this.referenceDelegate),this.Ms[e.toKey()]=n),n}getTargetCache(){return this.Fs}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ls}runTransaction(e,t,n){lQ("MemoryPersistence","Starting transaction:",e);let r=new f7(this.Os.next());return this.referenceDelegate.qs(),n(r).next(e=>this.referenceDelegate.Us(r).next(()=>e)).toPromise().then(e=>(r.raiseOnCommittedEvent(),e))}Ks(e,t){return uE.or(Object.values(this.Ms).map(n=>()=>n.containsKey(e,t)))}}class f7 extends uI{constructor(e){super(),this.currentSequenceNumber=e}}class pe{constructor(e){this.persistence=e,this.Gs=new f2,this.Qs=null}static js(e){return new pe(e)}get zs(){if(this.Qs)return this.Qs;throw l0()}addReference(e,t,n){return this.Gs.addReference(n,t),this.zs.delete(n.toString()),uE.resolve()}removeReference(e,t,n){return this.Gs.removeReference(n,t),this.zs.add(n.toString()),uE.resolve()}markPotentiallyOrphaned(e,t){return this.zs.add(t.toString()),uE.resolve()}removeTarget(e,t){this.Gs.ps(t.targetId).forEach(e=>this.zs.add(e.toString()));let n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.zs.add(e.toString()))}).next(()=>n.removeTargetData(e,t))}qs(){this.Qs=new Set}Us(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return uE.forEach(this.zs,n=>{let r=uh.fromPath(n);return this.Ws(e,r).next(e=>{e||t.removeEntry(r,uo.min())})}).next(()=>(this.Qs=null,t.apply(e)))}updateLimboDocument(e,t){return this.Ws(e,t).next(e=>{e?this.zs.delete(t.toString()):this.zs.add(t.toString())})}Bs(e){return 0}Ws(e,t){return uE.or([()=>uE.resolve(this.Gs.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ks(e,t)])}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pt{constructor(e){this.serializer=e}$(e,t,n,r){let i=new uC("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uB,{unique:!0}),e.createObjectStore("documentMutations"),pn(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=uE.resolve();return n<3&&r>=3&&(0!==n&&(e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal"),pn(e)),s=s.next(()=>(function(e){let t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:uo.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)})(i))),n<4&&r>=4&&(0!==n&&(s=s.next(()=>i.store("mutations").j().next(t=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",uB,{unique:!0});let n=i.store("mutations"),r=t.map(e=>n.put(e));return uE.waitFor(r)}))),s=s.next(()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)})),n<5&&r>=5&&(s=s.next(()=>this.Js(i))),n<6&&r>=6&&(s=s.next(()=>((function(e){e.createObjectStore("remoteDocumentGlobal")})(e),this.Ys(i)))),n<7&&r>=7&&(s=s.next(()=>this.Xs(i))),n<8&&r>=8&&(s=s.next(()=>this.Zs(e,i))),n<9&&r>=9&&(s=s.next(()=>{e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")})),n<10&&r>=10&&(s=s.next(()=>this.ti(i))),n<11&&r>=11&&(s=s.next(()=>{(function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})})(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)})),n<12&&r>=12&&(s=s.next(()=>{!function(e){let t=e.createObjectStore("documentOverlays",{keyPath:u1});t.createIndex("collectionPathOverlayIndex",u2,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",u4,{unique:!1})}(e)})),n<13&&r>=13&&(s=s.next(()=>(function(e){let t=e.createObjectStore("remoteDocumentsV14",{keyPath:u$});t.createIndex("documentKeyIndex",uH),t.createIndex("collectionGroupIndex",uW)})(e)).next(()=>this.ei(e,i)).next(()=>e.deleteObjectStore("remoteDocuments"))),n<14&&r>=14&&(s=s.next(()=>this.ni(e,i))),n<15&&r>=15&&(s=s.next(()=>{e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:uY}).createIndex("sequenceNumberIndex",uX,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:uJ}).createIndex("documentKeyIndex",u0,{unique:!1})})),s}Ys(e){let t=0;return e.store("remoteDocuments").X((e,n)=>{t+=fk(n)}).next(()=>{let n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)})}Js(e){let t=e.store("mutationQueues"),n=e.store("mutations");return t.j().next(t=>uE.forEach(t,t=>{let r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.j("userMutationsIndex",r).next(n=>uE.forEach(n,n=>{n.userId===t.userId||l0();let r=dY(this.serializer,n);return fS(e,t.userId,r).next(()=>{})}))}))}Xs(e){let t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next(e=>{let r=[];return n.X((n,i)=>{let s=new ul(n),o=[0,uq(s)];r.push(t.get(o).next(n=>n?uE.resolve():t.put({targetId:0,path:uq(s),sequenceNumber:e.highestListenSequenceNumber})))}).next(()=>uE.waitFor(r))})}Zs(e,t){e.createObjectStore("collectionParents",{keyPath:uQ});let n=t.store("collectionParents"),r=new fm,i=e=>{if(r.add(e)){let t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:uq(r)})}};return t.store("remoteDocuments").X({Y:!0},(e,t)=>{let n=new ul(e);return i(n.popLast())}).next(()=>t.store("documentMutations").X({Y:!0},([e,t,n],r)=>{let s=uj(t);return i(s.popLast())}))}ti(e){let t=e.store("targets");return t.X((e,n)=>{let r=dX(n),i=dJ(this.serializer,r);return t.put(i)})}ei(e,t){let n=t.store("remoteDocuments"),r=[];return n.X((e,n)=>{let i=t.store("remoteDocumentsV14"),s=(n.document?new uh(ul.fromString(n.document.name).popFirst(5)):n.noDocument?uh.fromSegments(n.noDocument.path):n.unknownDocument?uh.fromSegments(n.unknownDocument.path):l0()).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))}).next(()=>uE.waitFor(r))}ni(e,t){var n;let r=t.store("mutations"),i=(n=this.serializer,new fH(n)),s=new f8(pe.js,this.serializer.le);return r.j().next(e=>{let n=new Map;return e.forEach(e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:hA();dY(this.serializer,e).keys().forEach(e=>r=r.add(e)),n.set(e.userId,r)}),uE.forEach(n,(e,n)=>{let r=new lW(n),o=d3.fe(this.serializer,r),a=s.getIndexManager(r),l=fx.fe(r,this.serializer,a,s.referenceDelegate);return new fJ(i,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new u8(t,uL.ct),e).next()})})}}function pn(e){e.createObjectStore("targetDocuments",{keyPath:uK}).createIndex("documentTargetsIndex",uZ,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",uG,{unique:!0}),e.createObjectStore("targetGlobal")}let pr="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class pi{constructor(e,t,n,r,i,s,o,a,l,u,c=15){var h;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.si=i,this.window=s,this.document=o,this.ii=l,this.ri=u,this.oi=c,this.Os=null,this.$s=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ui=null,this.inForeground=!1,this.ci=null,this.ai=null,this.hi=Number.NEGATIVE_INFINITY,this.li=e=>Promise.resolve(),!pi.D())throw new l2(l1.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new fB(this,r),this.fi=t+"main",this.serializer=new dW(a),this.di=new uS(this.fi,this.oi,new pt(this.serializer)),this.Fs=new fO(this.referenceDelegate,this.serializer),this.remoteDocumentCache=(h=this.serializer,new fH(h)),this.Ls=new d9,this.window&&this.window.localStorage?this._i=this.window.localStorage:(this._i=null,!1===u&&lY("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.wi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new l2(l1.FAILED_PRECONDITION,pr);return this.mi(),this.gi(),this.yi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Fs.getHighestSequenceNumber(e))}).then(e=>{this.Os=new uL(e,this.ii)}).then(()=>{this.$s=!0}).catch(e=>(this.di&&this.di.close(),Promise.reject(e)))}pi(e){return this.li=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.di.B(async t=>{null===t.newVersion&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.si.enqueueAndForget(async()=>{this.started&&await this.wi()}))}wi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>po(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Ii(e).next(e=>{e||(this.isPrimary=!1,this.si.enqueueRetryable(()=>this.li(!1)))})}).next(()=>this.Ti(e)).next(t=>this.isPrimary&&!t?this.Ei(e).next(()=>!1):!!t&&this.Ai(e).next(()=>!0))).catch(e=>{if(uA(e))return lQ("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return lQ("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.si.enqueueRetryable(()=>this.li(e)),this.isPrimary=e})}Ii(e){return ps(e).get("owner").next(e=>uE.resolve(this.Ri(e)))}vi(e){return po(e).delete(this.clientId)}async Pi(){if(this.isPrimary&&!this.bi(this.hi,18e5)){this.hi=Date.now();let e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let t=u7(e,"clientMetadata");return t.j().next(e=>{let n=this.Vi(e,18e5),r=e.filter(e=>-1===n.indexOf(e));return uE.forEach(r,e=>t.delete(e.clientId)).next(()=>r)})}).catch(()=>[]);if(this._i)for(let t of e)this._i.removeItem(this.Si(t.clientId))}}yi(){this.ai=this.si.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.wi().then(()=>this.Pi()).then(()=>this.yi()))}Ri(e){return!!e&&e.ownerId===this.clientId}Ti(e){return this.ri?uE.resolve(!0):ps(e).get("owner").next(t=>{if(null!==t&&this.bi(t.leaseTimestampMs,5e3)&&!this.Di(t.ownerId)){if(this.Ri(t)&&this.networkEnabled)return!0;if(!this.Ri(t)){if(!t.allowTabSynchronization)throw new l2(l1.FAILED_PRECONDITION,pr);return!1}}return!(!this.networkEnabled||!this.inForeground)||po(e).j().next(e=>void 0===this.Vi(e,5e3).find(e=>{if(this.clientId!==e.clientId){let t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))}).next(e=>(this.isPrimary!==e&&lQ("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}async shutdown(){this.$s=!1,this.Ci(),this.ai&&(this.ai.cancel(),this.ai=null),this.xi(),this.Ni(),await this.di.runTransaction("shutdown","readwrite",["owner","clientMetadata"],e=>{let t=new u8(e,uL.ct);return this.Ei(t).next(()=>this.vi(t))}),this.di.close(),this.ki()}Vi(e,t){return e.filter(e=>this.bi(e.updateTimeMs,t)&&!this.Di(e.clientId))}Mi(){return this.runTransaction("getActiveClients","readonly",e=>po(e).j().next(e=>this.Vi(e,18e5).map(e=>e.clientId)))}get started(){return this.$s}getMutationQueue(e,t){return fx.fe(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Fs}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new fv(e,this.serializer.le.databaseId)}getDocumentOverlayCache(e){return d3.fe(this.serializer,e)}getBundleCache(){return this.Ls}runTransaction(e,t,n){var r;let i;lQ("IndexedDbPersistence","Starting transaction:",e);let s=15===(r=this.oi)?u3:14===r?u6:13===r?u6:12===r?u5:11===r?u9:void l0();return this.di.runTransaction(e,"readonly"===t?"readonly":"readwrite",s,r=>(i=new u8(r,this.Os?this.Os.next():uL.ct),"readwrite-primary"===t?this.Ii(i).next(e=>!!e||this.Ti(i)).next(t=>{if(!t)throw lY(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.si.enqueueRetryable(()=>this.li(!1)),new l2(l1.FAILED_PRECONDITION,ub);return n(i)}).next(e=>this.Ai(i).next(()=>e)):this.Oi(i).next(()=>n(i)))).then(e=>(i.raiseOnCommittedEvent(),e))}Oi(e){return ps(e).get("owner").next(e=>{if(null!==e&&this.bi(e.leaseTimestampMs,5e3)&&!this.Di(e.ownerId)&&!this.Ri(e)&&!(this.ri||this.allowTabSynchronization&&e.allowTabSynchronization))throw new l2(l1.FAILED_PRECONDITION,pr)})}Ai(e){let t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return ps(e).put("owner",t)}static D(){return uS.D()}Ei(e){let t=ps(e);return t.get("owner").next(e=>this.Ri(e)?(lQ("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):uE.resolve())}bi(e,t){let n=Date.now();return!(e<n-t)&&(!(e>n)||(lY(`Detected an update time that is in the future: ${e} > ${n}`),!1))}mi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.ci=()=>{this.si.enqueueAndForget(()=>(this.inForeground="visible"===this.document.visibilityState,this.wi()))},this.document.addEventListener("visibilitychange",this.ci),this.inForeground="visible"===this.document.visibilityState)}xi(){this.ci&&(this.document.removeEventListener("visibilitychange",this.ci),this.ci=null)}gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.ui=()=>{this.Ci();let e=/(?:Version|Mobile)\/1[456]/;(0,b.G6)()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.si.enterRestrictedMode(!0),this.si.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.ui))}Ni(){this.ui&&(this.window.removeEventListener("pagehide",this.ui),this.ui=null)}Di(e){var t;try{let n=null!==(null===(t=this._i)||void 0===t?void 0:t.getItem(this.Si(e)));return lQ("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return lY("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Ci(){if(this._i)try{this._i.setItem(this.Si(this.clientId),String(Date.now()))}catch(e){lY("Failed to set zombie client id.",e)}}ki(){if(this._i)try{this._i.removeItem(this.Si(this.clientId))}catch(e){}}Si(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function ps(e){return u7(e,"owner")}function po(e){return u7(e,"clientMetadata")}function pa(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pl{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Fi=r}static Bi(e,t){let n=hA(),r=hA();for(let e of t.docChanges)switch(e.type){case 0:n=n.add(e.doc.key);break;case 1:r=r.add(e.doc.key)}return new pl(e,t.fromCache,n,r)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(){this.Li=!1}initialize(e,t){this.qi=e,this.indexManager=t,this.Li=!0}getDocumentsMatchingQuery(e,t,n,r){return this.Ui(e,t).next(i=>i||this.Ki(e,t,r,n)).next(n=>n||this.Gi(e,t))}Ui(e,t){if(ha(t))return uE.resolve(null);let n=hd(t);return this.indexManager.getIndexType(e,n).next(r=>0===r?null:(null!==t.limit&&1===r&&(n=hd(t=hp(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,n).next(r=>{let i=hA(...r);return this.qi.getDocuments(e,i).next(r=>this.indexManager.getMinOffset(e,n).next(n=>{let s=this.Qi(t,r);return this.ji(t,s,i,n.readTime)?this.Ui(e,hp(t,null,"F")):this.zi(e,s,t,n)}))})))}Ki(e,t,n,r){return ha(t)||r.isEqual(uo.min())?this.Gi(e,t):this.qi.getDocuments(e,n).next(i=>{let s=this.Qi(t,i);return this.ji(t,s,n,r)?this.Gi(e,t):(lZ()<=E.in.DEBUG&&lQ("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),hy(t)),this.zi(e,s,t,uy(r,-1)))})}Qi(e,t){let n=new co(hw(e));return t.forEach((t,r)=>{hv(e,r)&&(n=n.add(r))}),n}ji(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;let i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Gi(e,t){return lZ()<=E.in.DEBUG&&lQ("QueryEngine","Using full collection scan to execute query:",hy(t)),this.qi.getDocumentsMatchingQuery(e,t,u_.min())}zi(e,t,n,r){return this.qi.getDocumentsMatchingQuery(e,n,r).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pc{constructor(e,t,n,r){this.persistence=e,this.Wi=t,this.serializer=r,this.Hi=new cr(ur),this.Ji=new hb(e=>c7(e),he),this.Yi=new Map,this.Xi=e.getRemoteDocumentCache(),this.Fs=e.getTargetCache(),this.Ls=e.getBundleCache(),this.Zi(n)}Zi(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new fJ(this.Xi,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Xi.setIndexManager(this.indexManager),this.Wi.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.Hi))}}async function ph(e,t){return await e.persistence.runTransaction("Handle user change","readonly",n=>{let r;return e.mutationQueue.getAllMutationBatches(n).next(i=>(r=i,e.Zi(t),e.mutationQueue.getAllMutationBatches(n))).next(t=>{let i=[],s=[],o=hA();for(let e of r)for(let t of(i.push(e.batchId),e.mutations))o=o.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))o=o.add(t.key);return e.localDocuments.getDocuments(n,o).next(e=>({tr:e,removedBatchIds:i,addedBatchIds:s}))})})}function pd(e){return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Fs.getLastRemoteSnapshotVersion(t))}function pf(e,t,n){let r=hA(),i=hA();return n.forEach(e=>r=r.add(e)),t.getEntries(e,r).next(e=>{let r=hI;return n.forEach((n,s)=>{let o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(uo.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):lQ("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)}),{er:r,nr:i}})}function pp(e,t){let n=e;return n.persistence.runTransaction("Allocate target","readwrite",e=>{let r;return n.Fs.getTargetData(e,t).next(i=>i?(r=i,uE.resolve(r)):n.Fs.allocateTargetId(e).next(i=>(r=new dH(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Fs.addTargetData(e,r).next(()=>r))))}).then(e=>{let r=n.Hi.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Hi=n.Hi.insert(e.targetId,e),n.Ji.set(t,e.targetId)),e})}async function pg(e,t,n){let r=e,i=r.Hi.get(t);try{n||await r.persistence.runTransaction("Release target",n?"readwrite":"readwrite-primary",e=>r.persistence.referenceDelegate.removeTarget(e,i))}catch(e){if(!uA(e))throw e;lQ("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.Hi=r.Hi.remove(t),r.Ji.delete(i.target)}function pm(e,t,n){let r=uo.min(),i=hA();return e.persistence.runTransaction("Execute query","readonly",s=>(function(e,t,n){let r=e.Ji.get(n);return void 0!==r?uE.resolve(e.Hi.get(r)):e.Fs.getTargetData(t,n)})(e,s,hd(t)).next(t=>{if(t)return r=t.lastLimboFreeSnapshotVersion,e.Fs.getMatchingKeysForTargetId(s,t.targetId).next(e=>{i=e})}).next(()=>e.Wi.getDocumentsMatchingQuery(s,t,n?r:uo.min(),n?i:hA())).next(n=>(p_(e,h_(t),n),{documents:n,sr:i})))}function py(e,t){let n=e.Fs,r=e.Hi.get(t);return r?Promise.resolve(r.target):e.persistence.runTransaction("Get target data","readonly",e=>n.he(e,t).next(e=>e?e.target:null))}function pv(e,t){let n=e.Yi.get(t)||uo.min();return e.persistence.runTransaction("Get new document changes","readonly",r=>e.Xi.getAllFromCollectionGroup(r,t,uy(n,-1),Number.MAX_SAFE_INTEGER)).then(n=>(p_(e,t,n),n))}function p_(e,t,n){let r=e.Yi.get(t)||uo.min();n.forEach((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)}),e.Yi.set(t,r)}async function pw(e,t,n,r){let i=hA(),s=hI;for(let e of n){let n=t.ir(e.metadata.name);e.document&&(i=i.add(n));let r=t.rr(e);r.setReadTime(t.ur(e.metadata.readTime)),s=s.insert(n,r)}let o=e.Xi.newChangeBuffer({trackRemovals:!0}),a=await pp(e,hd(ho(ul.fromString(`__bundle__/docs/${r}`))));return e.persistence.runTransaction("Apply bundle documents","readwrite",t=>pf(t,o,s).next(e=>(o.apply(t),e)).next(n=>e.Fs.removeMatchingKeysForTargetId(t,a.targetId).next(()=>e.Fs.addMatchingKeys(t,i,a.targetId)).next(()=>e.localDocuments.getLocalViewOfDocuments(t,n.er,n.nr)).next(()=>n.er)))}async function pb(e,t,n=hA()){let r=await pp(e,hd(d0(t.bundledQuery))),i=e;return i.persistence.runTransaction("Save named query","readwrite",e=>{let s=dS(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Ls.saveNamedQuery(e,t);let o=r.withResumeToken(ch.EMPTY_BYTE_STRING,s);return i.Hi=i.Hi.insert(o.targetId,o),i.Fs.updateTargetData(e,o).next(()=>i.Fs.removeMatchingKeysForTargetId(e,r.targetId)).next(()=>i.Fs.addMatchingKeys(e,n,r.targetId)).next(()=>i.Ls.saveNamedQuery(e,t))})}function pI(e,t){return`firestore_clients_${e}_${t}`}function pT(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function pE(e,t){return`firestore_targets_${e}_${t}`}class pC{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static cr(e,t,n){let r=JSON.parse(n),i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code)&&(i=new l2(r.error.code,r.error.message)),s?new pC(e,t,r.state,i):(lY("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}ar(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pS{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static cr(e,t){let n=JSON.parse(t),r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code)&&(r=new l2(n.error.code,n.error.message)),i?new pS(e,n.state,r):(lY("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}ar(){let e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class pk{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static cr(e,t){let n=JSON.parse(t),r="object"==typeof n&&n.activeTargetIds instanceof Array,i=hR;for(let e=0;r&&e<n.activeTargetIds.length;++e)r=uV(n.activeTargetIds[e]),i=i.add(n.activeTargetIds[e]);return r?new pk(e,i):(lY("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class px{constructor(e,t){this.clientId=e,this.onlineState=t}static cr(e){let t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new px(t.clientId,t.onlineState):(lY("SharedClientState",`Failed to parse online state: ${e}`),null)}}class pA{constructor(){this.activeTargetIds=hR}hr(e){this.activeTargetIds=this.activeTargetIds.add(e)}lr(e){this.activeTargetIds=this.activeTargetIds.delete(e)}ar(){let e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class pR{constructor(e,t,n,r,i){this.window=e,this.si=t,this.persistenceKey=n,this.dr=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this._r=this.wr.bind(this),this.mr=new cr(ur),this.started=!1,this.gr=[];let s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.yr=pI(this.persistenceKey,this.dr),this.pr=`firestore_sequence_number_${this.persistenceKey}`,this.mr=this.mr.insert(this.dr,new pA),this.Ir=RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Tr=RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Er=RegExp(`^firestore_targets_${s}_(\\d+)$`),this.Ar=`firestore_online_state_${this.persistenceKey}`,this.Rr=`firestore_bundle_loaded_v2_${this.persistenceKey}`,this.window.addEventListener("storage",this._r)}static D(e){return!(!e||!e.localStorage)}async start(){let e=await this.syncEngine.Mi();for(let t of e){if(t===this.dr)continue;let e=this.getItem(pI(this.persistenceKey,t));if(e){let n=pk.cr(t,e);n&&(this.mr=this.mr.insert(n.clientId,n))}}this.vr();let t=this.storage.getItem(this.Ar);if(t){let e=this.Pr(t);e&&this.br(e)}for(let e of this.gr)this.wr(e);this.gr=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.pr,JSON.stringify(e))}getAllActiveQueryTargets(){return this.Vr(this.mr)}isActiveQueryTarget(e){let t=!1;return this.mr.forEach((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Sr(e,"pending")}updateMutationState(e,t,n){this.Sr(e,t,n),this.Dr(e)}addLocalQueryTarget(e){let t="not-current";if(this.isActiveQueryTarget(e)){let n=this.storage.getItem(pE(this.persistenceKey,e));if(n){let r=pS.cr(e,n);r&&(t=r.state)}}return this.Cr.hr(e),this.vr(),t}removeLocalQueryTarget(e){this.Cr.lr(e),this.vr()}isLocalQueryTarget(e){return this.Cr.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(pE(this.persistenceKey,e))}updateQueryState(e,t,n){this.Nr(e,t,n)}handleUserChange(e,t,n){t.forEach(e=>{this.Dr(e)}),this.currentUser=e,n.forEach(e=>{this.addPendingMutation(e)})}setOnlineState(e){this.kr(e)}notifyBundleLoaded(e){this.Mr(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this._r),this.removeItem(this.yr),this.started=!1)}getItem(e){let t=this.storage.getItem(e);return lQ("SharedClientState","READ",e,t),t}setItem(e,t){lQ("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){lQ("SharedClientState","REMOVE",e),this.storage.removeItem(e)}wr(e){if(e.storageArea===this.storage){if(lQ("SharedClientState","EVENT",e.key,e.newValue),e.key===this.yr)return void lY("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.si.enqueueRetryable(async()=>{if(this.started){if(null!==e.key){if(this.Ir.test(e.key)){if(null==e.newValue){let t=this.Or(e.key);return this.$r(t,null)}{let t=this.Fr(e.key,e.newValue);if(t)return this.$r(t.clientId,t)}}else if(this.Tr.test(e.key)){if(null!==e.newValue){let t=this.Br(e.key,e.newValue);if(t)return this.Lr(t)}}else if(this.Er.test(e.key)){if(null!==e.newValue){let t=this.qr(e.key,e.newValue);if(t)return this.Ur(t)}}else if(e.key===this.Ar){if(null!==e.newValue){let t=this.Pr(e.newValue);if(t)return this.br(t)}}else if(e.key===this.pr){let t=function(e){let t=uL.ct;if(null!=e)try{let n=JSON.parse(e);"number"==typeof n||l0(),t=n}catch(e){lY("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(e.newValue);t!==uL.ct&&this.sequenceNumberHandler(t)}else if(e.key===this.Rr){let t=this.Kr(e.newValue);await Promise.all(t.map(e=>this.syncEngine.Gr(e)))}}}else this.gr.push(e)})}}get Cr(){return this.mr.get(this.dr)}vr(){this.setItem(this.yr,this.Cr.ar())}Sr(e,t,n){let r=new pC(this.currentUser,e,t,n),i=pT(this.persistenceKey,this.currentUser,e);this.setItem(i,r.ar())}Dr(e){let t=pT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}kr(e){let t={clientId:this.dr,onlineState:e};this.storage.setItem(this.Ar,JSON.stringify(t))}Nr(e,t,n){let r=pE(this.persistenceKey,e),i=new pS(e,t,n);this.setItem(r,i.ar())}Mr(e){let t=JSON.stringify(Array.from(e));this.setItem(this.Rr,t)}Or(e){let t=this.Ir.exec(e);return t?t[1]:null}Fr(e,t){let n=this.Or(e);return pk.cr(n,t)}Br(e,t){let n=this.Tr.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return pC.cr(new lW(i),r,t)}qr(e,t){let n=this.Er.exec(e),r=Number(n[1]);return pS.cr(r,t)}Pr(e){return px.cr(e)}Kr(e){return JSON.parse(e)}async Lr(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Qr(e.batchId,e.state,e.error);lQ("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Ur(e){return this.syncEngine.jr(e.targetId,e.state,e.error)}$r(e,t){let n=t?this.mr.insert(e,t):this.mr.remove(e),r=this.Vr(this.mr),i=this.Vr(n),s=[],o=[];return i.forEach(e=>{r.has(e)||s.push(e)}),r.forEach(e=>{i.has(e)||o.push(e)}),this.syncEngine.zr(s,o).then(()=>{this.mr=n})}br(e){this.mr.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}Vr(e){let t=hR;return e.forEach((e,n)=>{t=t.unionWith(n.activeTargetIds)}),t}}class pN{constructor(){this.Wr=new pA,this.Hr={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return this.Wr.hr(e),this.Hr[e]||"not-current"}updateQueryState(e,t,n){this.Hr[e]=t}removeLocalQueryTarget(e){this.Wr.lr(e)}isLocalQueryTarget(e){return this.Wr.activeTargetIds.has(e)}clearQueryState(e){delete this.Hr[e]}getAllActiveQueryTargets(){return this.Wr.activeTargetIds}isActiveQueryTarget(e){return this.Wr.activeTargetIds.has(e)}start(){return this.Wr=new pA,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{Jr(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pD{constructor(){this.Yr=()=>this.Xr(),this.Zr=()=>this.eo(),this.no=[],this.so()}Jr(e){this.no.push(e)}shutdown(){window.removeEventListener("online",this.Yr),window.removeEventListener("offline",this.Zr)}so(){window.addEventListener("online",this.Yr),window.addEventListener("offline",this.Zr)}Xr(){for(let e of(lQ("ConnectivityMonitor","Network connectivity changed: AVAILABLE"),this.no))e(0)}eo(){for(let e of(lQ("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE"),this.no))e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pO=null;function pF(){return null===pO?pO=268435456+Math.round(2147483648*Math.random()):pO++,"0x"+pO.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pM{constructor(e){this.io=e.io,this.ro=e.ro}oo(e){this.uo=e}co(e){this.ao=e}onMessage(e){this.ho=e}close(){this.ro()}send(e){this.io(e)}lo(){this.uo()}fo(e){this.ao(e)}_o(e){this.ho(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pU="WebChannelConnection";class pV extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let t=e.ssl?"https":"http";this.wo=t+"://"+e.host,this.mo="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}get yo(){return!1}po(e,t,n,r,i){let s=pF(),o=this.Io(e,t);lQ("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);let a={};return this.To(a,r,i),this.Eo(e,o,a,n).then(t=>(lQ("RestConnection",`Received RPC '${e}' ${s}: `,t),t),t=>{throw lX("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t})}Ao(e,t,n,r,i,s){return this.po(e,t,n,r,i)}To(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+lG,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((t,n)=>e[n]=t),n&&n.headers.forEach((t,n)=>e[n]=t)}Io(e,t){let n=pL[e];return`${this.wo}/v1/${t}:${n}`}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams}Eo(e,t,n,r){let i=pF();return new Promise((s,o)=>{let a=new lj;a.setWithCredentials(!0),a.listenOnce(lL.COMPLETE,()=>{try{switch(a.getLastErrorCode()){case lF.NO_ERROR:let t=a.getResponseJson();lQ(pU,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case lF.TIMEOUT:lQ(pU,`RPC '${e}' ${i} timed out`),o(new l2(l1.DEADLINE_EXCEEDED,"Request time out"));break;case lF.HTTP_ERROR:let n=a.getStatus();if(lQ(pU,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);let t=null==e?void 0:e.error;if(t&&t.status&&t.message){let e=function(e){let t=e.toLowerCase().replace(/_/g,"-");return Object.values(l1).indexOf(t)>=0?t:l1.UNKNOWN}(t.status);o(new l2(e,t.message))}else o(new l2(l1.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new l2(l1.UNAVAILABLE,"Connection failed."));break;default:l0()}}finally{lQ(pU,`RPC '${e}' ${i} completed.`)}});let l=JSON.stringify(r);lQ(pU,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)})}Ro(e,t,n){let r=pF(),i=[this.wo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=lD(),o=lO(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(a.xmlHttpFactory=new lV({})),this.To(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;let l=i.join("");lQ(pU,`Creating RPC '${e}' stream ${r}: ${l}`,a);let u=s.createWebChannel(l,a),c=!1,h=!1,d=new pM({io:t=>{h?lQ(pU,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(c||(lQ(pU,`Opening RPC '${e}' stream ${r} transport.`),u.open(),c=!0),lQ(pU,`RPC '${e}' stream ${r} sending:`,t),u.send(t))},ro:()=>u.close()}),f=(e,t,n)=>{e.listen(t,e=>{try{n(e)}catch(e){setTimeout(()=>{throw e},0)}})};return f(u,lq.EventType.OPEN,()=>{h||lQ(pU,`RPC '${e}' stream ${r} transport opened.`)}),f(u,lq.EventType.CLOSE,()=>{h||(h=!0,lQ(pU,`RPC '${e}' stream ${r} transport closed`),d.fo())}),f(u,lq.EventType.ERROR,t=>{h||(h=!0,lX(pU,`RPC '${e}' stream ${r} transport errored:`,t),d.fo(new l2(l1.UNAVAILABLE,"The operation could not be completed")))}),f(u,lq.EventType.MESSAGE,t=>{var n;if(!h){let i=t.data[0];i||l0();let s=i.error||(null===(n=i[0])||void 0===n?void 0:n.error);if(s){lQ(pU,`RPC '${e}' stream ${r} received error:`,s);let t=s.status,n=function(e){let t=_[e];if(void 0!==t)return de(t)}(t),i=s.message;void 0===n&&(n=l1.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),h=!0,d.fo(new l2(n,i)),u.close()}else lQ(pU,`RPC '${e}' stream ${r} received:`,i),d._o(i)}}),f(o,lM.STAT_EVENT,t=>{t.stat===lU.PROXY?lQ(pU,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===lU.NOPROXY&&lQ(pU,`RPC '${e}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{d.lo()},0),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pq(){return"undefined"!=typeof window?window:null}function pj(){return"undefined"!=typeof document?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pB(e){return new dI(e,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pz{constructor(e,t,n=1e3,r=1.5,i=6e4){this.si=e,this.timerId=t,this.vo=n,this.Po=r,this.bo=i,this.Vo=0,this.So=null,this.Do=Date.now(),this.reset()}reset(){this.Vo=0}Co(){this.Vo=this.bo}xo(e){this.cancel();let t=Math.floor(this.Vo+this.No()),n=Math.max(0,Date.now()-this.Do),r=Math.max(0,t-n);r>0&&lQ("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Vo} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.So=this.si.enqueueAfterDelay(this.timerId,r,()=>(this.Do=Date.now(),e())),this.Vo*=this.Po,this.Vo<this.vo&&(this.Vo=this.vo),this.Vo>this.bo&&(this.Vo=this.bo)}ko(){null!==this.So&&(this.So.skipDelay(),this.So=null)}cancel(){null!==this.So&&(this.So.cancel(),this.So=null)}No(){return(Math.random()-.5)*this.Vo}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p${constructor(e,t,n,r,i,s,o,a){this.si=e,this.Mo=n,this.Oo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.$o=0,this.Fo=null,this.Bo=null,this.stream=null,this.Lo=new pz(e,t)}qo(){return 1===this.state||5===this.state||this.Uo()}Uo(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.Ko()}async stop(){this.qo()&&await this.close(0)}Go(){this.state=0,this.Lo.reset()}Qo(){this.Uo()&&null===this.Fo&&(this.Fo=this.si.enqueueAfterDelay(this.Mo,6e4,()=>this.jo()))}zo(e){this.Wo(),this.stream.send(e)}async jo(){if(this.Uo())return this.close(0)}Wo(){this.Fo&&(this.Fo.cancel(),this.Fo=null)}Ho(){this.Bo&&(this.Bo.cancel(),this.Bo=null)}async close(e,t){this.Wo(),this.Ho(),this.Lo.cancel(),this.$o++,4!==e?this.Lo.reset():t&&t.code===l1.RESOURCE_EXHAUSTED?(lY(t.toString()),lY("Using maximum backoff delay to prevent overloading the backend."),this.Lo.Co()):t&&t.code===l1.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Jo(),this.stream.close(),this.stream=null),this.state=e,await this.listener.co(t)}Jo(){}auth(){this.state=1;let e=this.Yo(this.$o),t=this.$o;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,n])=>{this.$o===t&&this.Xo(e,n)},t=>{e(()=>{let e=new l2(l1.UNKNOWN,"Fetching auth token failed: "+t.message);return this.Zo(e)})})}Xo(e,t){let n=this.Yo(this.$o);this.stream=this.tu(e,t),this.stream.oo(()=>{n(()=>(this.state=2,this.Bo=this.si.enqueueAfterDelay(this.Oo,1e4,()=>(this.Uo()&&(this.state=3),Promise.resolve())),this.listener.oo()))}),this.stream.co(e=>{n(()=>this.Zo(e))}),this.stream.onMessage(e=>{n(()=>this.onMessage(e))})}Ko(){this.state=5,this.Lo.xo(async()=>{this.state=0,this.start()})}Zo(e){return lQ("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}Yo(e){return t=>{this.si.enqueueAndForget(()=>this.$o===e?t():(lQ("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class pH extends p${constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}tu(e,t){return this.connection.Ro("Listen",e,t)}onMessage(e){this.Lo.reset();let t=function(e,t){let n;if("targetChange"in t){var r,i;t.targetChange;let s="NO_CHANGE"===(r=t.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===r?1:"REMOVE"===r?2:"CURRENT"===r?3:"RESET"===r?4:l0(),o=t.targetChange.targetIds||[],a=(i=t.targetChange.resumeToken,e.useProto3Json?(void 0===i||"string"==typeof i||l0(),ch.fromBase64String(i||"")):(void 0===i||i instanceof Uint8Array||l0(),ch.fromUint8Array(i||new Uint8Array))),l=t.targetChange.cause,u=l&&function(e){let t=void 0===e.code?l1.UNKNOWN:de(e.code);return new l2(t,e.message||"")}(l);n=new dp(s,o,a,u||null)}else if("documentChange"in t){t.documentChange;let r=t.documentChange;r.document,r.document.name,r.document.updateTime;let i=dR(e,r.document.name),s=dS(r.document.updateTime),o=r.document.createTime?dS(r.document.createTime):uo.min(),a=new cV({mapValue:{fields:r.document.fields}}),l=cq.newFoundDocument(i,s,o,a),u=r.targetIds||[],c=r.removedTargetIds||[];n=new dd(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;let r=t.documentDelete;r.document;let i=dR(e,r.document),s=r.readTime?dS(r.readTime):uo.min(),o=cq.newNoDocument(i,s),a=r.removedTargetIds||[];n=new dd([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;let r=t.documentRemove;r.document;let i=dR(e,r.document),s=r.removedTargetIds||[];n=new dd([],s,i,null)}else{if(!("filter"in t))return l0();{t.filter;let e=t.filter;e.targetId;let{count:r=0,unchangedNames:i}=e,s=new h8(r,i),o=e.targetId;n=new df(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return uo.min();let t=e.targetChange;return t.targetIds&&t.targetIds.length?uo.min():t.readTime?dS(t.readTime):uo.min()}(e);return this.listener.eu(t,n)}nu(e){let t={};t.database=dD(this.serializer),t.addTarget=function(e,t){let n;let r=t.target;if((n=ht(r)?{documents:dV(e,r)}:{query:dq(e,r)}).targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=dC(e,t.resumeToken);let r=dT(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(uo.min())>0){n.readTime=dE(e,t.snapshotVersion.toTimestamp());let r=dT(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);let n=function(e,t){let n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return l0()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.zo(t)}su(e){let t={};t.database=dD(this.serializer),t.removeTarget=e,this.zo(t)}}class pW extends p${constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i,this.iu=!1}get ru(){return this.iu}start(){this.iu=!1,this.lastStreamToken=void 0,super.start()}Jo(){this.iu&&this.ou([])}tu(e,t){return this.connection.Ro("Write",e,t)}onMessage(e){var t,n;if(e.streamToken||l0(),this.lastStreamToken=e.streamToken,this.iu){this.Lo.reset();let r=(t=e.writeResults,n=e.commitTime,t&&t.length>0?(void 0!==n||l0(),t.map(e=>{let t;return(t=e.updateTime?dS(e.updateTime):dS(n)).isEqual(uo.min())&&(t=dS(n)),new hH(t,e.transformResults||[])})):[]),i=dS(e.commitTime);return this.listener.uu(i,r)}return e.writeResults&&0!==e.writeResults.length&&l0(),this.iu=!0,this.listener.cu()}au(){let e={};e.database=dD(this.serializer),this.zo(e)}ou(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>dM(this.serializer,e))};this.zo(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pG extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.hu=!1}lu(){if(this.hu)throw new l2(l1.FAILED_PRECONDITION,"The client has already been terminated.")}po(e,t,n){return this.lu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([r,i])=>this.connection.po(e,t,n,r,i)).catch(e=>{throw"FirebaseError"===e.name?(e.code===l1.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new l2(l1.UNKNOWN,e.toString())})}Ao(e,t,n,r){return this.lu(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,s])=>this.connection.Ao(e,t,n,i,s,r)).catch(e=>{throw"FirebaseError"===e.name?(e.code===l1.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new l2(l1.UNKNOWN,e.toString())})}terminate(){this.hu=!0}}class pK{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.du=0,this._u=null,this.wu=!0}mu(){0===this.du&&(this.gu("Unknown"),this._u=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this._u=null,this.yu("Backend didn't respond within 10 seconds."),this.gu("Offline"),Promise.resolve())))}pu(e){"Online"===this.state?this.gu("Unknown"):(this.du++,this.du>=1&&(this.Iu(),this.yu(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.gu("Offline")))}set(e){this.Iu(),this.du=0,"Online"===e&&(this.wu=!1),this.gu(e)}gu(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}yu(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.wu?(lY(t),this.wu=!1):lQ("OnlineStateTracker",t)}Iu(){null!==this._u&&(this._u.cancel(),this._u=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pZ{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Tu=[],this.Eu=new Map,this.Au=new Set,this.Ru=[],this.vu=i,this.vu.Jr(e=>{n.enqueueAndForget(async()=>{p9(this)&&(lQ("RemoteStore","Restarting streams for network reachability change."),await async function(e){e.Au.add(4),await pY(e),e.Pu.set("Unknown"),e.Au.delete(4),await pQ(e)}(this))})}),this.Pu=new pK(n,r)}}async function pQ(e){if(p9(e))for(let t of e.Ru)await t(!0)}async function pY(e){for(let t of e.Ru)await t(!1)}function pX(e,t){e.Eu.has(t.targetId)||(e.Eu.set(t.targetId,t),p4(e)?p2(e):gu(e).Uo()&&p0(e,t))}function pJ(e,t){let n=gu(e);e.Eu.delete(t),n.Uo()&&p1(e,t),0===e.Eu.size&&(n.Uo()?n.Qo():p9(e)&&e.Pu.set("Unknown"))}function p0(e,t){if(e.bu.Lt(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(uo.min())>0){let n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}gu(e).nu(t)}function p1(e,t){e.bu.Lt(t),gu(e).su(t)}function p2(e){e.bu=new dm({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),he:t=>e.Eu.get(t)||null,oe:()=>e.datastore.serializer.databaseId}),gu(e).start(),e.Pu.mu()}function p4(e){return p9(e)&&!gu(e).qo()&&e.Eu.size>0}function p9(e){return 0===e.Au.size}async function p5(e){e.Eu.forEach((t,n)=>{p0(e,t)})}async function p6(e,t){e.bu=void 0,p4(e)?(e.Pu.pu(t),p2(e)):e.Pu.set("Unknown")}async function p3(e,t,n){if(e.Pu.set("Online"),t instanceof dp&&2===t.state&&t.cause)try{await async function(e,t){let n=t.cause;for(let r of t.targetIds)e.Eu.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Eu.delete(r),e.bu.removeTarget(r))}(e,t)}catch(n){lQ("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await p8(e,n)}else if(t instanceof dd?e.bu.Wt(t):t instanceof df?e.bu.ee(t):e.bu.Yt(t),!n.isEqual(uo.min()))try{let t=await pd(e.localStore);n.compareTo(t)>=0&&await function(e,t){let n=e.bu.ue(t);return n.targetChanges.forEach((n,r)=>{if(n.resumeToken.approximateByteSize()>0){let i=e.Eu.get(r);i&&e.Eu.set(r,i.withResumeToken(n.resumeToken,t))}}),n.targetMismatches.forEach((t,n)=>{let r=e.Eu.get(t);if(!r)return;e.Eu.set(t,r.withResumeToken(ch.EMPTY_BYTE_STRING,r.snapshotVersion)),p1(e,t);let i=new dH(r.target,t,n,r.sequenceNumber);p0(e,i)}),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){lQ("RemoteStore","Failed to raise snapshot:",t),await p8(e,t)}}async function p8(e,t,n){if(!uA(t))throw t;e.Au.add(1),await pY(e),e.Pu.set("Offline"),n||(n=()=>pd(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{lQ("RemoteStore","Retrying IndexedDB access"),await n(),e.Au.delete(1),await pQ(e)})}function p7(e,t){return t().catch(n=>p8(e,n,t))}async function ge(e){let t=gc(e),n=e.Tu.length>0?e.Tu[e.Tu.length-1].batchId:-1;for(;p9(e)&&e.Tu.length<10;)try{let r=await function(e,t){return e.persistence.runTransaction("Get next mutation batch","readonly",n=>(void 0===t&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)))}(e.localStore,n);if(null===r){0===e.Tu.length&&t.Qo();break}n=r.batchId,function(e,t){e.Tu.push(t);let n=gc(e);n.Uo()&&n.ru&&n.ou(t.mutations)}(e,r)}catch(t){await p8(e,t)}gt(e)&&gn(e)}function gt(e){return p9(e)&&!gc(e).qo()&&e.Tu.length>0}function gn(e){gc(e).start()}async function gr(e){gc(e).au()}async function gi(e){let t=gc(e);for(let n of e.Tu)t.ou(n.mutations)}async function gs(e,t,n){let r=e.Tu.shift(),i=h6.from(r,t,n);await p7(e,()=>e.remoteSyncer.applySuccessfulWrite(i)),await ge(e)}async function go(e,t){t&&gc(e).ru&&await async function(e,t){var n;if(h7(n=t.code)&&n!==l1.ABORTED){let n=e.Tu.shift();gc(e).Go(),await p7(e,()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t)),await ge(e)}}(e,t),gt(e)&&gn(e)}async function ga(e,t){e.asyncQueue.verifyOperationInProgress(),lQ("RemoteStore","RemoteStore received new credentials");let n=p9(e);e.Au.add(3),await pY(e),n&&e.Pu.set("Unknown"),await e.remoteSyncer.handleCredentialChange(t),e.Au.delete(3),await pQ(e)}async function gl(e,t){t?(e.Au.delete(2),await pQ(e)):t||(e.Au.add(2),await pY(e),e.Pu.set("Unknown"))}function gu(e){var t,n,r;return e.Vu||(e.Vu=(t=e.datastore,n=e.asyncQueue,r={oo:p5.bind(null,e),co:p6.bind(null,e),eu:p3.bind(null,e)},t.lu(),new pH(n,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,r)),e.Ru.push(async t=>{t?(e.Vu.Go(),p4(e)?p2(e):e.Pu.set("Unknown")):(await e.Vu.stop(),e.bu=void 0)})),e.Vu}function gc(e){var t,n,r;return e.Su||(e.Su=(t=e.datastore,n=e.asyncQueue,r={oo:gr.bind(null,e),co:go.bind(null,e),cu:gi.bind(null,e),uu:gs.bind(null,e)},t.lu(),new pW(n,t.connection,t.authCredentials,t.appCheckCredentials,t.serializer,r)),e.Ru.push(async t=>{t?(e.Su.Go(),await ge(e)):(await e.Su.stop(),e.Tu.length>0&&(lQ("RemoteStore",`Stopping write stream with ${e.Tu.length} pending writes`),e.Tu=[]))})),e.Su}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gh{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new l4,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}static createAndSchedule(e,t,n,r,i){let s=Date.now()+n,o=new gh(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new l2(l1.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function gd(e,t){if(lY("AsyncQueue",`${t}: ${e}`),uA(e))return new l2(l1.UNAVAILABLE,`${t}: ${e}`);throw e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gf{constructor(e){this.comparator=e?(t,n)=>e(t,n)||uh.comparator(t.key,n.key):(e,t)=>uh.comparator(e.key,t.key),this.keyedMap=hE(),this.sortedSet=new cr(this.comparator)}static emptySet(e){return new gf(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){let t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){let t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){let t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gf)||this.size!==e.size)return!1;let t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){let e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){let e=[];return this.forEach(t=>{e.push(t.toString())}),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){let n=new gf;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gp{constructor(){this.Du=new cr(uh.comparator)}track(e){let t=e.doc.key,n=this.Du.get(t);n?0!==e.type&&3===n.type?this.Du=this.Du.insert(t,e):3===e.type&&1!==n.type?this.Du=this.Du.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.Du=this.Du.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.Du=this.Du.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.Du=this.Du.remove(t):1===e.type&&2===n.type?this.Du=this.Du.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.Du=this.Du.insert(t,{type:2,doc:e.doc}):l0():this.Du=this.Du.insert(t,e)}Cu(){let e=[];return this.Du.inorderTraversal((t,n)=>{e.push(n)}),e}}class gg{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){let s=[];return t.forEach(e=>{s.push({type:0,doc:e})}),new gg(e,t,gf.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&hg(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;let t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let e=0;e<t.length;e++)if(t[e].type!==n[e].type||!t[e].doc.isEqual(n[e].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gm{constructor(){this.xu=void 0,this.listeners=[]}}class gy{constructor(){this.queries=new hb(e=>hm(e),hg),this.onlineState="Unknown",this.Nu=new Set}}async function gv(e,t){let n=t.query,r=!1,i=e.queries.get(n);if(i||(r=!0,i=new gm),r)try{i.xu=await e.onListen(n)}catch(n){let e=gd(n,`Initialization of query '${hy(t.query)}' failed`);return void t.onError(e)}e.queries.set(n,i),i.listeners.push(t),t.ku(e.onlineState),i.xu&&t.Mu(i.xu)&&gI(e)}async function g_(e,t){let n=t.query,r=!1,i=e.queries.get(n);if(i){let e=i.listeners.indexOf(t);e>=0&&(i.listeners.splice(e,1),r=0===i.listeners.length)}if(r)return e.queries.delete(n),e.onUnlisten(n)}function gw(e,t){let n=!1;for(let r of t){let t=r.query,i=e.queries.get(t);if(i){for(let e of i.listeners)e.Mu(r)&&(n=!0);i.xu=r}}n&&gI(e)}function gb(e,t,n){let r=e.queries.get(t);if(r)for(let e of r.listeners)e.onError(n);e.queries.delete(t)}function gI(e){e.Nu.forEach(e=>{e.next()})}class gT{constructor(e,t,n){this.query=e,this.Ou=t,this.$u=!1,this.Fu=null,this.onlineState="Unknown",this.options=n||{}}Mu(e){if(!this.options.includeMetadataChanges){let t=[];for(let n of e.docChanges)3!==n.type&&t.push(n);e=new gg(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.$u?this.Bu(e)&&(this.Ou.next(e),t=!0):this.Lu(e,this.onlineState)&&(this.qu(e),t=!0),this.Fu=e,t}onError(e){this.Ou.error(e)}ku(e){this.onlineState=e;let t=!1;return this.Fu&&!this.$u&&this.Lu(this.Fu,e)&&(this.qu(this.Fu),t=!0),t}Lu(e,t){return!e.fromCache||(!this.options.Uu||!("Offline"!==t))&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Bu(e){if(e.docChanges.length>0)return!0;let t=this.Fu&&this.Fu.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}qu(e){e=gg.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.$u=!0,this.Ou.next(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gE{constructor(e,t){this.Ku=e,this.byteLength=t}Gu(){return"metadata"in this.Ku}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e){this.serializer=e}ir(e){return dR(this.serializer,e)}rr(e){return e.metadata.exists?dL(this.serializer,e.document,!1):cq.newNoDocument(this.ir(e.metadata.name),this.ur(e.metadata.readTime))}ur(e){return dS(e)}}class gS{constructor(e,t,n){this.Qu=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=gk(e)}ju(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.Ku.namedQuery)this.queries.push(e.Ku.namedQuery);else if(e.Ku.documentMetadata){this.documents.push({metadata:e.Ku.documentMetadata}),e.Ku.documentMetadata.exists||++t;let n=ul.fromString(e.Ku.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.Ku.document&&(this.documents[this.documents.length-1].document=e.Ku.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}zu(e){let t=new Map,n=new gC(this.serializer);for(let r of e)if(r.metadata.queries){let e=n.ir(r.metadata.name);for(let n of r.metadata.queries){let r=(t.get(n)||hA()).add(e);t.set(n,r)}}return t}async complete(){let e=await pw(this.localStore,new gC(this.serializer),this.documents,this.Qu.id),t=this.zu(this.documents);for(let e of this.queries)await pb(this.localStore,e,t.get(e.name));return this.progress.taskState="Success",{progress:this.progress,Wu:this.collectionGroups,Hu:e}}}function gk(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gx{constructor(e){this.key=e}}class gA{constructor(e){this.key=e}}class gR{constructor(e,t){this.query=e,this.Ju=t,this.Yu=null,this.hasCachedResults=!1,this.current=!1,this.Xu=hA(),this.mutatedKeys=hA(),this.Zu=hw(e),this.tc=new gf(this.Zu)}get ec(){return this.Ju}nc(e,t){let n=t?t.sc:new gp,r=t?t.tc:this.tc,i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1,a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal((e,t)=>{let u=r.get(e),c=hv(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations),f=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(n.track({type:3,doc:c}),f=!0):this.ic(u,c)||(n.track({type:2,doc:c}),f=!0,(a&&this.Zu(c,a)>0||l&&0>this.Zu(c,l))&&(o=!0)):!u&&c?(n.track({type:0,doc:c}),f=!0):u&&!c&&(n.track({type:1,doc:u}),f=!0,(a||l)&&(o=!0)),f&&(c?(s=s.add(c),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))}),null!==this.query.limit)for(;s.size>this.query.limit;){let e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tc:s,sc:n,ji:o,mutatedKeys:i}}ic(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n){let r=this.tc;this.tc=e.tc,this.mutatedKeys=e.mutatedKeys;let i=e.sc.Cu();i.sort((e,t)=>(function(e,t){let n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return l0()}};return n(e)-n(t)})(e.type,t.type)||this.Zu(e.doc,t.doc)),this.rc(n);let s=t?this.oc():[],o=0===this.Xu.size&&this.current?1:0,a=o!==this.Yu;return(this.Yu=o,0!==i.length||a)?{snapshot:new gg(this.query,e.tc,r,i,e.mutatedKeys,0===o,a,!1,!!n&&n.resumeToken.approximateByteSize()>0),uc:s}:{uc:s}}ku(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tc:this.tc,sc:new gp,mutatedKeys:this.mutatedKeys,ji:!1},!1)):{uc:[]}}cc(e){return!this.Ju.has(e)&&!!this.tc.has(e)&&!this.tc.get(e).hasLocalMutations}rc(e){e&&(e.addedDocuments.forEach(e=>this.Ju=this.Ju.add(e)),e.modifiedDocuments.forEach(e=>{}),e.removedDocuments.forEach(e=>this.Ju=this.Ju.delete(e)),this.current=e.current)}oc(){if(!this.current)return[];let e=this.Xu;this.Xu=hA(),this.tc.forEach(e=>{this.cc(e.key)&&(this.Xu=this.Xu.add(e.key))});let t=[];return e.forEach(e=>{this.Xu.has(e)||t.push(new gA(e))}),this.Xu.forEach(n=>{e.has(n)||t.push(new gx(n))}),t}ac(e){this.Ju=e.sr,this.Xu=hA();let t=this.nc(e.documents);return this.applyChanges(t,!0)}hc(){return gg.fromInitialDocuments(this.query,this.tc,this.mutatedKeys,0===this.Yu,this.hasCachedResults)}}class gN{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class gP{constructor(e){this.key=e,this.lc=!1}}class gD{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.fc={},this.dc=new hb(e=>hm(e),hg),this._c=new Map,this.wc=new Set,this.mc=new cr(uh.comparator),this.gc=new Map,this.yc=new f2,this.Ic={},this.Tc=new Map,this.Ec=fD.kn(),this.onlineState="Unknown",this.Ac=void 0}get isPrimaryClient(){return!0===this.Ac}}async function gO(e,t){let n,r;let i=g8(e),s=i.dc.get(t);if(s)n=s.targetId,i.sharedClientState.addLocalQueryTarget(n),r=s.view.hc();else{let e=await pp(i.localStore,hd(t)),s=i.sharedClientState.addLocalQueryTarget(e.targetId);n=e.targetId,r=await gF(i,t,n,"current"===s,e.resumeToken),i.isPrimaryClient&&pX(i.remoteStore,e)}return r}async function gF(e,t,n,r,i){e.Rc=(t,n,r)=>(async function(e,t,n,r){let i=t.view.nc(n);i.ji&&(i=await pm(e.localStore,t.query,!1).then(({documents:e})=>t.view.nc(e,i)));let s=r&&r.targetChanges.get(t.targetId),o=t.view.applyChanges(i,e.isPrimaryClient,s);return gK(e,t.targetId,o.uc),o.snapshot})(e,t,n,r);let s=await pm(e.localStore,t,!0),o=new gR(t,s.sr),a=o.nc(s.documents),l=dh.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,l);gK(e,n,u.uc);let c=new gN(t,n,o);return e.dc.set(t,c),e._c.has(n)?e._c.get(n).push(t):e._c.set(n,[t]),u.snapshot}async function gL(e,t){let n=e.dc.get(t),r=e._c.get(n.targetId);if(r.length>1)return e._c.set(n.targetId,r.filter(e=>!hg(e,t))),void e.dc.delete(t);e.isPrimaryClient?(e.sharedClientState.removeLocalQueryTarget(n.targetId),e.sharedClientState.isActiveQueryTarget(n.targetId)||await pg(e.localStore,n.targetId,!1).then(()=>{e.sharedClientState.clearQueryState(n.targetId),pJ(e.remoteStore,n.targetId),gW(e,n.targetId)}).catch(uT)):(gW(e,n.targetId),await pg(e.localStore,n.targetId,!0))}async function gM(e,t,n){let r=g7(e);try{var i,s;let e;let o=await function(e,t){let n,r;let i=us.now(),s=t.reduce((e,t)=>e.add(t.key),hA());return e.persistence.runTransaction("Locally write mutations","readwrite",o=>{let a=hI,l=hA();return e.Xi.getEntries(o,s).next(e=>{(a=e).forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>e.localDocuments.getOverlayedDocuments(o,a)).next(r=>{n=r;let s=[];for(let e of t){let t=function(e,t){let n=null;for(let r of e.fieldTransforms){let e=t.data.field(r.field),i=hF(r.transform,e||null);null!=i&&(null===n&&(n=cV.empty()),n.set(r.field,i))}return n||null}(e,n.get(e.key).overlayedDocument);null!=t&&s.push(new hJ(e.key,t,function e(t){let n=[];return ct(t.fields,(t,r)=>{let i=new uc([t]);if(cO(r)){let t=e(r.mapValue).fields;if(0===t.length)n.push(i);else for(let e of t)n.push(i.child(e))}else n.push(i)}),new cu(n)}(t.value.mapValue),hW.exists(!0)))}return e.mutationQueue.addMutationBatch(o,i,s,t)}).next(t=>{r=t;let i=t.applyToLocalDocumentSet(n,l);return e.documentOverlayCache.saveOverlays(o,t.batchId,i)})}).then(()=>({batchId:r.batchId,changes:hC(n)}))}(r.localStore,t);r.sharedClientState.addPendingMutation(o.batchId),i=r,s=o.batchId,(e=i.Ic[i.currentUser.toKey()])||(e=new cr(ur)),e=e.insert(s,n),i.Ic[i.currentUser.toKey()]=e,await gQ(r,o.changes),await ge(r.remoteStore)}catch(t){let e=gd(t,"Failed to persist write");n.reject(e)}}async function gU(e,t){try{let n=await function(e,t){let n=e,r=t.snapshotVersion,i=n.Hi;return n.persistence.runTransaction("Apply remote event","readwrite-primary",e=>{let s=n.Xi.newChangeBuffer({trackRemovals:!0});i=n.Hi;let o=[];t.targetChanges.forEach((s,a)=>{var l;let u=i.get(a);if(!u)return;o.push(n.Fs.removeMatchingKeys(e,s.removedDocuments,a).next(()=>n.Fs.addMatchingKeys(e,s.addedDocuments,a)));let c=u.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?c=c.withResumeToken(ch.EMPTY_BYTE_STRING,uo.min()).withLastLimboFreeSnapshotVersion(uo.min()):s.resumeToken.approximateByteSize()>0&&(c=c.withResumeToken(s.resumeToken,r)),i=i.insert(a,c),l=c,(0===u.resumeToken.approximateByteSize()||l.snapshotVersion.toMicroseconds()-u.snapshotVersion.toMicroseconds()>=3e8||s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size>0)&&o.push(n.Fs.updateTargetData(e,c))});let a=hI,l=hA();if(t.documentUpdates.forEach(r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))}),o.push(pf(e,s,t.documentUpdates).next(e=>{a=e.er,l=e.nr})),!r.isEqual(uo.min())){let t=n.Fs.getLastRemoteSnapshotVersion(e).next(t=>n.Fs.setTargetsMetadata(e,e.currentSequenceNumber,r));o.push(t)}return uE.waitFor(o).next(()=>s.apply(e)).next(()=>n.localDocuments.getLocalViewOfDocuments(e,a,l)).next(()=>a)}).then(e=>(n.Hi=i,e))}(e.localStore,t);t.targetChanges.forEach((t,n)=>{let r=e.gc.get(n);r&&(t.addedDocuments.size+t.modifiedDocuments.size+t.removedDocuments.size<=1||l0(),t.addedDocuments.size>0?r.lc=!0:t.modifiedDocuments.size>0?r.lc||l0():t.removedDocuments.size>0&&(r.lc||l0(),r.lc=!1))}),await gQ(e,n,t)}catch(e){await uT(e)}}function gV(e,t,n){let r=e;if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){let e=[];r.dc.forEach((n,r)=>{let i=r.view.ku(t);i.snapshot&&e.push(i.snapshot)}),function(e,t){let n=e;n.onlineState=t;let r=!1;n.queries.forEach((e,n)=>{for(let e of n.listeners)e.ku(t)&&(r=!0)}),r&&gI(n)}(r.eventManager,t),e.length&&r.fc.eu(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function gq(e,t,n){let r=e;r.sharedClientState.updateQueryState(t,"rejected",n);let i=r.gc.get(t),s=i&&i.key;if(s){let e=new cr(uh.comparator);e=e.insert(s,cq.newNoDocument(s,uo.min()));let n=hA().add(s),i=new dc(uo.min(),new Map,new cr(ur),e,n);await gU(r,i),r.mc=r.mc.remove(s),r.gc.delete(t),gZ(r)}else await pg(r.localStore,t,!1).then(()=>gW(r,t,n)).catch(uT)}async function gj(e,t){var n;let r=t.batch.batchId;try{let i=await (n=e.localStore).persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let r=t.batch.keys(),i=n.Xi.newChangeBuffer({trackRemovals:!0});return(function(e,t,n,r){let i=n.batch,s=i.keys(),o=uE.resolve();return s.forEach(e=>{o=o.next(()=>r.getEntry(t,e)).next(t=>{let s=n.docVersions.get(e);null!==s||l0(),0>t.version.compareTo(s)&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))})}),o.next(()=>e.mutationQueue.removeMutationBatch(t,i))})(n,e,t,i).next(()=>i.apply(e)).next(()=>n.mutationQueue.performConsistencyCheck(e)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=hA();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t))).next(()=>n.localDocuments.getDocuments(e,r))});gH(e,r,null),g$(e,r),e.sharedClientState.updateMutationState(r,"acknowledged"),await gQ(e,i)}catch(e){await uT(e)}}async function gB(e,t,n){var r;try{let i=await (r=e.localStore).persistence.runTransaction("Reject batch","readwrite-primary",e=>{let n;return r.mutationQueue.lookupMutationBatch(e,t).next(t=>(null!==t||l0(),n=t.keys(),r.mutationQueue.removeMutationBatch(e,t))).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,n,t)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,n)).next(()=>r.localDocuments.getDocuments(e,n))});gH(e,t,n),g$(e,t),e.sharedClientState.updateMutationState(t,"rejected",n),await gQ(e,i)}catch(e){await uT(e)}}async function gz(e,t){var n;p9(e.remoteStore)||lQ("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let r=await (n=e.localStore).persistence.runTransaction("Get highest unacknowledged batch id","readonly",e=>n.mutationQueue.getHighestUnacknowledgedBatchId(e));if(-1===r)return void t.resolve();let i=e.Tc.get(r)||[];i.push(t),e.Tc.set(r,i)}catch(n){let e=gd(n,"Initialization of waitForPendingWrites() operation failed");t.reject(e)}}function g$(e,t){(e.Tc.get(t)||[]).forEach(e=>{e.resolve()}),e.Tc.delete(t)}function gH(e,t,n){let r=e,i=r.Ic[r.currentUser.toKey()];if(i){let e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ic[r.currentUser.toKey()]=i}}function gW(e,t,n=null){for(let r of(e.sharedClientState.removeLocalQueryTarget(t),e._c.get(t)))e.dc.delete(r),n&&e.fc.vc(r,n);e._c.delete(t),e.isPrimaryClient&&e.yc.ps(t).forEach(t=>{e.yc.containsKey(t)||gG(e,t)})}function gG(e,t){e.wc.delete(t.path.canonicalString());let n=e.mc.get(t);null!==n&&(pJ(e.remoteStore,n),e.mc=e.mc.remove(t),e.gc.delete(n),gZ(e))}function gK(e,t,n){for(let r of n)r instanceof gx?(e.yc.addReference(r.key,t),function(e,t){let n=t.key,r=n.path.canonicalString();e.mc.get(n)||e.wc.has(r)||(lQ("SyncEngine","New document in limbo: "+n),e.wc.add(r),gZ(e))}(e,r)):r instanceof gA?(lQ("SyncEngine","Document no longer in limbo: "+r.key),e.yc.removeReference(r.key,t),e.yc.containsKey(r.key)||gG(e,r.key)):l0()}function gZ(e){for(;e.wc.size>0&&e.mc.size<e.maxConcurrentLimboResolutions;){let t=e.wc.values().next().value;e.wc.delete(t);let n=new uh(ul.fromString(t)),r=e.Ec.next();e.gc.set(r,new gP(n)),e.mc=e.mc.insert(n,r),pX(e.remoteStore,new dH(hd(ho(n.path)),r,"TargetPurposeLimboResolution",uL.ct))}}async function gQ(e,t,n){let r=[],i=[],s=[];e.dc.isEmpty()||(e.dc.forEach((o,a)=>{s.push(e.Rc(a,t,n).then(t=>{if((t||n)&&e.isPrimaryClient&&e.sharedClientState.updateQueryState(a.targetId,(null==t?void 0:t.fromCache)?"not-current":"current"),t){r.push(t);let e=pl.Bi(a.targetId,t);i.push(e)}}))}),await Promise.all(s),e.fc.eu(r),await async function(e,t){let n=e;try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>uE.forEach(t,t=>uE.forEach(t.$i,r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r)).next(()=>uE.forEach(t.Fi,r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))}catch(e){if(!uA(e))throw e;lQ("LocalStore","Failed to update sequence numbers: "+e)}for(let e of t){let t=e.targetId;if(!e.fromCache){let e=n.Hi.get(t),r=e.snapshotVersion,i=e.withLastLimboFreeSnapshotVersion(r);n.Hi=n.Hi.insert(t,i)}}}(e.localStore,i))}async function gY(e,t){let n=e;if(!n.currentUser.isEqual(t)){lQ("SyncEngine","User change. New user:",t.toKey());let e=await ph(n.localStore,t);n.currentUser=t,n.Tc.forEach(e=>{e.forEach(e=>{e.reject(new l2(l1.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),n.Tc.clear(),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await gQ(n,e.tr)}}function gX(e,t){let n=e.gc.get(t);if(n&&n.lc)return hA().add(n.key);{let n=hA(),r=e._c.get(t);if(!r)return n;for(let t of r){let r=e.dc.get(t);n=n.unionWith(r.view.ec)}return n}}async function gJ(e,t){let n=await pm(e.localStore,t.query,!0),r=t.view.ac(n);return e.isPrimaryClient&&gK(e,t.targetId,r.uc),r}async function g0(e,t){return pv(e.localStore,t).then(t=>gQ(e,t))}async function g1(e,t,n,r){let i=await function(e,t){let n=e.mutationQueue;return e.persistence.runTransaction("Lookup mutation documents","readonly",r=>n.Vn(r,t).next(t=>t?e.localDocuments.getDocuments(r,t):uE.resolve(null)))}(e.localStore,t);null!==i?("pending"===n?await ge(e.remoteStore):"acknowledged"===n||"rejected"===n?(gH(e,t,r||null),g$(e,t),function(e,t){e.mutationQueue.Dn(t)}(e.localStore,t)):l0(),await gQ(e,i)):lQ("SyncEngine","Cannot apply mutation batch with id: "+t)}async function g2(e,t){let n=e;if(g8(n),g7(n),!0===t&&!0!==n.Ac){let e=n.sharedClientState.getAllActiveQueryTargets(),t=await g4(n,e.toArray());for(let e of(n.Ac=!0,await gl(n.remoteStore,!0),t))pX(n.remoteStore,e)}else if(!1===t&&!1!==n.Ac){let e=[],t=Promise.resolve();n._c.forEach((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then(()=>(gW(n,i),pg(n.localStore,i,!0))),pJ(n.remoteStore,i)}),await t,await g4(n,e),function(e){let t=e;t.gc.forEach((e,n)=>{pJ(t.remoteStore,n)}),t.yc.Is(),t.gc=new Map,t.mc=new cr(uh.comparator)}(n),n.Ac=!1,await gl(n.remoteStore,!1)}}async function g4(e,t,n){let r=[],i=[];for(let n of t){let t;let s=e._c.get(n);if(s&&0!==s.length)for(let n of(t=await pp(e.localStore,hd(s[0])),s)){let t=e.dc.get(n),r=await gJ(e,t);r.snapshot&&i.push(r.snapshot)}else{let r=await py(e.localStore,n);t=await pp(e.localStore,r),await gF(e,g9(r),n,!1,t.resumeToken)}r.push(t)}return e.fc.eu(i),r}function g9(e){var t,n,r,i,s,o,a;return t=e.path,n=e.collectionGroup,r=e.orderBy,i=e.filters,s=e.limit,o=e.startAt,a=e.endAt,new hs(t,n,r,i,s,"F",o,a)}function g5(e){return e.localStore.persistence.Mi()}async function g6(e,t,n,r){if(e.Ac)return void lQ("SyncEngine","Ignoring unexpected query state notification.");let i=e._c.get(t);if(i&&i.length>0)switch(n){case"current":case"not-current":{let r=await pv(e.localStore,h_(i[0])),s=dc.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,ch.EMPTY_BYTE_STRING);await gQ(e,r,s);break}case"rejected":await pg(e.localStore,t,!0),gW(e,t,r);break;default:l0()}}async function g3(e,t,n){let r=g8(e);if(r.Ac){for(let e of t){if(r._c.has(e)){lQ("SyncEngine","Adding an already active target "+e);continue}let t=await py(r.localStore,e),n=await pp(r.localStore,t);await gF(r,g9(t),n.targetId,!1,n.resumeToken),pX(r.remoteStore,n)}for(let e of n)r._c.has(e)&&await pg(r.localStore,e,!1).then(()=>{pJ(r.remoteStore,e),gW(r,e)}).catch(uT)}}function g8(e){let t=e;return t.remoteStore.remoteSyncer.applyRemoteEvent=gU.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=gX.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=gq.bind(null,t),t.fc.eu=gw.bind(null,t.eventManager),t.fc.vc=gb.bind(null,t.eventManager),t}function g7(e){let t=e;return t.remoteStore.remoteSyncer.applySuccessfulWrite=gj.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=gB.bind(null,t),t}class me{constructor(){this.synchronizeTabs=!1}async initialize(e){this.serializer=pB(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){var t,n,r,i;return t=this.persistence,n=new pu,r=e.initialUser,i=this.serializer,new pc(t,n,r,i)}createPersistence(e){return new f8(pe.js,this.serializer)}createSharedClientState(e){return new pN}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class mt extends me{constructor(e,t,n){super(),this.bc=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.bc.initialize(this,e),await g7(this.bc.syncEngine),await ge(this.bc.remoteStore),await this.persistence.pi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}createLocalStore(e){var t,n,r,i;return t=this.persistence,n=new pu,r=e.initialUser,i=this.serializer,new pc(t,n,r,i)}createGarbageCollectionScheduler(e,t){let n=this.persistence.referenceDelegate.garbageCollector;return new fq(n,e.asyncQueue,t)}createIndexBackfillerScheduler(e,t){let n=new uF(t,this.persistence);return new uO(e.asyncQueue,n)}createPersistence(e){let t=pa(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?fC.withCacheSize(this.cacheSizeBytes):fC.DEFAULT;return new pi(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,pq(),pj(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(e){return new pN}}class mn extends mt{constructor(e,t){super(e,t,!1),this.bc=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);let t=this.bc.syncEngine;this.sharedClientState instanceof pR&&(this.sharedClientState.syncEngine={Qr:g1.bind(null,t),jr:g6.bind(null,t),zr:g3.bind(null,t),Mi:g5.bind(null,t),Gr:g0.bind(null,t)},await this.sharedClientState.start()),await this.persistence.pi(async e=>{await g2(this.bc.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())})}createSharedClientState(e){let t=pq();if(!pR.D(t))throw new l2(l1.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let n=pa(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new pR(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class mr{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>gV(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=gY.bind(null,this.syncEngine),await gl(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new gy}createDatastore(e){var t,n,r;let i=pB(e.databaseInfo.databaseId),s=(t=e.databaseInfo,new pV(t));return n=e.authCredentials,r=e.appCheckCredentials,new pG(n,r,s,i)}createRemoteStore(e){var t,n,r,i,s;return t=this.localStore,n=this.datastore,r=e.asyncQueue,i=e=>gV(this.syncEngine,e,0),s=pD.D()?new pD:new pP,new pZ(t,n,r,i,s)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){let a=new gD(e,t,n,r,i,s);return o&&(a.Ac=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}terminate(){return async function(e){lQ("RemoteStore","RemoteStore shutting down."),e.Au.add(5),await pY(e),e.vu.shutdown(),e.Pu.set("Unknown")}(this.remoteStore)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mi(e,t=10240){let n=0;return{async read(){if(n<e.byteLength){let r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ms{constructor(e){this.observer=e,this.muted=!1}next(e){this.observer.next&&this.Vc(this.observer.next,e)}error(e){this.observer.error?this.Vc(this.observer.error,e):lY("Uncaught Error in snapshot listener:",e.toString())}Sc(){this.muted=!0}Vc(e,t){this.muted||setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mo{constructor(e,t){this.Dc=e,this.serializer=t,this.metadata=new l4,this.buffer=new Uint8Array,this.Cc=new TextDecoder("utf-8"),this.xc().then(e=>{e&&e.Gu()?this.metadata.resolve(e.Ku.metadata):this.metadata.reject(Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(null==e?void 0:e.Ku)}`))},e=>this.metadata.reject(e))}close(){return this.Dc.cancel()}async getMetadata(){return this.metadata.promise}async Pc(){return await this.getMetadata(),this.xc()}async xc(){let e=await this.Nc();if(null===e)return null;let t=this.Cc.decode(e),n=Number(t);isNaN(n)&&this.kc(`length string (${t}) is not valid number`);let r=await this.Mc(n);return new gE(JSON.parse(r),e.length+n)}Oc(){return this.buffer.findIndex(e=>123===e)}async Nc(){for(;0>this.Oc()&&!await this.$c(););if(0===this.buffer.length)return null;let e=this.Oc();e<0&&this.kc("Reached the end of bundle when a length string is expected.");let t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async Mc(e){for(;this.buffer.length<e;)await this.$c()&&this.kc("Reached the end of bundle when more is expected.");let t=this.Cc.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}kc(e){throw this.Dc.cancel(),Error(`Invalid bundle format: ${e}`)}async $c(){let e=await this.Dc.read();if(!e.done){let t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ma{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new l2(l1.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");let t=await async function(e,t){let n=dD(e.serializer)+"/documents",r={documents:t.map(t=>dA(e.serializer,t))},i=await e.Ao("BatchGetDocuments",n,r,t.length),s=new Map;i.forEach(t=>{var n;let r=(n=e.serializer,"found"in t?function(e,t){t.found||l0(),t.found.name,t.found.updateTime;let n=dR(e,t.found.name),r=dS(t.found.updateTime),i=t.found.createTime?dS(t.found.createTime):uo.min(),s=new cV({mapValue:{fields:t.found.fields}});return cq.newFoundDocument(n,r,i,s)}(n,t):"missing"in t?function(e,t){t.missing||l0(),t.readTime||l0();let n=dR(e,t.missing),r=dS(t.readTime);return cq.newNoDocument(n,r)}(n,t):l0());s.set(r.key.toString(),r)});let o=[];return t.forEach(e=>{let t=s.get(e.toString());t||l0(),o.push(t)}),o}(this.datastore,e);return t.forEach(e=>this.recordVersion(e)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastWriteError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new h4(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;let e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((e,t)=>{let n=uh.fromPath(t);this.mutations.push(new h9(n,this.precondition(n)))}),await async function(e,t){let n=dD(e.serializer)+"/documents",r={writes:t.map(t=>dM(e.serializer,t))};await e.po("Commit",n,r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw l0();t=uo.min()}let n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new l2(l1.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){let t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(uo.min())?hW.exists(!1):hW.updateTime(t):hW.none()}preconditionForUpdate(e){let t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(uo.min()))throw new l2(l1.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return hW.updateTime(t)}return hW.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this.Fc=n.maxAttempts,this.Lo=new pz(this.asyncQueue,"transaction_retry")}run(){this.Fc-=1,this.Bc()}Bc(){this.Lo.xo(async()=>{let e=new ma(this.datastore),t=this.Lc(e);t&&t.then(t=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(t)}).catch(e=>{this.qc(e)}))}).catch(e=>{this.qc(e)})})}Lc(e){try{let t=this.updateFunction(e);return!uM(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}qc(e){this.Fc>0&&this.Uc(e)?(this.Fc-=1,this.asyncQueue.enqueueAndForget(()=>(this.Bc(),Promise.resolve()))):this.deferred.reject(e)}Uc(e){if("FirebaseError"===e.name){let t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!h7(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mu{constructor(e,t,n,r){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=lW.UNAUTHENTICATED,this.clientId=un.A(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(n,async e=>{lQ("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(n,e=>(lQ("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new l2(l1.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let e=new l4;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){let t=gd(n,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function mc(e,t){e.asyncQueue.verifyOperationInProgress(),lQ("FirestoreClient","Initializing OfflineComponentProvider");let n=await e.getConfiguration();await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener(async e=>{r.isEqual(e)||(await ph(t.localStore,e),r=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function mh(e,t){e.asyncQueue.verifyOperationInProgress();let n=await mf(e);lQ("FirestoreClient","Initializing OnlineComponentProvider");let r=await e.getConfiguration();await t.initialize(n,r),e.setCredentialChangeListener(e=>ga(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,n)=>ga(t.remoteStore,n)),e._onlineComponents=t}function md(e){return"FirebaseError"===e.name?e.code===l1.FAILED_PRECONDITION||e.code===l1.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}async function mf(e){if(!e._offlineComponents){if(e._uninitializedComponentsProvider){lQ("FirestoreClient","Using user provided OfflineComponentProvider");try{await mc(e,e._uninitializedComponentsProvider._offline)}catch(t){if(!md(t))throw t;lX("Error using user provided cache. Falling back to memory cache: "+t),await mc(e,new me)}}else lQ("FirestoreClient","Using default OfflineComponentProvider"),await mc(e,new me)}return e._offlineComponents}async function mp(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(lQ("FirestoreClient","Using user provided OnlineComponentProvider"),await mh(e,e._uninitializedComponentsProvider._online)):(lQ("FirestoreClient","Using default OnlineComponentProvider"),await mh(e,new mr))),e._onlineComponents}function mg(e){return mf(e).then(e=>e.persistence)}function mm(e){return mf(e).then(e=>e.localStore)}function my(e){return mp(e).then(e=>e.remoteStore)}function mv(e){return mp(e).then(e=>e.syncEngine)}async function m_(e){let t=await mp(e),n=t.eventManager;return n.onListen=gO.bind(null,t.syncEngine),n.onUnlisten=gL.bind(null,t.syncEngine),n}function mw(e,t,n={}){let r=new l4;return e.asyncQueue.enqueueAndForget(async()=>(function(e,t,n,r,i){let s=new ms({next:s=>{t.enqueueAndForget(()=>g_(e,o));let a=s.docs.has(n);!a&&s.fromCache?i.reject(new l2(l1.UNAVAILABLE,"Failed to get document because the client is offline.")):a&&s.fromCache&&r&&"server"===r.source?i.reject(new l2(l1.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(s)},error:e=>i.reject(e)}),o=new gT(ho(n.path),s,{includeMetadataChanges:!0,Uu:!0});return gv(e,o)})(await m_(e),e.asyncQueue,t,n,r)),r.promise}function mb(e,t,n={}){let r=new l4;return e.asyncQueue.enqueueAndForget(async()=>(function(e,t,n,r,i){let s=new ms({next:n=>{t.enqueueAndForget(()=>g_(e,o)),n.fromCache&&"server"===r.source?i.reject(new l2(l1.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new gT(n,s,{includeMetadataChanges:!0,Uu:!0});return gv(e,o)})(await m_(e),e.asyncQueue,t,n,r)),r.promise}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mI=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mT(e,t,n){if(!n)throw new l2(l1.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function mE(e,t,n,r){if(!0===t&&!0===r)throw new l2(l1.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function mC(e){if(!uh.isDocumentKey(e))throw new l2(l1.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function mS(e){if(uh.isDocumentKey(e))throw new l2(l1.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function mk(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{var t;let n=(t=e).constructor?t.constructor.name:null;return n?`a custom ${n} object`:"an object"}}return"function"==typeof e?"a function":l0()}function mx(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new l2(l1.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let n=mk(e);throw new l2(l1.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function mA(e,t){if(t<=0)throw new l2(l1.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e){var t;if(void 0===e.host){if(void 0!==e.ssl)throw new l2(l1.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.cache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new l2(l1.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}mE("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!1:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new mR({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new l2(l1.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new l2(l1.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new mR(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new l5;switch(e.type){case"firstParty":return new l7(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new l2(l1.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let t=mI.get(e);t&&(lQ("ComponentProvider","Removing Datastore"),mI.delete(e),t.terminate())}(this),Promise.resolve()}}function mP(e,t,n,r={}){var i;let s=(e=mx(e,mN))._getSettings();if("firestore.googleapis.com"!==s.host&&s.host!==t&&lX("Host has been set in both settings() and useEmulator(), emulator host will be used"),e._setSettings(Object.assign(Object.assign({},s),{host:`${t}:${n}`,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=lW.MOCK_USER;else{t=(0,b.Sg)(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);let s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new l2(l1.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new lW(s)}e._authCredentials=new l6(new l9(t,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new mF(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new mD(this.firestore,e,this._key)}}class mO{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new mO(this.firestore,e,this._query)}}class mF extends mO{constructor(e,t,n){super(e,t,ho(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new mD(this.firestore,null,new uh(e))}withConverter(e){return new mF(this.firestore,e,this._path)}}function mL(e,t,...n){if(e=(0,b.m9)(e),mT("collection","path",t),e instanceof mN){let r=ul.fromString(t,...n);return mS(r),new mF(e,null,r)}{if(!(e instanceof mD||e instanceof mF))throw new l2(l1.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=e._path.child(ul.fromString(t,...n));return mS(r),new mF(e.firestore,null,r)}}function mM(e,t,...n){if(e=(0,b.m9)(e),1==arguments.length&&(t=un.A()),mT("doc","path",t),e instanceof mN){let r=ul.fromString(t,...n);return mC(r),new mD(e,null,new uh(r))}{if(!(e instanceof mD||e instanceof mF))throw new l2(l1.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let r=e._path.child(ul.fromString(t,...n));return mC(r),new mD(e.firestore,e instanceof mF?e.converter:null,new uh(r))}}function mU(e,t){return e=(0,b.m9)(e),t=(0,b.m9)(t),(e instanceof mD||e instanceof mF)&&(t instanceof mD||t instanceof mF)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function mV(e,t){return e=(0,b.m9)(e),t=(0,b.m9)(t),e instanceof mO&&t instanceof mO&&e.firestore===t.firestore&&hg(e._query,t._query)&&e.converter===t.converter}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mq{constructor(){this.Kc=Promise.resolve(),this.Gc=[],this.Qc=!1,this.jc=[],this.zc=null,this.Wc=!1,this.Hc=!1,this.Jc=[],this.Lo=new pz(this,"async_queue_retry"),this.Yc=()=>{let e=pj();e&&lQ("AsyncQueue","Visibility state changed to "+e.visibilityState),this.Lo.ko()};let e=pj();e&&"function"==typeof e.addEventListener&&e.addEventListener("visibilitychange",this.Yc)}get isShuttingDown(){return this.Qc}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.Xc(),this.Zc(e)}enterRestrictedMode(e){if(!this.Qc){this.Qc=!0,this.Hc=e||!1;let t=pj();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Yc)}}enqueue(e){if(this.Xc(),this.Qc)return new Promise(()=>{});let t=new l4;return this.Zc(()=>this.Qc&&this.Hc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Gc.push(e),this.ta()))}async ta(){if(0!==this.Gc.length){try{await this.Gc[0](),this.Gc.shift(),this.Lo.reset()}catch(e){if(!uA(e))throw e;lQ("AsyncQueue","Operation failed with retryable error: "+e)}this.Gc.length>0&&this.Lo.xo(()=>this.ta())}}Zc(e){let t=this.Kc.then(()=>(this.Wc=!0,e().catch(e=>{let t;this.zc=e,this.Wc=!1;let n=(t=e.message||"",e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t);throw lY("INTERNAL UNHANDLED ERROR: ",n),e}).then(e=>(this.Wc=!1,e))));return this.Kc=t,t}enqueueAfterDelay(e,t,n){this.Xc(),this.Jc.indexOf(e)>-1&&(t=0);let r=gh.createAndSchedule(this,e,t,n,e=>this.ea(e));return this.jc.push(r),r}Xc(){this.zc&&l0()}verifyOperationInProgress(){}async na(){let e;do e=this.Kc,await e;while(e!==this.Kc)}sa(e){for(let t of this.jc)if(t.timerId===e)return!0;return!1}ia(e){return this.na().then(()=>{for(let t of(this.jc.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.jc))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.na()})}ra(e){this.Jc.push(e)}ea(e){let t=this.jc.indexOf(e);this.jc.splice(t,1)}}function mj(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(let n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])}class mB{constructor(){this._progressObserver={},this._taskCompletionResolver=new l4,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class mz extends mN{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new mq,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}_terminate(){return this._firestoreClient||mH(this),this._firestoreClient.terminate()}}function m$(e){return e._firestoreClient||mH(e),e._firestoreClient.verifyNotTerminated(),e._firestoreClient}function mH(e){var t,n,r,i,s,o;let a=e._freezeSettings(),l=(i=e._databaseId,s=(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",o=e._persistenceKey,new c_(i,s,o,a.host,a.ssl,a.experimentalForceLongPolling,a.experimentalAutoDetectLongPolling,a.useFetchStreams));e._firestoreClient=new mu(e._authCredentials,e._appCheckCredentials,e._queue,l),(null===(n=a.cache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=a.cache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._firestoreClient._uninitializedComponentsProvider={_offlineKind:a.cache.kind,_offline:a.cache._offlineComponentProvider,_online:a.cache._onlineComponentProvider})}function mW(e,t,n){let r=new l4;return e.asyncQueue.enqueue(async()=>{try{await mc(e,n),await mh(e,t),r.resolve()}catch(e){if(!md(e))throw e;lX("Error enabling indexeddb cache. Falling back to memory cache: "+e),r.reject(e)}}).then(()=>r.promise)}function mG(e){if(e._initialized||e._terminated)throw new l2(l1.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mK{constructor(e){this._byteString=e}static fromBase64String(e){try{return new mK(ch.fromBase64String(e))}catch(e){throw new l2(l1.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new mK(ch.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mZ{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new l2(l1.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new uc(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mQ{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mY{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new l2(l1.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new l2(l1.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return ur(this._lat,e._lat)||ur(this._long,e._long)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let mX=/^__.*__$/;class mJ{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new hJ(e,this.data,this.fieldMask,t,this.fieldTransforms):new hX(e,this.data,t,this.fieldTransforms)}}class m0{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new hJ(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function m1(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw l0()}}class m2{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.oa(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get ua(){return this.settings.ua}ca(e){return new m2(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}aa(e){var t;let n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ca({path:n,ha:!1});return r.la(e),r}fa(e){var t;let n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.ca({path:n,ha:!1});return r.oa(),r}da(e){return this.ca({path:void 0,ha:!0})}_a(e){return yd(e,this.settings.methodName,this.settings.wa||!1,this.path,this.settings.ma)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}oa(){if(this.path)for(let e=0;e<this.path.length;e++)this.la(this.path.get(e))}la(e){if(0===e.length)throw this._a("Document fields must not be empty");if(m1(this.ua)&&mX.test(e))throw this._a('Document fields cannot begin and end with "__"')}}class m4{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||pB(e)}ga(e,t,n,r=!1){return new m2({ua:e,methodName:t,ma:n,path:uc.emptyPath(),ha:!1,wa:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function m9(e){let t=e._freezeSettings(),n=pB(e._databaseId);return new m4(e._databaseId,!!t.ignoreUndefinedProperties,n)}function m5(e,t,n,r,i,s={}){let o,a;let l=e.ga(s.merge||s.mergeFields?2:0,t,n,i);yl("Data must be an object, but it was:",l,r);let u=yo(r,l);if(s.merge)o=new cu(l.fieldMask),a=l.fieldTransforms;else if(s.mergeFields){let e=[];for(let r of s.mergeFields){let i=yu(t,r,n);if(!l.contains(i))throw new l2(l1.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);yf(e,i)||e.push(i)}o=new cu(e),a=l.fieldTransforms.filter(e=>o.covers(e.field))}else o=null,a=l.fieldTransforms;return new mJ(new cV(u),o,a)}class m6 extends mQ{_toFieldTransform(e){if(2!==e.ua)throw 1===e.ua?e._a(`${this._methodName}() can only appear at the top level of your update data`):e._a(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof m6}}function m3(e,t,n){return new m2({ua:3,ma:t.settings.ma,methodName:e._methodName,ha:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class m8 extends mQ{_toFieldTransform(e){return new h$(e.path,new hL)}isEqual(e){return e instanceof m8}}class m7 extends mQ{constructor(e,t){super(e),this.ya=t}_toFieldTransform(e){let t=m3(this,e,!0),n=this.ya.map(e=>ys(e,t)),r=new hM(n);return new h$(e.path,r)}isEqual(e){return this===e}}class ye extends mQ{constructor(e,t){super(e),this.ya=t}_toFieldTransform(e){let t=m3(this,e,!0),n=this.ya.map(e=>ys(e,t)),r=new hV(n);return new h$(e.path,r)}isEqual(e){return this===e}}class yt extends mQ{constructor(e,t){super(e),this.pa=t}_toFieldTransform(e){let t=new hj(e.serializer,hD(e.serializer,this.pa));return new h$(e.path,t)}isEqual(e){return this===e}}function yn(e,t,n,r){let i=e.ga(1,t,n);yl("Data must be an object, but it was:",i,r);let s=[],o=cV.empty();ct(r,(e,r)=>{let a=yh(t,e,n);r=(0,b.m9)(r);let l=i.fa(a);if(r instanceof m6)s.push(a);else{let e=ys(r,l);null!=e&&(s.push(a),o.set(a,e))}});let a=new cu(s);return new m0(o,a,i.fieldTransforms)}function yr(e,t,n,r,i,s){let o=e.ga(1,t,n),a=[yu(t,r,n)],l=[i];if(s.length%2!=0)throw new l2(l1.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let e=0;e<s.length;e+=2)a.push(yu(t,s[e])),l.push(s[e+1]);let u=[],c=cV.empty();for(let e=a.length-1;e>=0;--e)if(!yf(u,a[e])){let t=a[e],n=l[e];n=(0,b.m9)(n);let r=o.fa(t);if(n instanceof m6)u.push(t);else{let e=ys(n,r);null!=e&&(u.push(t),c.set(t,e))}}let h=new cu(u);return new m0(c,h,o.fieldTransforms)}function yi(e,t,n,r=!1){return ys(n,e.ga(r?4:3,t))}function ys(e,t){if(ya(e=(0,b.m9)(e)))return yl("Unsupported field value:",t,e),yo(e,t);if(e instanceof mQ)return function(e,t){if(!m1(t.ua))throw t._a(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t._a(`${e._methodName}() is not currently supported inside arrays`);let n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.ha&&4!==t.ua)throw t._a("Nested arrays are not supported");return function(e,t){let n=[],r=0;for(let i of e){let e=ys(i,t.da(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,b.m9)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return hD(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let n=us.fromDate(e);return{timestampValue:dE(t.serializer,n)}}if(e instanceof us){let n=new us(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:dE(t.serializer,n)}}if(e instanceof mY)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof mK)return{bytesValue:dC(t.serializer,e._byteString)};if(e instanceof mD){let n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t._a(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:dk(e.firestore._databaseId||t.databaseId,e._key.path)}}throw t._a(`Unsupported field value: ${mk(e)}`)}(e,t)}function yo(e,t){let n={};return cn(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ct(e,(e,r)=>{let i=ys(r,t.aa(e));null!=i&&(n[e]=i)}),{mapValue:{fields:n}}}function ya(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof us||e instanceof mY||e instanceof mK||e instanceof mD||e instanceof mQ)}function yl(e,t,n){if(!ya(n)||!("object"==typeof n&&null!==n&&(Object.getPrototypeOf(n)===Object.prototype||null===Object.getPrototypeOf(n)))){let r=mk(n);throw"an object"===r?t._a(e+" a custom object"):t._a(e+" "+r)}}function yu(e,t,n){if((t=(0,b.m9)(t))instanceof mZ)return t._internalPath;if("string"==typeof t)return yh(e,t);throw yd("Field path arguments must be of type string or ",e,!1,void 0,n)}let yc=RegExp("[~\\*/\\[\\]]");function yh(e,t,n){if(t.search(yc)>=0)throw yd(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new mZ(...t.split("."))._internalPath}catch(r){throw yd(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function yd(e,t,n,r,i){let s=r&&!r.isEmpty(),o=void 0!==i,a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new l2(l1.INVALID_ARGUMENT,a+e+l)}function yf(e,t){return e.some(e=>e.isEqual(t))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yp{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new mD(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){let e=new yg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){let t=this._document.data.field(ym("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class yg extends yp{data(){return super.data()}}function ym(e,t){return"string"==typeof t?yh(e,t):t instanceof mZ?t._internalPath:t._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yy(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new l2(l1.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class yv{}class y_ extends yv{}function yw(e,t,...n){let r=[];for(let i of(t instanceof yv&&r.push(t),function(e){let t=e.filter(e=>e instanceof yI).length,n=e.filter(e=>e instanceof yb).length;if(t>1||t>0&&n>0)throw new l2(l1.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r=r.concat(n)),r))e=i._apply(e);return e}class yb extends y_{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new yb(e,t,n)}_apply(e){let t=this._parse(e);return yR(e._query,t),new mO(e.firestore,e.converter,hf(e._query,t))}_parse(e){let t=m9(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new l2(l1.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){yA(o,s);let t=[];for(let n of o)t.push(yx(r,e,n));a={arrayValue:{values:t}}}else a=yx(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||yA(o,s),a=yi(n,t,o,"in"===s||"not-in"===s);return cW.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class yI extends yv{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new yI(e,t)}_parse(e){let t=this._queryConstraints.map(t=>t._parse(e)).filter(e=>e.getFilters().length>0);return 1===t.length?t[0]:cG.create(t,this._getOperator())}_apply(e){let t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e,r=t.getFlattenedFilters();for(let e of r)yR(n,e),n=hf(n,e)}(e._query,t),new mO(e.firestore,e.converter,hf(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class yT extends y_{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new yT(e,t)}_apply(e){let t=function(e,t,n){if(null!==e.startAt)throw new l2(l1.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new l2(l1.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");let r=new c$(t,n);return function(e,t){if(null===hl(e)){let n=hu(e);null!==n&&yN(e,n,t.field)}}(e,r),r}(e._query,this._field,this._direction);return new mO(e.firestore,e.converter,function(e,t){let n=e.explicitOrderBy.concat([t]);return new hs(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class yE extends y_{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new yE(e,t,n)}_apply(e){return new mO(e.firestore,e.converter,hp(e._query,this._limit,this._limitType))}}class yC extends y_{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new yC(e,t,n)}_apply(e){var t;let n=yk(e,this.type,this._docOrFields,this._inclusive);return new mO(e.firestore,e.converter,(t=e._query,new hs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,n,t.endAt)))}}class yS extends y_{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new yS(e,t,n)}_apply(e){var t;let n=yk(e,this.type,this._docOrFields,this._inclusive);return new mO(e.firestore,e.converter,(t=e._query,new hs(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),t.limit,t.limitType,t.startAt,n)))}}function yk(e,t,n,r){if(n[0]=(0,b.m9)(n[0]),n[0]instanceof yp)return function(e,t,n,r,i){if(!r)throw new l2(l1.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);let s=[];for(let n of hh(e))if(n.field.isKeyField())s.push(cA(t,r.key));else{let e=r.data.field(n.field);if(cm(e))throw new l2(l1.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+n.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){let e=n.field.canonicalString();throw new l2(l1.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new cj(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{let i=m9(e.firestore);return function(e,t,n,r,i,s){let o=e.explicitOrderBy;if(i.length>o.length)throw new l2(l1.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let a=[];for(let s=0;s<i.length;s++){let l=i[s];if(o[s].field.isKeyField()){if("string"!=typeof l)throw new l2(l1.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof l}`);if(!hc(e)&&-1!==l.indexOf("/"))throw new l2(l1.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${l}' contains a slash.`);let n=e.path.child(ul.fromString(l));if(!uh.isDocumentKey(n))throw new l2(l1.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);let i=new uh(n);a.push(cA(t,i))}else{let e=yi(n,r,l);a.push(e)}}return new cj(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function yx(e,t,n){if("string"==typeof(n=(0,b.m9)(n))){if(""===n)throw new l2(l1.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!hc(t)&&-1!==n.indexOf("/"))throw new l2(l1.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);let r=t.path.child(ul.fromString(n));if(!uh.isDocumentKey(r))throw new l2(l1.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return cA(e,new uh(r))}if(n instanceof mD)return cA(e,n._key);throw new l2(l1.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${mk(n)}.`)}function yA(e,t){if(!Array.isArray(e)||0===e.length)throw new l2(l1.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function yR(e,t){if(t.isInequality()){let n=hu(e),r=t.field;if(null!==n&&!n.isEqual(r))throw new l2(l1.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${n.toString()}' and '${r.toString()}'`);let i=hl(e);null!==i&&yN(e,r,i)}let n=function(e,t){for(let n of e)for(let e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new l2(l1.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new l2(l1.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}function yN(e,t,n){if(!n.isEqual(t))throw new l2(l1.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${t.toString()}' and so you must also use '${t.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${n.toString()}' instead.`)}class yP{convertValue(e,t="none"){switch(cT(e)){case 0:return null;case 1:return e.booleanValue;case 2:return cp(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(cg(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 10:return this.convertObject(e.mapValue,t);default:throw l0()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){let n={};return ct(e,(e,r)=>{n[e]=this.convertValue(r,t)}),n}convertGeoPoint(e){return new mY(cp(e.latitude),cp(e.longitude))}convertArray(e,t){return(e.values||[]).map(e=>this.convertValue(e,t))}convertServerTimestamp(e,t){switch(t){case"previous":let n=cy(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(cv(e));default:return null}}convertTimestamp(e){let t=cf(e);return new us(t.seconds,t.nanos)}convertDocumentKey(e,t){let n=ul.fromString(e);d$(n)||l0();let r=new cw(n.get(1),n.get(3)),i=new uh(n.popFirst(5));return r.isEqual(t)||lY(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yD(e,t,n){return e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t}class yO extends yP{constructor(e){super(),this.firestore=e}convertBytes(e){return new mK(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new mD(this.firestore,null,t)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yF{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yL extends yp{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){let t=new yM(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){let n=this._document.data.field(ym("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class yM extends yL{data(e={}){return super.data(e)}}class yU{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new yF(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new yM(this._firestore,this._userDataWriter,n.key,n,new yF(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new l2(l1.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(n=>{let r=new yM(e._firestore,e._userDataWriter,n.doc.key,n.doc,new yF(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}})}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let r=new yM(e._firestore,e._userDataWriter,t.doc.key,t.doc,new yF(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(s=(n=n.add(t.doc)).indexOf(t.doc.key)),{type:function(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return l0()}}(t.type),doc:r,oldIndex:i,newIndex:s}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function yV(e,t){return e instanceof yL&&t instanceof yL?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof yU&&t instanceof yU&&e._firestore===t._firestore&&mV(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}class yq extends yP{constructor(e){super(),this.firestore=e}convertBytes(e){return new mK(e)}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return new mD(this.firestore,null,t)}}function yj(e,t,n){e=mx(e,mD);let r=mx(e.firestore,mz),i=yD(e.converter,t,n);return y$(r,[m5(m9(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,hW.none())])}function yB(e,t,n,...r){let i;e=mx(e,mD);let s=mx(e.firestore,mz),o=m9(s);return i="string"==typeof(t=(0,b.m9)(t))||t instanceof mZ?yr(o,"updateDoc",e._key,t,n,r):yn(o,"updateDoc",e._key,t),y$(s,[i.toMutation(e._key,hW.exists(!0))])}function yz(e,...t){var n,r,i;let s,o,a;e=(0,b.m9)(e);let l={includeMetadataChanges:!1},u=0;"object"!=typeof t[0]||mj(t[u])||(l=t[u],u++);let c={includeMetadataChanges:l.includeMetadataChanges};if(mj(t[u])){let e=t[u];t[u]=null===(n=e.next)||void 0===n?void 0:n.bind(e),t[u+1]=null===(r=e.error)||void 0===r?void 0:r.bind(e),t[u+2]=null===(i=e.complete)||void 0===i?void 0:i.bind(e)}if(e instanceof mD)o=mx(e.firestore,mz),a=ho(e._key.path),s={next:n=>{t[u]&&t[u](yH(o,e,n))},error:t[u+1],complete:t[u+2]};else{let n=mx(e,mO);o=mx(n.firestore,mz),a=n._query;let r=new yq(o);s={next:e=>{t[u]&&t[u](new yU(o,r,n,e))},error:t[u+1],complete:t[u+2]},yy(e._query)}return function(e,t,n,r){let i=new ms(r),s=new gT(t,i,n);return e.asyncQueue.enqueueAndForget(async()=>gv(await m_(e),s)),()=>{i.Sc(),e.asyncQueue.enqueueAndForget(async()=>g_(await m_(e),s))}}(m$(o),a,c,s)}function y$(e,t){return function(e,t){let n=new l4;return e.asyncQueue.enqueueAndForget(async()=>gM(await mv(e),t,n)),n.promise}(m$(e),t)}function yH(e,t,n){let r=n.docs.get(t._key),i=new yq(e);return new yL(e,i,t._key,r,new yF(n.hasPendingWrites,n.fromCache),t.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yW={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yG{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=m9(e)}set(e,t,n){this._verifyNotCommitted();let r=yK(e,this._firestore),i=yD(r.converter,t,n),s=m5(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,hW.none())),this}update(e,t,n,...r){let i;this._verifyNotCommitted();let s=yK(e,this._firestore);return i="string"==typeof(t=(0,b.m9)(t))||t instanceof mZ?yr(this._dataReader,"WriteBatch.update",s._key,t,n,r):yn(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(i.toMutation(s._key,hW.exists(!0))),this}delete(e){this._verifyNotCommitted();let t=yK(e,this._firestore);return this._mutations=this._mutations.concat(new h4(t._key,hW.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new l2(l1.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function yK(e,t){if((e=(0,b.m9)(e)).firestore!==t)throw new l2(l1.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yZ extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=m9(e)}get(e){let t=yK(e,this._firestore),n=new yO(this._firestore);return this._transaction.lookup([t._key]).then(e=>{if(!e||1!==e.length)return l0();let r=e[0];if(r.isFoundDocument())return new yp(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new yp(this._firestore,n,t._key,null,t.converter);throw l0()})}set(e,t,n){let r=yK(e,this._firestore),i=yD(r.converter,t,n),s=m5(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n,...r){let i;let s=yK(e,this._firestore);return i="string"==typeof(t=(0,b.m9)(t))||t instanceof mZ?yr(this._dataReader,"Transaction.update",s._key,t,n,r):yn(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,i),this}delete(e){let t=yK(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){let t=yK(e,this._firestore),n=new yq(this._firestore);return super.get(e).then(e=>new yL(this._firestore,n,t._key,e._document,new yF(!1,!1),t.converter))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yQ(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new l2("invalid-argument",`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yY(){if("undefined"==typeof Uint8Array)throw new l2("unimplemented","Uint8Arrays are not available in this environment.")}function yX(){if(!("undefined"!=typeof atob))throw new l2("unimplemented","Blobs are unavailable in Firestore in this environment.")}!function(e,t=!0){lG=T.SDK_VERSION,(0,T._registerComponent)(new I.wA("firestore",(e,{instanceIdentifier:n,options:r})=>{let i=e.getProvider("app").getImmediate(),s=new mz(new l3(e.getProvider("auth-internal")),new ut(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new l2(l1.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cw(e.options.projectId,t)}(i,n),i);return r=Object.assign({useFetchStreams:t},r),s._setSettings(r),s},"PUBLIC").setMultipleInstances(!0)),(0,T.registerVersion)(lH,"3.11.0",void 0),(0,T.registerVersion)(lH,"3.11.0","esm2017")}();class yJ{constructor(e){this._delegate=e}static fromBase64String(e){return yX(),new yJ(mK.fromBase64String(e))}static fromUint8Array(e){return yY(),new yJ(mK.fromUint8Array(e))}toBase64(){return yX(),this._delegate.toBase64()}toUint8Array(){return yY(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0(e){return function(e,t){if("object"!=typeof e||null===e)return!1;for(let n of t)if(n in e&&"function"==typeof e[n])return!0;return!1}(e,["next","error","complete"])}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y1{enableIndexedDbPersistence(e,t){return function(e,t){mG(e=mx(e,mz));let n=m$(e);if(n._uninitializedComponentsProvider)throw new l2(l1.FAILED_PRECONDITION,"SDK cache is already specified.");lX("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let r=e._freezeSettings(),i=new mr;return mW(n,i,new mt(i,r.cacheSizeBytes,null==t?void 0:t.forceOwnership))}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return function(e){mG(e=mx(e,mz));let t=m$(e);if(t._uninitializedComponentsProvider)throw new l2(l1.FAILED_PRECONDITION,"SDK cache is already specified.");lX("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let n=e._freezeSettings(),r=new mr;return mW(t,r,new mn(r,n.cacheSizeBytes))}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new l2(l1.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let t=new l4;return e._queue.enqueueAndForgetEvenWhileRestricted(async()=>{try{await async function(e){if(!uS.D())return Promise.resolve();await uS.delete(e+"main")}(pa(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}}),t.promise}(e._delegate)}}class y2{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof cw||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){let t=this._delegate._getSettings();e.merge||t.host===e.host||lX("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&(e=Object.assign(Object.assign({},t),e),delete e.merge),this._delegate._setSettings(e)}useEmulator(e,t,n={}){mP(this._delegate,e,t,n)}enableNetwork(){var e;return(e=m$(mx(this._delegate,mz))).asyncQueue.enqueue(async()=>{let t=await mg(e),n=await my(e);return t.setNetworkEnabled(!0),n.Au.delete(0),pQ(n)})}disableNetwork(){var e;return(e=m$(mx(this._delegate,mz))).asyncQueue.enqueue(async()=>{let t=await mg(e),n=await my(e);return t.setNetworkEnabled(!1),async function(e){e.Au.add(0),await pY(e),e.Pu.set("Offline")}(n)})}enablePersistence(e){let t=!1,n=!1;return e&&mE("synchronizeTabs",t=!!e.synchronizeTabs,"experimentalForceOwningTab",n=!!e.experimentalForceOwningTab),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return function(e){let t=new l4;return e.asyncQueue.enqueueAndForget(async()=>gz(await mv(e),t)),t.promise}(m$(mx(this._delegate,mz)))}onSnapshotsInSync(e){var t;return function(e,t){let n=new ms(t);return e.asyncQueue.enqueueAndForget(async()=>{(await m_(e)).Nu.add(n),n.next()}),()=>{n.Sc(),e.asyncQueue.enqueueAndForget(async()=>(function(e,t){e.Nu.delete(t)})(await m_(e),n))}}(m$(mx(this._delegate,mz)),mj(e)?e:{next:e})}get app(){if(!this._appCompat)throw new l2("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new vo(this,mL(this._delegate,e))}catch(e){throw y8(e,"collection()","Firestore.collection()")}}doc(e){try{return new y3(this,mM(this._delegate,e))}catch(e){throw y8(e,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new vr(this,function(e,t){if(e=mx(e,mN),mT("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new l2(l1.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new mO(e,null,new hs(ul.emptyPath(),t))}(this._delegate,e))}catch(e){throw y8(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function(e,t,n){e=mx(e,mz);let r=Object.assign(Object.assign({},yW),void 0);return!function(e){if(e.maxAttempts<1)throw new l2(l1.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){let r=new l4;return e.asyncQueue.enqueueAndForget(async()=>{let i=await mp(e).then(e=>e.datastore);new ml(e.asyncQueue,i,n,t,r).run()}),r.promise}(m$(e),n=>t(new yZ(e,n)),r)}(this._delegate,t=>e(new y9(this,t)))}batch(){return m$(this._delegate),new y5(new yG(this._delegate,e=>y$(this._delegate,e)))}loadBundle(e){return function(e,t){let n=m$(e=mx(e,mz)),r=new mB;return function(e,t,n,r){var i,s;let o=(i=pB(t),s=function(e,t){if(e instanceof Uint8Array)return mi(e,t);if(e instanceof ArrayBuffer)return mi(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}("string"==typeof n?dr().encode(n):n),new mo(s,i));e.asyncQueue.enqueueAndForget(async()=>{!function(e,t,n){(async function(e,t,n){try{var r;let i=await t.getMetadata();if(await function(e,t){let n=dS(t.createTime);return e.persistence.runTransaction("hasNewerBundle","readonly",n=>e.Ls.getBundleMetadata(n,t.id)).then(e=>!!e&&e.createTime.compareTo(n)>=0)}(e.localStore,i))return await t.close(),n._completeWith({taskState:"Success",documentsLoaded:i.totalDocuments,bytesLoaded:i.totalBytes,totalDocuments:i.totalDocuments,totalBytes:i.totalBytes}),Promise.resolve(new Set);n._updateProgress(gk(i));let s=new gS(i,e.localStore,t.serializer),o=await t.Pc();for(;o;){let e=await s.ju(o);e&&n._updateProgress(e),o=await t.Pc()}let a=await s.complete();return await gQ(e,a.Hu,void 0),await (r=e.localStore).persistence.runTransaction("Save bundle","readwrite",e=>r.Ls.saveBundleMetadata(e,i)),n._completeWith(a.progress),Promise.resolve(a.Wu)}catch(e){return lX("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(e,t,n).then(t=>{e.sharedClientState.notifyBundleLoaded(t)})}(await mv(e),o,r)})}(n,e._databaseId,t,r),r}(this._delegate,e)}namedQuery(e){var t,n;return(n=m$(t=mx(t=this._delegate,mz))).asyncQueue.enqueue(async()=>{var t;return(t=await mm(n)).persistence.runTransaction("Get named query","readonly",n=>t.Ls.getNamedQuery(n,e))}).then(e=>e?new mO(t,null,e.query):null).then(e=>e?new vr(this,e):null)}}class y4 extends yP{constructor(e){super(),this.firestore=e}convertBytes(e){return new yJ(new mK(e))}convertReference(e){let t=this.convertDocumentKey(e,this.firestore._databaseId);return y3.forKey(t,this.firestore,null)}}class y9{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new y4(e)}get(e){let t=mx(e,mD);return this._delegate.get(t).then(e=>new vt(this._firestore,new yL(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter)))}set(e,t,n){let r=mx(e,mD);return n?(yQ("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){let i=mx(e,mD);return 2==arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){let t=mx(e,mD);return this._delegate.delete(t),this}}class y5{constructor(e){this._delegate=e}set(e,t,n){let r=mx(e,mD);return n?(yQ("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n,...r){let i=mx(e,mD);return 2==arguments.length?this._delegate.update(i,t):this._delegate.update(i,t,n,...r),this}delete(e){let t=mx(e,mD);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class y6{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){let n=new yM(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new vn(this._firestore,n),null!=t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){let n=y6.INSTANCES,r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new y6(e,new y4(e),t),r.set(t,i)),i}}y6.INSTANCES=new WeakMap;class y3{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new y4(e)}static forPath(e,t,n){if(e.length%2!=0)throw new l2("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new y3(t,new mD(t._delegate,n,new uh(e)))}static forKey(e,t,n){return new y3(t,new mD(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new vo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new vo(this.firestore,mL(this._delegate,e))}catch(e){throw y8(e,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=(0,b.m9)(e))instanceof mD&&mU(this._delegate,e)}set(e,t){t=yQ("DocumentReference.set",t);try{if(t)return yj(this._delegate,e,t);return yj(this._delegate,e)}catch(e){throw y8(e,"setDoc()","DocumentReference.set()")}}update(e,t,...n){try{if(1==arguments.length)return yB(this._delegate,e);return yB(this._delegate,e,t,...n)}catch(e){throw y8(e,"updateDoc()","DocumentReference.update()")}}delete(){var e;return y$(mx((e=this._delegate).firestore,mz),[new h4(e._key,hW.none())])}onSnapshot(...e){let t=y7(e),n=ve(e,e=>new vt(this.firestore,new yL(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)));return yz(this._delegate,t,n)}get(e){return((null==e?void 0:e.source)==="cache"?function(e){e=mx(e,mD);let t=mx(e.firestore,mz),n=m$(t),r=new yq(t);return(function(e,t){let n=new l4;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,t,n){try{let r=await e.persistence.runTransaction("read document","readonly",n=>e.localDocuments.getDocument(n,t));r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new l2(l1.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(r){let e=gd(r,`Failed to get document '${t} from cache`);n.reject(e)}})(await mm(e),t,n)),n.promise})(n,e._key).then(n=>new yL(t,r,e._key,n,new yF(null!==n&&n.hasLocalMutations,!0),e.converter))}(this._delegate):(null==e?void 0:e.source)==="server"?function(e){e=mx(e,mD);let t=mx(e.firestore,mz);return mw(m$(t),e._key,{source:"server"}).then(n=>yH(t,e,n))}(this._delegate):/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function(e){e=mx(e,mD);let t=mx(e.firestore,mz);return mw(m$(t),e._key).then(n=>yH(t,e,n))}(this._delegate)).then(e=>new vt(this.firestore,new yL(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter)))}withConverter(e){return new y3(this.firestore,e?this._delegate.withConverter(y6.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function y8(e,t,n){return e.message=e.message.replace(t,n),e}function y7(e){for(let t of e)if("object"==typeof t&&!y0(t))return t;return{}}function ve(e,t){var n,r;let i;return{next:e=>{i.next&&i.next(t(e))},error:null===(n=(i=y0(e[0])?e[0]:y0(e[1])?e[1]:"function"==typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]}).error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class vt{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new y3(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return yV(this._delegate,e._delegate)}}class vn extends vt{data(e){let t=this._delegate.data(e);return void 0!==t||l0(),t}}class vr{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new y4(e)}where(e,t,n){try{return new vr(this.firestore,yw(this._delegate,function(e,t,n){let r=ym("where",e);return yb._create(r,t,n)}(e,t,n)))}catch(e){throw y8(e,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new vr(this.firestore,yw(this._delegate,function(e,t="asc"){let n=ym("orderBy",e);return yT._create(n,t)}(e,t)))}catch(e){throw y8(e,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new vr(this.firestore,yw(this._delegate,(mA("limit",e),yE._create("limit",e,"F"))))}catch(e){throw y8(e,"limit()","Query.limit()")}}limitToLast(e){try{return new vr(this.firestore,yw(this._delegate,(mA("limitToLast",e),yE._create("limitToLast",e,"L"))))}catch(e){throw y8(e,"limitToLast()","Query.limitToLast()")}}startAt(...e){try{return new vr(this.firestore,yw(this._delegate,function(...e){return yC._create("startAt",e,!0)}(...e)))}catch(e){throw y8(e,"startAt()","Query.startAt()")}}startAfter(...e){try{return new vr(this.firestore,yw(this._delegate,function(...e){return yC._create("startAfter",e,!1)}(...e)))}catch(e){throw y8(e,"startAfter()","Query.startAfter()")}}endBefore(...e){try{return new vr(this.firestore,yw(this._delegate,function(...e){return yS._create("endBefore",e,!1)}(...e)))}catch(e){throw y8(e,"endBefore()","Query.endBefore()")}}endAt(...e){try{return new vr(this.firestore,yw(this._delegate,function(...e){return yS._create("endAt",e,!0)}(...e)))}catch(e){throw y8(e,"endAt()","Query.endAt()")}}isEqual(e){return mV(this._delegate,e._delegate)}get(e){return((null==e?void 0:e.source)==="cache"?function(e){e=mx(e,mO);let t=mx(e.firestore,mz),n=m$(t),r=new yq(t);return(function(e,t){let n=new l4;return e.asyncQueue.enqueueAndForget(async()=>(async function(e,t,n){try{let r=await pm(e,t,!0),i=new gR(t,r.sr),s=i.nc(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(r){let e=gd(r,`Failed to execute query '${t} against cache`);n.reject(e)}})(await mm(e),t,n)),n.promise})(n,e._query).then(n=>new yU(t,r,e,n))}(this._delegate):(null==e?void 0:e.source)==="server"?function(e){e=mx(e,mO);let t=mx(e.firestore,mz),n=m$(t),r=new yq(t);return mb(n,e._query,{source:"server"}).then(n=>new yU(t,r,e,n))}(this._delegate):function(e){e=mx(e,mO);let t=mx(e.firestore,mz),n=m$(t),r=new yq(t);return yy(e._query),mb(n,e._query).then(n=>new yU(t,r,e,n))}(this._delegate)).then(e=>new vs(this.firestore,new yU(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)))}onSnapshot(...e){let t=y7(e),n=ve(e,e=>new vs(this.firestore,new yU(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot)));return yz(this._delegate,t,n)}withConverter(e){return new vr(this.firestore,e?this._delegate.withConverter(y6.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class vi{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new vn(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class vs{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new vr(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(e=>new vn(this._firestore,e))}docChanges(e){return this._delegate.docChanges(e).map(e=>new vi(this._firestore,e))}forEach(e,t){this._delegate.forEach(n=>{e.call(t,new vn(this._firestore,n))})}isEqual(e){return yV(this._delegate,e._delegate)}}class vo extends vr{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let e=this._delegate.parent;return e?new y3(this.firestore,e):null}doc(e){try{if(void 0===e)return new y3(this.firestore,mM(this._delegate));return new y3(this.firestore,mM(this._delegate,e))}catch(e){throw y8(e,"doc()","CollectionReference.doc()")}}add(e){return(function(e,t){let n=mx(e.firestore,mz),r=mM(e),i=yD(e.converter,t);return y$(n,[m5(m9(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,hW.exists(!1))]).then(()=>r)})(this._delegate,e).then(e=>new y3(this.firestore,e))}isEqual(e){return mU(this._delegate,e._delegate)}withConverter(e){return new vo(this.firestore,e?this._delegate.withConverter(y6.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(...e){this._delegate=new mZ(...e)}static documentId(){return new va(uc.keyField().canonicalString())}isEqual(e){return(e=(0,b.m9)(e))instanceof mZ&&this._delegate._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e){this._delegate=e}static serverTimestamp(){let e=new m8("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new vl(e)}static delete(){let e=new m6("deleteField");return e._methodName="FieldValue.delete",new vl(e)}static arrayUnion(...e){let t=function(...e){return new m7("arrayUnion",e)}(...e);return t._methodName="FieldValue.arrayUnion",new vl(t)}static arrayRemove(...e){let t=function(...e){return new ye("arrayRemove",e)}(...e);return t._methodName="FieldValue.arrayRemove",new vl(t)}static increment(e){let t=new yt("increment",e);return t._methodName="FieldValue.increment",new vl(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vu={Firestore:y2,GeoPoint:mY,Timestamp:us,Blob:yJ,Transaction:y9,WriteBatch:y5,DocumentReference:y3,DocumentSnapshot:vt,Query:vr,QueryDocumentSnapshot:vn,QuerySnapshot:vs,CollectionReference:vo,FieldPath:va,FieldValue:vl,setLogLevel:function(e){lK.setLogLevel(e)},CACHE_SIZE_UNLIMITED:-1};!function(e,t){e.INTERNAL.registerComponent(new I.wA("firestore-compat",e=>{let n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)},"PUBLIC").setServiceProps(Object.assign({},vu)))}(k,(e,t)=>new y2(e,t,new y1)),k.registerVersion("@firebase/firestore-compat","0.3.8");var vc=n(774);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vh{constructor(e,t,n){this._delegate=e,this.task=t,this.ref=n}get bytesTransferred(){return this._delegate.bytesTransferred}get metadata(){return this._delegate.metadata}get state(){return this._delegate.state}get totalBytes(){return this._delegate.totalBytes}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vd{constructor(e,t){this._delegate=e,this._ref=t,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}get snapshot(){return new vh(this._delegate.snapshot,this,this._ref)}then(e,t){return this._delegate.then(t=>{if(e)return e(new vh(t,this,this._ref))},t)}on(e,t,n,r){let i;return t&&(i="function"==typeof t?e=>t(new vh(e,this,this._ref)):{next:t.next?e=>t.next(new vh(e,this,this._ref)):void 0,complete:t.complete||void 0,error:t.error||void 0}),this._delegate.on(e,i,n||void 0,r||void 0)}}class vf{constructor(e,t){this._delegate=e,this._service=t}get prefixes(){return this._delegate.prefixes.map(e=>new vp(e,this._service))}get items(){return this._delegate.items.map(e=>new vp(e,this._service))}get nextPageToken(){return this._delegate.nextPageToken||null}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vp{constructor(e,t){this._delegate=e,this.storage=t}get name(){return this._delegate.name}get bucket(){return this._delegate.bucket}get fullPath(){return this._delegate.fullPath}toString(){return this._delegate.toString()}child(e){let t=(0,vc.g6)(this._delegate,e);return new vp(t,this.storage)}get root(){return new vp(this._delegate.root,this.storage)}get parent(){let e=this._delegate.parent;return null==e?null:new vp(e,this.storage)}put(e,t){return this._throwIfRoot("put"),new vd((0,vc.B0)(this._delegate,e,t),this)}putString(e,t=vc.bm.RAW,n){this._throwIfRoot("putString");let r=(0,vc.qm)(t,e),i=Object.assign({},n);return null==i.contentType&&null!=r.contentType&&(i.contentType=r.contentType),new vd(new vc.IX(this._delegate,new vc.UJ(r.data,!0),i),this)}listAll(){return(0,vc.aF)(this._delegate).then(e=>new vf(e,this.storage))}list(e){return(0,vc.pb)(this._delegate,e||void 0).then(e=>new vf(e,this.storage))}getMetadata(){return(0,vc.sd)(this._delegate)}updateMetadata(e){return(0,vc.Ym)(this._delegate,e)}getDownloadURL(){return(0,vc.Jt)(this._delegate)}delete(){return this._throwIfRoot("delete"),(0,vc.oq)(this._delegate)}_throwIfRoot(e){if(""===this._delegate._location.path)throw(0,vc.y4)(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vg{constructor(e,t){this.app=e,this._delegate=t}get maxOperationRetryTime(){return this._delegate.maxOperationRetryTime}get maxUploadRetryTime(){return this._delegate.maxUploadRetryTime}ref(e){if(vm(e))throw(0,vc.gH)("ref() expected a child path but got a URL, use refFromURL instead.");return new vp((0,vc.iH)(this._delegate,e),this)}refFromURL(e){if(!vm(e))throw(0,vc.gH)("refFromURL() expected a full URL but got a child path, use ref() instead.");try{vc.gE.makeFromUrl(e,this._delegate.host)}catch(e){throw(0,vc.gH)("refFromUrl() expected a valid full URL but got an invalid one.")}return new vp((0,vc.iH)(this._delegate,e),this)}setMaxUploadRetryTime(e){this._delegate.maxUploadRetryTime=e}setMaxOperationRetryTime(e){this._delegate.maxOperationRetryTime=e}useEmulator(e,t,n={}){(0,vc.a1)(this._delegate,e,t,n)}}function vm(e){return/^[A-Za-z]+:\/\//.test(e)}function vy(e,{instanceIdentifier:t}){let n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("storage").getImmediate({identifier:t}),i=new vg(n,r);return i}!function(e){let t={TaskState:vc.$Y,TaskEvent:vc.FN,StringFormat:vc.bm,Storage:vg,Reference:vp};e.INTERNAL.registerComponent(new I.wA("storage-compat",vy,"PUBLIC").setServiceProps(t).setMultipleInstances(!0)),e.registerVersion("@firebase/storage-compat","0.3.2")}(k);var vv=n(6845),v_=n(1259);let vw=k.initializeApp({apiKey:"AIzaSyA_0GPDiKi_3SK3clG1TvIxAxwvffmVbus",authDomain:"todolist-dcc0a.firebaseapp.com",projectId:"todolist-dcc0a",storageBucket:"todolist-dcc0a.appspot.com",messagingSenderId:"196415986511",appId:"1:196415986511:web:2d4f2a4d02f3261e14c33a"}),vb=(0,v_.v0)();!function(e,t){let n="object"==typeof e?e:(0,T.getApp)(),r=(0,T._getProvider)(n,"firestore").getImmediate({identifier:"string"==typeof e?e:"(default)"});if(!r._initialized){let e=(0,b.P0)("firestore");e&&mP(r,...e)}}();let vI=(0,vv.cF)(vw);function vT(e,t){return new Promise(function(n,r){try{vw.firestore().collection(e).add(t).then(r=>{var i,s;(i={...t,idPost:r.id},s=r.id,new Promise(function(t,n){try{vw.firestore().collection(e).doc(s).update(i).then(e=>{t({result:e})}).catch(e=>{n(e)})}catch(e){n(e)}})).then(e=>console.info(e)).catch(e=>console.error(e)),n({result:r})}).catch(e=>{r(e)})}catch(e){r(e)}})}let vE=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;try{let n=await vw.firestore().collection(e).limit(t).get(),r=[];return n.forEach(e=>{r.push({idPost:e.id,...e.data()})}),r}catch(e){throw Error(e)}};function vC(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:16;return new Promise(function(i,s){vw.firestore().collection(e).orderBy(t).startAt(n).endAt(n+"~").limit(r).get().then(e=>{let t=[];e.forEach(e=>{t.push({idPost:e.id,...e.data()})}),i(t)}).catch(e=>{s(e)})})}},3478:function(e,t,n){"use strict";n.d(t,{SE:function(){return l},fS:function(){return u}});var r=n(5893),i=n(1259),s=n(7294),o=n(4076);let a=(0,s.createContext)({}),l=()=>(0,s.useContext)(a),u=e=>{let{children:t}=e,[n,l]=(0,s.useState)(null),[u,c]=(0,s.useState)(!0),[h,d]=(0,s.useState)("");(0,s.useEffect)(()=>(0,i.Aj)(o.I8,e=>{l(e||null),c(!1)}),[]);let f=(0,s.useMemo)(()=>({user:n,loading:u,error:h}),[h,u,n]);return(0,r.jsx)(a.Provider,{value:f,children:t})}},8375:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return o}});var r=n(5893);n(7952);var i=n(3830),s=n(3478);function o(e){let{Component:t,pageProps:n}=e;return(0,r.jsx)(i.ZP,{theme:{token:{colorPrimary:"#00b96b"}},children:(0,r.jsx)(s.fS,{children:(0,r.jsx)(t,{...n})})})}},7952:function(){},7663:function(e){!function(){var t={229:function(e){var t,n,r,i=e.exports={};function s(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function a(e){if(t===setTimeout)return setTimeout(e,0);if((t===s||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:s}catch(e){t=s}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l=[],u=!1,c=-1;function h(){u&&r&&(u=!1,r.length?l=r.concat(l):c=-1,l.length&&d())}function d(){if(!u){var e=a(h);u=!0;for(var t=l.length;t;){for(r=l,l=[];++c<t;)r&&r[c].run();c=-1,t=l.length}r=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];l.push(new f(e,t)),1!==l.length||u||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw Error("process.chdir is not supported")},i.umask=function(){return 0}}},n={};function r(e){var i=n[e];if(void 0!==i)return i.exports;var s=n[e]={exports:{}},o=!0;try{t[e](s,s.exports,r),o=!1}finally{o&&delete n[e]}return s.exports}r.ab="//";var i=r(229);e.exports=i}()},8335:function(e,t,n){"use strict";n.d(t,{gN:function(){return eu},zb:function(){return _},RV:function(){return eI},aV:function(){return ec},ZM:function(){return w},ZP:function(){return ex},cI:function(){return ew},qo:function(){return eS}});var r,i=n(7294),s=n(7462),o=n(91),a=n(4942),l=n(1413),u=n(4902),c=n(5671),h=n(3144),d=n(7326),f=n(2531),p=n(3568),g=n(344),m=n(334),y="RC_FORM_INTERNAL_HOOKS",v=function(){(0,m.ZP)(!1,"Can not find FormContext. Please make sure you wrap Field under Form.")},_=i.createContext({getFieldValue:v,getFieldsValue:v,getFieldError:v,getFieldWarning:v,getFieldsError:v,isFieldsTouched:v,isFieldTouched:v,isFieldValidating:v,isFieldsValidating:v,resetFields:v,setFields:v,setFieldValue:v,setFieldsValue:v,validateFields:v,submit:v,getInternalHooks:function(){return v(),{dispatch:v,initEntityValue:v,registerField:v,useSubscribe:v,setInitialValues:v,destroyForm:v,setCallbacks:v,registerWatch:v,getFields:v,setValidateMessages:v,setPreserve:v,getInitialValue:v}}}),w=i.createContext(null),b=n(3409),I=n(4165),T=n(5861),E=n(3454);function C(){return(C=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e,t){return(k=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function x(e,t,n){return(x=!function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&k(i,n.prototype),i}:Reflect.construct.bind()).apply(null,arguments)}function A(e){var t="function"==typeof Map?new Map:void 0;return(A=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return x(e,arguments,S(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),k(n,e)})(e)}var R=/%[sdj%]/g;function N(e){if(!e||!e.length)return null;var t={};return e.forEach(function(e){var n=e.field;t[n]=t[n]||[],t[n].push(e)}),t}function P(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,s=n.length;return"function"==typeof e?e.apply(null,n):"string"==typeof e?e.replace(R,function(e){if("%%"===e)return"%";if(i>=s)return e;switch(e){case"%s":return String(n[i++]);case"%d":return Number(n[i++]);case"%j":try{return JSON.stringify(n[i++])}catch(e){return"[Circular]"}break;default:return e}}):e}function D(e,t){return!!(null==e||"array"===t&&Array.isArray(e)&&!e.length)||("string"===t||"url"===t||"hex"===t||"email"===t||"date"===t||"pattern"===t)&&"string"==typeof e&&!e}function O(e,t,n){var r=0,i=e.length;!function s(o){if(o&&o.length){n(o);return}var a=r;r+=1,a<i?t(e[a],s):n([])}([])}void 0!==E&&E.env;var F=function(e){var t;function n(t,n){var r;return(r=e.call(this,"Async Validation Error")||this).errors=t,r.fields=n,r}return(t=n).prototype=Object.create(e.prototype),t.prototype.constructor=t,k(t,e),n}(A(Error));function L(e,t){return function(n){var r;return(r=e.fullFields?function(e,t){for(var n=e,r=0;r<t.length&&void 0!=n;r++)n=n[t[r]];return n}(t,e.fullFields):t[n.field||e.fullField],n&&void 0!==n.message)?(n.field=n.field||e.fullField,n.fieldValue=r,n):{message:"function"==typeof n?n():n,fieldValue:r,field:n.field||e.fullField}}}function M(e,t){if(t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];"object"==typeof r&&"object"==typeof e[n]?e[n]=C({},e[n],r):e[n]=r}}return e}var U=function(e,t,n,r,i,s){e.required&&(!n.hasOwnProperty(e.field)||D(t,s||e.type))&&r.push(P(i.messages.required,e.fullField))},V=function(){if(r)return r;var e="[a-fA-F\\d:]",t=function(t){return t&&t.includeBoundaries?"(?:(?<=\\s|^)(?="+e+")|(?<="+e+")(?=\\s|$))":""},n="(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)(?:\\.(?:25[0-5]|2[0-4]\\d|1\\d\\d|[1-9]\\d|\\d)){3}",i="[a-fA-F\\d]{1,4}",s=("\n(?:\n(?:"+i+":){7}(?:"+i+"|:)|                                    // 1:2:3:4:5:6:7::  1:2:3:4:5:6:7:8\n(?:"+i+":){6}(?:"+n+"|:"+i+"|:)|                             // 1:2:3:4:5:6::    1:2:3:4:5:6::8   1:2:3:4:5:6::8  1:2:3:4:5:6::1.2.3.4\n(?:"+i+":){5}(?::"+n+"|(?::"+i+"){1,2}|:)|                   // 1:2:3:4:5::      1:2:3:4:5::7:8   1:2:3:4:5::8    1:2:3:4:5::7:1.2.3.4\n(?:"+i+":){4}(?:(?::"+i+"){0,1}:"+n+"|(?::"+i+"){1,3}|:)| // 1:2:3:4::        1:2:3:4::6:7:8   1:2:3:4::8      1:2:3:4::6:7:1.2.3.4\n(?:"+i+":){3}(?:(?::"+i+"){0,2}:"+n+"|(?::"+i+"){1,4}|:)| // 1:2:3::          1:2:3::5:6:7:8   1:2:3::8        1:2:3::5:6:7:1.2.3.4\n(?:"+i+":){2}(?:(?::"+i+"){0,3}:"+n+"|(?::"+i+"){1,5}|:)| // 1:2::            1:2::4:5:6:7:8   1:2::8          1:2::4:5:6:7:1.2.3.4\n(?:"+i+":){1}(?:(?::"+i+"){0,4}:"+n+"|(?::"+i+"){1,6}|:)| // 1::              1::3:4:5:6:7:8   1::8            1::3:4:5:6:7:1.2.3.4\n(?::(?:(?::"+i+"){0,5}:"+n+"|(?::"+i+"){1,7}|:))             // ::2:3:4:5:6:7:8  ::2:3:4:5:6:7:8  ::8             ::1.2.3.4\n)(?:%[0-9a-zA-Z]{1,})?                                             // %eth0            %1\n").replace(/\s*\/\/.*$/gm,"").replace(/\n/g,"").trim(),o=RegExp("(?:^"+n+"$)|(?:^"+s+"$)"),a=RegExp("^"+n+"$"),l=RegExp("^"+s+"$"),u=function(e){return e&&e.exact?o:RegExp("(?:"+t(e)+n+t(e)+")|(?:"+t(e)+s+t(e)+")","g")};return u.v4=function(e){return e&&e.exact?a:RegExp(""+t(e)+n+t(e),"g")},u.v6=function(e){return e&&e.exact?l:RegExp(""+t(e)+s+t(e),"g")},r=RegExp("(?:^"+("(?:(?:(?:[a-z]+:)?//)|www\\.)(?:\\S+(?::\\S*)?@)?(?:localhost|"+u.v4().source+"|")+u.v6().source+'|(?:(?:[a-z\\u00a1-\\uffff0-9][-_]*)*[a-z\\u00a1-\\uffff0-9]+)(?:\\.(?:[a-z\\u00a1-\\uffff0-9]-*)*[a-z\\u00a1-\\uffff0-9]+)*(?:\\.(?:[a-z\\u00a1-\\uffff]{2,})))(?::\\d{2,5})?(?:[/?#][^\\s"]*)?$)',"i")},q={email:/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+\.)+[a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]{2,}))$/,hex:/^#?([a-f0-9]{6}|[a-f0-9]{3})$/i},j={integer:function(e){return j.number(e)&&parseInt(e,10)===e},float:function(e){return j.number(e)&&!j.integer(e)},array:function(e){return Array.isArray(e)},regexp:function(e){if(e instanceof RegExp)return!0;try{return new RegExp(e),!0}catch(e){return!1}},date:function(e){return"function"==typeof e.getTime&&"function"==typeof e.getMonth&&"function"==typeof e.getYear&&!isNaN(e.getTime())},number:function(e){return!isNaN(e)&&"number"==typeof e},object:function(e){return"object"==typeof e&&!j.array(e)},method:function(e){return"function"==typeof e},email:function(e){return"string"==typeof e&&e.length<=320&&!!e.match(q.email)},url:function(e){return"string"==typeof e&&e.length<=2048&&!!e.match(V())},hex:function(e){return"string"==typeof e&&!!e.match(q.hex)}},B="enum",z={required:U,whitespace:function(e,t,n,r,i){(/^\s+$/.test(t)||""===t)&&r.push(P(i.messages.whitespace,e.fullField))},type:function(e,t,n,r,i){if(e.required&&void 0===t){U(e,t,n,r,i);return}var s=e.type;["integer","float","array","regexp","object","method","email","number","date","url","hex"].indexOf(s)>-1?j[s](t)||r.push(P(i.messages.types[s],e.fullField,e.type)):s&&typeof t!==e.type&&r.push(P(i.messages.types[s],e.fullField,e.type))},range:function(e,t,n,r,i){var s="number"==typeof e.len,o="number"==typeof e.min,a="number"==typeof e.max,l=t,u=null,c="string"==typeof t,h=Array.isArray(t);if("number"==typeof t?u="number":c?u="string":h&&(u="array"),!u)return!1;h&&(l=t.length),c&&(l=t.replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"_").length),s?l!==e.len&&r.push(P(i.messages[u].len,e.fullField,e.len)):o&&!a&&l<e.min?r.push(P(i.messages[u].min,e.fullField,e.min)):a&&!o&&l>e.max?r.push(P(i.messages[u].max,e.fullField,e.max)):o&&a&&(l<e.min||l>e.max)&&r.push(P(i.messages[u].range,e.fullField,e.min,e.max))},enum:function(e,t,n,r,i){e[B]=Array.isArray(e[B])?e[B]:[],-1===e[B].indexOf(t)&&r.push(P(i.messages[B],e.fullField,e[B].join(", ")))},pattern:function(e,t,n,r,i){!e.pattern||(e.pattern instanceof RegExp?(e.pattern.lastIndex=0,e.pattern.test(t)||r.push(P(i.messages.pattern.mismatch,e.fullField,t,e.pattern))):"string"!=typeof e.pattern||new RegExp(e.pattern).test(t)||r.push(P(i.messages.pattern.mismatch,e.fullField,t,e.pattern)))}},$=function(e,t,n,r,i){var s=e.type,o=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t,s)&&!e.required)return n();z.required(e,t,r,o,i,s),D(t,s)||z.type(e,t,r,o,i)}n(o)},H={string:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t,"string")&&!e.required)return n();z.required(e,t,r,s,i,"string"),D(t,"string")||(z.type(e,t,r,s,i),z.range(e,t,r,s,i),z.pattern(e,t,r,s,i),!0===e.whitespace&&z.whitespace(e,t,r,s,i))}n(s)},method:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t)&&!e.required)return n();z.required(e,t,r,s,i),void 0!==t&&z.type(e,t,r,s,i)}n(s)},number:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(""===t&&(t=void 0),D(t)&&!e.required)return n();z.required(e,t,r,s,i),void 0!==t&&(z.type(e,t,r,s,i),z.range(e,t,r,s,i))}n(s)},boolean:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t)&&!e.required)return n();z.required(e,t,r,s,i),void 0!==t&&z.type(e,t,r,s,i)}n(s)},regexp:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t)&&!e.required)return n();z.required(e,t,r,s,i),D(t)||z.type(e,t,r,s,i)}n(s)},integer:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t)&&!e.required)return n();z.required(e,t,r,s,i),void 0!==t&&(z.type(e,t,r,s,i),z.range(e,t,r,s,i))}n(s)},float:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t)&&!e.required)return n();z.required(e,t,r,s,i),void 0!==t&&(z.type(e,t,r,s,i),z.range(e,t,r,s,i))}n(s)},array:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(null==t&&!e.required)return n();z.required(e,t,r,s,i,"array"),null!=t&&(z.type(e,t,r,s,i),z.range(e,t,r,s,i))}n(s)},object:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t)&&!e.required)return n();z.required(e,t,r,s,i),void 0!==t&&z.type(e,t,r,s,i)}n(s)},enum:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t)&&!e.required)return n();z.required(e,t,r,s,i),void 0!==t&&z.enum(e,t,r,s,i)}n(s)},pattern:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t,"string")&&!e.required)return n();z.required(e,t,r,s,i),D(t,"string")||z.pattern(e,t,r,s,i)}n(s)},date:function(e,t,n,r,i){var s,o=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t,"date")&&!e.required)return n();z.required(e,t,r,o,i),!D(t,"date")&&(s=t instanceof Date?t:new Date(t),z.type(e,s,r,o,i),s&&z.range(e,s.getTime(),r,o,i))}n(o)},url:$,hex:$,email:$,required:function(e,t,n,r,i){var s=[],o=Array.isArray(t)?"array":typeof t;z.required(e,t,r,s,i,o),n(s)},any:function(e,t,n,r,i){var s=[];if(e.required||!e.required&&r.hasOwnProperty(e.field)){if(D(t)&&!e.required)return n();z.required(e,t,r,s,i)}n(s)}};function W(){return{default:"Validation error on field %s",required:"%s is required",enum:"%s must be one of %s",whitespace:"%s cannot be empty",date:{format:"%s date %s is invalid for format %s",parse:"%s date could not be parsed, %s is invalid ",invalid:"%s date %s is invalid"},types:{string:"%s is not a %s",method:"%s is not a %s (function)",array:"%s is not an %s",object:"%s is not an %s",number:"%s is not a %s",date:"%s is not a %s",boolean:"%s is not a %s",integer:"%s is not an %s",float:"%s is not a %s",regexp:"%s is not a valid %s",email:"%s is not a valid %s",url:"%s is not a valid %s",hex:"%s is not a valid %s"},string:{len:"%s must be exactly %s characters",min:"%s must be at least %s characters",max:"%s cannot be longer than %s characters",range:"%s must be between %s and %s characters"},number:{len:"%s must equal %s",min:"%s cannot be less than %s",max:"%s cannot be greater than %s",range:"%s must be between %s and %s"},array:{len:"%s must be exactly %s in length",min:"%s cannot be less than %s in length",max:"%s cannot be greater than %s in length",range:"%s must be between %s and %s in length"},pattern:{mismatch:"%s value %s does not match pattern %s"},clone:function(){var e=JSON.parse(JSON.stringify(this));return e.clone=this.clone,e}}}var G=W(),K=function(){function e(e){this.rules=null,this._messages=G,this.define(e)}var t=e.prototype;return t.define=function(e){var t=this;if(!e)throw Error("Cannot configure a schema with no rules");if("object"!=typeof e||Array.isArray(e))throw Error("Rules must be an object");this.rules={},Object.keys(e).forEach(function(n){var r=e[n];t.rules[n]=Array.isArray(r)?r:[r]})},t.messages=function(e){return e&&(this._messages=M(W(),e)),this._messages},t.validate=function(t,n,r){var i=this;void 0===n&&(n={}),void 0===r&&(r=function(){});var s=t,o=n,a=r;if("function"==typeof o&&(a=o,o={}),!this.rules||0===Object.keys(this.rules).length)return a&&a(null,s),Promise.resolve(s);if(o.messages){var l=this.messages();l===G&&(l=W()),M(l,o.messages),o.messages=l}else o.messages=this.messages();var u={};(o.keys||Object.keys(this.rules)).forEach(function(e){var n=i.rules[e],r=s[e];n.forEach(function(n){var o=n;"function"==typeof o.transform&&(s===t&&(s=C({},s)),r=s[e]=o.transform(r)),(o="function"==typeof o?{validator:o}:C({},o)).validator=i.getValidationMethod(o),o.validator&&(o.field=e,o.fullField=o.fullField||e,o.type=i.getType(o),u[e]=u[e]||[],u[e].push({rule:o,value:r,source:s,field:e}))})});var c={};return function(e,t,n,r,i){if(t.first){var s=new Promise(function(t,s){var o;O((o=[],Object.keys(e).forEach(function(t){o.push.apply(o,e[t]||[])}),o),n,function(e){return r(e),e.length?s(new F(e,N(e))):t(i)})});return s.catch(function(e){return e}),s}var o=!0===t.firstFields?Object.keys(e):t.firstFields||[],a=Object.keys(e),l=a.length,u=0,c=[],h=new Promise(function(t,s){var h=function(e){if(c.push.apply(c,e),++u===l)return r(c),c.length?s(new F(c,N(c))):t(i)};a.length||(r(c),t(i)),a.forEach(function(t){var r=e[t];-1!==o.indexOf(t)?O(r,n,h):function(e,t,n){var r=[],i=0,s=e.length;function o(e){r.push.apply(r,e||[]),++i===s&&n(r)}e.forEach(function(e){t(e,o)})}(r,n,h)})});return h.catch(function(e){return e}),h}(u,o,function(t,n){var r,i=t.rule,a=("object"===i.type||"array"===i.type)&&("object"==typeof i.fields||"object"==typeof i.defaultField);function l(e,t){return C({},t,{fullField:i.fullField+"."+e,fullFields:i.fullFields?[].concat(i.fullFields,[e]):[e]})}function u(r){void 0===r&&(r=[]);var u=Array.isArray(r)?r:[r];!o.suppressWarning&&u.length&&e.warning("async-validator:",u),u.length&&void 0!==i.message&&(u=[].concat(i.message));var h=u.map(L(i,s));if(o.first&&h.length)return c[i.field]=1,n(h);if(a){if(i.required&&!t.value)return void 0!==i.message?h=[].concat(i.message).map(L(i,s)):o.error&&(h=[o.error(i,P(o.messages.required,i.field))]),n(h);var d={};i.defaultField&&Object.keys(t.value).map(function(e){d[e]=i.defaultField});var f={};Object.keys(d=C({},d,t.rule.fields)).forEach(function(e){var t=d[e],n=Array.isArray(t)?t:[t];f[e]=n.map(l.bind(null,e))});var p=new e(f);p.messages(o.messages),t.rule.options&&(t.rule.options.messages=o.messages,t.rule.options.error=o.error),p.validate(t.value,t.rule.options||o,function(e){var t=[];h&&h.length&&t.push.apply(t,h),e&&e.length&&t.push.apply(t,e),n(t.length?t:null)})}else n(h)}if(a=a&&(i.required||!i.required&&t.value),i.field=t.field,i.asyncValidator)r=i.asyncValidator(i,t.value,u,t.source,o);else if(i.validator){try{r=i.validator(i,t.value,u,t.source,o)}catch(e){null==console.error||console.error(e),o.suppressValidatorError||setTimeout(function(){throw e},0),u(e.message)}!0===r?u():!1===r?u("function"==typeof i.message?i.message(i.fullField||i.field):i.message||(i.fullField||i.field)+" fails"):r instanceof Array?u(r):r instanceof Error&&u(r.message)}r&&r.then&&r.then(function(){return u()},function(e){return u(e)})},function(e){!function(e){for(var t=[],n={},r=0;r<e.length;r++)!function(e){if(Array.isArray(e)){var n;t=(n=t).concat.apply(n,e)}else t.push(e)}(e[r]);t.length?(n=N(t),a(t,n)):a(null,s)}(e)},s)},t.getType=function(e){if(void 0===e.type&&e.pattern instanceof RegExp&&(e.type="pattern"),"function"!=typeof e.validator&&e.type&&!H.hasOwnProperty(e.type))throw Error(P("Unknown rule type %s",e.type));return e.type||"string"},t.getValidationMethod=function(e){if("function"==typeof e.validator)return e.validator;var t=Object.keys(e),n=t.indexOf("message");return(-1!==n&&t.splice(n,1),1===t.length&&"required"===t[0])?H.required:H[this.getType(e)]||void 0},e}();K.register=function(e,t){if("function"!=typeof t)throw Error("Cannot register a validator by type, validator is not a function");H[e]=t},K.warning=function(){},K.messages=G,K.validators=H;var Z="'${name}' is not a valid ${type}",Q={default:"Validation error on field '${name}'",required:"'${name}' is required",enum:"'${name}' must be one of [${enum}]",whitespace:"'${name}' cannot be empty",date:{format:"'${name}' is invalid for format date",parse:"'${name}' could not be parsed as date",invalid:"'${name}' is invalid date"},types:{string:Z,method:Z,array:Z,object:Z,number:Z,date:Z,boolean:Z,integer:Z,float:Z,regexp:Z,email:Z,url:Z,hex:Z},string:{len:"'${name}' must be exactly ${len} characters",min:"'${name}' must be at least ${min} characters",max:"'${name}' cannot be longer than ${max} characters",range:"'${name}' must be between ${min} and ${max} characters"},number:{len:"'${name}' must equal ${len}",min:"'${name}' cannot be less than ${min}",max:"'${name}' cannot be greater than ${max}",range:"'${name}' must be between ${min} and ${max}"},array:{len:"'${name}' must be exactly ${len} in length",min:"'${name}' cannot be less than ${min} in length",max:"'${name}' cannot be greater than ${max} in length",range:"'${name}' must be between ${min} and ${max} in length"},pattern:{mismatch:"'${name}' does not match pattern ${pattern}"}},Y=n(3236),X=K,J="CODE_LOGIC_ERROR";function ee(e,t,n,r,i){return et.apply(this,arguments)}function et(){return(et=(0,T.Z)((0,I.Z)().mark(function e(t,n,r,s,o){var c,h,d,f,p,g,m,y,v;return(0,I.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return c=(0,l.Z)({},r),delete c.ruleIndex,X.warning=function(){},c.validator&&(h=c.validator,c.validator=function(){try{return h.apply(void 0,arguments)}catch(e){return console.error(e),Promise.reject(J)}}),d=null,c&&"array"===c.type&&c.defaultField&&(d=c.defaultField,delete c.defaultField),f=new X((0,a.Z)({},t,[c])),p=(0,Y.gg)({},Q,s.validateMessages),f.messages(p),g=[],e.prev=10,e.next=13,Promise.resolve(f.validate((0,a.Z)({},t,n),(0,l.Z)({},s)));case 13:e.next=18;break;case 15:e.prev=15,e.t0=e.catch(10),e.t0.errors&&(g=e.t0.errors.map(function(e,t){var n=e.message,r=n===J?p.default:n;return i.isValidElement(r)?i.cloneElement(r,{key:"error_".concat(t)}):r}));case 18:if(!(!g.length&&d)){e.next=23;break}return e.next=21,Promise.all(n.map(function(e,n){return ee("".concat(t,".").concat(n),e,d,s,o)}));case 21:return m=e.sent,e.abrupt("return",m.reduce(function(e,t){return[].concat((0,u.Z)(e),(0,u.Z)(t))},[]));case 23:return y=(0,l.Z)((0,l.Z)({},r),{},{name:t,enum:(r.enum||[]).join(", ")},o),v=g.map(function(e){return"string"==typeof e?function(e,t){return e.replace(/\$\{\w+\}/g,function(e){return t[e.slice(2,-1)]})}(e,y):e}),e.abrupt("return",v);case 26:case"end":return e.stop()}},e,null,[[10,15]])}))).apply(this,arguments)}function en(){return(en=(0,T.Z)((0,I.Z)().mark(function e(t){return(0,I.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.all(t).then(function(e){var t;return(t=[]).concat.apply(t,(0,u.Z)(e))}));case 1:case"end":return e.stop()}},e)}))).apply(this,arguments)}function er(){return(er=(0,T.Z)((0,I.Z)().mark(function e(t){var n;return(0,I.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=0,e.abrupt("return",new Promise(function(e){t.forEach(function(r){r.then(function(r){r.errors.length&&e([r]),(n+=1)===t.length&&e([])})})}));case 2:case"end":return e.stop()}},e)}))).apply(this,arguments)}var ei=n(8306),es=["name"],eo=[];function ea(e,t,n,r,i,s){return"function"==typeof e?e(t,n,"source"in s?{source:s.source}:{}):r!==i}var el=function(e){(0,f.Z)(n,e);var t=(0,p.Z)(n);function n(e){var r;return(0,c.Z)(this,n),(r=t.call(this,e)).state={resetCount:0},r.cancelRegisterFunc=null,r.mounted=!1,r.touched=!1,r.dirty=!1,r.validatePromise=void 0,r.prevValidating=void 0,r.errors=eo,r.warnings=eo,r.cancelRegister=function(){var e=r.props,t=e.preserve,n=e.isListField,i=e.name;r.cancelRegisterFunc&&r.cancelRegisterFunc(n,t,(0,Y.gU)(i)),r.cancelRegisterFunc=null},r.getNamePath=function(){var e=r.props,t=e.name,n=e.fieldContext.prefixName;return void 0!==t?[].concat((0,u.Z)(void 0===n?[]:n),(0,u.Z)(t)):[]},r.getRules=function(){var e=r.props,t=e.rules,n=e.fieldContext;return(void 0===t?[]:t).map(function(e){return"function"==typeof e?e(n):e})},r.refresh=function(){r.mounted&&r.setState(function(e){return{resetCount:e.resetCount+1}})},r.triggerMetaEvent=function(e){var t=r.props.onMetaChange;null==t||t((0,l.Z)((0,l.Z)({},r.getMeta()),{},{destroy:e}))},r.onStoreChange=function(e,t,n){var i=r.props,s=i.shouldUpdate,o=i.dependencies,a=void 0===o?[]:o,l=i.onReset,u=n.store,c=r.getNamePath(),h=r.getValue(e),d=r.getValue(u),f=t&&(0,Y.T1)(t,c);switch("valueUpdate"===n.type&&"external"===n.source&&h!==d&&(r.touched=!0,r.dirty=!0,r.validatePromise=null,r.errors=eo,r.warnings=eo,r.triggerMetaEvent()),n.type){case"reset":if(!t||f){r.touched=!1,r.dirty=!1,r.validatePromise=void 0,r.errors=eo,r.warnings=eo,r.triggerMetaEvent(),null==l||l(),r.refresh();return}break;case"remove":if(s){r.reRender();return}break;case"setField":if(f){var p=n.data;"touched"in p&&(r.touched=p.touched),"validating"in p&&!("originRCField"in p)&&(r.validatePromise=p.validating?Promise.resolve([]):null),"errors"in p&&(r.errors=p.errors||eo),"warnings"in p&&(r.warnings=p.warnings||eo),r.dirty=!0,r.triggerMetaEvent(),r.reRender();return}if(s&&!c.length&&ea(s,e,u,h,d,n)){r.reRender();return}break;case"dependenciesUpdate":if(a.map(Y.gU).some(function(e){return(0,Y.T1)(n.relatedFields,e)})){r.reRender();return}break;default:if(f||(!a.length||c.length||s)&&ea(s,e,u,h,d,n)){r.reRender();return}}!0===s&&r.reRender()},r.validateRules=function(e){var t=r.getNamePath(),n=r.getValue(),i=Promise.resolve().then(function(){if(!r.mounted)return[];var s=r.props,o=s.validateFirst,a=s.messageVariables,c=(e||{}).triggerName,h=r.getRules();c&&(h=h.filter(function(e){return e}).filter(function(e){var t=e.validateTrigger;return!t||(0,b.q)(t).includes(c)}));var d=function(e,t,n,r,i,s){var o,a,u=e.join("."),c=n.map(function(e,t){var n=e.validator,r=(0,l.Z)((0,l.Z)({},e),{},{ruleIndex:t});return n&&(r.validator=function(e,t,r){var i=!1,s=n(e,t,function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];Promise.resolve().then(function(){(0,m.ZP)(!i,"Your validator function has already return a promise. `callback` will be ignored."),i||r.apply(void 0,t)})});i=s&&"function"==typeof s.then&&"function"==typeof s.catch,(0,m.ZP)(i,"`callback` is deprecated. Please return a promise instead."),i&&s.then(function(){r()}).catch(function(e){r(e||" ")})}),r}).sort(function(e,t){var n=e.warningOnly,r=e.ruleIndex,i=t.warningOnly,s=t.ruleIndex;return!!n==!!i?r-s:n?1:-1});if(!0===i)a=new Promise((o=(0,T.Z)((0,I.Z)().mark(function e(n,i){var o,a,l;return(0,I.Z)().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:o=0;case 1:if(!(o<c.length)){e.next=12;break}return a=c[o],e.next=5,ee(u,t,a,r,s);case 5:if(!(l=e.sent).length){e.next=9;break}return i([{errors:l,rule:a}]),e.abrupt("return");case 9:o+=1,e.next=1;break;case 12:n([]);case 13:case"end":return e.stop()}},e)})),function(e,t){return o.apply(this,arguments)}));else{var h=c.map(function(e){return ee(u,t,e,r,s).then(function(t){return{errors:t,rule:e}})});a=(i?function(e){return er.apply(this,arguments)}(h):function(e){return en.apply(this,arguments)}(h)).then(function(e){return Promise.reject(e)})}return a.catch(function(e){return e}),a}(t,n,h,e,void 0!==o&&o,a);return d.catch(function(e){return e}).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:eo;if(r.validatePromise===i){r.validatePromise=null;var t,n=[],s=[];null===(t=e.forEach)||void 0===t||t.call(e,function(e){var t=e.rule.warningOnly,r=e.errors,i=void 0===r?eo:r;t?s.push.apply(s,(0,u.Z)(i)):n.push.apply(n,(0,u.Z)(i))}),r.errors=n,r.warnings=s,r.triggerMetaEvent(),r.reRender()}}),d});return r.validatePromise=i,r.dirty=!0,r.errors=eo,r.warnings=eo,r.triggerMetaEvent(),r.reRender(),i},r.isFieldValidating=function(){return!!r.validatePromise},r.isFieldTouched=function(){return r.touched},r.isFieldDirty=function(){return!!r.dirty||void 0!==r.props.initialValue||void 0!==(0,r.props.fieldContext.getInternalHooks(y).getInitialValue)(r.getNamePath())},r.getErrors=function(){return r.errors},r.getWarnings=function(){return r.warnings},r.isListField=function(){return r.props.isListField},r.isList=function(){return r.props.isList},r.isPreserve=function(){return r.props.preserve},r.getMeta=function(){return r.prevValidating=r.isFieldValidating(),{touched:r.isFieldTouched(),validating:r.prevValidating,errors:r.errors,warnings:r.warnings,name:r.getNamePath(),validated:null===r.validatePromise}},r.getOnlyChild=function(e){if("function"==typeof e){var t=r.getMeta();return(0,l.Z)((0,l.Z)({},r.getOnlyChild(e(r.getControlled(),t,r.props.fieldContext))),{},{isFunction:!0})}var n=(0,g.Z)(e);return 1===n.length&&i.isValidElement(n[0])?{child:n[0],isFunction:!1}:{child:n,isFunction:!1}},r.getValue=function(e){var t=r.props.fieldContext.getFieldsValue,n=r.getNamePath();return(0,ei.Z)(e||t(!0),n)},r.getControlled=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=r.props,n=t.trigger,i=t.validateTrigger,s=t.getValueFromEvent,o=t.normalize,u=t.valuePropName,c=t.getValueProps,h=t.fieldContext,d=void 0!==i?i:h.validateTrigger,f=r.getNamePath(),p=h.getInternalHooks,g=h.getFieldsValue,m=p(y).dispatch,v=r.getValue(),_=e[n],w=(0,l.Z)((0,l.Z)({},e),(c||function(e){return(0,a.Z)({},u,e)})(v));return w[n]=function(){r.touched=!0,r.dirty=!0,r.triggerMetaEvent();for(var e,t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];e=s?s.apply(void 0,n):Y.iZ.apply(void 0,[u].concat(n)),o&&(e=o(e,v,g(!0))),m({type:"updateValue",namePath:f,value:e}),_&&_.apply(void 0,n)},(0,b.q)(d||[]).forEach(function(e){var t=w[e];w[e]=function(){t&&t.apply(void 0,arguments);var n=r.props.rules;n&&n.length&&m({type:"validateField",namePath:f,triggerName:e})}}),w},e.fieldContext&&(0,(0,e.fieldContext.getInternalHooks)(y).initEntityValue)((0,d.Z)(r)),r}return(0,h.Z)(n,[{key:"componentDidMount",value:function(){var e=this.props,t=e.shouldUpdate,n=e.fieldContext;if(this.mounted=!0,n){var r=(0,n.getInternalHooks)(y).registerField;this.cancelRegisterFunc=r(this)}!0===t&&this.reRender()}},{key:"componentWillUnmount",value:function(){this.cancelRegister(),this.triggerMetaEvent(!0),this.mounted=!1}},{key:"reRender",value:function(){this.mounted&&this.forceUpdate()}},{key:"render",value:function(){var e,t=this.state.resetCount,n=this.props.children,r=this.getOnlyChild(n),s=r.child;return r.isFunction?e=s:i.isValidElement(s)?e=i.cloneElement(s,this.getControlled(s.props)):((0,m.ZP)(!s,"`children` of Field is not validate ReactElement."),e=s),i.createElement(i.Fragment,{key:t},e)}}]),n}(i.Component);el.contextType=_,el.defaultProps={trigger:"onChange",valuePropName:"value"};var eu=function(e){var t=e.name,n=(0,o.Z)(e,es),r=i.useContext(_),a=i.useContext(w),l=void 0!==t?(0,Y.gU)(t):void 0,u="keep";return n.isListField||(u="_".concat((l||[]).join("_"))),i.createElement(el,(0,s.Z)({key:u,name:l,isListField:!!a},n,{fieldContext:r}))},ec=function(e){var t=e.name,n=e.initialValue,r=e.children,s=e.rules,o=e.validateTrigger,a=e.isListField,c=i.useContext(_),h=i.useContext(w),d=i.useRef({keys:[],id:0}).current,f=i.useMemo(function(){var e=(0,Y.gU)(c.prefixName)||[];return[].concat((0,u.Z)(e),(0,u.Z)((0,Y.gU)(t)))},[c.prefixName,t]),p=i.useMemo(function(){return(0,l.Z)((0,l.Z)({},c),{},{prefixName:f})},[c,f]),g=i.useMemo(function(){return{getKey:function(e){var t=f.length,n=e[t];return[d.keys[n],e.slice(t+1)]}}},[f]);return"function"!=typeof r?((0,m.ZP)(!1,"Form.List only accepts function as children."),null):i.createElement(w.Provider,{value:g},i.createElement(_.Provider,{value:p},i.createElement(eu,{name:[],shouldUpdate:function(e,t,n){return"internal"!==n.source&&e!==t},rules:s,validateTrigger:o,initialValue:n,isList:!0,isListField:null!=a?a:!!h},function(e,t){var n=e.value,i=e.onChange,s=c.getFieldValue,o=function(){return s(f||[])||[]},a=(void 0===n?[]:n)||[];return Array.isArray(a)||(a=[]),r(a.map(function(e,t){var n=d.keys[t];return void 0===n&&(d.keys[t]=d.id,n=d.keys[t],d.id+=1),{name:t,key:n,isListField:!0}}),{add:function(e,t){var n=o();t>=0&&t<=n.length?(d.keys=[].concat((0,u.Z)(d.keys.slice(0,t)),[d.id],(0,u.Z)(d.keys.slice(t))),i([].concat((0,u.Z)(n.slice(0,t)),[e],(0,u.Z)(n.slice(t))))):(d.keys=[].concat((0,u.Z)(d.keys),[d.id]),i([].concat((0,u.Z)(n),[e]))),d.id+=1},remove:function(e){var t=o(),n=new Set(Array.isArray(e)?e:[e]);n.size<=0||(d.keys=d.keys.filter(function(e,t){return!n.has(t)}),i(t.filter(function(e,t){return!n.has(t)})))},move:function(e,t){if(e!==t){var n=o();e<0||e>=n.length||t<0||t>=n.length||(d.keys=(0,Y.pB)(d.keys,e,t),i((0,Y.pB)(n,e,t)))}}},t)})))},eh=n(7685),ed=n(7434),ef=n(1002),ep="__@field_split__";function eg(e){return e.map(function(e){return"".concat((0,ef.Z)(e),":").concat(e)}).join(ep)}var em=function(){function e(){(0,c.Z)(this,e),this.kvs=new Map}return(0,h.Z)(e,[{key:"set",value:function(e,t){this.kvs.set(eg(e),t)}},{key:"get",value:function(e){return this.kvs.get(eg(e))}},{key:"update",value:function(e,t){var n=t(this.get(e));n?this.set(e,n):this.delete(e)}},{key:"delete",value:function(e){this.kvs.delete(eg(e))}},{key:"map",value:function(e){return(0,u.Z)(this.kvs.entries()).map(function(t){var n=(0,eh.Z)(t,2),r=n[0],i=n[1];return e({key:r.split(ep).map(function(e){var t=e.match(/^([^:]*):(.*)$/),n=(0,eh.Z)(t,3),r=n[1],i=n[2];return"number"===r?Number(i):i}),value:i})})}},{key:"toJSON",value:function(){var e={};return this.map(function(t){var n=t.key,r=t.value;return e[n.join(".")]=r,null}),e}}]),e}(),ey=n(8880),ev=["name"],e_=(0,h.Z)(function e(t){var n=this;(0,c.Z)(this,e),this.formHooked=!1,this.forceRootUpdate=void 0,this.subscribable=!0,this.store={},this.fieldEntities=[],this.initialValues={},this.callbacks={},this.validateMessages=null,this.preserve=null,this.lastValidatePromise=null,this.getForm=function(){return{getFieldValue:n.getFieldValue,getFieldsValue:n.getFieldsValue,getFieldError:n.getFieldError,getFieldWarning:n.getFieldWarning,getFieldsError:n.getFieldsError,isFieldsTouched:n.isFieldsTouched,isFieldTouched:n.isFieldTouched,isFieldValidating:n.isFieldValidating,isFieldsValidating:n.isFieldsValidating,resetFields:n.resetFields,setFields:n.setFields,setFieldValue:n.setFieldValue,setFieldsValue:n.setFieldsValue,validateFields:n.validateFields,submit:n.submit,_init:!0,getInternalHooks:n.getInternalHooks}},this.getInternalHooks=function(e){return e===y?(n.formHooked=!0,{dispatch:n.dispatch,initEntityValue:n.initEntityValue,registerField:n.registerField,useSubscribe:n.useSubscribe,setInitialValues:n.setInitialValues,destroyForm:n.destroyForm,setCallbacks:n.setCallbacks,setValidateMessages:n.setValidateMessages,getFields:n.getFields,setPreserve:n.setPreserve,getInitialValue:n.getInitialValue,registerWatch:n.registerWatch}):((0,m.ZP)(!1,"`getInternalHooks` is internal usage. Should not call directly."),null)},this.useSubscribe=function(e){n.subscribable=e},this.prevWithoutPreserves=null,this.setInitialValues=function(e,t){if(n.initialValues=e||{},t){var r,i=(0,Y.gg)({},e,n.store);null===(r=n.prevWithoutPreserves)||void 0===r||r.map(function(t){var n=t.key;i=(0,ey.Z)(i,n,(0,ei.Z)(e,n))}),n.prevWithoutPreserves=null,n.updateStore(i)}},this.destroyForm=function(){var e=new em;n.getFieldEntities(!0).forEach(function(t){n.isMergedPreserve(t.isPreserve())||e.set(t.getNamePath(),!0)}),n.prevWithoutPreserves=e},this.getInitialValue=function(e){var t=(0,ei.Z)(n.initialValues,e);return e.length?(0,ed.Z)(t):t},this.setCallbacks=function(e){n.callbacks=e},this.setValidateMessages=function(e){n.validateMessages=e},this.setPreserve=function(e){n.preserve=e},this.watchList=[],this.registerWatch=function(e){return n.watchList.push(e),function(){n.watchList=n.watchList.filter(function(t){return t!==e})}},this.notifyWatch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(n.watchList.length){var t=n.getFieldsValue(),r=n.getFieldsValue(!0);n.watchList.forEach(function(n){n(t,r,e)})}},this.timeoutId=null,this.warningUnhooked=function(){},this.updateStore=function(e){n.store=e},this.getFieldEntities=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return e?n.fieldEntities.filter(function(e){return e.getNamePath().length}):n.fieldEntities},this.getFieldsMap=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=new em;return n.getFieldEntities(e).forEach(function(e){var n=e.getNamePath();t.set(n,e)}),t},this.getFieldEntitiesForNamePathList=function(e){if(!e)return n.getFieldEntities(!0);var t=n.getFieldsMap(!0);return e.map(function(e){var n=(0,Y.gU)(e);return t.get(n)||{INVALIDATE_NAME_PATH:(0,Y.gU)(e)}})},this.getFieldsValue=function(e,t){if(n.warningUnhooked(),!0===e&&!t)return n.store;var r=n.getFieldEntitiesForNamePathList(Array.isArray(e)?e:null),i=[];return r.forEach(function(n){var r,s="INVALIDATE_NAME_PATH"in n?n.INVALIDATE_NAME_PATH:n.getNamePath();!(!e&&(null===(r=n.isListField)||void 0===r?void 0:r.call(n)))&&(t?t("getMeta"in n?n.getMeta():null)&&i.push(s):i.push(s))}),(0,Y.H_)(n.store,i.map(Y.gU))},this.getFieldValue=function(e){n.warningUnhooked();var t=(0,Y.gU)(e);return(0,ei.Z)(n.store,t)},this.getFieldsError=function(e){return n.warningUnhooked(),n.getFieldEntitiesForNamePathList(e).map(function(t,n){return!t||"INVALIDATE_NAME_PATH"in t?{name:(0,Y.gU)(e[n]),errors:[],warnings:[]}:{name:t.getNamePath(),errors:t.getErrors(),warnings:t.getWarnings()}})},this.getFieldError=function(e){n.warningUnhooked();var t=(0,Y.gU)(e);return n.getFieldsError([t])[0].errors},this.getFieldWarning=function(e){n.warningUnhooked();var t=(0,Y.gU)(e);return n.getFieldsError([t])[0].warnings},this.isFieldsTouched=function(){n.warningUnhooked();for(var e,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];var s=r[0],o=r[1],a=!1;0===r.length?e=null:1===r.length?Array.isArray(s)?(e=s.map(Y.gU),a=!1):(e=null,a=s):(e=s.map(Y.gU),a=o);var l=n.getFieldEntities(!0),c=function(e){return e.isFieldTouched()};if(!e)return a?l.every(c):l.some(c);var h=new em;e.forEach(function(e){h.set(e,[])}),l.forEach(function(t){var n=t.getNamePath();e.forEach(function(e){e.every(function(e,t){return n[t]===e})&&h.update(e,function(e){return[].concat((0,u.Z)(e),[t])})})});var d=function(e){return e.some(c)},f=h.map(function(e){return e.value});return a?f.every(d):f.some(d)},this.isFieldTouched=function(e){return n.warningUnhooked(),n.isFieldsTouched([e])},this.isFieldsValidating=function(e){n.warningUnhooked();var t=n.getFieldEntities();if(!e)return t.some(function(e){return e.isFieldValidating()});var r=e.map(Y.gU);return t.some(function(e){var t=e.getNamePath();return(0,Y.T1)(r,t)&&e.isFieldValidating()})},this.isFieldValidating=function(e){return n.warningUnhooked(),n.isFieldsValidating([e])},this.resetWithFieldInitialValue=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=new em,i=n.getFieldEntities(!0);i.forEach(function(e){var t=e.props.initialValue,n=e.getNamePath();if(void 0!==t){var i=r.get(n)||new Set;i.add({entity:e,value:t}),r.set(n,i)}}),t.entities?e=t.entities:t.namePathList?(e=[],t.namePathList.forEach(function(t){var n,i=r.get(t);i&&(n=e).push.apply(n,(0,u.Z)((0,u.Z)(i).map(function(e){return e.entity})))})):e=i,function(e){e.forEach(function(e){if(void 0!==e.props.initialValue){var i=e.getNamePath();if(void 0!==n.getInitialValue(i))(0,m.ZP)(!1,"Form already set 'initialValues' with path '".concat(i.join("."),"'. Field can not overwrite it."));else{var s=r.get(i);if(s&&s.size>1)(0,m.ZP)(!1,"Multiple Field with path '".concat(i.join("."),"' set 'initialValue'. Can not decide which one to pick."));else if(s){var o=n.getFieldValue(i);t.skipExist&&void 0!==o||n.updateStore((0,ey.Z)(n.store,i,(0,u.Z)(s)[0].value))}}}})}(e)},this.resetFields=function(e){n.warningUnhooked();var t=n.store;if(!e){n.updateStore((0,Y.gg)({},n.initialValues)),n.resetWithFieldInitialValue(),n.notifyObservers(t,null,{type:"reset"}),n.notifyWatch();return}var r=e.map(Y.gU);r.forEach(function(e){var t=n.getInitialValue(e);n.updateStore((0,ey.Z)(n.store,e,t))}),n.resetWithFieldInitialValue({namePathList:r}),n.notifyObservers(t,r,{type:"reset"}),n.notifyWatch(r)},this.setFields=function(e){n.warningUnhooked();var t=n.store,r=[];e.forEach(function(e){var i=e.name,s=(0,o.Z)(e,ev),a=(0,Y.gU)(i);r.push(a),"value"in s&&n.updateStore((0,ey.Z)(n.store,a,s.value)),n.notifyObservers(t,[a],{type:"setField",data:e})}),n.notifyWatch(r)},this.getFields=function(){return n.getFieldEntities(!0).map(function(e){var t=e.getNamePath(),r=e.getMeta(),i=(0,l.Z)((0,l.Z)({},r),{},{name:t,value:n.getFieldValue(t)});return Object.defineProperty(i,"originRCField",{value:!0}),i})},this.initEntityValue=function(e){var t=e.props.initialValue;if(void 0!==t){var r=e.getNamePath();void 0===(0,ei.Z)(n.store,r)&&n.updateStore((0,ey.Z)(n.store,r,t))}},this.isMergedPreserve=function(e){var t=void 0!==e?e:n.preserve;return null==t||t},this.registerField=function(e){n.fieldEntities.push(e);var t=e.getNamePath();if(n.notifyWatch([t]),void 0!==e.props.initialValue){var r=n.store;n.resetWithFieldInitialValue({entities:[e],skipExist:!0}),n.notifyObservers(r,[e.getNamePath()],{type:"valueUpdate",source:"internal"})}return function(r,i){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(n.fieldEntities=n.fieldEntities.filter(function(t){return t!==e}),!n.isMergedPreserve(i)&&(!r||s.length>1)){var o=r?void 0:n.getInitialValue(t);if(t.length&&n.getFieldValue(t)!==o&&n.fieldEntities.every(function(e){return!(0,Y.LX)(e.getNamePath(),t)})){var a=n.store;n.updateStore((0,ey.Z)(a,t,o,!0)),n.notifyObservers(a,[t],{type:"remove"}),n.triggerDependenciesUpdate(a,t)}}n.notifyWatch([t])}},this.dispatch=function(e){switch(e.type){case"updateValue":var t=e.namePath,r=e.value;n.updateValue(t,r);break;case"validateField":var i=e.namePath,s=e.triggerName;n.validateFields([i],{triggerName:s})}},this.notifyObservers=function(e,t,r){if(n.subscribable){var i=(0,l.Z)((0,l.Z)({},r),{},{store:n.getFieldsValue(!0)});n.getFieldEntities().forEach(function(n){(0,n.onStoreChange)(e,t,i)})}else n.forceRootUpdate()},this.triggerDependenciesUpdate=function(e,t){var r=n.getDependencyChildrenFields(t);return r.length&&n.validateFields(r),n.notifyObservers(e,r,{type:"dependenciesUpdate",relatedFields:[t].concat((0,u.Z)(r))}),r},this.updateValue=function(e,t){var r=(0,Y.gU)(e),i=n.store;n.updateStore((0,ey.Z)(n.store,r,t)),n.notifyObservers(i,[r],{type:"valueUpdate",source:"internal"}),n.notifyWatch([r]);var s=n.triggerDependenciesUpdate(i,r),o=n.callbacks.onValuesChange;o&&o((0,Y.H_)(n.store,[r]),n.getFieldsValue()),n.triggerOnFieldsChange([r].concat((0,u.Z)(s)))},this.setFieldsValue=function(e){n.warningUnhooked();var t=n.store;if(e){var r=(0,Y.gg)(n.store,e);n.updateStore(r)}n.notifyObservers(t,null,{type:"valueUpdate",source:"external"}),n.notifyWatch()},this.setFieldValue=function(e,t){n.setFields([{name:e,value:t}])},this.getDependencyChildrenFields=function(e){var t=new Set,r=[],i=new em;return n.getFieldEntities().forEach(function(e){(e.props.dependencies||[]).forEach(function(t){var n=(0,Y.gU)(t);i.update(n,function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Set;return t.add(e),t})})}),function e(n){(i.get(n)||new Set).forEach(function(n){if(!t.has(n)){t.add(n);var i=n.getNamePath();n.isFieldDirty()&&i.length&&(r.push(i),e(i))}})}(e),r},this.triggerOnFieldsChange=function(e,t){var r=n.callbacks.onFieldsChange;if(r){var i=n.getFields();if(t){var s=new em;t.forEach(function(e){var t=e.name,n=e.errors;s.set(t,n)}),i.forEach(function(e){e.errors=s.get(e.name)||e.errors})}r(i.filter(function(t){var n=t.name;return(0,Y.T1)(e,n)}),i)}},this.validateFields=function(e,t){n.warningUnhooked();var r,i,s,o=!!e,a=o?e.map(Y.gU):[],c=[];n.getFieldEntities(!0).forEach(function(r){if(o||a.push(r.getNamePath()),(null==t?void 0:t.recursive)&&o){var i=r.getNamePath();i.every(function(t,n){return e[n]===t||void 0===e[n]})&&a.push(i)}if(r.props.rules&&r.props.rules.length){var s=r.getNamePath();if(!o||(0,Y.T1)(a,s)){var h=r.validateRules((0,l.Z)({validateMessages:(0,l.Z)((0,l.Z)({},Q),n.validateMessages)},t));c.push(h.then(function(){return{name:s,errors:[],warnings:[]}}).catch(function(e){var t,n=[],r=[];return(null===(t=e.forEach)||void 0===t||t.call(e,function(e){var t=e.rule.warningOnly,i=e.errors;t?r.push.apply(r,(0,u.Z)(i)):n.push.apply(n,(0,u.Z)(i))}),n.length)?Promise.reject({name:s,errors:n,warnings:r}):{name:s,errors:n,warnings:r}}))}}});var h=(r=!1,i=c.length,s=[],c.length?new Promise(function(e,t){c.forEach(function(n,o){n.catch(function(e){return r=!0,e}).then(function(n){i-=1,s[o]=n,i>0||(r&&t(s),e(s))})})}):Promise.resolve([]));n.lastValidatePromise=h,h.catch(function(e){return e}).then(function(e){var t=e.map(function(e){return e.name});n.notifyObservers(n.store,t,{type:"validateFinish"}),n.triggerOnFieldsChange(t,e)});var d=h.then(function(){return n.lastValidatePromise===h?Promise.resolve(n.getFieldsValue(a)):Promise.reject([])}).catch(function(e){var t=e.filter(function(e){return e&&e.errors.length});return Promise.reject({values:n.getFieldsValue(a),errorFields:t,outOfDate:n.lastValidatePromise!==h})});return d.catch(function(e){return e}),n.triggerOnFieldsChange(a),d},this.submit=function(){n.warningUnhooked(),n.validateFields().then(function(e){var t=n.callbacks.onFinish;if(t)try{t(e)}catch(e){console.error(e)}}).catch(function(e){var t=n.callbacks.onFinishFailed;t&&t(e)})},this.forceRootUpdate=t}),ew=function(e){var t=i.useRef(),n=i.useState({}),r=(0,eh.Z)(n,2)[1];if(!t.current){if(e)t.current=e;else{var s=new e_(function(){r({})});t.current=s.getForm()}}return[t.current]},eb=i.createContext({triggerFormChange:function(){},triggerFormFinish:function(){},registerForm:function(){},unregisterForm:function(){}}),eI=function(e){var t=e.validateMessages,n=e.onFormChange,r=e.onFormFinish,s=e.children,o=i.useContext(eb),u=i.useRef({});return i.createElement(eb.Provider,{value:(0,l.Z)((0,l.Z)({},o),{},{validateMessages:(0,l.Z)((0,l.Z)({},o.validateMessages),t),triggerFormChange:function(e,t){n&&n(e,{changedFields:t,forms:u.current}),o.triggerFormChange(e,t)},triggerFormFinish:function(e,t){r&&r(e,{values:t,forms:u.current}),o.triggerFormFinish(e,t)},registerForm:function(e,t){e&&(u.current=(0,l.Z)((0,l.Z)({},u.current),{},(0,a.Z)({},e,t))),o.registerForm(e,t)},unregisterForm:function(e){var t=(0,l.Z)({},u.current);delete t[e],u.current=t,o.unregisterForm(e)}})},s)},eT=["name","initialValues","fields","form","preserve","children","component","validateMessages","validateTrigger","onValuesChange","onFieldsChange","onFinish","onFinishFailed"];function eE(e){try{return JSON.stringify(e)}catch(e){return Math.random()}}var eC=function(){},eS=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=t[0],s=t[1],o=void 0===s?{}:s,a=(0,b.G)(o)?{form:o}:o,l=a.form,u=(0,i.useState)(),c=(0,eh.Z)(u,2),h=c[0],d=c[1],f=(0,i.useMemo)(function(){return eE(h)},[h]),p=(0,i.useRef)(f);p.current=f;var g=(0,i.useContext)(_),m=l||g,v=m&&m._init,w=(0,Y.gU)(void 0===r?[]:r),I=(0,i.useRef)(w);return I.current=w,eC(w),(0,i.useEffect)(function(){if(v){var e=m.getFieldsValue,t=(0,(0,m.getInternalHooks)(y).registerWatch)(function(e,t){var n=(0,ei.Z)(a.preserve?t:e,I.current),r=eE(n);p.current!==r&&(p.current=r,d(n))});return d((0,ei.Z)(a.preserve?e(!0):e(),I.current)),t}},[v]),h},ek=i.forwardRef(function(e,t){var n,r=e.name,a=e.initialValues,u=e.fields,c=e.form,h=e.preserve,d=e.children,f=e.component,p=void 0===f?"form":f,g=e.validateMessages,m=e.validateTrigger,v=void 0===m?"onChange":m,w=e.onValuesChange,b=e.onFieldsChange,I=e.onFinish,T=e.onFinishFailed,E=(0,o.Z)(e,eT),C=i.useContext(eb),S=ew(c),k=(0,eh.Z)(S,1)[0],x=k.getInternalHooks(y),A=x.useSubscribe,R=x.setInitialValues,N=x.setCallbacks,P=x.setValidateMessages,D=x.setPreserve,O=x.destroyForm;i.useImperativeHandle(t,function(){return k}),i.useEffect(function(){return C.registerForm(r,k),function(){C.unregisterForm(r)}},[C,k,r]),P((0,l.Z)((0,l.Z)({},C.validateMessages),g)),N({onValuesChange:w,onFieldsChange:function(e){if(C.triggerFormChange(r,e),b){for(var t=arguments.length,n=Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];b.apply(void 0,[e].concat(n))}},onFinish:function(e){C.triggerFormFinish(r,e),I&&I(e)},onFinishFailed:T}),D(h);var F=i.useRef(null);R(a,!F.current),F.current||(F.current=!0),i.useEffect(function(){return O},[]);var L="function"==typeof d;n=L?d(k.getFieldsValue(!0),k):d,A(!L);var M=i.useRef();i.useEffect(function(){(0,Y.T0)(M.current||[],u||[])||k.setFields(u||[]),M.current=u},[u,k]);var U=i.useMemo(function(){return(0,l.Z)((0,l.Z)({},k),{},{validateTrigger:v})},[k,v]),V=i.createElement(_.Provider,{value:U},n);return!1===p?V:i.createElement(p,(0,s.Z)({},E,{onSubmit:function(e){e.preventDefault(),e.stopPropagation(),k.submit()},onReset:function(e){var t;e.preventDefault(),k.resetFields(),null===(t=E.onReset)||void 0===t||t.call(E,e)}}),V)});ek.FormProvider=eI,ek.Field=eu,ek.List=ec,ek.useForm=ew,ek.useWatch=eS;var ex=ek},7434:function(e,t,n){"use strict";var r=n(1002);t.Z=function e(t){return Array.isArray(t)?t.map(function(t){return e(t)}):"object"===(0,r.Z)(t)&&null!==t?function(t){if(Object.getPrototypeOf(t)===Object.prototype){var n={};for(var r in t)n[r]=e(t[r]);return n}return t}(t):t}},3409:function(e,t,n){"use strict";function r(e){return null==e?[]:Array.isArray(e)?e:[e]}function i(e){return e&&!!e._init}n.d(t,{G:function(){return i},q:function(){return r}})},3236:function(e,t,n){"use strict";n.d(t,{H_:function(){return h},LX:function(){return g},T0:function(){return m},T1:function(){return d},gU:function(){return c},gg:function(){return p},iZ:function(){return y},pB:function(){return v}});var r=n(1413),i=n(4902),s=n(1002),o=n(8306),a=n(8880),l=n(3409),u=n(7434);function c(e){return(0,l.q)(e)}function h(e,t){var n={};return t.forEach(function(t){var r=(0,o.Z)(e,t);n=(0,a.Z)(n,t,r)}),n}function d(e,t){return e&&e.some(function(e){return g(e,t)})}function f(e){return"object"===(0,s.Z)(e)&&null!==e&&Object.getPrototypeOf(e)===Object.prototype}function p(e){for(var t=arguments.length,n=Array(t>1?t-1:0),s=1;s<t;s++)n[s-1]=arguments[s];return n.reduce(function(e,t){return function e(t,n){var s=Array.isArray(t)?(0,i.Z)(t):(0,r.Z)({},t);return n&&Object.keys(n).forEach(function(t){var r=s[t],i=n[t],o=f(r)&&f(i);s[t]=o?e(r,i||{}):(0,u.Z)(i)}),s}(e,t)},e)}function g(e,t){return!!e&&!!t&&e.length===t.length&&e.every(function(e,n){return t[n]===e})}function m(e,t){if(e===t)return!0;if(!e&&t||e&&!t||!e||!t||"object"!==(0,s.Z)(e)||"object"!==(0,s.Z)(t))return!1;var n=Object.keys(e),r=Object.keys(t),o=new Set([].concat(n,r));return(0,i.Z)(o).every(function(n){var r=e[n],i=t[n];return"function"==typeof r&&"function"==typeof i||r===i})}function y(e){var t=arguments.length<=1?void 0:arguments[1];return t&&t.target&&"object"===(0,s.Z)(t.target)&&e in t.target?t.target[e]:t}function v(e,t,n){var r=e.length;if(t<0||t>=r||n<0||n>=r)return e;var s=e[t],o=t-n;return o>0?[].concat((0,i.Z)(e.slice(0,n)),[s],(0,i.Z)(e.slice(n,t)),(0,i.Z)(e.slice(t+1,r))):o<0?[].concat((0,i.Z)(e.slice(0,t)),(0,i.Z)(e.slice(t+1,n+1)),[s],(0,i.Z)(e.slice(n+1,r))):e}},2906:function(e,t){"use strict";t.Z={items_per_page:"/ page",jump_to:"Go to",jump_to_confirm:"confirm",page:"Page",prev_page:"Previous Page",next_page:"Next Page",prev_5:"Previous 5 Pages",next_5:"Next 5 Pages",prev_3:"Previous 3 Pages",next_3:"Next 3 Pages",page_size:"Page Size"}},344:function(e,t,n){"use strict";n.d(t,{Z:function(){return function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=[];return r.Children.forEach(t,function(t){(null!=t||n.keepEmpty)&&(Array.isArray(t)?s=s.concat(e(t)):(0,i.isFragment)(t)&&t.props?s=s.concat(e(t.props.children,n)):s.push(t))}),s}}});var r=n(7294),i=n(9864)},8924:function(e,t,n){"use strict";function r(){return!!("undefined"!=typeof window&&window.document&&window.document.createElement)}n.d(t,{Z:function(){return r}})},4999:function(e,t,n){"use strict";function r(e,t){if(!e)return!1;if(e.contains)return e.contains(t);for(var n=t;n;){if(n===e)return!0;n=n.parentNode}return!1}n.d(t,{Z:function(){return r}})},4958:function(e,t,n){"use strict";n.d(t,{hq:function(){return f},jL:function(){return d}});var r=n(8924),i=n(4999),s="data-rc-order",o=new Map;function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.mark;return t?t.startsWith("data-")?t:"data-".concat(t):"rc-util-key"}function l(e){return e.attachTo?e.attachTo:document.querySelector("head")||document.body}function u(e){return Array.from((o.get(e)||e).children).filter(function(e){return"STYLE"===e.tagName})}function c(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,r.Z)())return null;var n=t.csp,i=t.prepend,o=document.createElement("style");o.setAttribute(s,"queue"===i?"prependQueue":i?"prepend":"append"),null!=n&&n.nonce&&(o.nonce=null==n?void 0:n.nonce),o.innerHTML=e;var a=l(t),c=a.firstChild;if(i){if("queue"===i){var h=u(a).filter(function(e){return["prepend","prependQueue"].includes(e.getAttribute(s))});if(h.length)return a.insertBefore(o,h[h.length-1].nextSibling),o}a.insertBefore(o,c)}else a.appendChild(o);return o}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u(l(t)).find(function(n){return n.getAttribute(a(t))===e})}function d(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=h(e,t);n&&l(t).removeChild(n)}function f(e,t){var n,r,s,u=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};!function(e,t){var n=o.get(e);if(!n||!(0,i.Z)(document,n)){var r=c("",t),s=r.parentNode;o.set(e,s),e.removeChild(r)}}(l(u),u);var d=h(t,u);if(d)return null!==(n=u.csp)&&void 0!==n&&n.nonce&&d.nonce!==(null===(r=u.csp)||void 0===r?void 0:r.nonce)&&(d.nonce=null===(s=u.csp)||void 0===s?void 0:s.nonce),d.innerHTML!==e&&(d.innerHTML=e),d;var f=c(e,u);return f.setAttribute(a(u),t),f}},6982:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7294);function i(e,t,n){var i=r.useRef({});return(!("value"in i.current)||n(i.current.condition,t))&&(i.current.value=e(),i.current.condition=t),i.current.value}},1881:function(e,t,n){"use strict";var r=n(1002),i=n(334);t.Z=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=new Set;return function e(t,o){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=s.has(t);if((0,i.ZP)(!l,"Warning: There may be circular references"),l)return!1;if(t===o)return!0;if(n&&a>1)return!1;s.add(t);var u=a+1;if(Array.isArray(t)){if(!Array.isArray(o)||t.length!==o.length)return!1;for(var c=0;c<t.length;c++)if(!e(t[c],o[c],u))return!1;return!0}if(t&&o&&"object"===(0,r.Z)(t)&&"object"===(0,r.Z)(o)){var h=Object.keys(t);return h.length===Object.keys(o).length&&h.every(function(n){return e(t[n],o[n],u)})}return!1}(e,t)}},8306:function(e,t,n){"use strict";function r(e,t){for(var n=e,r=0;r<t.length;r+=1){if(null==n)return;n=n[t[r]]}return n}n.d(t,{Z:function(){return r}})},8880:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(1413),i=n(4902),s=n(4506),o=n(8306);function a(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t.length&&a&&void 0===n&&!(0,o.Z)(e,t.slice(0,-1))?e:function e(t,n,o,a){if(!n.length)return o;var l,u=(0,s.Z)(n),c=u[0],h=u.slice(1);return l=t||"number"!=typeof c?Array.isArray(t)?(0,i.Z)(t):(0,r.Z)({},t):[],a&&void 0===o&&1===h.length?delete l[c][h[0]]:l[c]=e(l[c],h,o,a),l}(e,t,n,a)}},334:function(e,t,n){"use strict";n.d(t,{Kp:function(){return s}});var r={},i=[];function s(e,t){}function o(e,t){}function a(e,t,n){t||r[n]||(e(!1,n),r[n]=!0)}function l(e,t){a(s,e,t)}l.preMessage=function(e){i.push(e)},l.resetWarned=function(){r={}},l.noteOnce=function(e,t){a(o,e,t)},t.ZP=l},9921:function(e,t){"use strict";/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n="function"==typeof Symbol&&Symbol.for,r=n?Symbol.for("react.element"):60103,i=n?Symbol.for("react.portal"):60106,s=n?Symbol.for("react.fragment"):60107,o=n?Symbol.for("react.strict_mode"):60108,a=n?Symbol.for("react.profiler"):60114,l=n?Symbol.for("react.provider"):60109,u=n?Symbol.for("react.context"):60110,c=n?Symbol.for("react.async_mode"):60111,h=n?Symbol.for("react.concurrent_mode"):60111,d=n?Symbol.for("react.forward_ref"):60112,f=n?Symbol.for("react.suspense"):60113,p=(n&&Symbol.for("react.suspense_list"),n?Symbol.for("react.memo"):60115),g=n?Symbol.for("react.lazy"):60116;function m(e){if("object"==typeof e&&null!==e){var t=e.$$typeof;switch(t){case r:switch(e=e.type){case c:case h:case s:case a:case o:case f:return e;default:switch(e=e&&e.$$typeof){case u:case d:case g:case p:case l:return e;default:return t}}case i:return t}}}n&&Symbol.for("react.block"),n&&Symbol.for("react.fundamental"),n&&Symbol.for("react.responder"),n&&Symbol.for("react.scope"),t.isFragment=function(e){return m(e)===s},t.isMemo=function(e){return m(e)===p}},9864:function(e,t,n){"use strict";e.exports=n(9921)},907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},3878:function(e,t,n){"use strict";function r(e){if(Array.isArray(e))return e}n.d(t,{Z:function(){return r}})},7326:function(e,t,n){"use strict";function r(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}n.d(t,{Z:function(){return r}})},5861:function(e,t,n){"use strict";function r(e,t,n,r,i,s,o){try{var a=e[s](o),l=a.value}catch(e){n(e);return}a.done?t(l):Promise.resolve(l).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise(function(i,s){var o=e.apply(t,n);function a(e){r(o,i,s,a,l,"next",e)}function l(e){r(o,i,s,a,l,"throw",e)}a(void 0)})}}n.d(t,{Z:function(){return i}})},5671:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},3144:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(3997);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(0,r.Z)(i.key),i)}}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},3568:function(e,t,n){"use strict";function r(e){return(r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}n.d(t,{Z:function(){return o}});var i=n(1002),s=n(7326);function o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var n,o=r(e);if(t){var a=r(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return function(e,t){if(t&&("object"===(0,i.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return(0,s.Z)(e)}(this,n)}}},4942:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(3997);function i(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},7462:function(e,t,n){"use strict";function r(){return(r=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}n.d(t,{Z:function(){return r}})},2531:function(e,t,n){"use strict";function r(e,t){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)}n.d(t,{Z:function(){return i}})},9199:function(e,t,n){"use strict";function r(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}n.d(t,{Z:function(){return r}})},5267:function(e,t,n){"use strict";function r(){throw TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}n.d(t,{Z:function(){return r}})},1413:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(4942);function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}},91:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}n.d(t,{Z:function(){return r}})},4165:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(1002);function i(){i=function(){return e};var e={},t=Object.prototype,n=t.hasOwnProperty,s=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},a=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{c({},"")}catch(e){c=function(e,t,n){return e[t]=n}}function h(e,t,n,r){var i,o,a=Object.create((t&&t.prototype instanceof p?t:p).prototype);return s(a,"_invoke",{value:(i=new C(r||[]),o="suspendedStart",function(t,r){if("executing"===o)throw Error("Generator is already running");if("completed"===o){if("throw"===t)throw r;return k()}for(i.method=t,i.arg=r;;){var s=i.delegate;if(s){var a=function e(t,n){var r=n.method,i=t.iterator[r];if(void 0===i)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=void 0,e(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+r+"' method")),f;var s=d(i,t.iterator,n.arg);if("throw"===s.type)return n.method="throw",n.arg=s.arg,n.delegate=null,f;var o=s.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=void 0),n.delegate=null,f):o:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,f)}(s,i);if(a){if(a===f)continue;return a}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===o)throw o="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);o="executing";var l=d(e,n,i);if("normal"===l.type){if(o=i.done?"completed":"suspendedYield",l.arg===f)continue;return{value:l.arg,done:i.done}}"throw"===l.type&&(o="completed",i.method="throw",i.arg=l.arg)}})}),a}function d(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=h;var f={};function p(){}function g(){}function m(){}var y={};c(y,a,function(){return this});var v=Object.getPrototypeOf,_=v&&v(v(S([])));_&&_!==t&&n.call(_,a)&&(y=_);var w=m.prototype=p.prototype=Object.create(y);function b(e){["next","throw","return"].forEach(function(t){c(e,t,function(e){return this._invoke(t,e)})})}function I(e,t){var i;s(this,"_invoke",{value:function(s,o){function a(){return new t(function(i,a){!function i(s,o,a,l){var u=d(e[s],e,o);if("throw"!==u.type){var c=u.arg,h=c.value;return h&&"object"==(0,r.Z)(h)&&n.call(h,"__await")?t.resolve(h.__await).then(function(e){i("next",e,a,l)},function(e){i("throw",e,a,l)}):t.resolve(h).then(function(e){c.value=e,a(c)},function(e){return i("throw",e,a,l)})}l(u.arg)}(s,o,i,a)})}return i=i?i.then(a,a):a()}})}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function C(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function S(e){if(e){var t=e[a];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,i=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:k}}function k(){return{value:void 0,done:!0}}return g.prototype=m,s(w,"constructor",{value:m,configurable:!0}),s(m,"constructor",{value:g,configurable:!0}),g.displayName=c(m,u,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,m):(e.__proto__=m,c(e,u,"GeneratorFunction")),e.prototype=Object.create(w),e},e.awrap=function(e){return{__await:e}},b(I.prototype),c(I.prototype,l,function(){return this}),e.AsyncIterator=I,e.async=function(t,n,r,i,s){void 0===s&&(s=Promise);var o=new I(h(t,n,r,i),s);return e.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},b(w),c(w,u,"Generator"),c(w,a,function(){return this}),c(w,"toString",function(){return"[object Generator]"}),e.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},e.values=S,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return o.type="throw",o.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],o=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var a=n.call(s,"catchLoc"),l=n.call(s,"finallyLoc");if(a&&l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var s=i;break}}s&&("break"===e||"continue"===e)&&s.tryLoc<=t&&t<=s.finallyLoc&&(s=null);var o=s?s.completion:{};return o.type=e,o.arg=t,s?(this.method="next",this.next=s.finallyLoc,f):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),f},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),E(n),f}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;E(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),f}},e}},7685:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(3878),i=n(181),s=n(5267);function o(e,t){return(0,r.Z)(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s,o,a=[],l=!0,u=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=s.call(n)).done)&&(a.push(r.value),a.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return a}}(e,t)||(0,i.Z)(e,t)||(0,s.Z)()}},4506:function(e,t,n){"use strict";n.d(t,{Z:function(){return a}});var r=n(3878),i=n(9199),s=n(181),o=n(5267);function a(e){return(0,r.Z)(e)||(0,i.Z)(e)||(0,s.Z)(e)||(0,o.Z)()}},4902:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(907),i=n(9199),s=n(181);function o(e){return function(e){if(Array.isArray(e))return(0,r.Z)(e)}(e)||(0,i.Z)(e)||(0,s.Z)(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},3997:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(1002);function i(e){var t=function(e,t){if("object"!==(0,r.Z)(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!==(0,r.Z)(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===(0,r.Z)(t)?t:String(t)}},1002:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,{Z:function(){return r}})},181:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(907);function i(e,t){if(e){if("string"==typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return(0,r.Z)(e,t)}}},5816:function(e,t,n){"use strict";let r,i;n.r(t),n.d(t,{FirebaseError:function(){return l.ZR},SDK_VERSION:function(){return U},_DEFAULT_ENTRY_NAME:function(){return S},_addComponent:function(){return R},_addOrOverwriteComponent:function(){return N},_apps:function(){return x},_clearComponents:function(){return F},_components:function(){return A},_getProvider:function(){return D},_registerComponent:function(){return P},_removeServiceInstance:function(){return O},deleteApp:function(){return B},getApp:function(){return q},getApps:function(){return j},initializeApp:function(){return V},onLog:function(){return $},registerVersion:function(){return z},setLogLevel:function(){return H}});var s,o=n(740),a=n(3333),l=n(4444);let u=(e,t)=>t.some(t=>e instanceof t),c=new WeakMap,h=new WeakMap,d=new WeakMap,f=new WeakMap,p=new WeakMap,g={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return h.get(e);if("objectStoreNames"===t)return e.objectStoreNames||d.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return m(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function m(e){var t;if(e instanceof IDBRequest)return function(e){let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(m(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&c.set(t,e)}).catch(()=>{}),p.set(t,e),t}(e);if(f.has(e))return f.get(e);let n="function"==typeof(t=e)?t!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(i||(i=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(t)?function(...e){return t.apply(y(this),e),m(c.get(this))}:function(...e){return m(t.apply(y(this),e))}:function(e,...n){let r=t.call(y(this),e,...n);return d.set(r,e.sort?e.sort():[e]),m(r)}:(t instanceof IDBTransaction&&function(e){if(h.has(e))return;let t=new Promise((t,n)=>{let r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)});h.set(e,t)}(t),u(t,r||(r=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])))?new Proxy(t,g):t;return n!==e&&(f.set(e,n),p.set(n,e)),n}let y=e=>p.get(e),v=["get","getKey","getAll","getAllKeys","count"],_=["put","add","delete","clear"],w=new Map;function b(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(w.get(t))return w.get(t);let n=t.replace(/FromIndex$/,""),r=t!==n,i=_.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(i||v.includes(n)))return;let s=async function(e,...t){let s=this.transaction(e,i?"readwrite":"readonly"),o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return w.set(t,s),s}g={...s=g,get:(e,t,n)=>b(e,t)||s.get(e,t,n),has:(e,t)=>!!b(e,t)||s.has(e,t)};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I{constructor(e){this.container=e}getPlatformInfoString(){let e=this.container.getProviders();return e.map(e=>{if(!function(e){let t=e.getComponent();return(null==t?void 0:t.type)==="VERSION"}(e))return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}let T="@firebase/app",E="0.9.9",C=new a.Yd("@firebase/app"),S="[DEFAULT]",k={[T]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","fire-js":"fire-js",firebase:"fire-js-all"},x=new Map,A=new Map;function R(e,t){try{e.container.addComponent(t)}catch(n){C.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function N(e,t){e.container.addOrOverwriteComponent(t)}function P(e){let t=e.name;if(A.has(t))return C.debug(`There were multiple attempts to register component ${t}.`),!1;for(let n of(A.set(t,e),x.values()))R(n,e);return!0}function D(e,t){let n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function O(e,t,n=S){D(e,t).clearInstance(n)}function F(){A.clear()}let L=new l.LL("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$appName}","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}."});/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new o.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw L.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let U="9.21.0";function V(e,t={}){let n=e;if("object"!=typeof t){let e=t;t={name:e}}let r=Object.assign({name:S,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!=typeof i||!i)throw L.create("bad-app-name",{appName:String(i)});if(n||(n=(0,l.aH)()),!n)throw L.create("no-options");let s=x.get(i);if(s){if((0,l.vZ)(n,s.options)&&(0,l.vZ)(r,s.config))return s;throw L.create("duplicate-app",{appName:i})}let a=new o.H0(i);for(let e of A.values())a.addComponent(e);let u=new M(n,r,a);return x.set(i,u),u}function q(e=S){let t=x.get(e);if(!t&&e===S)return V();if(!t)throw L.create("no-app",{appName:e});return t}function j(){return Array.from(x.values())}async function B(e){let t=e.name;x.has(t)&&(x.delete(t),await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function z(e,t,n){var r;let i=null!==(r=k[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);let s=i.match(/\s|\//),a=t.match(/\s|\//);if(s||a){let e=[`Unable to register library "${i}" with version "${t}":`];s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&a&&e.push("and"),a&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),C.warn(e.join(" "));return}P(new o.wA(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}function $(e,t){if(null!==e&&"function"!=typeof e)throw L.create("invalid-log-argument");(0,a.Am)(e,t)}function H(e){(0,a.Ub)(e)}let W="firebase-heartbeat-store",G=null;function K(){return G||(G=(function(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){let o=indexedDB.open(e,1),a=m(o);return r&&o.addEventListener("upgradeneeded",e=>{r(m(o.result),e.oldVersion,e.newVersion,m(o.transaction),e)}),n&&o.addEventListener("blocked",e=>n(e.oldVersion,e.newVersion,e)),a.then(e=>{s&&e.addEventListener("close",()=>s()),i&&e.addEventListener("versionchange",e=>i(e.oldVersion,e.newVersion,e))}).catch(()=>{}),a})("firebase-heartbeat-database",0,{upgrade:(e,t)=>{0===t&&e.createObjectStore(W)}}).catch(e=>{throw L.create("idb-open",{originalErrorMessage:e.message})})),G}async function Z(e){try{let t=await K();return t.transaction(W).objectStore(W).get(Y(e))}catch(e){if(e instanceof l.ZR)C.warn(e.message);else{let t=L.create("idb-get",{originalErrorMessage:null==e?void 0:e.message});C.warn(t.message)}}}async function Q(e,t){try{let n=await K(),r=n.transaction(W,"readwrite"),i=r.objectStore(W);return await i.put(t,Y(e)),r.done}catch(e){if(e instanceof l.ZR)C.warn(e.message);else{let t=L.create("idb-set",{originalErrorMessage:null==e?void 0:e.message});C.warn(t.message)}}}function Y(e){return`${e.name}!${e.options.appId}`}class X{constructor(e){this.container=e,this._heartbeatsCache=null;let t=this.container.getProvider("app").getImmediate();this._storage=new ee(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){let e=this.container.getProvider("platform-logger").getImmediate(),t=e.getPlatformInfoString(),n=J();return(null===this._heartbeatsCache&&(this._heartbeatsCache=await this._heartbeatsCachePromise),this._heartbeatsCache.lastSentHeartbeatDate===n||this._heartbeatsCache.heartbeats.some(e=>e.date===n))?void 0:(this._heartbeatsCache.heartbeats.push({date:n,agent:t}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(e=>{let t=new Date(e.date).valueOf(),n=Date.now();return n-t<=2592e6}),this._storage.overwrite(this._heartbeatsCache))}async getHeartbeatsHeader(){if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null===this._heartbeatsCache||0===this._heartbeatsCache.heartbeats.length)return"";let e=J(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){let n=[],r=e.slice();for(let i of e){let e=n.find(e=>e.agent===i.agent);if(e){if(e.dates.push(i.date),et(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),et(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=(0,l.L)(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}}function J(){let e=new Date;return e.toISOString().substring(0,10)}class ee{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,l.hl)()&&(0,l.eu)().then(()=>!0).catch(()=>!1)}async read(){let e=await this._canUseIndexedDBPromise;if(!e)return{heartbeats:[]};{let e=await Z(this.app);return e||{heartbeats:[]}}}async overwrite(e){var t;let n=await this._canUseIndexedDBPromise;if(n){let n=await this.read();return Q(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;let n=await this._canUseIndexedDBPromise;if(n){let n=await this.read();return Q(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function et(e){return(0,l.L)(JSON.stringify({version:2,heartbeats:e})).length}P(new o.wA("platform-logger",e=>new I(e),"PRIVATE")),P(new o.wA("heartbeat",e=>new X(e),"PRIVATE")),z(T,E,""),z(T,E,"esm2017"),z("fire-js","")},740:function(e,t,n){"use strict";n.d(t,{H0:function(){return a},wA:function(){return i},zt:function(){return o}});var r=n(4444);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new r.BH;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;let n=this.normalizeInstanceIdentifier(null==e?void 0:e.identifier),r=null!==(t=null==e?void 0:e.optional)&&void 0!==t&&t;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(e){if(r)return null;throw e}else{if(r)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if("EAGER"===e.instantiationMode)try{this.getOrInitializeService({instanceIdentifier:s})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let n=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:n});t.resolve(e)}catch(e){}}}}clearInstance(e=s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=s){return this.instances.has(e)}getOptions(e=s){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(let[e,t]of this.instancesDeferred.entries()){let i=this.normalizeInstanceIdentifier(e);n===i&&t.resolve(r)}return r}onInit(e,t){var n;let r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);let s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let n=this.onInitCallbacks.get(t);if(n)for(let r of n)try{r(e,t)}catch(e){}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:e===s?void 0:e,options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch(e){}return n||null}normalizeInstanceIdentifier(e=s){return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){let t=this.getProvider(e.name);t.isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},3333:function(e,t,n){"use strict";var r,i;n.d(t,{Am:function(){return d},Ub:function(){return h},Yd:function(){return c},in:function(){return r}});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s=[];(i=r||(r={}))[i.DEBUG=0]="DEBUG",i[i.VERBOSE=1]="VERBOSE",i[i.INFO=2]="INFO",i[i.WARN=3]="WARN",i[i.ERROR=4]="ERROR",i[i.SILENT=5]="SILENT";let o={debug:r.DEBUG,verbose:r.VERBOSE,info:r.INFO,warn:r.WARN,error:r.ERROR,silent:r.SILENT},a=r.INFO,l={[r.DEBUG]:"log",[r.VERBOSE]:"log",[r.INFO]:"info",[r.WARN]:"warn",[r.ERROR]:"error"},u=(e,t,...n)=>{if(t<e.logLevel)return;let r=new Date().toISOString(),i=l[t];if(i)console[i](`[${r}]  ${e.name}:`,...n);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class c{constructor(e){this.name=e,this._logLevel=a,this._logHandler=u,this._userLogHandler=null,s.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in r))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?o[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,r.DEBUG,...e),this._logHandler(this,r.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,r.VERBOSE,...e),this._logHandler(this,r.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,r.INFO,...e),this._logHandler(this,r.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,r.WARN,...e),this._logHandler(this,r.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,r.ERROR,...e),this._logHandler(this,r.ERROR,...e)}}function h(e){s.forEach(t=>{t.setLogLevel(e)})}function d(e,t){for(let n of s){let i=null;t&&t.level&&(i=o[t.level]),null===e?n.userLogHandler=null:n.userLogHandler=(t,n,...s)=>{let o=s.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");n>=(null!=i?i:t.logLevel)&&e({level:r[n].toLowerCase(),message:o,args:s,type:t.name})}}}},1259:function(e,t,n){"use strict";n.d(t,{Xb:function(){return r.a8},v0:function(){return r.o},Aj:function(){return r.x},e5:function(){return r.a9},w7:function(){return r.B}});var r=n(1720);n(4444),n(5816),n(3333),n(740)},6845:function(e,t,n){"use strict";n.d(t,{B0:function(){return r.B0},Jt:function(){return r.Jt},cF:function(){return r.cF},iH:function(){return r.iH}});var r=n(774)}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[774,179],function(){return t(1118),t(6885)}),_N_E=e.O()}]);